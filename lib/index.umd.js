!function(e,t){"object"==typeof exports&&"undefined"!=typeof module?t(exports):"function"==typeof define&&define.amd?define(["exports"],t):t((e="undefined"!=typeof globalThis?globalThis:e||self).__MLK_Agent={})}(this,(function(exports){"use strict";function _mergeNamespaces(e,t){return t.forEach((function(t){t&&"string"!=typeof t&&!Array.isArray(t)&&Object.keys(t).forEach((function(r){if("default"!==r&&!(r in e)){var i=Object.getOwnPropertyDescriptor(t,r);Object.defineProperty(e,r,i.get?i:{enumerable:!0,get:function(){return t[r]}})}}))})),Object.freeze(e)}let logDisabled_=!0,deprecationWarnings_=!0;function extractVersion(e,t,r){const i=e.match(t);return i&&i.length>=r&&parseInt(i[r],10)}function wrapPeerConnectionEvent(e,t,r){if(!e.RTCPeerConnection)return;const i=e.RTCPeerConnection.prototype,n=i.addEventListener;i.addEventListener=function(e,i){if(e!==t)return n.apply(this,arguments);const s=e=>{const t=r(e);t&&(i.handleEvent?i.handleEvent(t):i(t))};return this.h=this.h||{},this.h[t]||(this.h[t]=new Map),this.h[t].set(i,s),n.apply(this,[e,s])};const s=i.removeEventListener;i.removeEventListener=function(e,r){if(e!==t||!this.h||!this.h[t])return s.apply(this,arguments);if(!this.h[t].has(r))return s.apply(this,arguments);const i=this.h[t].get(r);return this.h[t].delete(r),0===this.h[t].size&&delete this.h[t],0===Object.keys(this.h).length&&delete this.h,s.apply(this,[e,i])},Object.defineProperty(i,"on"+t,{get(){return this["_on"+t]},set(e){this["_on"+t]&&(this.removeEventListener(t,this["_on"+t]),delete this["_on"+t]),e&&this.addEventListener(t,this["_on"+t]=e)},enumerable:!0,configurable:!0})}function disableLog(e){return"boolean"!=typeof e?new Error("Argument type: "+typeof e+". Please use a boolean."):(logDisabled_=e,e?"adapter.js logging disabled":"adapter.js logging enabled")}function disableWarnings(e){return"boolean"!=typeof e?new Error("Argument type: "+typeof e+". Please use a boolean."):(deprecationWarnings_=!e,"adapter.js deprecation warnings "+(e?"disabled":"enabled"))}function log(){if("object"==typeof window){if(logDisabled_)return;"undefined"!=typeof console&&"function"==typeof console.log&&console.log.apply(console,arguments)}}function deprecated(e,t){deprecationWarnings_&&console.warn(e+" is deprecated, please use "+t+" instead.")}function detectBrowser(e){const t={browser:null,version:null};if(void 0===e||!e.navigator)return t.browser="Not a browser.",t;const{navigator:r}=e;if(r.mozGetUserMedia)t.browser="firefox",t.version=extractVersion(r.userAgent,/Firefox\/(\d+)\./,1);else if(r.webkitGetUserMedia||!1===e.isSecureContext&&e.webkitRTCPeerConnection)t.browser="chrome",t.version=extractVersion(r.userAgent,/Chrom(e|ium)\/(\d+)\./,2);else{if(!e.RTCPeerConnection||!r.userAgent.match(/AppleWebKit\/(\d+)\./))return t.browser="Not a supported browser.",t;t.browser="safari",t.version=extractVersion(r.userAgent,/AppleWebKit\/(\d+)\./,1),t.supportsUnifiedPlan=e.RTCRtpTransceiver&&"currentDirection"in e.RTCRtpTransceiver.prototype}return t}function isObject$a(e){return"[object Object]"===Object.prototype.toString.call(e)}function compactObject(e){return isObject$a(e)?Object.keys(e).reduce((function(t,r){const i=isObject$a(e[r]),n=i?compactObject(e[r]):e[r],s=i&&!Object.keys(n).length;return void 0===n||s?t:Object.assign(t,{[r]:n})}),{}):e}function walkStats(e,t,r){t&&!r.has(t.id)&&(r.set(t.id,t),Object.keys(t).forEach((i=>{i.endsWith("Id")?walkStats(e,e.get(t[i]),r):i.endsWith("Ids")&&t[i].forEach((t=>{walkStats(e,e.get(t),r)}))})))}function filterStats(e,t,r){const i=r?"outbound-rtp":"inbound-rtp",n=new Map;if(null===t)return n;const s=[];return e.forEach((e=>{"track"===e.type&&e.trackIdentifier===t.id&&s.push(e)})),s.forEach((t=>{e.forEach((r=>{r.type===i&&r.trackId===t.id&&walkStats(e,r,n)}))})),n}const logging=log;function shimGetUserMedia$2(e,t){const r=e&&e.navigator;if(!r.mediaDevices)return;const i=function(e){if("object"!=typeof e||e.mandatory||e.optional)return e;const t={};return Object.keys(e).forEach((r=>{if("require"===r||"advanced"===r||"mediaSource"===r)return;const i="object"==typeof e[r]?e[r]:{ideal:e[r]};void 0!==i.exact&&"number"==typeof i.exact&&(i.min=i.max=i.exact);const n=function(e,t){return e?e+t.charAt(0).toUpperCase()+t.slice(1):"deviceId"===t?"sourceId":t};if(void 0!==i.ideal){t.optional=t.optional||[];let e={};"number"==typeof i.ideal?(e[n("min",r)]=i.ideal,t.optional.push(e),e={},e[n("max",r)]=i.ideal,t.optional.push(e)):(e[n("",r)]=i.ideal,t.optional.push(e))}void 0!==i.exact&&"number"!=typeof i.exact?(t.mandatory=t.mandatory||{},t.mandatory[n("",r)]=i.exact):["min","max"].forEach((e=>{void 0!==i[e]&&(t.mandatory=t.mandatory||{},t.mandatory[n(e,r)]=i[e])}))})),e.advanced&&(t.optional=(t.optional||[]).concat(e.advanced)),t},n=function(e,n){if(t.version>=61)return n(e);if((e=JSON.parse(JSON.stringify(e)))&&"object"==typeof e.audio){const t=function(e,t,r){t in e&&!(r in e)&&(e[r]=e[t],delete e[t])};t((e=JSON.parse(JSON.stringify(e))).audio,"autoGainControl","googAutoGainControl"),t(e.audio,"noiseSuppression","googNoiseSuppression"),e.audio=i(e.audio)}if(e&&"object"==typeof e.video){let s=e.video.facingMode;s=s&&("object"==typeof s?s:{ideal:s});const o=t.version<66;if(s&&("user"===s.exact||"environment"===s.exact||"user"===s.ideal||"environment"===s.ideal)&&(!r.mediaDevices.getSupportedConstraints||!r.mediaDevices.getSupportedConstraints().facingMode||o)){let t;if(delete e.video.facingMode,"environment"===s.exact||"environment"===s.ideal?t=["back","rear"]:"user"!==s.exact&&"user"!==s.ideal||(t=["front"]),t)return r.mediaDevices.enumerateDevices().then((r=>{r=r.filter((e=>"videoinput"===e.kind));let o=r.find((e=>t.some((t=>e.label.toLowerCase().includes(t)))));return!o&&r.length&&t.includes("back")&&(o=r[r.length-1]),o&&(e.video.deviceId=s.exact?{exact:o.deviceId}:{ideal:o.deviceId}),e.video=i(e.video),logging("chrome: "+JSON.stringify(e)),n(e)}))}e.video=i(e.video)}return logging("chrome: "+JSON.stringify(e)),n(e)},s=function(e){return t.version>=64?e:{name:{PermissionDeniedError:"NotAllowedError",PermissionDismissedError:"NotAllowedError",InvalidStateError:"NotAllowedError",DevicesNotFoundError:"NotFoundError",ConstraintNotSatisfiedError:"OverconstrainedError",TrackStartError:"NotReadableError",MediaDeviceFailedDueToShutdown:"NotAllowedError",MediaDeviceKillSwitchOn:"NotAllowedError",TabCaptureError:"AbortError",ScreenCaptureError:"AbortError",DeviceCaptureError:"AbortError"}[e.name]||e.name,message:e.message,constraint:e.constraint||e.constraintName,toString(){return this.name+(this.message&&": ")+this.message}}};if(r.getUserMedia=function(e,t,i){n(e,(e=>{r.webkitGetUserMedia(e,t,(e=>{i&&i(s(e))}))}))}.bind(r),r.mediaDevices.getUserMedia){const e=r.mediaDevices.getUserMedia.bind(r.mediaDevices);r.mediaDevices.getUserMedia=function(t){return n(t,(t=>e(t).then((e=>{if(t.audio&&!e.getAudioTracks().length||t.video&&!e.getVideoTracks().length)throw e.getTracks().forEach((e=>{e.stop()})),new DOMException("","NotFoundError");return e}),(e=>Promise.reject(s(e))))))}}}function shimGetDisplayMedia$1(e,t){e.navigator.mediaDevices&&"getDisplayMedia"in e.navigator.mediaDevices||e.navigator.mediaDevices&&("function"==typeof t?e.navigator.mediaDevices.getDisplayMedia=function(r){return t(r).then((t=>{const i=r.video&&r.video.width,n=r.video&&r.video.height,s=r.video&&r.video.frameRate;return r.video={mandatory:{chromeMediaSource:"desktop",chromeMediaSourceId:t,maxFrameRate:s||3}},i&&(r.video.mandatory.maxWidth=i),n&&(r.video.mandatory.maxHeight=n),e.navigator.mediaDevices.getUserMedia(r)}))}:console.error("shimGetDisplayMedia: getSourceId argument is not a function"))}function shimMediaStream(e){e.MediaStream=e.MediaStream||e.webkitMediaStream}function shimOnTrack$1(e){if("object"==typeof e&&e.RTCPeerConnection&&!("ontrack"in e.RTCPeerConnection.prototype)){Object.defineProperty(e.RTCPeerConnection.prototype,"ontrack",{get(){return this.l},set(e){this.l&&this.removeEventListener("track",this.l),this.addEventListener("track",this.l=e)},enumerable:!0,configurable:!0});const t=e.RTCPeerConnection.prototype.setRemoteDescription;e.RTCPeerConnection.prototype.setRemoteDescription=function(){return this.g||(this.g=t=>{t.stream.addEventListener("addtrack",(r=>{let i;i=e.RTCPeerConnection.prototype.getReceivers?this.getReceivers().find((e=>e.track&&e.track.id===r.track.id)):{track:r.track};const n=new Event("track");n.track=r.track,n.receiver=i,n.transceiver={receiver:i},n.streams=[t.stream],this.dispatchEvent(n)})),t.stream.getTracks().forEach((r=>{let i;i=e.RTCPeerConnection.prototype.getReceivers?this.getReceivers().find((e=>e.track&&e.track.id===r.id)):{track:r};const n=new Event("track");n.track=r,n.receiver=i,n.transceiver={receiver:i},n.streams=[t.stream],this.dispatchEvent(n)}))},this.addEventListener("addstream",this.g)),t.apply(this,arguments)}}else wrapPeerConnectionEvent(e,"track",(e=>(e.transceiver||Object.defineProperty(e,"transceiver",{value:{receiver:e.receiver}}),e)))}function shimGetSendersWithDtmf(e){if("object"==typeof e&&e.RTCPeerConnection&&!("getSenders"in e.RTCPeerConnection.prototype)&&"createDTMFSender"in e.RTCPeerConnection.prototype){const t=function(e,t){return{track:t,get dtmf(){return void 0===this.$&&("audio"===t.kind?this.$=e.createDTMFSender(t):this.$=null),this.$},S:e}};if(!e.RTCPeerConnection.prototype.getSenders){e.RTCPeerConnection.prototype.getSenders=function(){return this.k=this.k||[],this.k.slice()};const r=e.RTCPeerConnection.prototype.addTrack;e.RTCPeerConnection.prototype.addTrack=function(e,i){let n=r.apply(this,arguments);return n||(n=t(this,e),this.k.push(n)),n};const i=e.RTCPeerConnection.prototype.removeTrack;e.RTCPeerConnection.prototype.removeTrack=function(e){i.apply(this,arguments);const t=this.k.indexOf(e);-1!==t&&this.k.splice(t,1)}}const r=e.RTCPeerConnection.prototype.addStream;e.RTCPeerConnection.prototype.addStream=function(e){this.k=this.k||[],r.apply(this,[e]),e.getTracks().forEach((e=>{this.k.push(t(this,e))}))};const i=e.RTCPeerConnection.prototype.removeStream;e.RTCPeerConnection.prototype.removeStream=function(e){this.k=this.k||[],i.apply(this,[e]),e.getTracks().forEach((e=>{const t=this.k.find((t=>t.track===e));t&&this.k.splice(this.k.indexOf(t),1)}))}}else if("object"==typeof e&&e.RTCPeerConnection&&"getSenders"in e.RTCPeerConnection.prototype&&"createDTMFSender"in e.RTCPeerConnection.prototype&&e.RTCRtpSender&&!("dtmf"in e.RTCRtpSender.prototype)){const t=e.RTCPeerConnection.prototype.getSenders;e.RTCPeerConnection.prototype.getSenders=function(){const e=t.apply(this,[]);return e.forEach((e=>e.S=this)),e},Object.defineProperty(e.RTCRtpSender.prototype,"dtmf",{get(){return void 0===this.$&&("audio"===this.track.kind?this.$=this.S.createDTMFSender(this.track):this.$=null),this.$}})}}function shimGetStats(e){if(!e.RTCPeerConnection)return;const t=e.RTCPeerConnection.prototype.getStats;e.RTCPeerConnection.prototype.getStats=function(){const[e,r,i]=arguments;if(arguments.length>0&&"function"==typeof e)return t.apply(this,arguments);if(0===t.length&&(0===arguments.length||"function"!=typeof e))return t.apply(this,[]);const n=function(e){const t={};return e.result().forEach((e=>{const r={id:e.id,timestamp:e.timestamp,type:{localcandidate:"local-candidate",remotecandidate:"remote-candidate"}[e.type]||e.type};e.names().forEach((t=>{r[t]=e.stat(t)})),t[r.id]=r})),t},s=function(e){return new Map(Object.keys(e).map((t=>[t,e[t]])))};if(arguments.length>=2){const i=function(e){r(s(n(e)))};return t.apply(this,[i,e])}return new Promise(((e,r)=>{t.apply(this,[function(t){e(s(n(t)))},r])})).then(r,i)}}function shimSenderReceiverGetStats(e){if(!("object"==typeof e&&e.RTCPeerConnection&&e.RTCRtpSender&&e.RTCRtpReceiver))return;if(!("getStats"in e.RTCRtpSender.prototype)){const t=e.RTCPeerConnection.prototype.getSenders;t&&(e.RTCPeerConnection.prototype.getSenders=function(){const e=t.apply(this,[]);return e.forEach((e=>e.S=this)),e});const r=e.RTCPeerConnection.prototype.addTrack;r&&(e.RTCPeerConnection.prototype.addTrack=function(){const e=r.apply(this,arguments);return e.S=this,e}),e.RTCRtpSender.prototype.getStats=function(){const e=this;return this.S.getStats().then((t=>filterStats(t,e.track,!0)))}}if(!("getStats"in e.RTCRtpReceiver.prototype)){const t=e.RTCPeerConnection.prototype.getReceivers;t&&(e.RTCPeerConnection.prototype.getReceivers=function(){const e=t.apply(this,[]);return e.forEach((e=>e.S=this)),e}),wrapPeerConnectionEvent(e,"track",(e=>(e.receiver.S=e.srcElement,e))),e.RTCRtpReceiver.prototype.getStats=function(){const e=this;return this.S.getStats().then((t=>filterStats(t,e.track,!1)))}}if(!("getStats"in e.RTCRtpSender.prototype)||!("getStats"in e.RTCRtpReceiver.prototype))return;const t=e.RTCPeerConnection.prototype.getStats;e.RTCPeerConnection.prototype.getStats=function(){if(arguments.length>0&&arguments[0]instanceof e.MediaStreamTrack){const e=arguments[0];let t,r,i;return this.getSenders().forEach((r=>{r.track===e&&(t?i=!0:t=r)})),this.getReceivers().forEach((t=>(t.track===e&&(r?i=!0:r=t),t.track===e))),i||t&&r?Promise.reject(new DOMException("There are more than one sender or receiver for the track.","InvalidAccessError")):t?t.getStats():r?r.getStats():Promise.reject(new DOMException("There is no sender or receiver for the track.","InvalidAccessError"))}return t.apply(this,arguments)}}function shimAddTrackRemoveTrackWithNative(e){e.RTCPeerConnection.prototype.getLocalStreams=function(){return this.C=this.C||{},Object.keys(this.C).map((e=>this.C[e][0]))};const t=e.RTCPeerConnection.prototype.addTrack;e.RTCPeerConnection.prototype.addTrack=function(e,r){if(!r)return t.apply(this,arguments);this.C=this.C||{};const i=t.apply(this,arguments);return this.C[r.id]?-1===this.C[r.id].indexOf(i)&&this.C[r.id].push(i):this.C[r.id]=[r,i],i};const r=e.RTCPeerConnection.prototype.addStream;e.RTCPeerConnection.prototype.addStream=function(e){this.C=this.C||{},e.getTracks().forEach((e=>{const t=this.getSenders().find((t=>t.track===e));if(t)throw new DOMException("Track already exists.","InvalidAccessError")}));const t=this.getSenders();r.apply(this,arguments);const i=this.getSenders().filter((e=>-1===t.indexOf(e)));this.C[e.id]=[e].concat(i)};const i=e.RTCPeerConnection.prototype.removeStream;e.RTCPeerConnection.prototype.removeStream=function(e){return this.C=this.C||{},delete this.C[e.id],i.apply(this,arguments)};const n=e.RTCPeerConnection.prototype.removeTrack;e.RTCPeerConnection.prototype.removeTrack=function(e){return this.C=this.C||{},e&&Object.keys(this.C).forEach((t=>{const r=this.C[t].indexOf(e);-1!==r&&this.C[t].splice(r,1),1===this.C[t].length&&delete this.C[t]})),n.apply(this,arguments)}}function shimAddTrackRemoveTrack(e,t){if(!e.RTCPeerConnection)return;if(e.RTCPeerConnection.prototype.addTrack&&t.version>=65)return shimAddTrackRemoveTrackWithNative(e);const r=e.RTCPeerConnection.prototype.getLocalStreams;e.RTCPeerConnection.prototype.getLocalStreams=function(){const e=r.apply(this);return this.A=this.A||{},e.map((e=>this.A[e.id]))};const i=e.RTCPeerConnection.prototype.addStream;e.RTCPeerConnection.prototype.addStream=function(t){if(this._=this._||{},this.A=this.A||{},t.getTracks().forEach((e=>{const t=this.getSenders().find((t=>t.track===e));if(t)throw new DOMException("Track already exists.","InvalidAccessError")})),!this.A[t.id]){const r=new e.MediaStream(t.getTracks());this._[t.id]=r,this.A[r.id]=t,t=r}i.apply(this,[t])};const n=e.RTCPeerConnection.prototype.removeStream;function s(e,t){let r=t.sdp;return Object.keys(e.A||[]).forEach((t=>{const i=e.A[t],n=e._[i.id];r=r.replace(new RegExp(n.id,"g"),i.id)})),new RTCSessionDescription({type:t.type,sdp:r})}e.RTCPeerConnection.prototype.removeStream=function(e){this._=this._||{},this.A=this.A||{},n.apply(this,[this._[e.id]||e]),delete this.A[this._[e.id]?this._[e.id].id:e.id],delete this._[e.id]},e.RTCPeerConnection.prototype.addTrack=function(t,r){if("closed"===this.signalingState)throw new DOMException("The RTCPeerConnection's signalingState is 'closed'.","InvalidStateError");const i=[].slice.call(arguments,1);if(1!==i.length||!i[0].getTracks().find((e=>e===t)))throw new DOMException("The adapter.js addTrack polyfill only supports a single  stream which is associated with the specified track.","NotSupportedError");const n=this.getSenders().find((e=>e.track===t));if(n)throw new DOMException("Track already exists.","InvalidAccessError");this._=this._||{},this.A=this.A||{};const s=this._[r.id];if(s)s.addTrack(t),Promise.resolve().then((()=>{this.dispatchEvent(new Event("negotiationneeded"))}));else{const i=new e.MediaStream([t]);this._[r.id]=i,this.A[i.id]=r,this.addStream(i)}return this.getSenders().find((e=>e.track===t))},["createOffer","createAnswer"].forEach((function(t){const r=e.RTCPeerConnection.prototype[t],i={[t](){const e=arguments;return arguments.length&&"function"==typeof arguments[0]?r.apply(this,[t=>{const r=s(this,t);e[0].apply(null,[r])},t=>{e[1]&&e[1].apply(null,t)},arguments[2]]):r.apply(this,arguments).then((e=>s(this,e)))}};e.RTCPeerConnection.prototype[t]=i[t]}));const o=e.RTCPeerConnection.prototype.setLocalDescription;e.RTCPeerConnection.prototype.setLocalDescription=function(){return arguments.length&&arguments[0].type?(arguments[0]=function(e,t){let r=t.sdp;return Object.keys(e.A||[]).forEach((t=>{const i=e.A[t],n=e._[i.id];r=r.replace(new RegExp(i.id,"g"),n.id)})),new RTCSessionDescription({type:t.type,sdp:r})}(this,arguments[0]),o.apply(this,arguments)):o.apply(this,arguments)};const a=Object.getOwnPropertyDescriptor(e.RTCPeerConnection.prototype,"localDescription");Object.defineProperty(e.RTCPeerConnection.prototype,"localDescription",{get(){const e=a.get.apply(this);return""===e.type?e:s(this,e)}}),e.RTCPeerConnection.prototype.removeTrack=function(e){if("closed"===this.signalingState)throw new DOMException("The RTCPeerConnection's signalingState is 'closed'.","InvalidStateError");if(!e.S)throw new DOMException("Argument 1 of RTCPeerConnection.removeTrack does not implement interface RTCRtpSender.","TypeError");if(e.S!==this)throw new DOMException("Sender was not created by this connection.","InvalidAccessError");let t;this._=this._||{},Object.keys(this._).forEach((r=>{this._[r].getTracks().find((t=>e.track===t))&&(t=this._[r])})),t&&(1===t.getTracks().length?this.removeStream(this.A[t.id]):t.removeTrack(e.track),this.dispatchEvent(new Event("negotiationneeded")))}}function shimPeerConnection$1(e,t){!e.RTCPeerConnection&&e.webkitRTCPeerConnection&&(e.RTCPeerConnection=e.webkitRTCPeerConnection),e.RTCPeerConnection&&t.version<53&&["setLocalDescription","setRemoteDescription","addIceCandidate"].forEach((function(t){const r=e.RTCPeerConnection.prototype[t],i={[t](){return arguments[0]=new("addIceCandidate"===t?e.RTCIceCandidate:e.RTCSessionDescription)(arguments[0]),r.apply(this,arguments)}};e.RTCPeerConnection.prototype[t]=i[t]}))}function fixNegotiationNeeded(e,t){wrapPeerConnectionEvent(e,"negotiationneeded",(e=>{const r=e.target;if(!(t.version<72||r.getConfiguration&&"plan-b"===r.getConfiguration().sdpSemantics)||"stable"===r.signalingState)return e}))}var chromeShim=Object.freeze({__proto__:null,fixNegotiationNeeded:fixNegotiationNeeded,shimAddTrackRemoveTrack:shimAddTrackRemoveTrack,shimAddTrackRemoveTrackWithNative:shimAddTrackRemoveTrackWithNative,shimGetDisplayMedia:shimGetDisplayMedia$1,shimGetSendersWithDtmf:shimGetSendersWithDtmf,shimGetStats:shimGetStats,shimGetUserMedia:shimGetUserMedia$2,shimMediaStream:shimMediaStream,shimOnTrack:shimOnTrack$1,shimPeerConnection:shimPeerConnection$1,shimSenderReceiverGetStats:shimSenderReceiverGetStats});function shimGetUserMedia$1(e,t){const r=e&&e.navigator,i=e&&e.MediaStreamTrack;if(r.getUserMedia=function(e,t,i){deprecated("navigator.getUserMedia","navigator.mediaDevices.getUserMedia"),r.mediaDevices.getUserMedia(e).then(t,i)},!(t.version>55&&"autoGainControl"in r.mediaDevices.getSupportedConstraints())){const e=function(e,t,r){t in e&&!(r in e)&&(e[r]=e[t],delete e[t])},t=r.mediaDevices.getUserMedia.bind(r.mediaDevices);if(r.mediaDevices.getUserMedia=function(r){return"object"==typeof r&&"object"==typeof r.audio&&(r=JSON.parse(JSON.stringify(r)),e(r.audio,"autoGainControl","mozAutoGainControl"),e(r.audio,"noiseSuppression","mozNoiseSuppression")),t(r)},i&&i.prototype.getSettings){const t=i.prototype.getSettings;i.prototype.getSettings=function(){const r=t.apply(this,arguments);return e(r,"mozAutoGainControl","autoGainControl"),e(r,"mozNoiseSuppression","noiseSuppression"),r}}if(i&&i.prototype.applyConstraints){const t=i.prototype.applyConstraints;i.prototype.applyConstraints=function(r){return"audio"===this.kind&&"object"==typeof r&&(r=JSON.parse(JSON.stringify(r)),e(r,"autoGainControl","mozAutoGainControl"),e(r,"noiseSuppression","mozNoiseSuppression")),t.apply(this,[r])}}}}function shimGetDisplayMedia(e,t){e.navigator.mediaDevices&&"getDisplayMedia"in e.navigator.mediaDevices||e.navigator.mediaDevices&&(e.navigator.mediaDevices.getDisplayMedia=function(r){if(!r||!r.video){const e=new DOMException("getDisplayMedia without video constraints is undefined");return e.name="NotFoundError",e.code=8,Promise.reject(e)}return!0===r.video?r.video={mediaSource:t}:r.video.mediaSource=t,e.navigator.mediaDevices.getUserMedia(r)})}function shimOnTrack(e){"object"==typeof e&&e.RTCTrackEvent&&"receiver"in e.RTCTrackEvent.prototype&&!("transceiver"in e.RTCTrackEvent.prototype)&&Object.defineProperty(e.RTCTrackEvent.prototype,"transceiver",{get(){return{receiver:this.receiver}}})}function shimPeerConnection(e,t){if("object"!=typeof e||!e.RTCPeerConnection&&!e.mozRTCPeerConnection)return;!e.RTCPeerConnection&&e.mozRTCPeerConnection&&(e.RTCPeerConnection=e.mozRTCPeerConnection),t.version<53&&["setLocalDescription","setRemoteDescription","addIceCandidate"].forEach((function(t){const r=e.RTCPeerConnection.prototype[t],i={[t](){return arguments[0]=new("addIceCandidate"===t?e.RTCIceCandidate:e.RTCSessionDescription)(arguments[0]),r.apply(this,arguments)}};e.RTCPeerConnection.prototype[t]=i[t]}));const r={inboundrtp:"inbound-rtp",outboundrtp:"outbound-rtp",candidatepair:"candidate-pair",localcandidate:"local-candidate",remotecandidate:"remote-candidate"},i=e.RTCPeerConnection.prototype.getStats;e.RTCPeerConnection.prototype.getStats=function(){const[e,n,s]=arguments;return i.apply(this,[e||null]).then((e=>{if(t.version<53&&!n)try{e.forEach((e=>{e.type=r[e.type]||e.type}))}catch(t){if("TypeError"!==t.name)throw t;e.forEach(((t,i)=>{e.set(i,Object.assign({},t,{type:r[t.type]||t.type}))}))}return e})).then(n,s)}}function shimSenderGetStats(e){if("object"!=typeof e||!e.RTCPeerConnection||!e.RTCRtpSender)return;if(e.RTCRtpSender&&"getStats"in e.RTCRtpSender.prototype)return;const t=e.RTCPeerConnection.prototype.getSenders;t&&(e.RTCPeerConnection.prototype.getSenders=function(){const e=t.apply(this,[]);return e.forEach((e=>e.S=this)),e});const r=e.RTCPeerConnection.prototype.addTrack;r&&(e.RTCPeerConnection.prototype.addTrack=function(){const e=r.apply(this,arguments);return e.S=this,e}),e.RTCRtpSender.prototype.getStats=function(){return this.track?this.S.getStats(this.track):Promise.resolve(new Map)}}function shimReceiverGetStats(e){if("object"!=typeof e||!e.RTCPeerConnection||!e.RTCRtpSender)return;if(e.RTCRtpSender&&"getStats"in e.RTCRtpReceiver.prototype)return;const t=e.RTCPeerConnection.prototype.getReceivers;t&&(e.RTCPeerConnection.prototype.getReceivers=function(){const e=t.apply(this,[]);return e.forEach((e=>e.S=this)),e}),wrapPeerConnectionEvent(e,"track",(e=>(e.receiver.S=e.srcElement,e))),e.RTCRtpReceiver.prototype.getStats=function(){return this.S.getStats(this.track)}}function shimRemoveStream(e){e.RTCPeerConnection&&!("removeStream"in e.RTCPeerConnection.prototype)&&(e.RTCPeerConnection.prototype.removeStream=function(e){deprecated("removeStream","removeTrack"),this.getSenders().forEach((t=>{t.track&&e.getTracks().includes(t.track)&&this.removeTrack(t)}))})}function shimRTCDataChannel(e){e.DataChannel&&!e.RTCDataChannel&&(e.RTCDataChannel=e.DataChannel)}function shimAddTransceiver(e){if("object"!=typeof e||!e.RTCPeerConnection)return;const t=e.RTCPeerConnection.prototype.addTransceiver;t&&(e.RTCPeerConnection.prototype.addTransceiver=function(){this.setParametersPromises=[];let e=arguments[1]&&arguments[1].sendEncodings;void 0===e&&(e=[]),e=[...e];const r=e.length>0;r&&e.forEach((e=>{if("rid"in e&&!/^[a-z0-9]{0,16}$/i.test(e.rid))throw new TypeError("Invalid RID value provided.");if("scaleResolutionDownBy"in e&&!(parseFloat(e.scaleResolutionDownBy)>=1))throw new RangeError("scale_resolution_down_by must be >= 1.0");if("maxFramerate"in e&&!(parseFloat(e.maxFramerate)>=0))throw new RangeError("max_framerate must be >= 0.0")}));const i=t.apply(this,arguments);if(r){const{sender:t}=i,r=t.getParameters();(!("encodings"in r)||1===r.encodings.length&&0===Object.keys(r.encodings[0]).length)&&(r.encodings=e,t.sendEncodings=e,this.setParametersPromises.push(t.setParameters(r).then((()=>{delete t.sendEncodings})).catch((()=>{delete t.sendEncodings}))))}return i})}function shimGetParameters(e){if("object"!=typeof e||!e.RTCRtpSender)return;const t=e.RTCRtpSender.prototype.getParameters;t&&(e.RTCRtpSender.prototype.getParameters=function(){const e=t.apply(this,arguments);return"encodings"in e||(e.encodings=[].concat(this.sendEncodings||[{}])),e})}function shimCreateOffer(e){if("object"!=typeof e||!e.RTCPeerConnection)return;const t=e.RTCPeerConnection.prototype.createOffer;e.RTCPeerConnection.prototype.createOffer=function(){return this.setParametersPromises&&this.setParametersPromises.length?Promise.all(this.setParametersPromises).then((()=>t.apply(this,arguments))).finally((()=>{this.setParametersPromises=[]})):t.apply(this,arguments)}}function shimCreateAnswer(e){if("object"!=typeof e||!e.RTCPeerConnection)return;const t=e.RTCPeerConnection.prototype.createAnswer;e.RTCPeerConnection.prototype.createAnswer=function(){return this.setParametersPromises&&this.setParametersPromises.length?Promise.all(this.setParametersPromises).then((()=>t.apply(this,arguments))).finally((()=>{this.setParametersPromises=[]})):t.apply(this,arguments)}}var firefoxShim=Object.freeze({__proto__:null,shimAddTransceiver:shimAddTransceiver,shimCreateAnswer:shimCreateAnswer,shimCreateOffer:shimCreateOffer,shimGetDisplayMedia:shimGetDisplayMedia,shimGetParameters:shimGetParameters,shimGetUserMedia:shimGetUserMedia$1,shimOnTrack:shimOnTrack,shimPeerConnection:shimPeerConnection,shimRTCDataChannel:shimRTCDataChannel,shimReceiverGetStats:shimReceiverGetStats,shimRemoveStream:shimRemoveStream,shimSenderGetStats:shimSenderGetStats});function shimLocalStreamsAPI(e){if("object"==typeof e&&e.RTCPeerConnection){if("getLocalStreams"in e.RTCPeerConnection.prototype||(e.RTCPeerConnection.prototype.getLocalStreams=function(){return this.T||(this.T=[]),this.T}),!("addStream"in e.RTCPeerConnection.prototype)){const t=e.RTCPeerConnection.prototype.addTrack;e.RTCPeerConnection.prototype.addStream=function(e){this.T||(this.T=[]),this.T.includes(e)||this.T.push(e),e.getAudioTracks().forEach((r=>t.call(this,r,e))),e.getVideoTracks().forEach((r=>t.call(this,r,e)))},e.RTCPeerConnection.prototype.addTrack=function(e,...r){return r&&r.forEach((e=>{this.T?this.T.includes(e)||this.T.push(e):this.T=[e]})),t.apply(this,arguments)}}"removeStream"in e.RTCPeerConnection.prototype||(e.RTCPeerConnection.prototype.removeStream=function(e){this.T||(this.T=[]);const t=this.T.indexOf(e);if(-1===t)return;this.T.splice(t,1);const r=e.getTracks();this.getSenders().forEach((e=>{r.includes(e.track)&&this.removeTrack(e)}))})}}function shimRemoteStreamsAPI(e){if("object"==typeof e&&e.RTCPeerConnection&&("getRemoteStreams"in e.RTCPeerConnection.prototype||(e.RTCPeerConnection.prototype.getRemoteStreams=function(){return this.R?this.R:[]}),!("onaddstream"in e.RTCPeerConnection.prototype))){Object.defineProperty(e.RTCPeerConnection.prototype,"onaddstream",{get(){return this.O},set(e){this.O&&(this.removeEventListener("addstream",this.O),this.removeEventListener("track",this.I)),this.addEventListener("addstream",this.O=e),this.addEventListener("track",this.I=e=>{e.streams.forEach((e=>{if(this.R||(this.R=[]),this.R.includes(e))return;this.R.push(e);const t=new Event("addstream");t.stream=e,this.dispatchEvent(t)}))})}});const t=e.RTCPeerConnection.prototype.setRemoteDescription;e.RTCPeerConnection.prototype.setRemoteDescription=function(){const e=this;return this.I||this.addEventListener("track",this.I=function(t){t.streams.forEach((t=>{if(e.R||(e.R=[]),e.R.indexOf(t)>=0)return;e.R.push(t);const r=new Event("addstream");r.stream=t,e.dispatchEvent(r)}))}),t.apply(e,arguments)}}}function shimCallbacksAPI(e){if("object"!=typeof e||!e.RTCPeerConnection)return;const t=e.RTCPeerConnection.prototype,r=t.createOffer,i=t.createAnswer,n=t.setLocalDescription,s=t.setRemoteDescription,o=t.addIceCandidate;t.createOffer=function(e,t){const i=arguments.length>=2?arguments[2]:arguments[0],n=r.apply(this,[i]);return t?(n.then(e,t),Promise.resolve()):n},t.createAnswer=function(e,t){const r=arguments.length>=2?arguments[2]:arguments[0],n=i.apply(this,[r]);return t?(n.then(e,t),Promise.resolve()):n};let a=function(e,t,r){const i=n.apply(this,[e]);return r?(i.then(t,r),Promise.resolve()):i};t.setLocalDescription=a,a=function(e,t,r){const i=s.apply(this,[e]);return r?(i.then(t,r),Promise.resolve()):i},t.setRemoteDescription=a,a=function(e,t,r){const i=o.apply(this,[e]);return r?(i.then(t,r),Promise.resolve()):i},t.addIceCandidate=a}function shimGetUserMedia(e){const t=e&&e.navigator;if(t.mediaDevices&&t.mediaDevices.getUserMedia){const e=t.mediaDevices,r=e.getUserMedia.bind(e);t.mediaDevices.getUserMedia=e=>r(shimConstraints(e))}!t.getUserMedia&&t.mediaDevices&&t.mediaDevices.getUserMedia&&(t.getUserMedia=function(e,r,i){t.mediaDevices.getUserMedia(e).then(r,i)}.bind(t))}function shimConstraints(e){return e&&void 0!==e.video?Object.assign({},e,{video:compactObject(e.video)}):e}function shimRTCIceServerUrls(e){if(!e.RTCPeerConnection)return;const t=e.RTCPeerConnection;e.RTCPeerConnection=function(e,r){if(e&&e.iceServers){const t=[];for(let r=0;r<e.iceServers.length;r++){let i=e.iceServers[r];!i.hasOwnProperty("urls")&&i.hasOwnProperty("url")?(deprecated("RTCIceServer.url","RTCIceServer.urls"),i=JSON.parse(JSON.stringify(i)),i.urls=i.url,delete i.url,t.push(i)):t.push(e.iceServers[r])}e.iceServers=t}return new t(e,r)},e.RTCPeerConnection.prototype=t.prototype,"generateCertificate"in t&&Object.defineProperty(e.RTCPeerConnection,"generateCertificate",{get:()=>t.generateCertificate})}function shimTrackEventTransceiver(e){"object"==typeof e&&e.RTCTrackEvent&&"receiver"in e.RTCTrackEvent.prototype&&!("transceiver"in e.RTCTrackEvent.prototype)&&Object.defineProperty(e.RTCTrackEvent.prototype,"transceiver",{get(){return{receiver:this.receiver}}})}function shimCreateOfferLegacy(e){const t=e.RTCPeerConnection.prototype.createOffer;e.RTCPeerConnection.prototype.createOffer=function(e){if(e){void 0!==e.offerToReceiveAudio&&(e.offerToReceiveAudio=!!e.offerToReceiveAudio);const t=this.getTransceivers().find((e=>"audio"===e.receiver.track.kind));!1===e.offerToReceiveAudio&&t?"sendrecv"===t.direction?t.setDirection?t.setDirection("sendonly"):t.direction="sendonly":"recvonly"===t.direction&&(t.setDirection?t.setDirection("inactive"):t.direction="inactive"):!0!==e.offerToReceiveAudio||t||this.addTransceiver("audio",{direction:"recvonly"}),void 0!==e.offerToReceiveVideo&&(e.offerToReceiveVideo=!!e.offerToReceiveVideo);const r=this.getTransceivers().find((e=>"video"===e.receiver.track.kind));!1===e.offerToReceiveVideo&&r?"sendrecv"===r.direction?r.setDirection?r.setDirection("sendonly"):r.direction="sendonly":"recvonly"===r.direction&&(r.setDirection?r.setDirection("inactive"):r.direction="inactive"):!0!==e.offerToReceiveVideo||r||this.addTransceiver("video",{direction:"recvonly"})}return t.apply(this,arguments)}}function shimAudioContext(e){"object"!=typeof e||e.AudioContext||(e.AudioContext=e.webkitAudioContext)}var safariShim=Object.freeze({__proto__:null,shimAudioContext:shimAudioContext,shimCallbacksAPI:shimCallbacksAPI,shimConstraints:shimConstraints,shimCreateOfferLegacy:shimCreateOfferLegacy,shimGetUserMedia:shimGetUserMedia,shimLocalStreamsAPI:shimLocalStreamsAPI,shimRTCIceServerUrls:shimRTCIceServerUrls,shimRemoteStreamsAPI:shimRemoteStreamsAPI,shimTrackEventTransceiver:shimTrackEventTransceiver}),commonjsGlobal="undefined"!=typeof globalThis?globalThis:"undefined"!=typeof window?window:"undefined"!=typeof global?global:"undefined"!=typeof self?self:{};function getDefaultExportFromCjs(e){return e&&e.__esModule&&Object.prototype.hasOwnProperty.call(e,"default")?e.default:e}function getAugmentedNamespace(e){if(e.__esModule)return e;var t=e.default;if("function"==typeof t){var r=function e(){if(this instanceof e){var r=[null];return r.push.apply(r,arguments),new(Function.bind.apply(t,r))}return t.apply(this,arguments)};r.prototype=t.prototype}else r={};return Object.defineProperty(r,"__esModule",{value:!0}),Object.keys(e).forEach((function(t){var i=Object.getOwnPropertyDescriptor(e,t);Object.defineProperty(r,t,i.get?i:{enumerable:!0,get:function(){return e[t]}})})),r}var sdpExports={},sdp$1={get exports(){return sdpExports},set exports(e){sdpExports=e}};!function(e){const t={generateIdentifier:function(){return Math.random().toString(36).substr(2,10)}};t.localCName=t.generateIdentifier(),t.splitLines=function(e){return e.trim().split("\n").map((e=>e.trim()))},t.splitSections=function(e){return e.split("\nm=").map(((e,t)=>(t>0?"m="+e:e).trim()+"\r\n"))},t.getDescription=function(e){const r=t.splitSections(e);return r&&r[0]},t.getMediaSections=function(e){const r=t.splitSections(e);return r.shift(),r},t.matchPrefix=function(e,r){return t.splitLines(e).filter((e=>0===e.indexOf(r)))},t.parseCandidate=function(e){let t;t=0===e.indexOf("a=candidate:")?e.substring(12).split(" "):e.substring(10).split(" ");const r={foundation:t[0],component:{1:"rtp",2:"rtcp"}[t[1]]||t[1],protocol:t[2].toLowerCase(),priority:parseInt(t[3],10),ip:t[4],address:t[4],port:parseInt(t[5],10),type:t[7]};for(let e=8;e<t.length;e+=2)switch(t[e]){case"raddr":r.relatedAddress=t[e+1];break;case"rport":r.relatedPort=parseInt(t[e+1],10);break;case"tcptype":r.tcpType=t[e+1];break;case"ufrag":r.ufrag=t[e+1],r.usernameFragment=t[e+1];break;default:void 0===r[t[e]]&&(r[t[e]]=t[e+1])}return r},t.writeCandidate=function(e){const t=[];t.push(e.foundation);const r=e.component;"rtp"===r?t.push(1):"rtcp"===r?t.push(2):t.push(r),t.push(e.protocol.toUpperCase()),t.push(e.priority),t.push(e.address||e.ip),t.push(e.port);const i=e.type;return t.push("typ"),t.push(i),"host"!==i&&e.relatedAddress&&e.relatedPort&&(t.push("raddr"),t.push(e.relatedAddress),t.push("rport"),t.push(e.relatedPort)),e.tcpType&&"tcp"===e.protocol.toLowerCase()&&(t.push("tcptype"),t.push(e.tcpType)),(e.usernameFragment||e.ufrag)&&(t.push("ufrag"),t.push(e.usernameFragment||e.ufrag)),"candidate:"+t.join(" ")},t.parseIceOptions=function(e){return e.substr(14).split(" ")},t.parseRtpMap=function(e){let t=e.substr(9).split(" ");const r={payloadType:parseInt(t.shift(),10)};return t=t[0].split("/"),r.name=t[0],r.clockRate=parseInt(t[1],10),r.channels=3===t.length?parseInt(t[2],10):1,r.numChannels=r.channels,r},t.writeRtpMap=function(e){let t=e.payloadType;void 0!==e.preferredPayloadType&&(t=e.preferredPayloadType);const r=e.channels||e.numChannels||1;return"a=rtpmap:"+t+" "+e.name+"/"+e.clockRate+(1!==r?"/"+r:"")+"\r\n"},t.parseExtmap=function(e){const t=e.substr(9).split(" ");return{id:parseInt(t[0],10),direction:t[0].indexOf("/")>0?t[0].split("/")[1]:"sendrecv",uri:t[1]}},t.writeExtmap=function(e){return"a=extmap:"+(e.id||e.preferredId)+(e.direction&&"sendrecv"!==e.direction?"/"+e.direction:"")+" "+e.uri+"\r\n"},t.parseFmtp=function(e){const t={};let r;const i=e.substr(e.indexOf(" ")+1).split(";");for(let e=0;e<i.length;e++)r=i[e].trim().split("="),t[r[0].trim()]=r[1];return t},t.writeFmtp=function(e){let t="",r=e.payloadType;if(void 0!==e.preferredPayloadType&&(r=e.preferredPayloadType),e.parameters&&Object.keys(e.parameters).length){const i=[];Object.keys(e.parameters).forEach((t=>{void 0!==e.parameters[t]?i.push(t+"="+e.parameters[t]):i.push(t)})),t+="a=fmtp:"+r+" "+i.join(";")+"\r\n"}return t},t.parseRtcpFb=function(e){const t=e.substr(e.indexOf(" ")+1).split(" ");return{type:t.shift(),parameter:t.join(" ")}},t.writeRtcpFb=function(e){let t="",r=e.payloadType;return void 0!==e.preferredPayloadType&&(r=e.preferredPayloadType),e.rtcpFeedback&&e.rtcpFeedback.length&&e.rtcpFeedback.forEach((e=>{t+="a=rtcp-fb:"+r+" "+e.type+(e.parameter&&e.parameter.length?" "+e.parameter:"")+"\r\n"})),t},t.parseSsrcMedia=function(e){const t=e.indexOf(" "),r={ssrc:parseInt(e.substr(7,t-7),10)},i=e.indexOf(":",t);return i>-1?(r.attribute=e.substr(t+1,i-t-1),r.value=e.substr(i+1)):r.attribute=e.substr(t+1),r},t.parseSsrcGroup=function(e){const t=e.substr(13).split(" ");return{semantics:t.shift(),ssrcs:t.map((e=>parseInt(e,10)))}},t.getMid=function(e){const r=t.matchPrefix(e,"a=mid:")[0];if(r)return r.substr(6)},t.parseFingerprint=function(e){const t=e.substr(14).split(" ");return{algorithm:t[0].toLowerCase(),value:t[1].toUpperCase()}},t.getDtlsParameters=function(e,r){return{role:"auto",fingerprints:t.matchPrefix(e+r,"a=fingerprint:").map(t.parseFingerprint)}},t.writeDtlsParameters=function(e,t){let r="a=setup:"+t+"\r\n";return e.fingerprints.forEach((e=>{r+="a=fingerprint:"+e.algorithm+" "+e.value+"\r\n"})),r},t.parseCryptoLine=function(e){const t=e.substr(9).split(" ");return{tag:parseInt(t[0],10),cryptoSuite:t[1],keyParams:t[2],sessionParams:t.slice(3)}},t.writeCryptoLine=function(e){return"a=crypto:"+e.tag+" "+e.cryptoSuite+" "+("object"==typeof e.keyParams?t.writeCryptoKeyParams(e.keyParams):e.keyParams)+(e.sessionParams?" "+e.sessionParams.join(" "):"")+"\r\n"},t.parseCryptoKeyParams=function(e){if(0!==e.indexOf("inline:"))return null;const t=e.substr(7).split("|");return{keyMethod:"inline",keySalt:t[0],lifeTime:t[1],mkiValue:t[2]?t[2].split(":")[0]:void 0,mkiLength:t[2]?t[2].split(":")[1]:void 0}},t.writeCryptoKeyParams=function(e){return e.keyMethod+":"+e.keySalt+(e.lifeTime?"|"+e.lifeTime:"")+(e.mkiValue&&e.mkiLength?"|"+e.mkiValue+":"+e.mkiLength:"")},t.getCryptoParameters=function(e,r){return t.matchPrefix(e+r,"a=crypto:").map(t.parseCryptoLine)},t.getIceParameters=function(e,r){const i=t.matchPrefix(e+r,"a=ice-ufrag:")[0],n=t.matchPrefix(e+r,"a=ice-pwd:")[0];return i&&n?{usernameFragment:i.substr(12),password:n.substr(10)}:null},t.writeIceParameters=function(e){let t="a=ice-ufrag:"+e.usernameFragment+"\r\na=ice-pwd:"+e.password+"\r\n";return e.iceLite&&(t+="a=ice-lite\r\n"),t},t.parseRtpParameters=function(e){const r={codecs:[],headerExtensions:[],fecMechanisms:[],rtcp:[]},i=t.splitLines(e)[0].split(" ");for(let n=3;n<i.length;n++){const s=i[n],o=t.matchPrefix(e,"a=rtpmap:"+s+" ")[0];if(o){const i=t.parseRtpMap(o),n=t.matchPrefix(e,"a=fmtp:"+s+" ");switch(i.parameters=n.length?t.parseFmtp(n[0]):{},i.rtcpFeedback=t.matchPrefix(e,"a=rtcp-fb:"+s+" ").map(t.parseRtcpFb),r.codecs.push(i),i.name.toUpperCase()){case"RED":case"ULPFEC":r.fecMechanisms.push(i.name.toUpperCase())}}}return t.matchPrefix(e,"a=extmap:").forEach((e=>{r.headerExtensions.push(t.parseExtmap(e))})),r},t.writeRtpDescription=function(e,r){let i="";i+="m="+e+" ",i+=r.codecs.length>0?"9":"0",i+=" UDP/TLS/RTP/SAVPF ",i+=r.codecs.map((e=>void 0!==e.preferredPayloadType?e.preferredPayloadType:e.payloadType)).join(" ")+"\r\n",i+="c=IN IP4 0.0.0.0\r\n",i+="a=rtcp:9 IN IP4 0.0.0.0\r\n",r.codecs.forEach((e=>{i+=t.writeRtpMap(e),i+=t.writeFmtp(e),i+=t.writeRtcpFb(e)}));let n=0;return r.codecs.forEach((e=>{e.maxptime>n&&(n=e.maxptime)})),n>0&&(i+="a=maxptime:"+n+"\r\n"),r.headerExtensions&&r.headerExtensions.forEach((e=>{i+=t.writeExtmap(e)})),i},t.parseRtpEncodingParameters=function(e){const r=[],i=t.parseRtpParameters(e),n=-1!==i.fecMechanisms.indexOf("RED"),s=-1!==i.fecMechanisms.indexOf("ULPFEC"),o=t.matchPrefix(e,"a=ssrc:").map((e=>t.parseSsrcMedia(e))).filter((e=>"cname"===e.attribute)),a=o.length>0&&o[0].ssrc;let c;const u=t.matchPrefix(e,"a=ssrc-group:FID").map((e=>e.substr(17).split(" ").map((e=>parseInt(e,10)))));u.length>0&&u[0].length>1&&u[0][0]===a&&(c=u[0][1]),i.codecs.forEach((e=>{if("RTX"===e.name.toUpperCase()&&e.parameters.apt){let t={ssrc:a,codecPayloadType:parseInt(e.parameters.apt,10)};a&&c&&(t.rtx={ssrc:c}),r.push(t),n&&(t=JSON.parse(JSON.stringify(t)),t.fec={ssrc:a,mechanism:s?"red+ulpfec":"red"},r.push(t))}})),0===r.length&&a&&r.push({ssrc:a});let h=t.matchPrefix(e,"b=");return h.length&&(h=0===h[0].indexOf("b=TIAS:")?parseInt(h[0].substr(7),10):0===h[0].indexOf("b=AS:")?1e3*parseInt(h[0].substr(5),10)*.95-16e3:void 0,r.forEach((e=>{e.maxBitrate=h}))),r},t.parseRtcpParameters=function(e){const r={},i=t.matchPrefix(e,"a=ssrc:").map((e=>t.parseSsrcMedia(e))).filter((e=>"cname"===e.attribute))[0];i&&(r.cname=i.value,r.ssrc=i.ssrc);const n=t.matchPrefix(e,"a=rtcp-rsize");r.reducedSize=n.length>0,r.compound=0===n.length;const s=t.matchPrefix(e,"a=rtcp-mux");return r.mux=s.length>0,r},t.writeRtcpParameters=function(e){let t="";return e.reducedSize&&(t+="a=rtcp-rsize\r\n"),e.mux&&(t+="a=rtcp-mux\r\n"),void 0!==e.ssrc&&e.cname&&(t+="a=ssrc:"+e.ssrc+" cname:"+e.cname+"\r\n"),t},t.parseMsid=function(e){let r;const i=t.matchPrefix(e,"a=msid:");if(1===i.length)return r=i[0].substr(7).split(" "),{stream:r[0],track:r[1]};const n=t.matchPrefix(e,"a=ssrc:").map((e=>t.parseSsrcMedia(e))).filter((e=>"msid"===e.attribute));return n.length>0?(r=n[0].value.split(" "),{stream:r[0],track:r[1]}):void 0},t.parseSctpDescription=function(e){const r=t.parseMLine(e),i=t.matchPrefix(e,"a=max-message-size:");let n;i.length>0&&(n=parseInt(i[0].substr(19),10)),isNaN(n)&&(n=65536);const s=t.matchPrefix(e,"a=sctp-port:");if(s.length>0)return{port:parseInt(s[0].substr(12),10),protocol:r.fmt,maxMessageSize:n};const o=t.matchPrefix(e,"a=sctpmap:");if(o.length>0){const e=o[0].substr(10).split(" ");return{port:parseInt(e[0],10),protocol:e[1],maxMessageSize:n}}},t.writeSctpDescription=function(e,t){let r=[];return r="DTLS/SCTP"!==e.protocol?["m="+e.kind+" 9 "+e.protocol+" "+t.protocol+"\r\n","c=IN IP4 0.0.0.0\r\n","a=sctp-port:"+t.port+"\r\n"]:["m="+e.kind+" 9 "+e.protocol+" "+t.port+"\r\n","c=IN IP4 0.0.0.0\r\n","a=sctpmap:"+t.port+" "+t.protocol+" 65535\r\n"],void 0!==t.maxMessageSize&&r.push("a=max-message-size:"+t.maxMessageSize+"\r\n"),r.join("")},t.generateSessionId=function(){return Math.random().toString().substr(2,21)},t.writeSessionBoilerplate=function(e,r,i){let n;const s=void 0!==r?r:2;return n=e||t.generateSessionId(),"v=0\r\no="+(i||"thisisadapterortc")+" "+n+" "+s+" IN IP4 127.0.0.1\r\ns=-\r\nt=0 0\r\n"},t.getDirection=function(e,r){const i=t.splitLines(e);for(let e=0;e<i.length;e++)switch(i[e]){case"a=sendrecv":case"a=sendonly":case"a=recvonly":case"a=inactive":return i[e].substr(2)}return r?t.getDirection(r):"sendrecv"},t.getKind=function(e){return t.splitLines(e)[0].split(" ")[0].substr(2)},t.isRejected=function(e){return"0"===e.split(" ",2)[1]},t.parseMLine=function(e){const r=t.splitLines(e)[0].substr(2).split(" ");return{kind:r[0],port:parseInt(r[1],10),protocol:r[2],fmt:r.slice(3).join(" ")}},t.parseOLine=function(e){const r=t.matchPrefix(e,"o=")[0].substr(2).split(" ");return{username:r[0],sessionId:r[1],sessionVersion:parseInt(r[2],10),netType:r[3],addressType:r[4],address:r[5]}},t.isValidSDP=function(e){if("string"!=typeof e||0===e.length)return!1;const r=t.splitLines(e);for(let e=0;e<r.length;e++)if(r[e].length<2||"="!==r[e].charAt(1))return!1;return!0},e.exports=t}(sdp$1);var SDPUtils=sdpExports,sdp=_mergeNamespaces({__proto__:null,default:SDPUtils},[sdpExports]);function shimRTCIceCandidate(e){if(!e.RTCIceCandidate||e.RTCIceCandidate&&"foundation"in e.RTCIceCandidate.prototype)return;const t=e.RTCIceCandidate;e.RTCIceCandidate=function(e){if("object"==typeof e&&e.candidate&&0===e.candidate.indexOf("a=")&&((e=JSON.parse(JSON.stringify(e))).candidate=e.candidate.substr(2)),e.candidate&&e.candidate.length){const r=new t(e),i=SDPUtils.parseCandidate(e.candidate),n=Object.assign(r,i);return n.toJSON=function(){return{candidate:n.candidate,sdpMid:n.sdpMid,sdpMLineIndex:n.sdpMLineIndex,usernameFragment:n.usernameFragment}},n}return new t(e)},e.RTCIceCandidate.prototype=t.prototype,wrapPeerConnectionEvent(e,"icecandidate",(t=>(t.candidate&&Object.defineProperty(t,"candidate",{value:new e.RTCIceCandidate(t.candidate),writable:"false"}),t)))}function shimMaxMessageSize(e,t){if(!e.RTCPeerConnection)return;"sctp"in e.RTCPeerConnection.prototype||Object.defineProperty(e.RTCPeerConnection.prototype,"sctp",{get(){return void 0===this.M?null:this.M}});const r=function(e){if(!e||!e.sdp)return!1;const t=SDPUtils.splitSections(e.sdp);return t.shift(),t.some((e=>{const t=SDPUtils.parseMLine(e);return t&&"application"===t.kind&&-1!==t.protocol.indexOf("SCTP")}))},i=function(e){const t=e.sdp.match(/mozilla...THIS_IS_SDPARTA-(\d+)/);if(null===t||t.length<2)return-1;const r=parseInt(t[1],10);return r!=r?-1:r},n=function(e){let r=65536;return"firefox"===t.browser&&(r=t.version<57?-1===e?16384:2147483637:t.version<60?57===t.version?65535:65536:2147483637),r},s=function(e,r){let i=65536;"firefox"===t.browser&&57===t.version&&(i=65535);const n=SDPUtils.matchPrefix(e.sdp,"a=max-message-size:");return n.length>0?i=parseInt(n[0].substr(19),10):"firefox"===t.browser&&-1!==r&&(i=2147483637),i},o=e.RTCPeerConnection.prototype.setRemoteDescription;e.RTCPeerConnection.prototype.setRemoteDescription=function(){if(this.M=null,"chrome"===t.browser&&t.version>=76){const{sdpSemantics:e}=this.getConfiguration();"plan-b"===e&&Object.defineProperty(this,"sctp",{get(){return void 0===this.M?null:this.M},enumerable:!0,configurable:!0})}if(r(arguments[0])){const e=i(arguments[0]),t=n(e),r=s(arguments[0],e);let o;o=0===t&&0===r?Number.POSITIVE_INFINITY:0===t||0===r?Math.max(t,r):Math.min(t,r);const a={};Object.defineProperty(a,"maxMessageSize",{get:()=>o}),this.M=a}return o.apply(this,arguments)}}function shimSendThrowTypeError(e){if(!e.RTCPeerConnection||!("createDataChannel"in e.RTCPeerConnection.prototype))return;function t(e,t){const r=e.send;e.send=function(){const i=arguments[0],n=i.length||i.size||i.byteLength;if("open"===e.readyState&&t.sctp&&n>t.sctp.maxMessageSize)throw new TypeError("Message too large (can send a maximum of "+t.sctp.maxMessageSize+" bytes)");return r.apply(e,arguments)}}const r=e.RTCPeerConnection.prototype.createDataChannel;e.RTCPeerConnection.prototype.createDataChannel=function(){const e=r.apply(this,arguments);return t(e,this),e},wrapPeerConnectionEvent(e,"datachannel",(e=>(t(e.channel,e.target),e)))}function shimConnectionState(e){if(!e.RTCPeerConnection||"connectionState"in e.RTCPeerConnection.prototype)return;const t=e.RTCPeerConnection.prototype;Object.defineProperty(t,"connectionState",{get(){return{completed:"connected",checking:"connecting"}[this.iceConnectionState]||this.iceConnectionState},enumerable:!0,configurable:!0}),Object.defineProperty(t,"onconnectionstatechange",{get(){return this.q||null},set(e){this.q&&(this.removeEventListener("connectionstatechange",this.q),delete this.q),e&&this.addEventListener("connectionstatechange",this.q=e)},enumerable:!0,configurable:!0}),["setLocalDescription","setRemoteDescription"].forEach((e=>{const r=t[e];t[e]=function(){return this.N||(this.N=e=>{const t=e.target;if(t.P!==t.connectionState){t.P=t.connectionState;const r=new Event("connectionstatechange",e);t.dispatchEvent(r)}return e},this.addEventListener("iceconnectionstatechange",this.N)),r.apply(this,arguments)}}))}function removeExtmapAllowMixed(e,t){if(!e.RTCPeerConnection)return;if("chrome"===t.browser&&t.version>=71)return;if("safari"===t.browser&&t.version>=605)return;const r=e.RTCPeerConnection.prototype.setRemoteDescription;e.RTCPeerConnection.prototype.setRemoteDescription=function(t){if(t&&t.sdp&&-1!==t.sdp.indexOf("\na=extmap-allow-mixed")){const r=t.sdp.split("\n").filter((e=>"a=extmap-allow-mixed"!==e.trim())).join("\n");e.RTCSessionDescription&&t instanceof e.RTCSessionDescription?arguments[0]=new e.RTCSessionDescription({type:t.type,sdp:r}):t.sdp=r}return r.apply(this,arguments)}}function shimAddIceCandidateNullOrEmpty(e,t){if(!e.RTCPeerConnection||!e.RTCPeerConnection.prototype)return;const r=e.RTCPeerConnection.prototype.addIceCandidate;r&&0!==r.length&&(e.RTCPeerConnection.prototype.addIceCandidate=function(){return arguments[0]?("chrome"===t.browser&&t.version<78||"firefox"===t.browser&&t.version<68||"safari"===t.browser)&&arguments[0]&&""===arguments[0].candidate?Promise.resolve():r.apply(this,arguments):(arguments[1]&&arguments[1].apply(null),Promise.resolve())})}function shimParameterlessSetLocalDescription(e,t){if(!e.RTCPeerConnection||!e.RTCPeerConnection.prototype)return;const r=e.RTCPeerConnection.prototype.setLocalDescription;r&&0!==r.length&&(e.RTCPeerConnection.prototype.setLocalDescription=function(){let e=arguments[0]||{};if("object"!=typeof e||e.type&&e.sdp)return r.apply(this,arguments);if(e={type:e.type,sdp:e.sdp},!e.type)switch(this.signalingState){case"stable":case"have-local-offer":case"have-remote-pranswer":e.type="offer";break;default:e.type="answer"}return e.sdp||"offer"!==e.type&&"answer"!==e.type?r.apply(this,[e]):("offer"===e.type?this.createOffer:this.createAnswer).apply(this).then((e=>r.apply(this,[e])))})}var commonShim=Object.freeze({__proto__:null,removeExtmapAllowMixed:removeExtmapAllowMixed,shimAddIceCandidateNullOrEmpty:shimAddIceCandidateNullOrEmpty,shimConnectionState:shimConnectionState,shimMaxMessageSize:shimMaxMessageSize,shimParameterlessSetLocalDescription:shimParameterlessSetLocalDescription,shimRTCIceCandidate:shimRTCIceCandidate,shimSendThrowTypeError:shimSendThrowTypeError});function adapterFactory({window:e}={},t={shimChrome:!0,shimFirefox:!0,shimSafari:!0}){const r=log,i=detectBrowser(e),n={browserDetails:i,commonShim:commonShim,extractVersion:extractVersion,disableLog:disableLog,disableWarnings:disableWarnings,sdp:sdp};switch(i.browser){case"chrome":if(!chromeShim||!shimPeerConnection$1||!t.shimChrome)return r("Chrome shim is not included in this adapter release."),n;if(null===i.version)return r("Chrome shim can not determine version, not shimming."),n;r("adapter.js shimming chrome."),n.browserShim=chromeShim,shimAddIceCandidateNullOrEmpty(e,i),shimParameterlessSetLocalDescription(e),shimGetUserMedia$2(e,i),shimMediaStream(e),shimPeerConnection$1(e,i),shimOnTrack$1(e),shimAddTrackRemoveTrack(e,i),shimGetSendersWithDtmf(e),shimGetStats(e),shimSenderReceiverGetStats(e),fixNegotiationNeeded(e,i),shimRTCIceCandidate(e),shimConnectionState(e),shimMaxMessageSize(e,i),shimSendThrowTypeError(e),removeExtmapAllowMixed(e,i);break;case"firefox":if(!firefoxShim||!shimPeerConnection||!t.shimFirefox)return r("Firefox shim is not included in this adapter release."),n;r("adapter.js shimming firefox."),n.browserShim=firefoxShim,shimAddIceCandidateNullOrEmpty(e,i),shimParameterlessSetLocalDescription(e),shimGetUserMedia$1(e,i),shimPeerConnection(e,i),shimOnTrack(e),shimRemoveStream(e),shimSenderGetStats(e),shimReceiverGetStats(e),shimRTCDataChannel(e),shimAddTransceiver(e),shimGetParameters(e),shimCreateOffer(e),shimCreateAnswer(e),shimRTCIceCandidate(e),shimConnectionState(e),shimMaxMessageSize(e,i),shimSendThrowTypeError(e);break;case"safari":if(!safariShim||!t.shimSafari)return r("Safari shim is not included in this adapter release."),n;r("adapter.js shimming safari."),n.browserShim=safariShim,shimAddIceCandidateNullOrEmpty(e,i),shimParameterlessSetLocalDescription(e),shimRTCIceServerUrls(e),shimCreateOfferLegacy(e),shimCallbacksAPI(e),shimLocalStreamsAPI(e),shimRemoteStreamsAPI(e),shimTrackEventTransceiver(e),shimGetUserMedia(e),shimAudioContext(e),shimRTCIceCandidate(e),shimMaxMessageSize(e,i),shimSendThrowTypeError(e),removeExtmapAllowMixed(e,i);break;default:r("Unsupported browser!")}return n}const adapter=adapterFactory({window:"undefined"==typeof window?void 0:window});var version$1="1.0.0",commit$1="xxxx";const c$6={apiProxy:"https://apis.mindlinker.com",logUploadServer:""},d$6={"x-device-type":"pc-web-sdk"},e$6={ServerUri:c$6,version:version$1,commit:commit$1,HeaderConfig:d$6,ipv6:!1,maxEndpoint:9};function a$a(){return{access_token:"",token_type:"bearer",expires_in:0}}function b$6(){return{access_token:"",refresh_token:"",expires_in:0,token_type:"",state:"",userId:""}}const c$5={D:a$a(),L:b$6()};function updateClientToken(e){c$5.D=e}function updateAuthToken(e){c$5.L={...c$5.L,...e}}function getClientToken(){return c$5.D}function getAuthToken(){return c$5.L}function a$9(e){return{all:e=e||new Map,on:function(t,r){var i=e.get(t);i?i.push(r):e.set(t,[r])},off:function(t,r){var i=e.get(t);i&&(r?i.splice(i.indexOf(r)>>>0,1):e.set(t,[]))},emit:function(t,r){var i=e.get(t);i&&i.slice().map((function(e){e(r)})),(i=e.get("*"))&&i.slice().map((function(e){e(t,r)}))}}}var SocketConfServiceEvents,SocketState;!function(e){e.RoomEndPointRecovering="recovering",e.RoomEndpointQuitRoom="leave",e.RoomEndpointKickOut="kickOut",e.RoomEndpointDisconnect="disconnect",e.RoomEndpointTurnVideoOff="videoOff",e.RoomEndpointTurnVideoOn="videoOn",e.RoomEndpointMuteAllV2="muteAll",e.RoomEndpointUnmuteV2="unmuted",e.RoomEndpointMuteV2="muted",e.RoomOptionUpdate="optionUpdate",e.RoomInfoUpdate="virtual_room.update",e.RoomLayoutChanged="virtual_room.layout.changed",e.RoomEndpointExtStateUpdate="exStateUpdate",e.RoleChange="roleChange",e.MediaRequestUnmute="requestUnmute",e.MediaRejectUnmute="rejectUnmute",e.MediaRequestUnmuteVideo="requestUnmuteVideo",e.MediaRejectUnmuteVideo="rejectUnmuteVideo",e.RoomChangeView="changeView",e.EndpointSpeakRequest="speakRequest",e.EndpointSpeakResponse="speakResponse",e.UnmuteSpeaker="unmute_speaker",e.MuteSpeaker="mute_speaker",e.UnmuteAllSpeaker="unmute_all_speaker",e.MuteAllSpeaker="mute_all_speaker",e.SessionMainVenueUpdate="mainVenueUpdate",e.AudioModeSwitch="audioModeSwitch",e.SessionLiveStatusUpdate="liveStatus",e.SessionLiveDelete="liveDeleted",e.SessionRecordStatusUpdate="recordStatusUpdate",e.EndpointPermissionUpdate="permissionsUpdate",e.ModeStateUpdate="modeStateUpdate",e.RoomJoin="join",e.RoomClose="close",e.SessionClose="sessionClose",e.JoinFail="joinFail",e.BenefitExpired="benefitExpired",e.SocketStateChange="SocketStateChange",e.NicknameChanged="NicknameChanged",e.HangupStatusUpdated="HangupStatusUpdated"}(SocketConfServiceEvents||(SocketConfServiceEvents={})),function(e){e.connect="connect",e.connect_error="connect_error",e.connect_timeout="connect_timeout",e.connecting="connecting",e.disconnect="disconnect",e.error="error",e.reconnect="reconnect",e.reconnect_attempt="reconnect_attempt",e.reconnect_failed="reconnect_failed",e.reconnect_error="reconnect_error",e.reconnecting="reconnecting",e.ping="ping",e.pong="pong"}(SocketState||(SocketState={}));const ConfServiceTopicsEventMap={"roomendpoint.recovering":SocketConfServiceEvents.RoomEndPointRecovering,"roomendpoint.quit_room":SocketConfServiceEvents.RoomEndpointQuitRoom,"roomendpoint.kick_out":SocketConfServiceEvents.RoomEndpointKickOut,"roomendpoint.disconnect":SocketConfServiceEvents.RoomEndpointDisconnect,"roomendpoint.turn_video_off":SocketConfServiceEvents.RoomEndpointTurnVideoOff,"roomendpoint.turn_video_on":SocketConfServiceEvents.RoomEndpointTurnVideoOn,"roomendpoint.mute_all.v2":SocketConfServiceEvents.RoomEndpointMuteAllV2,"roomendpoint.unmute.v2":SocketConfServiceEvents.RoomEndpointUnmuteV2,"roomendpoint.mute.v2":SocketConfServiceEvents.RoomEndpointMuteV2,"endpoint.unmute_speaker":SocketConfServiceEvents.UnmuteSpeaker,"endpoint.mute_speaker":SocketConfServiceEvents.MuteSpeaker,"endpoint.unmute_all_speaker":SocketConfServiceEvents.UnmuteAllSpeaker,"endpoint.mute_all_speaker":SocketConfServiceEvents.MuteAllSpeaker,"endpoint.nickname_update":SocketConfServiceEvents.NicknameChanged,"roomendpoint.ext_state_update":SocketConfServiceEvents.RoomEndpointExtStateUpdate,"media.request_unmute":SocketConfServiceEvents.MediaRequestUnmute,"media.reject_unmute":SocketConfServiceEvents.MediaRejectUnmute,"endpoint.reject_turn_on_video":SocketConfServiceEvents.MediaRejectUnmuteVideo,"endpoint.request_turn_on_video":SocketConfServiceEvents.MediaRequestUnmuteVideo,"role.changed":SocketConfServiceEvents.RoleChange,"session.change_mode":SocketConfServiceEvents.RoomChangeView,"endpoint.speak_request":SocketConfServiceEvents.EndpointSpeakRequest,"endpoint.speak_response":SocketConfServiceEvents.EndpointSpeakResponse,"session.main_venue_update":SocketConfServiceEvents.SessionMainVenueUpdate,"session.audiomode.switch":SocketConfServiceEvents.AudioModeSwitch,"session.live_status_update":SocketConfServiceEvents.SessionLiveStatusUpdate,"session.live_delete":SocketConfServiceEvents.SessionLiveDelete,"session.options_changed":SocketConfServiceEvents.RoomOptionUpdate,"virtual_room.update":SocketConfServiceEvents.RoomInfoUpdate,"virtual-room.layout.changed":SocketConfServiceEvents.RoomLayoutChanged,"session.record_status_update":SocketConfServiceEvents.SessionRecordStatusUpdate,"endpoint.permission_update":SocketConfServiceEvents.EndpointPermissionUpdate,"mode.state_update":SocketConfServiceEvents.ModeStateUpdate,"room.join":SocketConfServiceEvents.RoomJoin,"room.close":SocketConfServiceEvents.RoomClose,"session.close":SocketConfServiceEvents.SessionClose,"join.fail":SocketConfServiceEvents.JoinFail,"benefit.expired":SocketConfServiceEvents.BenefitExpired,"hangup.status.update":SocketConfServiceEvents.HangupStatusUpdated},ConfServiceRoutes={prefix:"meeting.confservice.",topics:Object.keys(ConfServiceTopicsEventMap)};var NameSpace;function b$5(e){return e.getFullYear()+"-"+e.getMonth()+"1-"+e.getDate()+" "+e.getHours()+":"+e.getMinutes()+":"+e.getSeconds()+"."+e.getMilliseconds()}function c$4(e,t,r){for(var i=arguments.length,n=new Array(i>3?i-3:0),s=3;s<i;s++)n[s-3]=arguments[s];if(!n.length)return"";const o=[];return n.forEach((e=>{if(""!==e&&void 0!==e)if("object"==typeof e){if(Array.isArray(e)&&e.length>100)return o.push(`Array[${e.length}]`);try{o.push(JSON.stringify(e))}catch(t){console.error("parse s error",e),o.push(`[PARSE ERROR] ${e}`)}}else"symbol"==typeof e?o.push(e.toString()):o.push(e)})),`${b$5(new Date)} ${e} [${t}.${r}] ${o.join(" ")}`}!function(e){e.Confservice="meeting_confservice_v1",e.Meeting="meeting_meeting_v1"}(NameSpace||(NameSpace={})),exports.RecordStatus=void 0,function(e){e[e.ON=1]="ON",e[e.OFF=2]="OFF"}(exports.RecordStatus||(exports.RecordStatus={})),exports.RoleType=void 0,function(e){e[e.OWNER=1]="OWNER",e[e.HOST=2]="HOST",e[e.MEMBER=3]="MEMBER"}(exports.RoleType||(exports.RoleType={})),exports.Permission=void 0,function(e){e.muteLocalAudioEnable="muteLocalAudioEnable",e.unmuteLocalAudioEnable="unmuteLocalAudioEnable",e.unmuteOtherEnable="unmuteOtherEnable",e.muteOtherEnable="muteOtherEnable",e.kickOutOtherEnable="kickOutOtherEnable",e.requestSpeakEnable="requestSpeakEnable",e.responseSpeakEnable="responseSpeakEnable",e.mainVenueOperateEnable="mainVenueOperateEnable",e.closeSessionEnable="closeSessionEnable",e.localVideoOperationEnable="localVideoOperationEnable",e.muteAllEnable="muteAllEnable",e.lockedEnable="lockedEnable",e.unmuteSelfEnable="unmuteSelfEnable",e.transferRoleEnable="transferRoleEnable",e.localAudioOperationEnable="localAudioOperationEnable",e.remoteAudioOperationEnable="remoteAudioOperationEnable",e.setMasterEnable="setMasterEnable",e.muteAllSpeakerEnable="muteAllSpeakerEnable",e.unmuteAllSpeakerEnable="unmuteAllSpeakerEnable",e.muteSelfSpeakerEnable="muteSelfSpeakerEnable",e.unmuteSelfSpeakerEnable="unmuteSelfSpeakerEnable",e.muteOtherSpeakerEnable="muteOtherSpeakerEnable",e.unmuteOtherSpeakerEnable="unmuteOtherSpeakerEnable",e.liveOperationEnable="liveOperationEnable",e.recordOperationEnable="recordOperationEnable",e.openWhiteBoardEnable="openWhiteBoardEnable",e.closeWhiteBoardEnable="closeWhiteBoardEnable",e.setShareOptionEnable="setShareOptionEnable",e.openShareEnable="openShareEnable",e.closeShareEnable="closeShareEnable",e.setMarkOptionEnable="setMarkOptionEnable",e.markEnable="markEnable",e.setWhiteBoardOptionEnable="setWhiteBoardOptionEnable",e.startSignEnable="startSignEnable",e.endSignEnable="endSignEnable",e.startPollEnable="startPollEnable",e.endPollEnable="endPollEnable",e.turnOffVideoOtherEnable="turnOffVideoOtherEnable",e.turnOnVideoOtherEnable="turnOnVideoOtherEnable",e.remoteVideoOperationEnable="remoteVideoOperationEnable",e.setModeSettingsWatermarkEnable="setModeSettingsWatermarkEnable",e.openLocalRecordingEnable="openLocalRecordingEnable",e.closeLocalRecordingEnable="closeLocalRecordingEnable",e.turnOnVideoSelfEnable="turnOnVideoSelfEnable",e.turnOffVideoSelfEnable="turnOffVideoSelfEnable",e.setTurnOnVideoSelfOptionEnable="setTurnOnVideoSelfOptionEnable",e.stickyEndpointOnTop="stickyEndpointOnTop",e.allowSelfChangeNickname="allowSelfChangeNickname",e.allowChangeOtherNickname="allowChangeOtherNickname",e.setAllowChangeSelfNickname="setAllowChangeSelfNickname",e.allowChangeAutoMuteType="allowChangeAutoMuteType",e.waitingRoomEnable="waitingRoomEnable"}(exports.Permission||(exports.Permission={})),exports.ViewState=void 0,function(e){e.Video="VIDEO",e.Share="SHARE",e.WhiteBoard="WHITE_BOARD"}(exports.ViewState||(exports.ViewState={})),exports.SocketEmitState=void 0,function(e){e.CONNECTING="CONNECTING",e.CONNECTED="CONNECTED",e.RECONNECTING="RECONNECTING",e.DISCONNECTED="DISCONNECTED",e.RECONNECTED="RECONNECTED"}(exports.SocketEmitState||(exports.SocketEmitState={})),exports.LogLevel=void 0,function(e){e[e.DEBUG=0]="DEBUG",e[e.INFO=1]="INFO",e[e.WARN=2]="WARN",e[e.ERROR=3]="ERROR",e[e.NONE=4]="NONE"}(exports.LogLevel||(exports.LogLevel={}));let d$5={debug(){console.debug(...arguments)},info(){console.info(...arguments)},warn(){console.warn(...arguments)},error(){console.error(...arguments)}},e$5=exports.LogLevel.INFO,f$6=class{constructor(){this.debug=function(e,t){if("function"!=typeof d$5.debug||e$5>exports.LogLevel.DEBUG)return;for(var r=arguments.length,i=new Array(r>2?r-2:0),n=2;n<r;n++)i[n-2]=arguments[n];const s=c$4("D",e,t,...i);d$5.debug(s)},this.info=function(e,t){if("function"!=typeof d$5.info||e$5>exports.LogLevel.INFO)return;for(var r=arguments.length,i=new Array(r>2?r-2:0),n=2;n<r;n++)i[n-2]=arguments[n];const s=c$4("I",e,t,...i);d$5.info(s)},this.warn=function(e,t){if("function"!=typeof d$5.warn||e$5>exports.LogLevel.WARN)return;for(var r=arguments.length,i=new Array(r>2?r-2:0),n=2;n<r;n++)i[n-2]=arguments[n];const s=c$4("W",e,t,...i);d$5.warn(s)},this.error=function(e,t){if("function"!=typeof d$5.error||e$5>exports.LogLevel.ERROR)return;for(var r=arguments.length,i=new Array(r>2?r-2:0),n=2;n<r;n++)i[n-2]=arguments[n];const s=c$4("E",e,t,...i);d$5.error(s)}}};const g$4=new f$6;function bindLoggerTag(e,t){return{info:g$4.info.bind(null,e,t),warn:g$4.warn.bind(null,e,t),error:g$4.error.bind(null,e,t),debug:g$4.debug.bind(null,e,t)}}const GlobalLogger=bindLoggerTag("System","Global"),AuthLogger=bindLoggerTag("System","Auth"),ApiLogger=bindLoggerTag("Network","API"),SocketLogger=bindLoggerTag("Network","Socket"),peerLogger=bindLoggerTag("Media","Peer"),channelLogger=bindLoggerTag("Media","Channel"),trackLogger=bindLoggerTag("Media","Track"),deviceLogger=bindLoggerTag("Media","Device"),agentLogger=bindLoggerTag("Media","Agent"),metricsLogger=bindLoggerTag("DataHub","Metrics"),setLogLevel=e=>{e$5=e,GlobalLogger.info("setLogLevel",e)},setLogger=e=>{d$5=e,GlobalLogger.info("use customer logger")};var libExports$1={},lib$2={get exports(){return libExports$1},set exports(e){libExports$1=e}},re=/^(?:(?![^:@]+:[^:@\/]*@)(http|https|ws|wss):\/\/)?((?:(([^:@]*)(?::([^:@]*))?)?@)?((?:[a-f0-9]{0,4}:){2,7}[a-f0-9]{0,4}|[^:\/?#]*)(?::(\d*))?)(((\/(?:[^?#](?![^?#\/]*\.[^?#\/.]+(?:[?#]|$)))*\/?)?([^?#\/]*))(?:\?([^#]*))?(?:#(.*))?)/,parts=["source","protocol","authority","userInfo","user","password","host","port","relative","path","directory","file","query","anchor"],parseuri$2=function(e){var t=e,r=e.indexOf("["),i=e.indexOf("]");-1!=r&&-1!=i&&(e=e.substring(0,r)+e.substring(r,i).replace(/:/g,";")+e.substring(i,e.length));for(var n=re.exec(e||""),s={},o=14;o--;)s[parts[o]]=n[o]||"";return-1!=r&&-1!=i&&(s.source=t,s.host=s.host.substring(1,s.host.length-1).replace(/;/g,":"),s.authority=s.authority.replace("[","").replace("]","").replace(/;/g,":"),s.ipv6uri=!0),s.pathNames=pathNames(s,s.path),s.queryKey=queryKey(s,s.query),s};function pathNames(e,t){var r=t.replace(/\/{2,9}/g,"/").split("/");return"/"!=t.substr(0,1)&&0!==t.length||r.splice(0,1),"/"==t.substr(t.length-1,1)&&r.splice(r.length-1,1),r}function queryKey(e,t){var r={};return t.replace(/(?:^|&)([^&=]*)=?([^&]*)/g,(function(e,t,i){t&&(r[t]=i)})),r}var browserExports={},browser$1={get exports(){return browserExports},set exports(e){browserExports=e}},debugExports={},debug$6={get exports(){return debugExports},set exports(e){debugExports=e}},s=1e3,m$1=60*s,h=60*m$1,d$4=24*h,y=365.25*d$4,ms=function(e,t){t=t||{};var r=typeof e;if("string"===r&&e.length>0)return parse(e);if("number"===r&&!1===isNaN(e))return t.long?fmtLong(e):fmtShort(e);throw new Error("val is not a non-empty string or a valid number. val="+JSON.stringify(e))};function parse(e){if(!((e=String(e)).length>100)){var t=/^((?:\d+)?\.?\d+) *(milliseconds?|msecs?|ms|seconds?|secs?|s|minutes?|mins?|m|hours?|hrs?|h|days?|d|years?|yrs?|y)?$/i.exec(e);if(t){var r=parseFloat(t[1]);switch((t[2]||"ms").toLowerCase()){case"years":case"year":case"yrs":case"yr":case"y":return r*y;case"days":case"day":case"d":return r*d$4;case"hours":case"hour":case"hrs":case"hr":case"h":return r*h;case"minutes":case"minute":case"mins":case"min":case"m":return r*m$1;case"seconds":case"second":case"secs":case"sec":case"s":return r*s;case"milliseconds":case"millisecond":case"msecs":case"msec":case"ms":return r;default:return}}}}function fmtShort(e){return e>=d$4?Math.round(e/d$4)+"d":e>=h?Math.round(e/h)+"h":e>=m$1?Math.round(e/m$1)+"m":e>=s?Math.round(e/s)+"s":e+"ms"}function fmtLong(e){return plural(e,d$4,"day")||plural(e,h,"hour")||plural(e,m$1,"minute")||plural(e,s,"second")||e+" ms"}function plural(e,t,r){if(!(e<t))return e<1.5*t?Math.floor(e/t)+" "+r:Math.ceil(e/t)+" "+r+"s"}!function(e,t){function r(e){var r;function n(){if(n.enabled){var e=n,i=+new Date,s=i-(r||i);e.diff=s,e.prev=r,e.curr=i,r=i;for(var o=new Array(arguments.length),a=0;a<o.length;a++)o[a]=arguments[a];o[0]=t.coerce(o[0]),"string"!=typeof o[0]&&o.unshift("%O");var c=0;o[0]=o[0].replace(/%([a-zA-Z%])/g,(function(r,i){if("%%"===r)return r;c++;var n=t.formatters[i];if("function"==typeof n){var s=o[c];r=n.call(e,s),o.splice(c,1),c--}return r})),t.formatArgs.call(e,o),(n.log||t.log||console.log.bind(console)).apply(e,o)}}return n.namespace=e,n.enabled=t.enabled(e),n.useColors=t.useColors(),n.color=function(e){var r,i=0;for(r in e)i=(i<<5)-i+e.charCodeAt(r),i|=0;return t.colors[Math.abs(i)%t.colors.length]}(e),n.destroy=i,"function"==typeof t.init&&t.init(n),t.instances.push(n),n}function i(){var e=t.instances.indexOf(this);return-1!==e&&(t.instances.splice(e,1),!0)}(t=e.exports=r.debug=r.default=r).coerce=function(e){return e instanceof Error?e.stack||e.message:e},t.disable=function(){t.enable("")},t.enable=function(e){var r;t.save(e),t.names=[],t.skips=[];var i=("string"==typeof e?e:"").split(/[\s,]+/),n=i.length;for(r=0;r<n;r++)i[r]&&("-"===(e=i[r].replace(/\*/g,".*?"))[0]?t.skips.push(new RegExp("^"+e.substr(1)+"$")):t.names.push(new RegExp("^"+e+"$")));for(r=0;r<t.instances.length;r++){var s=t.instances[r];s.enabled=t.enabled(s.namespace)}},t.enabled=function(e){if("*"===e[e.length-1])return!0;var r,i;for(r=0,i=t.skips.length;r<i;r++)if(t.skips[r].test(e))return!1;for(r=0,i=t.names.length;r<i;r++)if(t.names[r].test(e))return!0;return!1},t.humanize=ms,t.instances=[],t.names=[],t.skips=[],t.formatters={}}(debug$6,debugExports),function(e,t){function r(){var e;try{e=t.storage.debug}catch(e){}return!e&&"undefined"!=typeof process&&"env"in process&&(e=process.env.DEBUG),e}(t=e.exports=debugExports).log=function(){return"object"==typeof console&&console.log&&Function.prototype.apply.call(console.log,console,arguments)},t.formatArgs=function(e){var r=this.useColors;if(e[0]=(r?"%c":"")+this.namespace+(r?" %c":" ")+e[0]+(r?"%c ":" ")+"+"+t.humanize(this.diff),r){var i="color: "+this.color;e.splice(1,0,i,"color: inherit");var n=0,s=0;e[0].replace(/%[a-zA-Z%]/g,(function(e){"%%"!==e&&(n++,"%c"===e&&(s=n))})),e.splice(s,0,i)}},t.save=function(e){try{null==e?t.storage.removeItem("debug"):t.storage.debug=e}catch(e){}},t.load=r,t.useColors=function(){return!("undefined"==typeof window||!window.process||"renderer"!==window.process.type)||("undefined"==typeof navigator||!navigator.userAgent||!navigator.userAgent.toLowerCase().match(/(edge|trident)\/(\d+)/))&&("undefined"!=typeof document&&document.documentElement&&document.documentElement.style&&document.documentElement.style.WebkitAppearance||"undefined"!=typeof window&&window.console&&(window.console.firebug||window.console.exception&&window.console.table)||"undefined"!=typeof navigator&&navigator.userAgent&&navigator.userAgent.toLowerCase().match(/firefox\/(\d+)/)&&parseInt(RegExp.$1,10)>=31||"undefined"!=typeof navigator&&navigator.userAgent&&navigator.userAgent.toLowerCase().match(/applewebkit\/(\d+)/))},t.storage="undefined"!=typeof chrome&&void 0!==chrome.storage?chrome.storage.local:function(){try{return window.localStorage}catch(e){}}(),t.colors=["#0000CC","#0000FF","#0033CC","#0033FF","#0066CC","#0066FF","#0099CC","#0099FF","#00CC00","#00CC33","#00CC66","#00CC99","#00CCCC","#00CCFF","#3300CC","#3300FF","#3333CC","#3333FF","#3366CC","#3366FF","#3399CC","#3399FF","#33CC00","#33CC33","#33CC66","#33CC99","#33CCCC","#33CCFF","#6600CC","#6600FF","#6633CC","#6633FF","#66CC00","#66CC33","#9900CC","#9900FF","#9933CC","#9933FF","#99CC00","#99CC33","#CC0000","#CC0033","#CC0066","#CC0099","#CC00CC","#CC00FF","#CC3300","#CC3333","#CC3366","#CC3399","#CC33CC","#CC33FF","#CC6600","#CC6633","#CC9900","#CC9933","#CCCC00","#CCCC33","#FF0000","#FF0033","#FF0066","#FF0099","#FF00CC","#FF00FF","#FF3300","#FF3333","#FF3366","#FF3399","#FF33CC","#FF33FF","#FF6600","#FF6633","#FF9900","#FF9933","#FFCC00","#FFCC33"],t.formatters.j=function(e){try{return JSON.stringify(e)}catch(e){return"[UnexpectedJSONParseError]: "+e.message}},t.enable(r())}(browser$1,browserExports);var parseuri$1=parseuri$2,debug$5=browserExports("socket.io-client:url"),url_1=url;function url(e,t){var r=e;t=t||"undefined"!=typeof location&&location,null==e&&(e=t.protocol+"//"+t.host),"string"==typeof e&&("/"===e.charAt(0)&&(e="/"===e.charAt(1)?t.protocol+e:t.host+e),/^(https?|wss?):\/\//.test(e)||(debug$5("protocol-less url %s",e),e=void 0!==t?t.protocol+"//"+e:"https://"+e),debug$5("parse %s",e),r=parseuri$1(e)),r.port||(/^(http|ws)$/.test(r.protocol)?r.port="80":/^(http|ws)s$/.test(r.protocol)&&(r.port="443")),r.path=r.path||"/";var i=-1!==r.host.indexOf(":")?"["+r.host+"]":r.host;return r.id=r.protocol+"://"+i+":"+r.port,r.href=r.protocol+"://"+i+(t&&t.port===r.port?"":":"+r.port),r}var socket_ioParser={},componentEmitterExports={},componentEmitter={get exports(){return componentEmitterExports},set exports(e){componentEmitterExports=e}};!function(e){function t(e){if(e)return function(e){for(var r in t.prototype)e[r]=t.prototype[r];return e}(e)}e.exports=t,t.prototype.on=t.prototype.addEventListener=function(e,t){return this.B=this.B||{},(this.B["$"+e]=this.B["$"+e]||[]).push(t),this},t.prototype.once=function(e,t){function r(){this.off(e,r),t.apply(this,arguments)}return r.fn=t,this.on(e,r),this},t.prototype.off=t.prototype.removeListener=t.prototype.removeAllListeners=t.prototype.removeEventListener=function(e,t){if(this.B=this.B||{},0==arguments.length)return this.B={},this;var r,i=this.B["$"+e];if(!i)return this;if(1==arguments.length)return delete this.B["$"+e],this;for(var n=0;n<i.length;n++)if((r=i[n])===t||r.fn===t){i.splice(n,1);break}return 0===i.length&&delete this.B["$"+e],this},t.prototype.emit=function(e){this.B=this.B||{};for(var t=new Array(arguments.length-1),r=this.B["$"+e],i=1;i<arguments.length;i++)t[i-1]=arguments[i];if(r){i=0;for(var n=(r=r.slice(0)).length;i<n;++i)r[i].apply(this,t)}return this},t.prototype.listeners=function(e){return this.B=this.B||{},this.B["$"+e]||[]},t.prototype.hasListeners=function(e){return!!this.listeners(e).length}}(componentEmitter);var binary={},toString$2={}.toString,isarray=Array.isArray||function(e){return"[object Array]"==toString$2.call(e)},isBuffer$6=isBuf$1,withNativeBuffer="function"==typeof Buffer&&"function"==typeof Buffer.isBuffer,withNativeArrayBuffer="function"==typeof ArrayBuffer,isView=function(e){return"function"==typeof ArrayBuffer.isView?ArrayBuffer.isView(e):e.buffer instanceof ArrayBuffer};function isBuf$1(e){return withNativeBuffer&&Buffer.isBuffer(e)||withNativeArrayBuffer&&(e instanceof ArrayBuffer||isView(e))}var isArray$7=isarray,isBuf=isBuffer$6,toString$1=Object.prototype.toString,withNativeBlob="function"==typeof Blob||"undefined"!=typeof Blob&&"[object BlobConstructor]"===toString$1.call(Blob),withNativeFile="function"==typeof File||"undefined"!=typeof File&&"[object FileConstructor]"===toString$1.call(File);function _deconstructPacket(e,t){if(!e)return e;if(isBuf(e)){var r={F:!0,num:t.length};return t.push(e),r}if(isArray$7(e)){for(var i=new Array(e.length),n=0;n<e.length;n++)i[n]=_deconstructPacket(e[n],t);return i}if("object"==typeof e&&!(e instanceof Date)){for(var s in i={},e)i[s]=_deconstructPacket(e[s],t);return i}return e}function _reconstructPacket(e,t){if(!e)return e;if(e&&e.F)return t[e.num];if(isArray$7(e))for(var r=0;r<e.length;r++)e[r]=_reconstructPacket(e[r],t);else if("object"==typeof e)for(var i in e)e[i]=_reconstructPacket(e[i],t);return e}binary.deconstructPacket=function(e){var t=[],r=e.data,i=e;return i.data=_deconstructPacket(r,t),i.attachments=t.length,{packet:i,buffers:t}},binary.reconstructPacket=function(e,t){return e.data=_reconstructPacket(e.data,t),e.attachments=void 0,e},binary.removeBlobs=function(e,t){var r=0,i=e;!function e(n,s,o){if(!n)return n;if(withNativeBlob&&n instanceof Blob||withNativeFile&&n instanceof File){r++;var a=new FileReader;a.onload=function(){o?o[s]=this.result:i=this.result,--r||t(i)},a.readAsArrayBuffer(n)}else if(isArray$7(n))for(var c=0;c<n.length;c++)e(n[c],c,n);else if("object"==typeof n&&!isBuf(n))for(var u in n)e(n[u],u,n)}(i),r||t(i)},function(e){var t=browserExports("socket.io-parser"),r=componentEmitterExports,i=binary,n=isarray,s=isBuffer$6;function o(){}e.protocol=4,e.types=["CONNECT","DISCONNECT","EVENT","ACK","ERROR","BINARY_EVENT","BINARY_ACK"],e.CONNECT=0,e.DISCONNECT=1,e.EVENT=2,e.ACK=3,e.ERROR=4,e.BINARY_EVENT=5,e.BINARY_ACK=6,e.Encoder=o,e.Decoder=u;var a=e.ERROR+'"encode error"';function c(r){var i=""+r.type;if(e.BINARY_EVENT!==r.type&&e.BINARY_ACK!==r.type||(i+=r.attachments+"-"),r.nsp&&"/"!==r.nsp&&(i+=r.nsp+","),null!=r.id&&(i+=r.id),null!=r.data){var n=function(e){try{return JSON.stringify(e)}catch(e){return!1}}(r.data);if(!1===n)return a;i+=n}return t("encoded %j as %s",r,i),i}function u(){this.reconstructor=null}function h(e){this.reconPack=e,this.buffers=[]}function d(t){return{type:e.ERROR,data:"parser error: "+t}}o.prototype.encode=function(r,n){t("encoding packet %j",r),e.BINARY_EVENT===r.type||e.BINARY_ACK===r.type?function(e,t){i.removeBlobs(e,(function(e){var r=i.deconstructPacket(e),n=c(r.packet),s=r.buffers;s.unshift(n),t(s)}))}(r,n):n([c(r)])},r(u.prototype),u.prototype.add=function(r){var i;if("string"==typeof r)i=function(r){var i=0,s={type:Number(r.charAt(0))};if(null==e.types[s.type])return d("unknown packet type "+s.type);if(e.BINARY_EVENT===s.type||e.BINARY_ACK===s.type){for(var o=i+1;"-"!==r.charAt(++i)&&i!=r.length;);var a=r.substring(o,i);if(a!=Number(a)||"-"!==r.charAt(i))throw new Error("Illegal attachments");s.attachments=Number(a)}if("/"===r.charAt(i+1)){for(o=i+1;++i&&","!==(u=r.charAt(i))&&i!==r.length;);s.nsp=r.substring(o,i)}else s.nsp="/";var c=r.charAt(i+1);if(""!==c&&Number(c)==c){for(o=i+1;++i;){var u;if(null==(u=r.charAt(i))||Number(u)!=u){--i;break}if(i===r.length)break}s.id=Number(r.substring(o,i+1))}if(r.charAt(++i)){var h=function(e){try{return JSON.parse(e)}catch(e){return!1}}(r.substr(i));if(!1===h||s.type!==e.ERROR&&!n(h))return d("invalid payload");s.data=h}return t("decoded %s as %j",r,s),s}(r),e.BINARY_EVENT===i.type||e.BINARY_ACK===i.type?(this.reconstructor=new h(i),0===this.reconstructor.reconPack.attachments&&this.emit("decoded",i)):this.emit("decoded",i);else{if(!s(r)&&!r.base64)throw new Error("Unknown type: "+r);if(!this.reconstructor)throw new Error("got binary data when not reconstructing a packet");(i=this.reconstructor.takeBinaryData(r))&&(this.reconstructor=null,this.emit("decoded",i))}},u.prototype.destroy=function(){this.reconstructor&&this.reconstructor.finishedReconstruction()},h.prototype.takeBinaryData=function(e){if(this.buffers.push(e),this.buffers.length===this.reconPack.attachments){var t=i.reconstructPacket(this.reconPack,this.buffers);return this.finishedReconstruction(),t}return null},h.prototype.finishedReconstruction=function(){this.reconPack=null,this.buffers=[]}}(socket_ioParser);var libExports={},lib$1={get exports(){return libExports},set exports(e){libExports=e}},transports$1={},hasCorsExports={},hasCors={get exports(){return hasCorsExports},set exports(e){hasCorsExports=e}};try{hasCors.exports="undefined"!=typeof XMLHttpRequest&&"withCredentials"in new XMLHttpRequest}catch(e){hasCors.exports=!1}var globalThis_browser="undefined"!=typeof self?self:"undefined"!=typeof window?window:Function("return this")(),hasCORS=hasCorsExports,globalThis$3=globalThis_browser,xmlhttprequest=function(e){var t=e.xdomain,r=e.xscheme,i=e.enablesXDR;try{if("undefined"!=typeof XMLHttpRequest&&(!t||hasCORS))return new XMLHttpRequest}catch(e){}try{if("undefined"!=typeof XDomainRequest&&!r&&i)return new XDomainRequest}catch(e){}if(!t)try{return new(globalThis$3[["Active"].concat("Object").join("X")])("Microsoft.XMLHTTP")}catch(e){}},pollingXhrExports={},pollingXhr={get exports(){return pollingXhrExports},set exports(e){pollingXhrExports=e}},browser={},keys$4=Object.keys||function(e){var t=[],r=Object.prototype.hasOwnProperty;for(var i in e)r.call(e,i)&&t.push(i);return t},hasBinary2,hasRequiredHasBinary2;function requireHasBinary2(){if(hasRequiredHasBinary2)return hasBinary2;hasRequiredHasBinary2=1;var e=isarray,t=Object.prototype.toString,r="function"==typeof Blob||"undefined"!=typeof Blob&&"[object BlobConstructor]"===t.call(Blob),i="function"==typeof File||"undefined"!=typeof File&&"[object FileConstructor]"===t.call(File);return hasBinary2=function t(n){if(!n||"object"!=typeof n)return!1;if(e(n)){for(var s=0,o=n.length;s<o;s++)if(t(n[s]))return!0;return!1}if("function"==typeof Buffer&&Buffer.isBuffer&&Buffer.isBuffer(n)||"function"==typeof ArrayBuffer&&n instanceof ArrayBuffer||r&&n instanceof Blob||i&&n instanceof File)return!0;if(n.toJSON&&"function"==typeof n.toJSON&&1===arguments.length)return t(n.toJSON(),!0);for(var a in n)if(Object.prototype.hasOwnProperty.call(n,a)&&t(n[a]))return!0;return!1},hasBinary2}var arraybuffer_slice=function(e,t,r){var i=e.byteLength;if(t=t||0,r=r||i,e.slice)return e.slice(t,r);if(t<0&&(t+=i),r<0&&(r+=i),r>i&&(r=i),t>=i||t>=r||0===i)return new ArrayBuffer(0);for(var n=new Uint8Array(e),s=new Uint8Array(r-t),o=t,a=0;o<r;o++,a++)s[a]=n[o];return s.buffer},after_1=after;function after(e,t,r){var i=!1;return r=r||noop,n.count=e,0===e?t():n;function n(e,s){if(n.count<=0)throw new Error("after called too many times");--n.count,e?(i=!0,t(e),t=r):0!==n.count||i||t(null,s)}}function noop(){}
/*! https://mths.be/utf8js v2.1.2 by @mathias */var stringFromCharCode=String.fromCharCode,byteArray,byteCount,byteIndex;function ucs2decode(e){for(var t,r,i=[],n=0,s=e.length;n<s;)(t=e.charCodeAt(n++))>=55296&&t<=56319&&n<s?56320==(64512&(r=e.charCodeAt(n++)))?i.push(((1023&t)<<10)+(1023&r)+65536):(i.push(t),n--):i.push(t);return i}function ucs2encode(e){for(var t,r=e.length,i=-1,n="";++i<r;)(t=e[i])>65535&&(n+=stringFromCharCode((t-=65536)>>>10&1023|55296),t=56320|1023&t),n+=stringFromCharCode(t);return n}function checkScalarValue(e,t){if(e>=55296&&e<=57343){if(t)throw Error("Lone surrogate U+"+e.toString(16).toUpperCase()+" is not a scalar value");return!1}return!0}function createByte(e,t){return stringFromCharCode(e>>t&63|128)}function encodeCodePoint(e,t){if(0==(4294967168&e))return stringFromCharCode(e);var r="";return 0==(4294965248&e)?r=stringFromCharCode(e>>6&31|192):0==(4294901760&e)?(checkScalarValue(e,t)||(e=65533),r=stringFromCharCode(e>>12&15|224),r+=createByte(e,6)):0==(4292870144&e)&&(r=stringFromCharCode(e>>18&7|240),r+=createByte(e,12),r+=createByte(e,6)),r+stringFromCharCode(63&e|128)}function utf8encode(e,t){for(var r=!1!==(t=t||{}).strict,i=ucs2decode(e),n=i.length,s=-1,o="";++s<n;)o+=encodeCodePoint(i[s],r);return o}function readContinuationByte(){if(byteIndex>=byteCount)throw Error("Invalid byte index");var e=255&byteArray[byteIndex];if(byteIndex++,128==(192&e))return 63&e;throw Error("Invalid continuation byte")}function decodeSymbol(e){var t,r;if(byteIndex>byteCount)throw Error("Invalid byte index");if(byteIndex==byteCount)return!1;if(t=255&byteArray[byteIndex],byteIndex++,0==(128&t))return t;if(192==(224&t)){if((r=(31&t)<<6|readContinuationByte())>=128)return r;throw Error("Invalid continuation byte")}if(224==(240&t)){if((r=(15&t)<<12|readContinuationByte()<<6|readContinuationByte())>=2048)return checkScalarValue(r,e)?r:65533;throw Error("Invalid continuation byte")}if(240==(248&t)&&(r=(7&t)<<18|readContinuationByte()<<12|readContinuationByte()<<6|readContinuationByte())>=65536&&r<=1114111)return r;throw Error("Invalid UTF-8 detected")}function utf8decode(e,t){var r=!1!==(t=t||{}).strict;byteArray=ucs2decode(e),byteCount=byteArray.length,byteIndex=0;for(var i,n=[];!1!==(i=decodeSymbol(r));)n.push(i);return ucs2encode(n)}var utf8$1={version:"2.1.2",encode:utf8encode,decode:utf8decode},base64Arraybuffer={},hasRequiredBase64Arraybuffer,blob,hasRequiredBlob,transport,hasRequiredTransport;function requireBase64Arraybuffer(){return hasRequiredBase64Arraybuffer||(hasRequiredBase64Arraybuffer=1,e="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/",base64Arraybuffer.encode=function(t){var r,i=new Uint8Array(t),n=i.length,s="";for(r=0;r<n;r+=3)s+=e[i[r]>>2],s+=e[(3&i[r])<<4|i[r+1]>>4],s+=e[(15&i[r+1])<<2|i[r+2]>>6],s+=e[63&i[r+2]];return n%3==2?s=s.substring(0,s.length-1)+"=":n%3==1&&(s=s.substring(0,s.length-2)+"=="),s},base64Arraybuffer.decode=function(t){var r,i,n,s,o,a=.75*t.length,c=t.length,u=0;"="===t[t.length-1]&&(a--,"="===t[t.length-2]&&a--);var h=new ArrayBuffer(a),d=new Uint8Array(h);for(r=0;r<c;r+=4)i=e.indexOf(t[r]),n=e.indexOf(t[r+1]),s=e.indexOf(t[r+2]),o=e.indexOf(t[r+3]),d[u++]=i<<2|n>>4,d[u++]=(15&n)<<4|s>>2,d[u++]=(3&s)<<6|63&o;return h}),base64Arraybuffer;var e}function requireBlob(){if(hasRequiredBlob)return blob;hasRequiredBlob=1;var e=void 0!==e?e:"undefined"!=typeof WebKitBlobBuilder?WebKitBlobBuilder:"undefined"!=typeof MSBlobBuilder?MSBlobBuilder:"undefined"!=typeof MozBlobBuilder&&MozBlobBuilder,t=function(){try{return 2===new Blob(["hi"]).size}catch(e){return!1}}(),r=t&&function(){try{return 2===new Blob([new Uint8Array([1,2])]).size}catch(e){return!1}}(),i=e&&e.prototype.append&&e.prototype.getBlob;function n(e){return e.map((function(e){if(e.buffer instanceof ArrayBuffer){var t=e.buffer;if(e.byteLength!==t.byteLength){var r=new Uint8Array(e.byteLength);r.set(new Uint8Array(t,e.byteOffset,e.byteLength)),t=r.buffer}return t}return e}))}function s(t,r){r=r||{};var i=new e;return n(t).forEach((function(e){i.append(e)})),r.type?i.getBlob(r.type):i.getBlob()}function o(e,t){return new Blob(n(e),t||{})}return"undefined"!=typeof Blob&&(s.prototype=Blob.prototype,o.prototype=Blob.prototype),blob=t?r?Blob:o:i?s:void 0}function requireTransport(){if(hasRequiredTransport)return transport;hasRequiredTransport=1;var e=browser;function t(e){this.path=e.path,this.hostname=e.hostname,this.port=e.port,this.secure=e.secure,this.query=e.query,this.timestampParam=e.timestampParam,this.timestampRequests=e.timestampRequests,this.readyState="",this.agent=e.agent||!1,this.socket=e.socket,this.enablesXDR=e.enablesXDR,this.withCredentials=e.withCredentials,this.pfx=e.pfx,this.key=e.key,this.passphrase=e.passphrase,this.cert=e.cert,this.ca=e.ca,this.ciphers=e.ciphers,this.rejectUnauthorized=e.rejectUnauthorized,this.forceNode=e.forceNode,this.isReactNative=e.isReactNative,this.extraHeaders=e.extraHeaders,this.localAddress=e.localAddress}return transport=t,componentEmitterExports(t.prototype),t.prototype.onError=function(e,t){var r=new Error(e);return r.type="TransportError",r.description=t,this.emit("error",r),this},t.prototype.open=function(){return"closed"!==this.readyState&&""!==this.readyState||(this.readyState="opening",this.doOpen()),this},t.prototype.close=function(){return"opening"!==this.readyState&&"open"!==this.readyState||(this.doClose(),this.onClose()),this},t.prototype.send=function(e){if("open"!==this.readyState)throw new Error("Transport not open");this.write(e)},t.prototype.onOpen=function(){this.readyState="open",this.writable=!0,this.emit("open")},t.prototype.onData=function(t){var r=e.decodePacket(t,this.socket.binaryType);this.onPacket(r)},t.prototype.onPacket=function(e){this.emit("packet",e)},t.prototype.onClose=function(){this.readyState="closed",this.emit("close")},transport}!function(e){var t,r=keys$4,i=requireHasBinary2(),n=arraybuffer_slice,s=after_1,o=utf8$1;"undefined"!=typeof ArrayBuffer&&(t=requireBase64Arraybuffer());var a="undefined"!=typeof navigator&&/Android/i.test(navigator.userAgent),c="undefined"!=typeof navigator&&/PhantomJS/i.test(navigator.userAgent),u=a||c;e.protocol=3;var h=e.packets={open:0,close:1,ping:2,pong:3,message:4,upgrade:5,noop:6},d=r(h),f={type:"error",data:"parser error"},l=requireBlob();function p(e,t,r){for(var i=new Array(e.length),n=s(e.length,r),o=function(e,r,n){t(r,(function(t,r){i[e]=r,n(t,i)}))},a=0;a<e.length;a++)o(a,e[a],n)}e.encodePacket=function(t,r,i,n){"function"==typeof r&&(n=r,r=!1),"function"==typeof i&&(n=i,i=null);var s=void 0===t.data?void 0:t.data.buffer||t.data;if("undefined"!=typeof ArrayBuffer&&s instanceof ArrayBuffer)return function(t,r,i){if(!r)return e.encodeBase64Packet(t,i);var n=t.data,s=new Uint8Array(n),o=new Uint8Array(1+n.byteLength);o[0]=h[t.type];for(var a=0;a<s.length;a++)o[a+1]=s[a];return i(o.buffer)}(t,r,n);if(void 0!==l&&s instanceof l)return function(t,r,i){if(!r)return e.encodeBase64Packet(t,i);if(u)return function(t,r,i){if(!r)return e.encodeBase64Packet(t,i);var n=new FileReader;return n.onload=function(){e.encodePacket({type:t.type,data:n.result},r,!0,i)},n.readAsArrayBuffer(t.data)}(t,r,i);var n=new Uint8Array(1);return n[0]=h[t.type],i(new l([n.buffer,t.data]))}(t,r,n);if(s&&s.base64)return function(t,r){return r("b"+e.packets[t.type]+t.data.data)}(t,n);var a=h[t.type];return void 0!==t.data&&(a+=i?o.encode(String(t.data),{strict:!1}):String(t.data)),n(""+a)},e.encodeBase64Packet=function(t,r){var i,n="b"+e.packets[t.type];if(void 0!==l&&t.data instanceof l){var s=new FileReader;return s.onload=function(){var e=s.result.split(",")[1];r(n+e)},s.readAsDataURL(t.data)}try{i=String.fromCharCode.apply(null,new Uint8Array(t.data))}catch(e){for(var o=new Uint8Array(t.data),a=new Array(o.length),c=0;c<o.length;c++)a[c]=o[c];i=String.fromCharCode.apply(null,a)}return n+=btoa(i),r(n)},e.decodePacket=function(t,r,i){if(void 0===t)return f;if("string"==typeof t){if("b"===t.charAt(0))return e.decodeBase64Packet(t.substr(1),r);if(i&&!1===(t=function(e){try{e=o.decode(e,{strict:!1})}catch(e){return!1}return e}(t)))return f;var s=t.charAt(0);return Number(s)==s&&d[s]?t.length>1?{type:d[s],data:t.substring(1)}:{type:d[s]}:f}s=new Uint8Array(t)[0];var a=n(t,1);return l&&"blob"===r&&(a=new l([a])),{type:d[s],data:a}},e.decodeBase64Packet=function(e,r){var i=d[e.charAt(0)];if(!t)return{type:i,data:{base64:!0,data:e.substr(1)}};var n=t.decode(e.substr(1));return"blob"===r&&l&&(n=new l([n])),{type:i,data:n}},e.encodePayload=function(t,r,n){"function"==typeof r&&(n=r,r=null);var s=i(t);return r&&s?l&&!u?e.encodePayloadAsBlob(t,n):e.encodePayloadAsArrayBuffer(t,n):t.length?void p(t,(function(t,i){e.encodePacket(t,!!s&&r,!1,(function(e){i(null,function(e){return e.length+":"+e}(e))}))}),(function(e,t){return n(t.join(""))})):n("0:")},e.decodePayload=function(t,r,i){if("string"!=typeof t)return e.decodePayloadAsBinary(t,r,i);var n;if("function"==typeof r&&(i=r,r=null),""===t)return i(f,0,1);for(var s,o,a="",c=0,u=t.length;c<u;c++){var h=t.charAt(c);if(":"===h){if(""===a||a!=(s=Number(a)))return i(f,0,1);if(a!=(o=t.substr(c+1,s)).length)return i(f,0,1);if(o.length){if(n=e.decodePacket(o,r,!1),f.type===n.type&&f.data===n.data)return i(f,0,1);if(!1===i(n,c+s,u))return}c+=s,a=""}else a+=h}return""!==a?i(f,0,1):void 0},e.encodePayloadAsArrayBuffer=function(t,r){if(!t.length)return r(new ArrayBuffer(0));p(t,(function(t,r){e.encodePacket(t,!0,!0,(function(e){return r(null,e)}))}),(function(e,t){var i=t.reduce((function(e,t){var r;return e+(r="string"==typeof t?t.length:t.byteLength).toString().length+r+2}),0),n=new Uint8Array(i),s=0;return t.forEach((function(e){var t="string"==typeof e,r=e;if(t){for(var i=new Uint8Array(e.length),o=0;o<e.length;o++)i[o]=e.charCodeAt(o);r=i.buffer}n[s++]=t?0:1;var a=r.byteLength.toString();for(o=0;o<a.length;o++)n[s++]=parseInt(a[o]);for(n[s++]=255,i=new Uint8Array(r),o=0;o<i.length;o++)n[s++]=i[o]})),r(n.buffer)}))},e.encodePayloadAsBlob=function(t,r){p(t,(function(t,r){e.encodePacket(t,!0,!0,(function(e){var t=new Uint8Array(1);if(t[0]=1,"string"==typeof e){for(var i=new Uint8Array(e.length),n=0;n<e.length;n++)i[n]=e.charCodeAt(n);e=i.buffer,t[0]=0}var s=(e instanceof ArrayBuffer?e.byteLength:e.size).toString(),o=new Uint8Array(s.length+1);for(n=0;n<s.length;n++)o[n]=parseInt(s[n]);if(o[s.length]=255,l){var a=new l([t.buffer,o.buffer,e]);r(null,a)}}))}),(function(e,t){return r(new l(t))}))},e.decodePayloadAsBinary=function(t,r,i){"function"==typeof r&&(i=r,r=null);for(var s=t,o=[];s.byteLength>0;){for(var a=new Uint8Array(s),c=0===a[0],u="",h=1;255!==a[h];h++){if(u.length>310)return i(f,0,1);u+=a[h]}s=n(s,2+u.length),u=parseInt(u);var d=n(s,0,u);if(c)try{d=String.fromCharCode.apply(null,new Uint8Array(d))}catch(e){var l=new Uint8Array(d);for(d="",h=0;h<l.length;h++)d+=String.fromCharCode(l[h])}o.push(d),s=n(s,u)}var p=o.length;o.forEach((function(t,n){i(e.decodePacket(t,r,!0),n,p)}))}}(browser);var parseqs$3={},hasRequiredParseqs;function requireParseqs(){return hasRequiredParseqs||(hasRequiredParseqs=1,parseqs$3.encode=function(e){var t="";for(var r in e)e.hasOwnProperty(r)&&(t.length&&(t+="&"),t+=encodeURIComponent(r)+"="+encodeURIComponent(e[r]));return t},parseqs$3.decode=function(e){for(var t={},r=e.split("&"),i=0,n=r.length;i<n;i++){var s=r[i].split("=");t[decodeURIComponent(s[0])]=decodeURIComponent(s[1])}return t}),parseqs$3}var componentInherit=function(e,t){var r=function(){};r.prototype=t.prototype,e.prototype=new r,e.prototype.constructor=e},alphabet="0123456789ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz-_".split(""),length=64,map={},seed=0,i$2=0,prev;function encode$1(e){var t="";do{t=alphabet[e%length]+t,e=Math.floor(e/length)}while(e>0);return t}function decode(e){var t=0;for(i$2=0;i$2<e.length;i$2++)t=t*length+map[e.charAt(i$2)];return t}function yeast$2(){var e=encode$1(+new Date);return e!==prev?(seed=0,prev=e):e+"."+encode$1(seed++)}for(;i$2<length;i$2++)map[alphabet[i$2]]=i$2;yeast$2.encode=encode$1,yeast$2.decode=decode;var yeast_1=yeast$2,Transport$1=requireTransport(),parseqs$2=requireParseqs(),parser$5=browser,inherit$3=componentInherit,yeast$1=yeast_1,debug$4=browserExports("engine.io-client:polling"),polling$1=Polling$2,hasXHR2=null!=new xmlhttprequest({xdomain:!1}).responseType;function Polling$2(e){var t=e&&e.forceBase64;hasXHR2&&!t||(this.supportsBinary=!1),Transport$1.call(this,e)}inherit$3(Polling$2,Transport$1),Polling$2.prototype.name="polling",Polling$2.prototype.doOpen=function(){this.poll()},Polling$2.prototype.pause=function(e){var t=this;function r(){debug$4("paused"),t.readyState="paused",e()}if(this.readyState="pausing",this.polling||!this.writable){var i=0;this.polling&&(debug$4("we are currently polling - waiting to pause"),i++,this.once("pollComplete",(function(){debug$4("pre-pause polling complete"),--i||r()}))),this.writable||(debug$4("we are currently writing - waiting to pause"),i++,this.once("drain",(function(){debug$4("pre-pause writing complete"),--i||r()})))}else r()},Polling$2.prototype.poll=function(){debug$4("polling"),this.polling=!0,this.doPoll(),this.emit("poll")},Polling$2.prototype.onData=function(e){var t=this;debug$4("polling got data %s",e),parser$5.decodePayload(e,this.socket.binaryType,(function(e,r,i){if("opening"===t.readyState&&"open"===e.type&&t.onOpen(),"close"===e.type)return t.onClose(),!1;t.onPacket(e)})),"closed"!==this.readyState&&(this.polling=!1,this.emit("pollComplete"),"open"===this.readyState?this.poll():debug$4('ignoring poll - transport state "%s"',this.readyState))},Polling$2.prototype.doClose=function(){var e=this;function t(){debug$4("writing close packet"),e.write([{type:"close"}])}"open"===this.readyState?(debug$4("transport open - closing"),t()):(debug$4("transport not open - deferring close"),this.once("open",t))},Polling$2.prototype.write=function(e){var t=this;this.writable=!1;var r=function(){t.writable=!0,t.emit("drain")};parser$5.encodePayload(e,this.supportsBinary,(function(e){t.doWrite(e,r)}))},Polling$2.prototype.uri=function(){var e=this.query||{},t=this.secure?"https":"http",r="";return!1!==this.timestampRequests&&(e[this.timestampParam]=yeast$1()),this.supportsBinary||e.sid||(e.b64=1),e=parseqs$2.encode(e),this.port&&("https"===t&&443!==Number(this.port)||"http"===t&&80!==Number(this.port))&&(r=":"+this.port),e.length&&(e="?"+e),t+"://"+(-1!==this.hostname.indexOf(":")?"["+this.hostname+"]":this.hostname)+r+this.path+e};var XMLHttpRequest$2=xmlhttprequest,Polling$1=polling$1,Emitter$2=componentEmitterExports,inherit$2=componentInherit,debug$3=browserExports("engine.io-client:polling-xhr"),globalThis$2=globalThis_browser;function empty$1(){}function XHR$1(e){if(Polling$1.call(this,e),this.requestTimeout=e.requestTimeout,this.extraHeaders=e.extraHeaders,"undefined"!=typeof location){var t="https:"===location.protocol,r=location.port;r||(r=t?443:80),this.xd="undefined"!=typeof location&&e.hostname!==location.hostname||r!==e.port,this.xs=e.secure!==t}}function Request(e){this.method=e.method||"GET",this.uri=e.uri,this.xd=!!e.xd,this.xs=!!e.xs,this.async=!1!==e.async,this.data=void 0!==e.data?e.data:null,this.agent=e.agent,this.isBinary=e.isBinary,this.supportsBinary=e.supportsBinary,this.enablesXDR=e.enablesXDR,this.withCredentials=e.withCredentials,this.requestTimeout=e.requestTimeout,this.pfx=e.pfx,this.key=e.key,this.passphrase=e.passphrase,this.cert=e.cert,this.ca=e.ca,this.ciphers=e.ciphers,this.rejectUnauthorized=e.rejectUnauthorized,this.extraHeaders=e.extraHeaders,this.create()}if(pollingXhr.exports=XHR$1,pollingXhrExports.Request=Request,inherit$2(XHR$1,Polling$1),XHR$1.prototype.supportsBinary=!0,XHR$1.prototype.request=function(e){return(e=e||{}).uri=this.uri(),e.xd=this.xd,e.xs=this.xs,e.agent=this.agent||!1,e.supportsBinary=this.supportsBinary,e.enablesXDR=this.enablesXDR,e.withCredentials=this.withCredentials,e.pfx=this.pfx,e.key=this.key,e.passphrase=this.passphrase,e.cert=this.cert,e.ca=this.ca,e.ciphers=this.ciphers,e.rejectUnauthorized=this.rejectUnauthorized,e.requestTimeout=this.requestTimeout,e.extraHeaders=this.extraHeaders,new Request(e)},XHR$1.prototype.doWrite=function(e,t){var r="string"!=typeof e&&void 0!==e,i=this.request({method:"POST",data:e,isBinary:r}),n=this;i.on("success",t),i.on("error",(function(e){n.onError("xhr post error",e)})),this.sendXhr=i},XHR$1.prototype.doPoll=function(){debug$3("xhr poll");var e=this.request(),t=this;e.on("data",(function(e){t.onData(e)})),e.on("error",(function(e){t.onError("xhr poll error",e)})),this.pollXhr=e},Emitter$2(Request.prototype),Request.prototype.create=function(){var e={agent:this.agent,xdomain:this.xd,xscheme:this.xs,enablesXDR:this.enablesXDR};e.pfx=this.pfx,e.key=this.key,e.passphrase=this.passphrase,e.cert=this.cert,e.ca=this.ca,e.ciphers=this.ciphers,e.rejectUnauthorized=this.rejectUnauthorized;var t=this.xhr=new XMLHttpRequest$2(e),r=this;try{debug$3("xhr open %s: %s",this.method,this.uri),t.open(this.method,this.uri,this.async);try{if(this.extraHeaders)for(var i in t.setDisableHeaderCheck&&t.setDisableHeaderCheck(!0),this.extraHeaders)this.extraHeaders.hasOwnProperty(i)&&t.setRequestHeader(i,this.extraHeaders[i])}catch(e){}if("POST"===this.method)try{this.isBinary?t.setRequestHeader("Content-type","application/octet-stream"):t.setRequestHeader("Content-type","text/plain;charset=UTF-8")}catch(e){}try{t.setRequestHeader("Accept","*/*")}catch(e){}"withCredentials"in t&&(t.withCredentials=this.withCredentials),this.requestTimeout&&(t.timeout=this.requestTimeout),this.hasXDR()?(t.onload=function(){r.onLoad()},t.onerror=function(){r.onError(t.responseText)}):t.onreadystatechange=function(){if(2===t.readyState)try{var e=t.getResponseHeader("Content-Type");(r.supportsBinary&&"application/octet-stream"===e||"application/octet-stream; charset=UTF-8"===e)&&(t.responseType="arraybuffer")}catch(e){}4===t.readyState&&(200===t.status||1223===t.status?r.onLoad():setTimeout((function(){r.onError("number"==typeof t.status?t.status:0)}),0))},debug$3("xhr data %s",this.data),t.send(this.data)}catch(e){return void setTimeout((function(){r.onError(e)}),0)}"undefined"!=typeof document&&(this.index=Request.requestsCount++,Request.requests[this.index]=this)},Request.prototype.onSuccess=function(){this.emit("success"),this.cleanup()},Request.prototype.onData=function(e){this.emit("data",e),this.onSuccess()},Request.prototype.onError=function(e){this.emit("error",e),this.cleanup(!0)},Request.prototype.cleanup=function(e){if(void 0!==this.xhr&&null!==this.xhr){if(this.hasXDR()?this.xhr.onload=this.xhr.onerror=empty$1:this.xhr.onreadystatechange=empty$1,e)try{this.xhr.abort()}catch(e){}"undefined"!=typeof document&&delete Request.requests[this.index],this.xhr=null}},Request.prototype.onLoad=function(){var e;try{var t;try{t=this.xhr.getResponseHeader("Content-Type")}catch(e){}e=("application/octet-stream"===t||"application/octet-stream; charset=UTF-8"===t)&&this.xhr.response||this.xhr.responseText}catch(e){this.onError(e)}null!=e&&this.onData(e)},Request.prototype.hasXDR=function(){return"undefined"!=typeof XDomainRequest&&!this.xs&&this.enablesXDR},Request.prototype.abort=function(){this.cleanup()},Request.requestsCount=0,Request.requests={},"undefined"!=typeof document)if("function"==typeof attachEvent)attachEvent("onunload",unloadHandler);else if("function"==typeof addEventListener){var terminationEvent="onpagehide"in globalThis$2?"pagehide":"unload";addEventListener(terminationEvent,unloadHandler,!1)}function unloadHandler(){for(var e in Request.requests)Request.requests.hasOwnProperty(e)&&Request.requests[e].abort()}var Polling=polling$1,inherit$1=componentInherit,globalThis$1=globalThis_browser,pollingJsonp=JSONPPolling,rNewline=/\n/g,rEscapedNewline=/\\n/g,callbacks;function empty(){}function JSONPPolling(e){Polling.call(this,e),this.query=this.query||{},callbacks||(callbacks=globalThis$1.___eio=globalThis$1.___eio||[]),this.index=callbacks.length;var t=this;callbacks.push((function(e){t.onData(e)})),this.query.j=this.index,"function"==typeof addEventListener&&addEventListener("beforeunload",(function(){t.script&&(t.script.onerror=empty)}),!1)}inherit$1(JSONPPolling,Polling),JSONPPolling.prototype.supportsBinary=!1,JSONPPolling.prototype.doClose=function(){this.script&&(this.script.parentNode.removeChild(this.script),this.script=null),this.form&&(this.form.parentNode.removeChild(this.form),this.form=null,this.iframe=null),Polling.prototype.doClose.call(this)},JSONPPolling.prototype.doPoll=function(){var e=this,t=document.createElement("script");this.script&&(this.script.parentNode.removeChild(this.script),this.script=null),t.async=!0,t.src=this.uri(),t.onerror=function(t){e.onError("jsonp poll error",t)};var r=document.getElementsByTagName("script")[0];r?r.parentNode.insertBefore(t,r):(document.head||document.body).appendChild(t),this.script=t,"undefined"!=typeof navigator&&/gecko/i.test(navigator.userAgent)&&setTimeout((function(){var e=document.createElement("iframe");document.body.appendChild(e),document.body.removeChild(e)}),100)},JSONPPolling.prototype.doWrite=function(e,t){var r=this;if(!this.form){var i,n=document.createElement("form"),s=document.createElement("textarea"),o=this.iframeId="eio_iframe_"+this.index;n.className="socketio",n.style.position="absolute",n.style.top="-1000px",n.style.left="-1000px",n.target=o,n.method="POST",n.setAttribute("accept-charset","utf-8"),s.name="d",n.appendChild(s),document.body.appendChild(n),this.form=n,this.area=s}function a(){c(),t()}function c(){if(r.iframe)try{r.form.removeChild(r.iframe)}catch(e){r.onError("jsonp polling iframe removal error",e)}try{var e='<iframe src="javascript:0" name="'+r.iframeId+'">';i=document.createElement(e)}catch(e){(i=document.createElement("iframe")).name=r.iframeId,i.src="javascript:0"}i.id=r.iframeId,r.form.appendChild(i),r.iframe=i}this.form.action=this.uri(),c(),e=e.replace(rEscapedNewline,"\\\n"),this.area.value=e.replace(rNewline,"\\n");try{this.form.submit()}catch(e){}this.iframe.attachEvent?this.iframe.onreadystatechange=function(){"complete"===r.iframe.readyState&&a()}:this.iframe.onload=a};var _nodeResolve_empty={},_nodeResolve_empty$1=Object.freeze({__proto__:null,default:_nodeResolve_empty}),require$$0=getAugmentedNamespace(_nodeResolve_empty$1),Transport=requireTransport(),parser$4=browser,parseqs$1=requireParseqs(),inherit=componentInherit,yeast=yeast_1,debug$2=browserExports("engine.io-client:websocket"),BrowserWebSocket,NodeWebSocket;if("undefined"!=typeof WebSocket?BrowserWebSocket=WebSocket:"undefined"!=typeof self&&(BrowserWebSocket=self.WebSocket||self.MozWebSocket),"undefined"==typeof window)try{NodeWebSocket=require$$0}catch(e){}var WebSocketImpl=BrowserWebSocket||NodeWebSocket,websocket$1=WS;function WS(e){e&&e.forceBase64&&(this.supportsBinary=!1),this.perMessageDeflate=e.perMessageDeflate,this.usingBrowserWebSocket=BrowserWebSocket&&!e.forceNode,this.protocols=e.protocols,this.usingBrowserWebSocket||(WebSocketImpl=NodeWebSocket),Transport.call(this,e)}inherit(WS,Transport),WS.prototype.name="websocket",WS.prototype.supportsBinary=!0,WS.prototype.doOpen=function(){if(this.check()){var e=this.uri(),t=this.protocols,r={};this.isReactNative||(r.agent=this.agent,r.perMessageDeflate=this.perMessageDeflate,r.pfx=this.pfx,r.key=this.key,r.passphrase=this.passphrase,r.cert=this.cert,r.ca=this.ca,r.ciphers=this.ciphers,r.rejectUnauthorized=this.rejectUnauthorized),this.extraHeaders&&(r.headers=this.extraHeaders),this.localAddress&&(r.localAddress=this.localAddress);try{this.ws=this.usingBrowserWebSocket&&!this.isReactNative?t?new WebSocketImpl(e,t):new WebSocketImpl(e):new WebSocketImpl(e,t,r)}catch(e){return this.emit("error",e)}void 0===this.ws.binaryType&&(this.supportsBinary=!1),this.ws.supports&&this.ws.supports.binary?(this.supportsBinary=!0,this.ws.binaryType="nodebuffer"):this.ws.binaryType="arraybuffer",this.addEventListeners()}},WS.prototype.addEventListeners=function(){var e=this;this.ws.onopen=function(){e.onOpen()},this.ws.onclose=function(){e.onClose()},this.ws.onmessage=function(t){e.onData(t.data)},this.ws.onerror=function(t){e.onError("websocket error",t)}},WS.prototype.write=function(e){var t=this;this.writable=!1;for(var r=e.length,i=0,n=r;i<n;i++)!function(e){parser$4.encodePacket(e,t.supportsBinary,(function(i){if(!t.usingBrowserWebSocket){var n={};e.options&&(n.compress=e.options.compress),t.perMessageDeflate&&("string"==typeof i?Buffer.byteLength(i):i.length)<t.perMessageDeflate.threshold&&(n.compress=!1)}try{t.usingBrowserWebSocket?t.ws.send(i):t.ws.send(i,n)}catch(e){debug$2("websocket closed before onclose event")}--r||(t.emit("flush"),setTimeout((function(){t.writable=!0,t.emit("drain")}),0))}))}(e[i])},WS.prototype.onClose=function(){Transport.prototype.onClose.call(this)},WS.prototype.doClose=function(){void 0!==this.ws&&this.ws.close()},WS.prototype.uri=function(){var e=this.query||{},t=this.secure?"wss":"ws",r="";return this.port&&("wss"===t&&443!==Number(this.port)||"ws"===t&&80!==Number(this.port))&&(r=":"+this.port),this.timestampRequests&&(e[this.timestampParam]=yeast()),this.supportsBinary||(e.b64=1),(e=parseqs$1.encode(e)).length&&(e="?"+e),t+"://"+(-1!==this.hostname.indexOf(":")?"["+this.hostname+"]":this.hostname)+r+this.path+e},WS.prototype.check=function(){return!(!WebSocketImpl||"__initialize"in WebSocketImpl&&this.name===WS.prototype.name)};var XMLHttpRequest$1=xmlhttprequest,XHR=pollingXhrExports,JSONP=pollingJsonp,websocket=websocket$1;function polling(e){var t=!1,r=!1,i=!1!==e.jsonp;if("undefined"!=typeof location){var n="https:"===location.protocol,s=location.port;s||(s=n?443:80),t=e.hostname!==location.hostname||s!==e.port,r=e.secure!==n}if(e.xdomain=t,e.xscheme=r,"open"in new XMLHttpRequest$1(e)&&!e.forceJSONP)return new XHR(e);if(!i)throw new Error("JSONP disabled");return new JSONP(e)}transports$1.polling=polling,transports$1.websocket=websocket;var indexOf$1=[].indexOf,indexof=function(e,t){if(indexOf$1)return e.indexOf(t);for(var r=0;r<e.length;++r)if(e[r]===t)return r;return-1},transports=transports$1,Emitter$1=componentEmitterExports,debug$1=browserExports("engine.io-client:socket"),index=indexof,parser$3=browser,parseuri=parseuri$2,parseqs=requireParseqs(),socket$1=Socket$1;function Socket$1(e,t){if(!(this instanceof Socket$1))return new Socket$1(e,t);t=t||{},e&&"object"==typeof e&&(t=e,e=null),e?(e=parseuri(e),t.hostname=e.host,t.secure="https"===e.protocol||"wss"===e.protocol,t.port=e.port,e.query&&(t.query=e.query)):t.host&&(t.hostname=parseuri(t.host).host),this.secure=null!=t.secure?t.secure:"undefined"!=typeof location&&"https:"===location.protocol,t.hostname&&!t.port&&(t.port=this.secure?"443":"80"),this.agent=t.agent||!1,this.hostname=t.hostname||("undefined"!=typeof location?location.hostname:"localhost"),this.port=t.port||("undefined"!=typeof location&&location.port?location.port:this.secure?443:80),this.query=t.query||{},"string"==typeof this.query&&(this.query=parseqs.decode(this.query)),this.upgrade=!1!==t.upgrade,this.path=(t.path||"/engine.io").replace(/\/$/,"")+"/",this.forceJSONP=!!t.forceJSONP,this.jsonp=!1!==t.jsonp,this.forceBase64=!!t.forceBase64,this.enablesXDR=!!t.enablesXDR,this.withCredentials=!1!==t.withCredentials,this.timestampParam=t.timestampParam||"t",this.timestampRequests=t.timestampRequests,this.transports=t.transports||["polling","websocket"],this.transportOptions=t.transportOptions||{},this.readyState="",this.writeBuffer=[],this.prevBufferLen=0,this.policyPort=t.policyPort||843,this.rememberUpgrade=t.rememberUpgrade||!1,this.binaryType=null,this.onlyBinaryUpgrades=t.onlyBinaryUpgrades,this.perMessageDeflate=!1!==t.perMessageDeflate&&(t.perMessageDeflate||{}),!0===this.perMessageDeflate&&(this.perMessageDeflate={}),this.perMessageDeflate&&null==this.perMessageDeflate.threshold&&(this.perMessageDeflate.threshold=1024),this.pfx=t.pfx||void 0,this.key=t.key||void 0,this.passphrase=t.passphrase||void 0,this.cert=t.cert||void 0,this.ca=t.ca||void 0,this.ciphers=t.ciphers||void 0,this.rejectUnauthorized=void 0===t.rejectUnauthorized||t.rejectUnauthorized,this.forceNode=!!t.forceNode,this.isReactNative="undefined"!=typeof navigator&&"string"==typeof navigator.product&&"reactnative"===navigator.product.toLowerCase(),("undefined"==typeof self||this.isReactNative)&&(t.extraHeaders&&Object.keys(t.extraHeaders).length>0&&(this.extraHeaders=t.extraHeaders),t.localAddress&&(this.localAddress=t.localAddress)),this.id=null,this.upgrades=null,this.pingInterval=null,this.pingTimeout=null,this.pingIntervalTimer=null,this.pingTimeoutTimer=null,this.open()}function clone(e){var t={};for(var r in e)e.hasOwnProperty(r)&&(t[r]=e[r]);return t}Socket$1.priorWebsocketSuccess=!1,Emitter$1(Socket$1.prototype),Socket$1.protocol=parser$3.protocol,Socket$1.Socket=Socket$1,Socket$1.Transport=requireTransport(),Socket$1.transports=transports$1,Socket$1.parser=browser,Socket$1.prototype.createTransport=function(e){debug$1('creating transport "%s"',e);var t=clone(this.query);t.EIO=parser$3.protocol,t.transport=e;var r=this.transportOptions[e]||{};return this.id&&(t.sid=this.id),new transports[e]({query:t,socket:this,agent:r.agent||this.agent,hostname:r.hostname||this.hostname,port:r.port||this.port,secure:r.secure||this.secure,path:r.path||this.path,forceJSONP:r.forceJSONP||this.forceJSONP,jsonp:r.jsonp||this.jsonp,forceBase64:r.forceBase64||this.forceBase64,enablesXDR:r.enablesXDR||this.enablesXDR,withCredentials:r.withCredentials||this.withCredentials,timestampRequests:r.timestampRequests||this.timestampRequests,timestampParam:r.timestampParam||this.timestampParam,policyPort:r.policyPort||this.policyPort,pfx:r.pfx||this.pfx,key:r.key||this.key,passphrase:r.passphrase||this.passphrase,cert:r.cert||this.cert,ca:r.ca||this.ca,ciphers:r.ciphers||this.ciphers,rejectUnauthorized:r.rejectUnauthorized||this.rejectUnauthorized,perMessageDeflate:r.perMessageDeflate||this.perMessageDeflate,extraHeaders:r.extraHeaders||this.extraHeaders,forceNode:r.forceNode||this.forceNode,localAddress:r.localAddress||this.localAddress,requestTimeout:r.requestTimeout||this.requestTimeout,protocols:r.protocols||void 0,isReactNative:this.isReactNative})},Socket$1.prototype.open=function(){var e;if(this.rememberUpgrade&&Socket$1.priorWebsocketSuccess&&-1!==this.transports.indexOf("websocket"))e="websocket";else{if(0===this.transports.length){var t=this;return void setTimeout((function(){t.emit("error","No transports available")}),0)}e=this.transports[0]}this.readyState="opening";try{e=this.createTransport(e)}catch(e){return this.transports.shift(),void this.open()}e.open(),this.setTransport(e)},Socket$1.prototype.setTransport=function(e){debug$1("setting transport %s",e.name);var t=this;this.transport&&(debug$1("clearing existing transport %s",this.transport.name),this.transport.removeAllListeners()),this.transport=e,e.on("drain",(function(){t.onDrain()})).on("packet",(function(e){t.onPacket(e)})).on("error",(function(e){t.onError(e)})).on("close",(function(){t.onClose("transport close")}))},Socket$1.prototype.probe=function(e){debug$1('probing transport "%s"',e);var t=this.createTransport(e,{probe:1}),r=!1,i=this;function n(){if(i.onlyBinaryUpgrades){var n=!this.supportsBinary&&i.transport.supportsBinary;r=r||n}r||(debug$1('probe transport "%s" opened',e),t.send([{type:"ping",data:"probe"}]),t.once("packet",(function(n){if(!r)if("pong"===n.type&&"probe"===n.data){if(debug$1('probe transport "%s" pong',e),i.upgrading=!0,i.emit("upgrading",t),!t)return;Socket$1.priorWebsocketSuccess="websocket"===t.name,debug$1('pausing current transport "%s"',i.transport.name),i.transport.pause((function(){r||"closed"!==i.readyState&&(debug$1("changing transport and sending upgrade packet"),h(),i.setTransport(t),t.send([{type:"upgrade"}]),i.emit("upgrade",t),t=null,i.upgrading=!1,i.flush())}))}else{debug$1('probe transport "%s" failed',e);var s=new Error("probe error");s.transport=t.name,i.emit("upgradeError",s)}})))}function s(){r||(r=!0,h(),t.close(),t=null)}function o(r){var n=new Error("probe error: "+r);n.transport=t.name,s(),debug$1('probe transport "%s" failed because of error: %s',e,r),i.emit("upgradeError",n)}function a(){o("transport closed")}function c(){o("socket closed")}function u(e){t&&e.name!==t.name&&(debug$1('"%s" works - aborting "%s"',e.name,t.name),s())}function h(){t.removeListener("open",n),t.removeListener("error",o),t.removeListener("close",a),i.removeListener("close",c),i.removeListener("upgrading",u)}Socket$1.priorWebsocketSuccess=!1,t.once("open",n),t.once("error",o),t.once("close",a),this.once("close",c),this.once("upgrading",u),t.open()},Socket$1.prototype.onOpen=function(){if(debug$1("socket open"),this.readyState="open",Socket$1.priorWebsocketSuccess="websocket"===this.transport.name,this.emit("open"),this.flush(),"open"===this.readyState&&this.upgrade&&this.transport.pause){debug$1("starting upgrade probes");for(var e=0,t=this.upgrades.length;e<t;e++)this.probe(this.upgrades[e])}},Socket$1.prototype.onPacket=function(e){if("opening"===this.readyState||"open"===this.readyState||"closing"===this.readyState)switch(debug$1('socket receive: type "%s", data "%s"',e.type,e.data),this.emit("packet",e),this.emit("heartbeat"),e.type){case"open":this.onHandshake(JSON.parse(e.data));break;case"pong":this.setPing(),this.emit("pong");break;case"error":var t=new Error("server error");t.code=e.data,this.onError(t);break;case"message":this.emit("data",e.data),this.emit("message",e.data)}else debug$1('packet received with socket readyState "%s"',this.readyState)},Socket$1.prototype.onHandshake=function(e){this.emit("handshake",e),this.id=e.sid,this.transport.query.sid=e.sid,this.upgrades=this.filterUpgrades(e.upgrades),this.pingInterval=e.pingInterval,this.pingTimeout=e.pingTimeout,this.onOpen(),"closed"!==this.readyState&&(this.setPing(),this.removeListener("heartbeat",this.onHeartbeat),this.on("heartbeat",this.onHeartbeat))},Socket$1.prototype.onHeartbeat=function(e){clearTimeout(this.pingTimeoutTimer);var t=this;t.pingTimeoutTimer=setTimeout((function(){"closed"!==t.readyState&&t.onClose("ping timeout")}),e||t.pingInterval+t.pingTimeout)},Socket$1.prototype.setPing=function(){var e=this;clearTimeout(e.pingIntervalTimer),e.pingIntervalTimer=setTimeout((function(){debug$1("writing ping packet - expecting pong within %sms",e.pingTimeout),e.ping(),e.onHeartbeat(e.pingTimeout)}),e.pingInterval)},Socket$1.prototype.ping=function(){var e=this;this.sendPacket("ping",(function(){e.emit("ping")}))},Socket$1.prototype.onDrain=function(){this.writeBuffer.splice(0,this.prevBufferLen),this.prevBufferLen=0,0===this.writeBuffer.length?this.emit("drain"):this.flush()},Socket$1.prototype.flush=function(){"closed"!==this.readyState&&this.transport.writable&&!this.upgrading&&this.writeBuffer.length&&(debug$1("flushing %d packets in socket",this.writeBuffer.length),this.transport.send(this.writeBuffer),this.prevBufferLen=this.writeBuffer.length,this.emit("flush"))},Socket$1.prototype.write=Socket$1.prototype.send=function(e,t,r){return this.sendPacket("message",e,t,r),this},Socket$1.prototype.sendPacket=function(e,t,r,i){if("function"==typeof t&&(i=t,t=void 0),"function"==typeof r&&(i=r,r=null),"closing"!==this.readyState&&"closed"!==this.readyState){(r=r||{}).compress=!1!==r.compress;var n={type:e,data:t,options:r};this.emit("packetCreate",n),this.writeBuffer.push(n),i&&this.once("flush",i),this.flush()}},Socket$1.prototype.close=function(){if("opening"===this.readyState||"open"===this.readyState){this.readyState="closing";var e=this;this.writeBuffer.length?this.once("drain",(function(){this.upgrading?i():t()})):this.upgrading?i():t()}function t(){e.onClose("forced close"),debug$1("socket closing - telling transport to close"),e.transport.close()}function r(){e.removeListener("upgrade",r),e.removeListener("upgradeError",r),t()}function i(){e.once("upgrade",r),e.once("upgradeError",r)}return this},Socket$1.prototype.onError=function(e){debug$1("socket error %j",e),Socket$1.priorWebsocketSuccess=!1,this.emit("error",e),this.onClose("transport error",e)},Socket$1.prototype.onClose=function(e,t){"opening"!==this.readyState&&"open"!==this.readyState&&"closing"!==this.readyState||(debug$1('socket close with reason: "%s"',e),clearTimeout(this.pingIntervalTimer),clearTimeout(this.pingTimeoutTimer),this.transport.removeAllListeners("close"),this.transport.close(),this.transport.removeAllListeners(),this.readyState="closed",this.id=null,this.emit("close",e,t),this.writeBuffer=[],this.prevBufferLen=0)},Socket$1.prototype.filterUpgrades=function(e){for(var t=[],r=0,i=e.length;r<i;r++)~index(this.transports,e[r])&&t.push(e[r]);return t},function(e){e.exports=socket$1,e.exports.parser=browser}(lib$1);var socketExports={},socket={get exports(){return socketExports},set exports(e){socketExports=e}},toArray_1,hasRequiredToArray;function requireToArray(){return hasRequiredToArray||(hasRequiredToArray=1,toArray_1=function(e,t){for(var r=[],i=(t=t||0)||0;i<e.length;i++)r[i-t]=e[i];return r}),toArray_1}var on_1=on$1;function on$1(e,t,r){return e.on(t,r),{destroy:function(){e.removeListener(t,r)}}}var slice=[].slice,componentBind=function(e,t){if("string"==typeof t&&(t=e[t]),"function"!=typeof t)throw new Error("bind() requires a function");var r=slice.call(arguments,2);return function(){return t.apply(e,r.concat(slice.call(arguments)))}},hasRequiredSocket;function requireSocket(){return hasRequiredSocket||(hasRequiredSocket=1,function(e,t){var r=socket_ioParser,i=componentEmitterExports,n=requireToArray(),s=on_1,o=componentBind,a=browserExports("socket.io-client:socket"),c=requireParseqs(),u=requireHasBinary2();e.exports=f;var h={connect:1,connect_error:1,connect_timeout:1,connecting:1,disconnect:1,error:1,reconnect:1,reconnect_attempt:1,reconnect_failed:1,reconnect_error:1,reconnecting:1,ping:1,pong:1},d=i.prototype.emit;function f(e,t,r){this.io=e,this.nsp=t,this.json=this,this.ids=0,this.acks={},this.receiveBuffer=[],this.sendBuffer=[],this.connected=!1,this.disconnected=!0,this.flags={},r&&r.query&&(this.query=r.query),this.io.autoConnect&&this.open()}i(f.prototype),f.prototype.subEvents=function(){if(!this.subs){var e=this.io;this.subs=[s(e,"open",o(this,"onopen")),s(e,"packet",o(this,"onpacket")),s(e,"close",o(this,"onclose"))]}},f.prototype.open=f.prototype.connect=function(){return this.connected||(this.subEvents(),this.io.reconnecting||this.io.open(),"open"===this.io.readyState&&this.onopen(),this.emit("connecting")),this},f.prototype.send=function(){var e=n(arguments);return e.unshift("message"),this.emit.apply(this,e),this},f.prototype.emit=function(e){if(h.hasOwnProperty(e))return d.apply(this,arguments),this;var t=n(arguments),i={type:(void 0!==this.flags.binary?this.flags.binary:u(t))?r.BINARY_EVENT:r.EVENT,data:t,options:{}};return i.options.compress=!this.flags||!1!==this.flags.compress,"function"==typeof t[t.length-1]&&(a("emitting packet with ack id %d",this.ids),this.acks[this.ids]=t.pop(),i.id=this.ids++),this.connected?this.packet(i):this.sendBuffer.push(i),this.flags={},this},f.prototype.packet=function(e){e.nsp=this.nsp,this.io.packet(e)},f.prototype.onopen=function(){if(a("transport is open - connecting"),"/"!==this.nsp)if(this.query){var e="object"==typeof this.query?c.encode(this.query):this.query;a("sending connect packet with query %s",e),this.packet({type:r.CONNECT,query:e})}else this.packet({type:r.CONNECT})},f.prototype.onclose=function(e){a("close (%s)",e),this.connected=!1,this.disconnected=!0,delete this.id,this.emit("disconnect",e)},f.prototype.onpacket=function(e){var t=e.nsp===this.nsp,i=e.type===r.ERROR&&"/"===e.nsp;if(t||i)switch(e.type){case r.CONNECT:this.onconnect();break;case r.EVENT:case r.BINARY_EVENT:this.onevent(e);break;case r.ACK:case r.BINARY_ACK:this.onack(e);break;case r.DISCONNECT:this.ondisconnect();break;case r.ERROR:this.emit("error",e.data)}},f.prototype.onevent=function(e){var t=e.data||[];a("emitting event %j",t),null!=e.id&&(a("attaching ack callback to event"),t.push(this.ack(e.id))),this.connected?d.apply(this,t):this.receiveBuffer.push(t)},f.prototype.ack=function(e){var t=this,i=!1;return function(){if(!i){i=!0;var s=n(arguments);a("sending ack %j",s),t.packet({type:u(s)?r.BINARY_ACK:r.ACK,id:e,data:s})}}},f.prototype.onack=function(e){var t=this.acks[e.id];"function"==typeof t?(a("calling ack %s with %j",e.id,e.data),t.apply(this,e.data),delete this.acks[e.id]):a("bad ack %s",e.id)},f.prototype.onconnect=function(){this.connected=!0,this.disconnected=!1,this.emitBuffered(),this.emit("connect")},f.prototype.emitBuffered=function(){var e;for(e=0;e<this.receiveBuffer.length;e++)d.apply(this,this.receiveBuffer[e]);for(this.receiveBuffer=[],e=0;e<this.sendBuffer.length;e++)this.packet(this.sendBuffer[e]);this.sendBuffer=[]},f.prototype.ondisconnect=function(){a("server disconnect (%s)",this.nsp),this.destroy(),this.onclose("io server disconnect")},f.prototype.destroy=function(){if(this.subs){for(var e=0;e<this.subs.length;e++)this.subs[e].destroy();this.subs=null}this.io.destroy(this)},f.prototype.close=f.prototype.disconnect=function(){return this.connected&&(a("performing disconnect (%s)",this.nsp),this.packet({type:r.DISCONNECT})),this.destroy(),this.connected&&this.onclose("io client disconnect"),this},f.prototype.compress=function(e){return this.flags.compress=e,this},f.prototype.binary=function(e){return this.flags.binary=e,this}}(socket)),socketExports}var backo2=Backoff$1;function Backoff$1(e){e=e||{},this.ms=e.min||100,this.max=e.max||1e4,this.factor=e.factor||2,this.jitter=e.jitter>0&&e.jitter<=1?e.jitter:0,this.attempts=0}Backoff$1.prototype.duration=function(){var e=this.ms*Math.pow(this.factor,this.attempts++);if(this.jitter){var t=Math.random(),r=Math.floor(t*this.jitter*e);e=0==(1&Math.floor(10*t))?e-r:e+r}return 0|Math.min(e,this.max)},Backoff$1.prototype.reset=function(){this.attempts=0},Backoff$1.prototype.setMin=function(e){this.ms=e},Backoff$1.prototype.setMax=function(e){this.max=e},Backoff$1.prototype.setJitter=function(e){this.jitter=e};var eio=libExports,Socket=requireSocket(),Emitter=componentEmitterExports,parser$2=socket_ioParser,on=on_1,bind$3=componentBind,debug=browserExports("socket.io-client:manager"),indexOf=indexof,Backoff=backo2,has=Object.prototype.hasOwnProperty,manager=Manager;function Manager(e,t){if(!(this instanceof Manager))return new Manager(e,t);e&&"object"==typeof e&&(t=e,e=void 0),(t=t||{}).path=t.path||"/socket.io",this.nsps={},this.subs=[],this.opts=t,this.reconnection(!1!==t.reconnection),this.reconnectionAttempts(t.reconnectionAttempts||1/0),this.reconnectionDelay(t.reconnectionDelay||1e3),this.reconnectionDelayMax(t.reconnectionDelayMax||5e3),this.randomizationFactor(t.randomizationFactor||.5),this.backoff=new Backoff({min:this.reconnectionDelay(),max:this.reconnectionDelayMax(),jitter:this.randomizationFactor()}),this.timeout(null==t.timeout?2e4:t.timeout),this.readyState="closed",this.uri=e,this.connecting=[],this.lastPing=null,this.encoding=!1,this.packetBuffer=[];var r=t.parser||parser$2;this.encoder=new r.Encoder,this.decoder=new r.Decoder,this.autoConnect=!1!==t.autoConnect,this.autoConnect&&this.open()}Manager.prototype.emitAll=function(){for(var e in this.emit.apply(this,arguments),this.nsps)has.call(this.nsps,e)&&this.nsps[e].emit.apply(this.nsps[e],arguments)},Manager.prototype.updateSocketIds=function(){for(var e in this.nsps)has.call(this.nsps,e)&&(this.nsps[e].id=this.generateId(e))},Manager.prototype.generateId=function(e){return("/"===e?"":e+"#")+this.engine.id},Emitter(Manager.prototype),Manager.prototype.reconnection=function(e){return arguments.length?(this.H=!!e,this):this.H},Manager.prototype.reconnectionAttempts=function(e){return arguments.length?(this.U=e,this):this.U},Manager.prototype.reconnectionDelay=function(e){return arguments.length?(this.V=e,this.backoff&&this.backoff.setMin(e),this):this.V},Manager.prototype.randomizationFactor=function(e){return arguments.length?(this.G=e,this.backoff&&this.backoff.setJitter(e),this):this.G},Manager.prototype.reconnectionDelayMax=function(e){return arguments.length?(this.K=e,this.backoff&&this.backoff.setMax(e),this):this.K},Manager.prototype.timeout=function(e){return arguments.length?(this.W=e,this):this.W},Manager.prototype.maybeReconnectOnOpen=function(){!this.reconnecting&&this.H&&0===this.backoff.attempts&&this.reconnect()},Manager.prototype.open=Manager.prototype.connect=function(e,t){if(debug("readyState %s",this.readyState),~this.readyState.indexOf("open"))return this;debug("opening %s",this.uri),this.engine=eio(this.uri,this.opts);var r=this.engine,i=this;this.readyState="opening",this.skipReconnect=!1;var n=on(r,"open",(function(){i.onopen(),e&&e()})),s=on(r,"error",(function(t){if(debug("connect_error"),i.cleanup(),i.readyState="closed",i.emitAll("connect_error",t),e){var r=new Error("Connection error");r.data=t,e(r)}else i.maybeReconnectOnOpen()}));if(!1!==this.W){var o=this.W;debug("connect attempt will timeout after %d",o),0===o&&n.destroy();var a=setTimeout((function(){debug("connect attempt timed out after %d",o),n.destroy(),r.close(),r.emit("error","timeout"),i.emitAll("connect_timeout",o)}),o);this.subs.push({destroy:function(){clearTimeout(a)}})}return this.subs.push(n),this.subs.push(s),this},Manager.prototype.onopen=function(){debug("open"),this.cleanup(),this.readyState="open",this.emit("open");var e=this.engine;this.subs.push(on(e,"data",bind$3(this,"ondata"))),this.subs.push(on(e,"ping",bind$3(this,"onping"))),this.subs.push(on(e,"pong",bind$3(this,"onpong"))),this.subs.push(on(e,"error",bind$3(this,"onerror"))),this.subs.push(on(e,"close",bind$3(this,"onclose"))),this.subs.push(on(this.decoder,"decoded",bind$3(this,"ondecoded")))},Manager.prototype.onping=function(){this.lastPing=new Date,this.emitAll("ping")},Manager.prototype.onpong=function(){this.emitAll("pong",new Date-this.lastPing)},Manager.prototype.ondata=function(e){this.decoder.add(e)},Manager.prototype.ondecoded=function(e){this.emit("packet",e)},Manager.prototype.onerror=function(e){debug("error",e),this.emitAll("error",e)},Manager.prototype.socket=function(e,t){var r=this.nsps[e];if(!r){r=new Socket(this,e,t),this.nsps[e]=r;var i=this;r.on("connecting",n),r.on("connect",(function(){r.id=i.generateId(e)})),this.autoConnect&&n()}function n(){~indexOf(i.connecting,r)||i.connecting.push(r)}return r},Manager.prototype.destroy=function(e){var t=indexOf(this.connecting,e);~t&&this.connecting.splice(t,1),this.connecting.length||this.close()},Manager.prototype.packet=function(e){debug("writing packet %j",e);var t=this;e.query&&0===e.type&&(e.nsp+="?"+e.query),t.encoding?t.packetBuffer.push(e):(t.encoding=!0,this.encoder.encode(e,(function(r){for(var i=0;i<r.length;i++)t.engine.write(r[i],e.options);t.encoding=!1,t.processPacketQueue()})))},Manager.prototype.processPacketQueue=function(){if(this.packetBuffer.length>0&&!this.encoding){var e=this.packetBuffer.shift();this.packet(e)}},Manager.prototype.cleanup=function(){debug("cleanup");for(var e=this.subs.length,t=0;t<e;t++)this.subs.shift().destroy();this.packetBuffer=[],this.encoding=!1,this.lastPing=null,this.decoder.destroy()},Manager.prototype.close=Manager.prototype.disconnect=function(){debug("disconnect"),this.skipReconnect=!0,this.reconnecting=!1,"opening"===this.readyState&&this.cleanup(),this.backoff.reset(),this.readyState="closed",this.engine&&this.engine.close()},Manager.prototype.onclose=function(e){debug("onclose"),this.cleanup(),this.backoff.reset(),this.readyState="closed",this.emit("close",e),this.H&&!this.skipReconnect&&this.reconnect()},Manager.prototype.reconnect=function(){if(this.reconnecting||this.skipReconnect)return this;var e=this;if(this.backoff.attempts>=this.U)debug("reconnect failed"),this.backoff.reset(),this.emitAll("reconnect_failed"),this.reconnecting=!1;else{var t=this.backoff.duration();debug("will wait %dms before reconnect attempt",t),this.reconnecting=!0;var r=setTimeout((function(){e.skipReconnect||(debug("attempting reconnect"),e.emitAll("reconnect_attempt",e.backoff.attempts),e.emitAll("reconnecting",e.backoff.attempts),e.skipReconnect||e.open((function(t){t?(debug("reconnect attempt error"),e.reconnecting=!1,e.reconnect(),e.emitAll("reconnect_error",t.data)):(debug("reconnect success"),e.onreconnect())})))}),t);this.subs.push({destroy:function(){clearTimeout(r)}})}},Manager.prototype.onreconnect=function(){var e=this.backoff.attempts;this.reconnecting=!1,this.backoff.reset(),this.updateSocketIds(),this.emitAll("reconnect",e)},function(e,t){var r=url_1,i=socket_ioParser,n=manager,s=browserExports("socket.io-client");e.exports=t=a;var o=t.managers={};function a(e,t){"object"==typeof e&&(t=e,e=void 0),t=t||{};var i,a=r(e),c=a.source,u=a.id,h=a.path,d=o[u]&&h in o[u].nsps;return t.forceNew||t["force new connection"]||!1===t.multiplex||d?(s("ignoring socket cache for %s",c),i=n(c,t)):(o[u]||(s("new io instance for %s",c),o[u]=n(c,t)),i=o[u]),a.query&&!t.query&&(t.query=a.query),i.socket(a.path,t)}t.protocol=i.protocol,t.connect=a,t.Manager=manager,t.Socket=requireSocket()}(lib$2,libExports$1);class SocketManager{constructor(){this.X={},this.J=a$9()}Y(e){for(const t in SocketState)e.on(SocketState[t],(e=>{this.J.emit(SocketState[t],e)}))}connect(e,t){this.Z=libExports$1(e,t),this.Y(this.Z)}on(e,t,r){if(r||"function"!=typeof t){if("string"==typeof t&&r){const e=this.Z;if(!e)return SocketLogger.warn("namespace not init yet"),this;e.on(t,r)}}else r=t,t=e,this.J.on(t,r);return this}disconnect(){var e;null===(e=this.Z)||void 0===e||e.disconnect();for(const e in this.X)this.X[e].disconnect()}reconnect(e){var t;null===(t=this.Z)||void 0===t||t.connect(),e.forEach((e=>{let[t,r]=e;const i=this.X[t];if(i){i.query={...i.query,...r};const e=i.io.opts.query;i.io.opts.query={...e,...r},i.connect()}}))}}exports.ErrorCode=void 0,function(e){e[e.UnexpectedError=500301999]="UnexpectedError",e[e.UnexpectedCall=500301998]="UnexpectedCall",e[e.NotSupport=500301997]="NotSupport",e[e.NetworkError=500301e3]="NetworkError",e[e.NotInRoom=400301e3]="NotInRoom",e[e.PeerTrackNotReady=400301100]="PeerTrackNotReady",e[e.MediaAgentNotReady=400301101]="MediaAgentNotReady",e[e.ClientJoinRoomAlready=400301102]="ClientJoinRoomAlready",e[e.SubscriptionExceedsRestrictions=400301103]="SubscriptionExceedsRestrictions",e[e.CanNotSubscribeYourself=400301104]="CanNotSubscribeYourself",e[e.PublishOrUnpublishParamsError=400301105]="PublishOrUnpublishParamsError",e[e.DeviceNotFound=400301200]="DeviceNotFound",e[e.TrackClosed=400301300]="TrackClosed",e[e.TrackNotPlaying=400301301]="TrackNotPlaying",e[e.CanvasContextFail=400301302]="CanvasContextFail",e[e.ChangeSourceTrackNull=400301303]="ChangeSourceTrackNull",e[e.StreamTrackNull=400301304]="StreamTrackNull",e[e.ProcessorPiped=400301305]="ProcessorPiped",e[e.SetSinkIdFail=400301306]="SetSinkIdFail",e[e.NotReadableError=400301307]="NotReadableError",e[e.NotAllowedError=400301308]="NotAllowedError",e[e.SocketConnectError=400301400]="SocketConnectError",e[e.SocketConnectTimeout=400301401]="SocketConnectTimeout",e[e.SocketConnectNetworkError=400301402]="SocketConnectNetworkError",e[e.TokenInvalid=4011e3]="TokenInvalid",e[e.LoginPasswordError=400105201]="LoginPasswordError",e[e.LoginPasswordFrequent=429105006]="LoginPasswordFrequent",e[e.LoginAccountInvalid=400105003]="LoginAccountInvalid",e[e.LoginParamError=400105001]="LoginParamError",e[e.RoomPasswordError=403111044]="RoomPasswordError",e[e.RoomNotExist=404111003]="RoomNotExist",e[e.RoomLocked=403111023]="RoomLocked",e[e.RoomBanJoin=403111031]="RoomBanJoin",e[e.PermissionDenied=403111006]="PermissionDenied",e[e.RoomPasswordFrequent=403111046]="RoomPasswordFrequent",e[e.OwnerJoinOtherRoom=403103015]="OwnerJoinOtherRoom",e[e.RoomBusy=403103014]="RoomBusy",e[e.RecordSpaceNotEnough=400111041]="RecordSpaceNotEnough",e[e.RecordCountFull=403111043]="RecordCountFull",e[e.CompanyNotSupportRecord=403111040]="CompanyNotSupportRecord",e[e.RecordStarted=403111062]="RecordStarted",e[e.NoRecordSpace=403111056]="NoRecordSpace",e[e.EndPointNotFound=404111007]="EndPointNotFound",e[e.LayoutNotSupportMainVenue=403111066]="LayoutNotSupportMainVenue"}(exports.ErrorCode||(exports.ErrorCode={}));const MEDIA_ERROR={NOT_ALLOW:{code:0,name:"NotAllowedError",returnCode:exports.ErrorCode.NotAllowedError},READ_DISABLE:{code:0,name:"NotReadableError",returnCode:exports.ErrorCode.NotReadableError}};class MError{constructor(e,t,r){this.code=e,this.message=t||"",this.context=r}toString(){return`${this.code}: ${this.message}`}}class ServiceSocket{constructor(e){let{uri:t,endpointId:r,accessToken:i,sessionId:n,userId:s,ownerId:o}=e;this.ee=-1,this.J=a$9(),this.onAll=e=>(this.J.on("*",e),this),this.disconnect=()=>{var e;null===(e=this.te)||void 0===e||e.disconnect()},this.reconnect=e=>{this.te.reconnect([[NameSpace.Confservice,{query:e}]])};const a=e$6.ipv6?t+"/":new URL(t).toString(),c=new SocketManager;this.ee=o;const u={endpointId:r,accessToken:i,rooms:n};c.connect(a+NameSpace.Confservice,{transports:["websocket"],reconnectionDelay:2e3,reconnectionAttempts:3,query:u}),ConfServiceRoutes.topics.forEach((e=>{c.on(NameSpace.Confservice,`${ConfServiceRoutes.prefix}${e}`,((t,r)=>{SocketLogger.debug(`${ConfServiceRoutes.prefix}${e}`,t.body),this.J.emit(ConfServiceTopicsEventMap[e],t),"function"==typeof r&&r()}))})),c.on(SocketState.connecting,(()=>{this.re=exports.SocketEmitState.CONNECTING,this.J.emit(SocketConfServiceEvents.SocketStateChange,{state:exports.SocketEmitState.CONNECTING}),SocketLogger.debug(this.ee,"socket connecting")})).on(SocketState.connect,(()=>{const e=this.re;this.re=exports.SocketEmitState.CONNECTED,this.J.emit(SocketConfServiceEvents.SocketStateChange,{state:e===exports.SocketEmitState.RECONNECTING?exports.SocketEmitState.RECONNECTED:exports.SocketEmitState.CONNECTED}),SocketLogger.info(this.ee,"socket connected")})).on(SocketState.connect_error,(e=>{SocketLogger.info(this.ee,`socket connect_error, ${null==e?void 0:e.message}`)})).on(SocketState.connect_timeout,(()=>{this.re=exports.SocketEmitState.DISCONNECTED,this.J.emit(SocketConfServiceEvents.SocketStateChange,{state:exports.SocketEmitState.DISCONNECTED,code:exports.ErrorCode.SocketConnectTimeout}),SocketLogger.info(this.ee,"socket connect_timeout")})).on(SocketState.disconnect,(e=>{SocketLogger.warn(this.ee,`socket disconnect ${e}`),this.re=exports.SocketEmitState.DISCONNECTED})).on(SocketState.error,(e=>{this.re=exports.SocketEmitState.DISCONNECTED,this.J.emit(SocketConfServiceEvents.SocketStateChange,{state:exports.SocketEmitState.DISCONNECTED,code:exports.ErrorCode.SocketConnectError,data:e}),SocketLogger.error(this.ee,`socket error, ${e}`)})).on(SocketState.reconnect_attempt,(()=>{SocketLogger.info(this.ee,"socket reconnect_attempt")})).on(SocketState.reconnect_failed,(e=>{this.re=exports.SocketEmitState.DISCONNECTED,this.J.emit(SocketConfServiceEvents.SocketStateChange,{state:exports.SocketEmitState.DISCONNECTED,code:exports.ErrorCode.SocketConnectNetworkError}),SocketLogger.info(this.ee,"socket reconnect_failed",e)})).on(SocketState.reconnect_error,(e=>{SocketLogger.info(this.ee,"socket reconnect_error",e)})).on(SocketState.reconnecting,(()=>{SocketLogger.info(this.ee,"socket reconnecting"),this.re!==exports.SocketEmitState.RECONNECTING&&(this.re=exports.SocketEmitState.RECONNECTING,this.J.emit(SocketConfServiceEvents.SocketStateChange,{state:exports.SocketEmitState.RECONNECTING}))})),this.te=c}on(e,t){return this.J.on(e,t),this}}exports.Resolution=void 0,function(e){e[e.rs270=270]="rs270",e[e.rs360=360]="rs360",e[e.rs720=720]="rs720",e[e.rs1080=1080]="rs1080",e[e.rs1440=1440]="rs1440",e[e.rs2160=2160]="rs2160"}(exports.Resolution||(exports.Resolution={}));const ResolutionRect={[exports.Resolution.rs270]:{width:480,height:270},[exports.Resolution.rs360]:{width:640,height:360},[exports.Resolution.rs720]:{width:1280,height:720},[exports.Resolution.rs1080]:{width:1920,height:1080},[exports.Resolution.rs1440]:{width:2560,height:1440},[exports.Resolution.rs2160]:{width:3840,height:2160}};var AgentEventType,RoomEventType;exports.RecordLayoutTemplate=void 0,function(e){e.SINGLE_ACTIVEVIDEO="SINGLE_ACTIVEVIDEO",e.TWO_ACTIVEVIDEO="TWO_ACTIVEVIDEO",e.THREE_ACTIVEVIDEO="THREE_ACTIVEVIDEO",e.FOUR_ACTIVEVIDEO="FOUR_ACTIVEVIDEO",e.GRIDDING_VIDEO_3X3="GRIDDING_VIDEO_3X3",e.GRIDDING_VIDEO_4X4="GRIDDING_VIDEO_4X4",e.GRIDDING_VIDEO_5X5="GRIDDING_VIDEO_5X5"}(exports.RecordLayoutTemplate||(exports.RecordLayoutTemplate={})),exports.RecordShareLayoutTemplate=void 0,function(e){e.GRIDDING_3X3_DESKTOP_AT_END="GRIDDING_3X3_DESKTOP_AT_END"}(exports.RecordShareLayoutTemplate||(exports.RecordShareLayoutTemplate={})),exports.PlatformType=void 0,function(e){e.Mobile="mobile",e.PC="pc",e.Pad="pad",e.Board="board",e.Browser="browser",e.MiniProgram="MiniProgram",e.Applet="applet",e.Sip="sip",e.Professional="professional",e.PSTN="pstn",e.h323="h323",e.unknown="unknown"}(exports.PlatformType||(exports.PlatformType={})),exports.HangupStatus=void 0,function(e){e.HANG_ON="hangon",e.HANG_UP="hangup"}(exports.HangupStatus||(exports.HangupStatus={})),function(e){e.ACTIVE_AUDIO_UPDATED="audio-active-updated",e.MEDIA_STATE_CHANGE="media-state-change",e.NETWORK_QUALITY="network-quality",e.ON_AUDIO_TRACK_ADD="on-audio-track-add",e.RTC_STATS="rtc-stats"}(AgentEventType||(AgentEventType={})),function(e){e.USER_LEFT="user-left",e.USER_JOINED="user-joined",e.USER_PUBLISHED="user-published",e.USER_UNPUBLISHED="user-unpublished",e.USER_NICKNAME_UPDATED="user-nickname-updated",e.USER_SPEAKER_MUTED="user-speaker-muted",e.USER_SPEAKER_UNMUTED="user-speaker-unmuted",e.SPEAKER_MUTE_ALL="speaker-mute-all",e.SPEAKER_UNMUTE_ALL="speaker-unmute-all",e.ROLE_UPDATED="user-role-updated",e.PERMISSION_UPDATED="user-permission-updated",e.AUDIO_MUTE_ALL="audio-mute-all",e.AUDIO_REQUEST_UNMUTE="audio-request-unmute",e.AUDIO_REJECT_UNMUTE="audio-reject-unmute",e.VIDEO_REQUEST_TURNON="video-request-unmute",e.VIDEO_REJECT_TURNON="video-reject-unmute",e.USER_KICK_OUT="user-kick-out",e.USER_HANG_STATUS_UPDATED="room-hang-status-updated",e.ROOM_MODE_AUDIO_UPDATED="room-mode-audio-updated",e.ROOM_VIEW_UPDATED="room-view-updated",e.ROOM_CLOSE="room-close",e.ROOM_RECORD_STATUS_UPDATED="room-record-status-updated",e.ROOM_MAIN_VENUE_UPDATED="room-main-venue-updated",e.ROOM_INFO_UPDATED="room-info-updated",e.ROOM_LAYOUT_UPDATED="room-layout-updated",e.ROOM_OPTION_UPDATED="room-option-updated",e.CONNECTION_STATE_CHANGE="connection-state-change"}(RoomEventType||(RoomEventType={}));const ClientEvents={...AgentEventType,...RoomEventType};var axiosExports$1={},axios$2={get exports(){return axiosExports$1},set exports(e){axiosExports$1=e}},axiosExports={},axios$1={get exports(){return axiosExports},set exports(e){axiosExports=e}},bind$2=function(e,t){return function(){for(var r=new Array(arguments.length),i=0;i<r.length;i++)r[i]=arguments[i];return e.apply(t,r)}},bind$1=bind$2,toString=Object.prototype.toString,kindOf=(cache=Object.create(null),function(e){var t=toString.call(e);return cache[t]||(cache[t]=t.slice(8,-1).toLowerCase())}),cache;function kindOfTest(e){return e=e.toLowerCase(),function(t){return kindOf(t)===e}}function isArray$6(e){return Array.isArray(e)}function isUndefined(e){return void 0===e}function isBuffer$5(e){return null!==e&&!isUndefined(e)&&null!==e.constructor&&!isUndefined(e.constructor)&&"function"==typeof e.constructor.isBuffer&&e.constructor.isBuffer(e)}var isArrayBuffer=kindOfTest("ArrayBuffer");function isArrayBufferView(e){return"undefined"!=typeof ArrayBuffer&&ArrayBuffer.isView?ArrayBuffer.isView(e):e&&e.buffer&&isArrayBuffer(e.buffer)}function isString(e){return"string"==typeof e}function isNumber(e){return"number"==typeof e}function isObject$9(e){return null!==e&&"object"==typeof e}function isPlainObject$2(e){if("object"!==kindOf(e))return!1;var t=Object.getPrototypeOf(e);return null===t||t===Object.prototype}var isDate=kindOfTest("Date"),isFile=kindOfTest("File"),isBlob=kindOfTest("Blob"),isFileList=kindOfTest("FileList");function isFunction$4(e){return"[object Function]"===toString.call(e)}function isStream(e){return isObject$9(e)&&isFunction$4(e.pipe)}function isFormData(e){var t="[object FormData]";return e&&("function"==typeof FormData&&e instanceof FormData||toString.call(e)===t||isFunction$4(e.toString)&&e.toString()===t)}var isURLSearchParams=kindOfTest("URLSearchParams");function trim(e){return e.trim?e.trim():e.replace(/^\s+|\s+$/g,"")}function isStandardBrowserEnv(){return("undefined"==typeof navigator||"ReactNative"!==navigator.product&&"NativeScript"!==navigator.product&&"NS"!==navigator.product)&&"undefined"!=typeof window&&"undefined"!=typeof document}function forEach(e,t){if(null!=e)if("object"!=typeof e&&(e=[e]),isArray$6(e))for(var r=0,i=e.length;r<i;r++)t.call(null,e[r],r,e);else for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&t.call(null,e[n],n,e)}function merge$1(){var e={};function t(t,r){isPlainObject$2(e[r])&&isPlainObject$2(t)?e[r]=merge$1(e[r],t):isPlainObject$2(t)?e[r]=merge$1({},t):isArray$6(t)?e[r]=t.slice():e[r]=t}for(var r=0,i=arguments.length;r<i;r++)forEach(arguments[r],t);return e}function extend(e,t,r){return forEach(t,(function(t,i){e[i]=r&&"function"==typeof t?bind$1(t,r):t})),e}function stripBOM(e){return 65279===e.charCodeAt(0)&&(e=e.slice(1)),e}function inherits(e,t,r,i){e.prototype=Object.create(t.prototype,i),e.prototype.constructor=e,r&&Object.assign(e.prototype,r)}function toFlatObject(e,t,r){var i,n,s,o={};t=t||{};do{for(n=(i=Object.getOwnPropertyNames(e)).length;n-- >0;)o[s=i[n]]||(t[s]=e[s],o[s]=!0);e=Object.getPrototypeOf(e)}while(e&&(!r||r(e,t))&&e!==Object.prototype);return t}function endsWith(e,t,r){e=String(e),(void 0===r||r>e.length)&&(r=e.length),r-=t.length;var i=e.indexOf(t,r);return-1!==i&&i===r}function toArray(e){if(!e)return null;var t=e.length;if(isUndefined(t))return null;for(var r=new Array(t);t-- >0;)r[t]=e[t];return r}var isTypedArray$4=(TypedArray="undefined"!=typeof Uint8Array&&Object.getPrototypeOf(Uint8Array),function(e){return TypedArray&&e instanceof TypedArray}),TypedArray,utils$9={isArray:isArray$6,isArrayBuffer:isArrayBuffer,isBuffer:isBuffer$5,isFormData:isFormData,isArrayBufferView:isArrayBufferView,isString:isString,isNumber:isNumber,isObject:isObject$9,isPlainObject:isPlainObject$2,isUndefined:isUndefined,isDate:isDate,isFile:isFile,isBlob:isBlob,isFunction:isFunction$4,isStream:isStream,isURLSearchParams:isURLSearchParams,isStandardBrowserEnv:isStandardBrowserEnv,forEach:forEach,merge:merge$1,extend:extend,trim:trim,stripBOM:stripBOM,inherits:inherits,toFlatObject:toFlatObject,kindOf:kindOf,kindOfTest:kindOfTest,endsWith:endsWith,toArray:toArray,isTypedArray:isTypedArray$4,isFileList:isFileList},utils$8=utils$9;function encode(e){return encodeURIComponent(e).replace(/%3A/gi,":").replace(/%24/g,"$").replace(/%2C/gi,",").replace(/%20/g,"+").replace(/%5B/gi,"[").replace(/%5D/gi,"]")}var buildURL$1=function(e,t,r){if(!t)return e;var i;if(r)i=r(t);else if(utils$8.isURLSearchParams(t))i=t.toString();else{var n=[];utils$8.forEach(t,(function(e,t){null!=e&&(utils$8.isArray(e)?t+="[]":e=[e],utils$8.forEach(e,(function(e){utils$8.isDate(e)?e=e.toISOString():utils$8.isObject(e)&&(e=JSON.stringify(e)),n.push(encode(t)+"="+encode(e))})))})),i=n.join("&")}if(i){var s=e.indexOf("#");-1!==s&&(e=e.slice(0,s)),e+=(-1===e.indexOf("?")?"?":"&")+i}return e},utils$7=utils$9;function InterceptorManager$1(){this.handlers=[]}InterceptorManager$1.prototype.use=function(e,t,r){return this.handlers.push({fulfilled:e,rejected:t,synchronous:!!r&&r.synchronous,runWhen:r?r.runWhen:null}),this.handlers.length-1},InterceptorManager$1.prototype.eject=function(e){this.handlers[e]&&(this.handlers[e]=null)},InterceptorManager$1.prototype.forEach=function(e){utils$7.forEach(this.handlers,(function(t){null!==t&&e(t)}))};var InterceptorManager_1=InterceptorManager$1,utils$6=utils$9,normalizeHeaderName$1=function(e,t){utils$6.forEach(e,(function(r,i){i!==t&&i.toUpperCase()===t.toUpperCase()&&(e[t]=r,delete e[i])}))},AxiosError_1,hasRequiredAxiosError;function requireAxiosError(){if(hasRequiredAxiosError)return AxiosError_1;hasRequiredAxiosError=1;var e=utils$9;function t(e,t,r,i,n){Error.call(this),this.message=e,this.name="AxiosError",t&&(this.code=t),r&&(this.config=r),i&&(this.request=i),n&&(this.response=n)}e.inherits(t,Error,{toJSON:function(){return{message:this.message,name:this.name,description:this.description,number:this.number,fileName:this.fileName,lineNumber:this.lineNumber,columnNumber:this.columnNumber,stack:this.stack,config:this.config,code:this.code,status:this.response&&this.response.status?this.response.status:null}}});var r=t.prototype,i={};return["ERR_BAD_OPTION_VALUE","ERR_BAD_OPTION","ECONNABORTED","ETIMEDOUT","ERR_NETWORK","ERR_FR_TOO_MANY_REDIRECTS","ERR_DEPRECATED","ERR_BAD_RESPONSE","ERR_BAD_REQUEST","ERR_CANCELED"].forEach((function(e){i[e]={value:e}})),Object.defineProperties(t,i),Object.defineProperty(r,"isAxiosError",{value:!0}),t.from=function(i,n,s,o,a,c){var u=Object.create(r);return e.toFlatObject(i,u,(function(e){return e!==Error.prototype})),t.call(u,i.message,n,s,o,a),u.name=i.name,c&&Object.assign(u,c),u},AxiosError_1=t}var transitional={silentJSONParsing:!0,forcedJSONParsing:!0,clarifyTimeoutError:!1},toFormData_1,hasRequiredToFormData,settle,hasRequiredSettle,cookies,hasRequiredCookies;function requireToFormData(){if(hasRequiredToFormData)return toFormData_1;hasRequiredToFormData=1;var e=utils$9;return toFormData_1=function(t,r){r=r||new FormData;var i=[];function n(t){return null===t?"":e.isDate(t)?t.toISOString():e.isArrayBuffer(t)||e.isTypedArray(t)?"function"==typeof Blob?new Blob([t]):Buffer.from(t):t}return function t(s,o){if(e.isPlainObject(s)||e.isArray(s)){if(-1!==i.indexOf(s))throw Error("Circular reference detected in "+o);i.push(s),e.forEach(s,(function(i,s){if(!e.isUndefined(i)){var a,c=o?o+"."+s:s;if(i&&!o&&"object"==typeof i)if(e.endsWith(s,"{}"))i=JSON.stringify(i);else if(e.endsWith(s,"[]")&&(a=e.toArray(i)))return void a.forEach((function(t){!e.isUndefined(t)&&r.append(c,n(t))}));t(i,c)}})),i.pop()}else r.append(o,n(s))}(t),r},toFormData_1}function requireSettle(){if(hasRequiredSettle)return settle;hasRequiredSettle=1;var e=requireAxiosError();return settle=function(t,r,i){var n=i.config.validateStatus;i.status&&n&&!n(i.status)?r(new e("Request failed with status code "+i.status,[e.ERR_BAD_REQUEST,e.ERR_BAD_RESPONSE][Math.floor(i.status/100)-4],i.config,i.request,i)):t(i)}}function requireCookies(){if(hasRequiredCookies)return cookies;hasRequiredCookies=1;var e=utils$9;return cookies=e.isStandardBrowserEnv()?{write:function(t,r,i,n,s,o){var a=[];a.push(t+"="+encodeURIComponent(r)),e.isNumber(i)&&a.push("expires="+new Date(i).toGMTString()),e.isString(n)&&a.push("path="+n),e.isString(s)&&a.push("domain="+s),!0===o&&a.push("secure"),document.cookie=a.join("; ")},read:function(e){var t=document.cookie.match(new RegExp("(^|;\\s*)("+e+")=([^;]*)"));return t?decodeURIComponent(t[3]):null},remove:function(e){this.write(e,"",Date.now()-864e5)}}:{write:function(){},read:function(){return null},remove:function(){}}}var isAbsoluteURL$1=function(e){return/^([a-z][a-z\d+\-.]*:)?\/\//i.test(e)},combineURLs$1=function(e,t){return t?e.replace(/\/+$/,"")+"/"+t.replace(/^\/+/,""):e},isAbsoluteURL=isAbsoluteURL$1,combineURLs=combineURLs$1,buildFullPath$1=function(e,t){return e&&!isAbsoluteURL(t)?combineURLs(e,t):t},parseHeaders,hasRequiredParseHeaders,isURLSameOrigin,hasRequiredIsURLSameOrigin,CanceledError_1,hasRequiredCanceledError,parseProtocol,hasRequiredParseProtocol,xhr,hasRequiredXhr,_null,hasRequired_null;function requireParseHeaders(){if(hasRequiredParseHeaders)return parseHeaders;hasRequiredParseHeaders=1;var e=utils$9,t=["age","authorization","content-length","content-type","etag","expires","from","host","if-modified-since","if-unmodified-since","last-modified","location","max-forwards","proxy-authorization","referer","retry-after","user-agent"];return parseHeaders=function(r){var i,n,s,o={};return r?(e.forEach(r.split("\n"),(function(r){if(s=r.indexOf(":"),i=e.trim(r.substr(0,s)).toLowerCase(),n=e.trim(r.substr(s+1)),i){if(o[i]&&t.indexOf(i)>=0)return;o[i]="set-cookie"===i?(o[i]?o[i]:[]).concat([n]):o[i]?o[i]+", "+n:n}})),o):o},parseHeaders}function requireIsURLSameOrigin(){if(hasRequiredIsURLSameOrigin)return isURLSameOrigin;hasRequiredIsURLSameOrigin=1;var e=utils$9;return isURLSameOrigin=e.isStandardBrowserEnv()?function(){var t,r=/(msie|trident)/i.test(navigator.userAgent),i=document.createElement("a");function n(e){var t=e;return r&&(i.setAttribute("href",t),t=i.href),i.setAttribute("href",t),{href:i.href,protocol:i.protocol?i.protocol.replace(/:$/,""):"",host:i.host,search:i.search?i.search.replace(/^\?/,""):"",hash:i.hash?i.hash.replace(/^#/,""):"",hostname:i.hostname,port:i.port,pathname:"/"===i.pathname.charAt(0)?i.pathname:"/"+i.pathname}}return t=n(window.location.href),function(r){var i=e.isString(r)?n(r):r;return i.protocol===t.protocol&&i.host===t.host}}():function(){return!0},isURLSameOrigin}function requireCanceledError(){if(hasRequiredCanceledError)return CanceledError_1;hasRequiredCanceledError=1;var e=requireAxiosError();function t(t){e.call(this,null==t?"canceled":t,e.ERR_CANCELED),this.name="CanceledError"}return utils$9.inherits(t,e,{__CANCEL__:!0}),CanceledError_1=t}function requireParseProtocol(){return hasRequiredParseProtocol||(hasRequiredParseProtocol=1,parseProtocol=function(e){var t=/^([-+\w]{1,25})(:?\/\/|:)/.exec(e);return t&&t[1]||""}),parseProtocol}function requireXhr(){if(hasRequiredXhr)return xhr;hasRequiredXhr=1;var e=utils$9,t=requireSettle(),r=requireCookies(),i=buildURL$1,n=buildFullPath$1,s=requireParseHeaders(),o=requireIsURLSameOrigin(),a=transitional,c=requireAxiosError(),u=requireCanceledError(),h=requireParseProtocol();return xhr=function(d){return new Promise((function(f,l){var p,v=d.data,b=d.headers,m=d.responseType;function g(){d.cancelToken&&d.cancelToken.unsubscribe(p),d.signal&&d.signal.removeEventListener("abort",p)}e.isFormData(v)&&e.isStandardBrowserEnv()&&delete b["Content-Type"];var y=new XMLHttpRequest;if(d.auth){var w=d.auth.username||"",$=d.auth.password?unescape(encodeURIComponent(d.auth.password)):"";b.Authorization="Basic "+btoa(w+":"+$)}var S=n(d.baseURL,d.url);function k(){if(y){var e="getAllResponseHeaders"in y?s(y.getAllResponseHeaders()):null,r={data:m&&"text"!==m&&"json"!==m?y.response:y.responseText,status:y.status,statusText:y.statusText,headers:e,config:d,request:y};t((function(e){f(e),g()}),(function(e){l(e),g()}),r),y=null}}if(y.open(d.method.toUpperCase(),i(S,d.params,d.paramsSerializer),!0),y.timeout=d.timeout,"onloadend"in y?y.onloadend=k:y.onreadystatechange=function(){y&&4===y.readyState&&(0!==y.status||y.responseURL&&0===y.responseURL.indexOf("file:"))&&setTimeout(k)},y.onabort=function(){y&&(l(new c("Request aborted",c.ECONNABORTED,d,y)),y=null)},y.onerror=function(){l(new c("Network Error",c.ERR_NETWORK,d,y,y)),y=null},y.ontimeout=function(){var e=d.timeout?"timeout of "+d.timeout+"ms exceeded":"timeout exceeded",t=d.transitional||a;d.timeoutErrorMessage&&(e=d.timeoutErrorMessage),l(new c(e,t.clarifyTimeoutError?c.ETIMEDOUT:c.ECONNABORTED,d,y)),y=null},e.isStandardBrowserEnv()){var E=(d.withCredentials||o(S))&&d.xsrfCookieName?r.read(d.xsrfCookieName):void 0;E&&(b[d.xsrfHeaderName]=E)}"setRequestHeader"in y&&e.forEach(b,(function(e,t){void 0===v&&"content-type"===t.toLowerCase()?delete b[t]:y.setRequestHeader(t,e)})),e.isUndefined(d.withCredentials)||(y.withCredentials=!!d.withCredentials),m&&"json"!==m&&(y.responseType=d.responseType),"function"==typeof d.onDownloadProgress&&y.addEventListener("progress",d.onDownloadProgress),"function"==typeof d.onUploadProgress&&y.upload&&y.upload.addEventListener("progress",d.onUploadProgress),(d.cancelToken||d.signal)&&(p=function(e){y&&(l(!e||e&&e.type?new u:e),y.abort(),y=null)},d.cancelToken&&d.cancelToken.subscribe(p),d.signal&&(d.signal.aborted?p():d.signal.addEventListener("abort",p))),v||(v=null);var x=h(S);x&&-1===["http","https","file"].indexOf(x)?l(new c("Unsupported protocol "+x+":",c.ERR_BAD_REQUEST,d)):y.send(v)}))},xhr}function require_null(){return hasRequired_null?_null:(hasRequired_null=1,_null=null)}var utils$5=utils$9,normalizeHeaderName=normalizeHeaderName$1,AxiosError$1=requireAxiosError(),transitionalDefaults=transitional,toFormData=requireToFormData(),DEFAULT_CONTENT_TYPE={"Content-Type":"application/x-www-form-urlencoded"};function setContentTypeIfUnset(e,t){!utils$5.isUndefined(e)&&utils$5.isUndefined(e["Content-Type"])&&(e["Content-Type"]=t)}function getDefaultAdapter(){var e;return("undefined"!=typeof XMLHttpRequest||"undefined"!=typeof process&&"[object process]"===Object.prototype.toString.call(process))&&(e=requireXhr()),e}function stringifySafely(e,t,r){if(utils$5.isString(e))try{return(t||JSON.parse)(e),utils$5.trim(e)}catch(e){if("SyntaxError"!==e.name)throw e}return(r||JSON.stringify)(e)}var defaults$3={transitional:transitionalDefaults,adapter:getDefaultAdapter(),transformRequest:[function(e,t){if(normalizeHeaderName(t,"Accept"),normalizeHeaderName(t,"Content-Type"),utils$5.isFormData(e)||utils$5.isArrayBuffer(e)||utils$5.isBuffer(e)||utils$5.isStream(e)||utils$5.isFile(e)||utils$5.isBlob(e))return e;if(utils$5.isArrayBufferView(e))return e.buffer;if(utils$5.isURLSearchParams(e))return setContentTypeIfUnset(t,"application/x-www-form-urlencoded;charset=utf-8"),e.toString();var r,i=utils$5.isObject(e),n=t&&t["Content-Type"];if((r=utils$5.isFileList(e))||i&&"multipart/form-data"===n){var s=this.env&&this.env.FormData;return toFormData(r?{"files[]":e}:e,s&&new s)}return i||"application/json"===n?(setContentTypeIfUnset(t,"application/json"),stringifySafely(e)):e}],transformResponse:[function(e){var t=this.transitional||defaults$3.transitional,r=t&&t.silentJSONParsing,i=t&&t.forcedJSONParsing,n=!r&&"json"===this.responseType;if(n||i&&utils$5.isString(e)&&e.length)try{return JSON.parse(e)}catch(e){if(n){if("SyntaxError"===e.name)throw AxiosError$1.from(e,AxiosError$1.ERR_BAD_RESPONSE,this,null,this.response);throw e}}return e}],timeout:0,xsrfCookieName:"XSRF-TOKEN",xsrfHeaderName:"X-XSRF-TOKEN",maxContentLength:-1,maxBodyLength:-1,env:{FormData:require_null()},validateStatus:function(e){return e>=200&&e<300},headers:{common:{Accept:"application/json, text/plain, */*"}}};utils$5.forEach(["delete","get","head"],(function(e){defaults$3.headers[e]={}})),utils$5.forEach(["post","put","patch"],(function(e){defaults$3.headers[e]=utils$5.merge(DEFAULT_CONTENT_TYPE)}));var defaults_1=defaults$3,utils$4=utils$9,defaults$2=defaults_1,transformData$1=function(e,t,r){var i=this||defaults$2;return utils$4.forEach(r,(function(r){e=r.call(i,e,t)})),e},isCancel$1,hasRequiredIsCancel;function requireIsCancel(){return hasRequiredIsCancel?isCancel$1:(hasRequiredIsCancel=1,isCancel$1=function(e){return!(!e||!e.__CANCEL__)})}var utils$3=utils$9,transformData=transformData$1,isCancel=requireIsCancel(),defaults$1=defaults_1,CanceledError=requireCanceledError();function throwIfCancellationRequested(e){if(e.cancelToken&&e.cancelToken.throwIfRequested(),e.signal&&e.signal.aborted)throw new CanceledError}var dispatchRequest$1=function(e){return throwIfCancellationRequested(e),e.headers=e.headers||{},e.data=transformData.call(e,e.data,e.headers,e.transformRequest),e.headers=utils$3.merge(e.headers.common||{},e.headers[e.method]||{},e.headers),utils$3.forEach(["delete","get","head","post","put","patch","common"],(function(t){delete e.headers[t]})),(e.adapter||defaults$1.adapter)(e).then((function(t){return throwIfCancellationRequested(e),t.data=transformData.call(e,t.data,t.headers,e.transformResponse),t}),(function(t){return isCancel(t)||(throwIfCancellationRequested(e),t&&t.response&&(t.response.data=transformData.call(e,t.response.data,t.response.headers,e.transformResponse))),Promise.reject(t)}))},utils$2=utils$9,mergeConfig$2=function(e,t){t=t||{};var r={};function i(e,t){return utils$2.isPlainObject(e)&&utils$2.isPlainObject(t)?utils$2.merge(e,t):utils$2.isPlainObject(t)?utils$2.merge({},t):utils$2.isArray(t)?t.slice():t}function n(r){return utils$2.isUndefined(t[r])?utils$2.isUndefined(e[r])?void 0:i(void 0,e[r]):i(e[r],t[r])}function s(e){if(!utils$2.isUndefined(t[e]))return i(void 0,t[e])}function o(r){return utils$2.isUndefined(t[r])?utils$2.isUndefined(e[r])?void 0:i(void 0,e[r]):i(void 0,t[r])}function a(r){return r in t?i(e[r],t[r]):r in e?i(void 0,e[r]):void 0}var c={url:s,method:s,data:s,baseURL:o,transformRequest:o,transformResponse:o,paramsSerializer:o,timeout:o,timeoutMessage:o,withCredentials:o,adapter:o,responseType:o,xsrfCookieName:o,xsrfHeaderName:o,onUploadProgress:o,onDownloadProgress:o,decompress:o,maxContentLength:o,maxBodyLength:o,beforeRedirect:o,transport:o,httpAgent:o,httpsAgent:o,cancelToken:o,socketPath:o,responseEncoding:o,validateStatus:a};return utils$2.forEach(Object.keys(e).concat(Object.keys(t)),(function(e){var t=c[e]||n,i=t(e);utils$2.isUndefined(i)&&t!==a||(r[e]=i)})),r},data,hasRequiredData;function requireData(){return hasRequiredData?data:(hasRequiredData=1,data={version:"0.27.2"})}var VERSION=requireData().version,AxiosError=requireAxiosError(),validators$1={};["object","boolean","number","function","string","symbol"].forEach((function(e,t){validators$1[e]=function(r){return typeof r===e||"a"+(t<1?"n ":" ")+e}}));var deprecatedWarnings={};function assertOptions(e,t,r){if("object"!=typeof e)throw new AxiosError("options must be an object",AxiosError.ERR_BAD_OPTION_VALUE);for(var i=Object.keys(e),n=i.length;n-- >0;){var s=i[n],o=t[s];if(o){var a=e[s],c=void 0===a||o(a,s,e);if(!0!==c)throw new AxiosError("option "+s+" must be "+c,AxiosError.ERR_BAD_OPTION_VALUE)}else if(!0!==r)throw new AxiosError("Unknown option "+s,AxiosError.ERR_BAD_OPTION)}}validators$1.transitional=function(e,t,r){function i(e,t){return"[Axios v"+VERSION+"] Transitional option '"+e+"'"+t+(r?". "+r:"")}return function(r,n,s){if(!1===e)throw new AxiosError(i(n," has been removed"+(t?" in "+t:"")),AxiosError.ERR_DEPRECATED);return t&&!deprecatedWarnings[n]&&(deprecatedWarnings[n]=!0,console.warn(i(n," has been deprecated since v"+t+" and will be removed in the near future"))),!e||e(r,n,s)}};var validator$1={assertOptions:assertOptions,validators:validators$1},utils$1=utils$9,buildURL=buildURL$1,InterceptorManager=InterceptorManager_1,dispatchRequest=dispatchRequest$1,mergeConfig$1=mergeConfig$2,buildFullPath=buildFullPath$1,validator=validator$1,validators=validator.validators;function Axios$1(e){this.defaults=e,this.interceptors={request:new InterceptorManager,response:new InterceptorManager}}Axios$1.prototype.request=function(e,t){"string"==typeof e?(t=t||{}).url=e:t=e||{},(t=mergeConfig$1(this.defaults,t)).method?t.method=t.method.toLowerCase():this.defaults.method?t.method=this.defaults.method.toLowerCase():t.method="get";var r=t.transitional;void 0!==r&&validator.assertOptions(r,{silentJSONParsing:validators.transitional(validators.boolean),forcedJSONParsing:validators.transitional(validators.boolean),clarifyTimeoutError:validators.transitional(validators.boolean)},!1);var i=[],n=!0;this.interceptors.request.forEach((function(e){"function"==typeof e.runWhen&&!1===e.runWhen(t)||(n=n&&e.synchronous,i.unshift(e.fulfilled,e.rejected))}));var s,o=[];if(this.interceptors.response.forEach((function(e){o.push(e.fulfilled,e.rejected)})),!n){var a=[dispatchRequest,void 0];for(Array.prototype.unshift.apply(a,i),a=a.concat(o),s=Promise.resolve(t);a.length;)s=s.then(a.shift(),a.shift());return s}for(var c=t;i.length;){var u=i.shift(),h=i.shift();try{c=u(c)}catch(e){h(e);break}}try{s=dispatchRequest(c)}catch(e){return Promise.reject(e)}for(;o.length;)s=s.then(o.shift(),o.shift());return s},Axios$1.prototype.getUri=function(e){e=mergeConfig$1(this.defaults,e);var t=buildFullPath(e.baseURL,e.url);return buildURL(t,e.params,e.paramsSerializer)},utils$1.forEach(["delete","get","head","options"],(function(e){Axios$1.prototype[e]=function(t,r){return this.request(mergeConfig$1(r||{},{method:e,url:t,data:(r||{}).data}))}})),utils$1.forEach(["post","put","patch"],(function(e){function t(t){return function(r,i,n){return this.request(mergeConfig$1(n||{},{method:e,headers:t?{"Content-Type":"multipart/form-data"}:{},url:r,data:i}))}}Axios$1.prototype[e]=t(),Axios$1.prototype[e+"Form"]=t(!0)}));var Axios_1=Axios$1,CancelToken_1,hasRequiredCancelToken,spread,hasRequiredSpread,isAxiosError,hasRequiredIsAxiosError;function requireCancelToken(){if(hasRequiredCancelToken)return CancelToken_1;hasRequiredCancelToken=1;var e=requireCanceledError();function t(t){if("function"!=typeof t)throw new TypeError("executor must be a function.");var r;this.promise=new Promise((function(e){r=e}));var i=this;this.promise.then((function(e){if(i.ie){var t,r=i.ie.length;for(t=0;t<r;t++)i.ie[t](e);i.ie=null}})),this.promise.then=function(e){var t,r=new Promise((function(e){i.subscribe(e),t=e})).then(e);return r.cancel=function(){i.unsubscribe(t)},r},t((function(t){i.reason||(i.reason=new e(t),r(i.reason))}))}return t.prototype.throwIfRequested=function(){if(this.reason)throw this.reason},t.prototype.subscribe=function(e){this.reason?e(this.reason):this.ie?this.ie.push(e):this.ie=[e]},t.prototype.unsubscribe=function(e){if(this.ie){var t=this.ie.indexOf(e);-1!==t&&this.ie.splice(t,1)}},t.source=function(){var e,r=new t((function(t){e=t}));return{token:r,cancel:e}},CancelToken_1=t}function requireSpread(){return hasRequiredSpread?spread:(hasRequiredSpread=1,spread=function(e){return function(t){return e.apply(null,t)}})}function requireIsAxiosError(){if(hasRequiredIsAxiosError)return isAxiosError;hasRequiredIsAxiosError=1;var e=utils$9;return isAxiosError=function(t){return e.isObject(t)&&!0===t.isAxiosError}}var utils=utils$9,bind=bind$2,Axios=Axios_1,mergeConfig=mergeConfig$2,defaults=defaults_1;function createInstance(e){var t=new Axios(e),r=bind(Axios.prototype.request,t);return utils.extend(r,Axios.prototype,t),utils.extend(r,t),r.create=function(t){return createInstance(mergeConfig(e,t))},r}var axios=createInstance(defaults);axios.Axios=Axios,axios.CanceledError=requireCanceledError(),axios.CancelToken=requireCancelToken(),axios.isCancel=requireIsCancel(),axios.VERSION=requireData().version,axios.toFormData=requireToFormData(),axios.AxiosError=requireAxiosError(),axios.Cancel=axios.CanceledError,axios.all=function(e){return Promise.all(e)},axios.spread=requireSpread(),axios.isAxiosError=requireIsAxiosError(),axios$1.exports=axios,axiosExports.default=axios,function(e){e.exports=axiosExports}(axios$2);var b$4=getDefaultExportFromCjs(axiosExports$1),getRandomValues,rnds8=new Uint8Array(16);function rng(){if(!getRandomValues&&!(getRandomValues="undefined"!=typeof crypto&&crypto.getRandomValues&&crypto.getRandomValues.bind(crypto)||"undefined"!=typeof msCrypto&&"function"==typeof msCrypto.getRandomValues&&msCrypto.getRandomValues.bind(msCrypto)))throw new Error("crypto.getRandomValues() not supported. See https://github.com/uuidjs/uuid#getrandomvalues-not-supported");return getRandomValues(rnds8)}var REGEX=/^(?:[0-9a-f]{8}-[0-9a-f]{4}-[1-5][0-9a-f]{3}-[89ab][0-9a-f]{3}-[0-9a-f]{12}|00000000-0000-0000-0000-000000000000)$/i;function validate(e){return"string"==typeof e&&REGEX.test(e)}for(var byteToHex=[],i$1=0;i$1<256;++i$1)byteToHex.push((i$1+256).toString(16).substr(1));function stringify(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0,r=(byteToHex[e[t+0]]+byteToHex[e[t+1]]+byteToHex[e[t+2]]+byteToHex[e[t+3]]+"-"+byteToHex[e[t+4]]+byteToHex[e[t+5]]+"-"+byteToHex[e[t+6]]+byteToHex[e[t+7]]+"-"+byteToHex[e[t+8]]+byteToHex[e[t+9]]+"-"+byteToHex[e[t+10]]+byteToHex[e[t+11]]+byteToHex[e[t+12]]+byteToHex[e[t+13]]+byteToHex[e[t+14]]+byteToHex[e[t+15]]).toLowerCase();if(!validate(r))throw TypeError("Stringified UUID is invalid");return r}function v4(e,t,r){var i=(e=e||{}).random||(e.rng||rng)();if(i[6]=15&i[6]|64,i[8]=63&i[8]|128,t){r=r||0;for(var n=0;n<16;++n)t[r+n]=i[n];return t}return stringify(i)}var uaParserExports={},uaParser={get exports(){return uaParserExports},set exports(e){uaParserExports=e}};!function(e,t){!function(r,i){var n="function",s="undefined",o="object",a="string",c="model",u="name",h="type",d="vendor",f="version",l="architecture",p="console",v="mobile",b="tablet",m="smarttv",g="wearable",y="embedded",w="Amazon",$="Apple",S="ASUS",k="BlackBerry",E="Browser",x="Chrome",C="Firefox",A="Google",_="Huawei",T="LG",R="Microsoft",O="Motorola",I="Opera",j="Samsung",M="Sharp",q="Sony",N="Xiaomi",P="Zebra",D="Facebook",L=function(e){for(var t={},r=0;r<e.length;r++)t[e[r].toUpperCase()]=e[r];return t},B=function(e,t){return typeof e===a&&-1!==F(t).indexOf(F(e))},F=function(e){return e.toLowerCase()},H=function(e,t){if(typeof e===a)return e=e.replace(/^\s\s*/,"").replace(/\s\s*$/,""),typeof t===s?e:e.substring(0,350)},U=function(e,t){for(var r,s,a,c,u,h,d=0;d<t.length&&!u;){var f=t[d],l=t[d+1];for(r=s=0;r<f.length&&!u;)if(u=f[r++].exec(e))for(a=0;a<l.length;a++)h=u[++s],typeof(c=l[a])===o&&c.length>0?2===c.length?typeof c[1]==n?this[c[0]]=c[1].call(this,h):this[c[0]]=c[1]:3===c.length?typeof c[1]!==n||c[1].exec&&c[1].test?this[c[0]]=h?h.replace(c[1],c[2]):i:this[c[0]]=h?c[1].call(this,h,c[2]):i:4===c.length&&(this[c[0]]=h?c[3].call(this,h.replace(c[1],c[2])):i):this[c]=h||i;d+=2}},V=function(e,t){for(var r in t)if(typeof t[r]===o&&t[r].length>0){for(var n=0;n<t[r].length;n++)if(B(t[r][n],e))return"?"===r?i:r}else if(B(t[r],e))return"?"===r?i:r;return e},G={ME:"4.90","NT 3.11":"NT3.51","NT 4.0":"NT4.0",2e3:"NT 5.0",XP:["NT 5.1","NT 5.2"],Vista:"NT 6.0",7:"NT 6.1",8:"NT 6.2",8.1:"NT 6.3",10:["NT 6.4","NT 10.0"],RT:"ARM"},K={browser:[[/\b(?:crmo|crios)\/([\w\.]+)/i],[f,[u,"Chrome"]],[/edg(?:e|ios|a)?\/([\w\.]+)/i],[f,[u,"Edge"]],[/(opera mini)\/([-\w\.]+)/i,/(opera [mobiletab]{3,6})\b.+version\/([-\w\.]+)/i,/(opera)(?:.+version\/|[\/ ]+)([\w\.]+)/i],[u,f],[/opios[\/ ]+([\w\.]+)/i],[f,[u,I+" Mini"]],[/\bopr\/([\w\.]+)/i],[f,[u,I]],[/(kindle)\/([\w\.]+)/i,/(lunascape|maxthon|netfront|jasmine|blazer)[\/ ]?([\w\.]*)/i,/(avant |iemobile|slim)(?:browser)?[\/ ]?([\w\.]*)/i,/(ba?idubrowser)[\/ ]?([\w\.]+)/i,/(?:ms|\()(ie) ([\w\.]+)/i,/(flock|rockmelt|midori|epiphany|silk|skyfire|ovibrowser|bolt|iron|vivaldi|iridium|phantomjs|bowser|quark|qupzilla|falkon|rekonq|puffin|brave|whale|qqbrowserlite|qq|duckduckgo)\/([-\w\.]+)/i,/(weibo)__([\d\.]+)/i],[u,f],[/(?:\buc? ?browser|(?:juc.+)ucweb)[\/ ]?([\w\.]+)/i],[f,[u,"UC"+E]],[/microm.+\bqbcore\/([\w\.]+)/i,/\bqbcore\/([\w\.]+).+microm/i],[f,[u,"WeChat(Win) Desktop"]],[/micromessenger\/([\w\.]+)/i],[f,[u,"WeChat"]],[/konqueror\/([\w\.]+)/i],[f,[u,"Konqueror"]],[/trident.+rv[: ]([\w\.]{1,9})\b.+like gecko/i],[f,[u,"IE"]],[/yabrowser\/([\w\.]+)/i],[f,[u,"Yandex"]],[/(avast|avg)\/([\w\.]+)/i],[[u,/(.+)/,"$1 Secure "+E],f],[/\bfocus\/([\w\.]+)/i],[f,[u,C+" Focus"]],[/\bopt\/([\w\.]+)/i],[f,[u,I+" Touch"]],[/coc_coc\w+\/([\w\.]+)/i],[f,[u,"Coc Coc"]],[/dolfin\/([\w\.]+)/i],[f,[u,"Dolphin"]],[/coast\/([\w\.]+)/i],[f,[u,I+" Coast"]],[/miuibrowser\/([\w\.]+)/i],[f,[u,"MIUI "+E]],[/fxios\/([-\w\.]+)/i],[f,[u,C]],[/\bqihu|(qi?ho?o?|360)browser/i],[[u,"360 "+E]],[/(oculus|samsung|sailfish|huawei)browser\/([\w\.]+)/i],[[u,/(.+)/,"$1 "+E],f],[/(comodo_dragon)\/([\w\.]+)/i],[[u,/_/g," "],f],[/(electron)\/([\w\.]+) safari/i,/(tesla)(?: qtcarbrowser|\/(20\d\d\.[-\w\.]+))/i,/m?(qqbrowser|baiduboxapp|2345Explorer)[\/ ]?([\w\.]+)/i],[u,f],[/(metasr)[\/ ]?([\w\.]+)/i,/(lbbrowser)/i,/\[(linkedin)app\]/i],[u],[/((?:fban\/fbios|fb_iab\/fb4a)(?!.+fbav)|;fbav\/([\w\.]+);)/i],[[u,D],f],[/safari (line)\/([\w\.]+)/i,/\b(line)\/([\w\.]+)\/iab/i,/(chromium|instagram)[\/ ]([-\w\.]+)/i],[u,f],[/\bgsa\/([\w\.]+) .*safari\//i],[f,[u,"GSA"]],[/headlesschrome(?:\/([\w\.]+)| )/i],[f,[u,x+" Headless"]],[/ wv\).+(chrome)\/([\w\.]+)/i],[[u,x+" WebView"],f],[/droid.+ version\/([\w\.]+)\b.+(?:mobile safari|safari)/i],[f,[u,"Android "+E]],[/(chrome|omniweb|arora|[tizenoka]{5} ?browser)\/v?([\w\.]+)/i],[u,f],[/version\/([\w\.\,]+) .*mobile\/\w+ (safari)/i],[f,[u,"Mobile Safari"]],[/version\/([\w(\.|\,)]+) .*(mobile ?safari|safari)/i],[f,u],[/webkit.+?(mobile ?safari|safari)(\/[\w\.]+)/i],[u,[f,V,{"1.0":"/8",1.2:"/1",1.3:"/3","2.0":"/412","2.0.2":"/416","2.0.3":"/417","2.0.4":"/419","?":"/"}]],[/(webkit|khtml)\/([\w\.]+)/i],[u,f],[/(navigator|netscape\d?)\/([-\w\.]+)/i],[[u,"Netscape"],f],[/mobile vr; rv:([\w\.]+)\).+firefox/i],[f,[u,C+" Reality"]],[/ekiohf.+(flow)\/([\w\.]+)/i,/(swiftfox)/i,/(icedragon|iceweasel|camino|chimera|fennec|maemo browser|minimo|conkeror|klar)[\/ ]?([\w\.\+]+)/i,/(seamonkey|k-meleon|icecat|iceape|firebird|phoenix|palemoon|basilisk|waterfox)\/([-\w\.]+)$/i,/(firefox)\/([\w\.]+)/i,/(mozilla)\/([\w\.]+) .+rv\:.+gecko\/\d+/i,/(polaris|lynx|dillo|icab|doris|amaya|w3m|netsurf|sleipnir|obigo|mosaic|(?:go|ice|up)[\. ]?browser)[-\/ ]?v?([\w\.]+)/i,/(links) \(([\w\.]+)/i],[u,f]],cpu:[[/(?:(amd|x(?:(?:86|64)[-_])?|wow|win)64)[;\)]/i],[[l,"amd64"]],[/(ia32(?=;))/i],[[l,F]],[/((?:i[346]|x)86)[;\)]/i],[[l,"ia32"]],[/\b(aarch64|arm(v?8e?l?|_?64))\b/i],[[l,"arm64"]],[/\b(arm(?:v[67])?ht?n?[fl]p?)\b/i],[[l,"armhf"]],[/windows (ce|mobile); ppc;/i],[[l,"arm"]],[/((?:ppc|powerpc)(?:64)?)(?: mac|;|\))/i],[[l,/ower/,"",F]],[/(sun4\w)[;\)]/i],[[l,"sparc"]],[/((?:avr32|ia64(?=;))|68k(?=\))|\barm(?=v(?:[1-7]|[5-7]1)l?|;|eabi)|(?=atmel )avr|(?:irix|mips|sparc)(?:64)?\b|pa-risc)/i],[[l,F]]],device:[[/\b(sch-i[89]0\d|shw-m380s|sm-[ptx]\w{2,4}|gt-[pn]\d{2,4}|sgh-t8[56]9|nexus 10)/i],[c,[d,j],[h,b]],[/\b((?:s[cgp]h|gt|sm)-\w+|galaxy nexus)/i,/samsung[- ]([-\w]+)/i,/sec-(sgh\w+)/i],[c,[d,j],[h,v]],[/\((ip(?:hone|od)[\w ]*);/i],[c,[d,$],[h,v]],[/\((ipad);[-\w\),; ]+apple/i,/applecoremedia\/[\w\.]+ \((ipad)/i,/\b(ipad)\d\d?,\d\d?[;\]].+ios/i],[c,[d,$],[h,b]],[/\b((?:ag[rs][23]?|bah2?|sht?|btv)-a?[lw]\d{2})\b(?!.+d\/s)/i],[c,[d,_],[h,b]],[/(?:huawei|honor)([-\w ]+)[;\)]/i,/\b(nexus 6p|\w{2,4}e?-[atu]?[ln][\dx][012359c][adn]?)\b(?!.+d\/s)/i],[c,[d,_],[h,v]],[/\b(poco[\w ]+)(?: bui|\))/i,/\b; (\w+) build\/hm\1/i,/\b(hm[-_ ]?note?[_ ]?(?:\d\w)?) bui/i,/\b(redmi[\-_ ]?(?:note|k)?[\w_ ]+)(?: bui|\))/i,/\b(mi[-_ ]?(?:a\d|one|one[_ ]plus|note lte|max|cc)?[_ ]?(?:\d?\w?)[_ ]?(?:plus|se|lite)?)(?: bui|\))/i],[[c,/_/g," "],[d,N],[h,v]],[/\b(mi[-_ ]?(?:pad)(?:[\w_ ]+))(?: bui|\))/i],[[c,/_/g," "],[d,N],[h,b]],[/; (\w+) bui.+ oppo/i,/\b(cph[12]\d{3}|p(?:af|c[al]|d\w|e[ar])[mt]\d0|x9007|a101op)\b/i],[c,[d,"OPPO"],[h,v]],[/vivo (\w+)(?: bui|\))/i,/\b(v[12]\d{3}\w?[at])(?: bui|;)/i],[c,[d,"Vivo"],[h,v]],[/\b(rmx[12]\d{3})(?: bui|;|\))/i],[c,[d,"Realme"],[h,v]],[/\b(milestone|droid(?:[2-4x]| (?:bionic|x2|pro|razr))?:?( 4g)?)\b[\w ]+build\//i,/\bmot(?:orola)?[- ](\w*)/i,/((?:moto[\w\(\) ]+|xt\d{3,4}|nexus 6)(?= bui|\)))/i],[c,[d,O],[h,v]],[/\b(mz60\d|xoom[2 ]{0,2}) build\//i],[c,[d,O],[h,b]],[/((?=lg)?[vl]k\-?\d{3}) bui| 3\.[-\w; ]{10}lg?-([06cv9]{3,4})/i],[c,[d,T],[h,b]],[/(lm(?:-?f100[nv]?|-[\w\.]+)(?= bui|\))|nexus [45])/i,/\blg[-e;\/ ]+((?!browser|netcast|android tv)\w+)/i,/\blg-?([\d\w]+) bui/i],[c,[d,T],[h,v]],[/(ideatab[-\w ]+)/i,/lenovo ?(s[56]000[-\w]+|tab(?:[\w ]+)|yt[-\d\w]{6}|tb[-\d\w]{6})/i],[c,[d,"Lenovo"],[h,b]],[/(?:maemo|nokia).*(n900|lumia \d+)/i,/nokia[-_ ]?([-\w\.]*)/i],[[c,/_/g," "],[d,"Nokia"],[h,v]],[/(pixel c)\b/i],[c,[d,A],[h,b]],[/droid.+; (pixel[\daxl ]{0,6})(?: bui|\))/i],[c,[d,A],[h,v]],[/droid.+ (a?\d[0-2]{2}so|[c-g]\d{4}|so[-gl]\w+|xq-a\w[4-7][12])(?= bui|\).+chrome\/(?![1-6]{0,1}\d\.))/i],[c,[d,q],[h,v]],[/sony tablet [ps]/i,/\b(?:sony)?sgp\w+(?: bui|\))/i],[[c,"Xperia Tablet"],[d,q],[h,b]],[/ (kb2005|in20[12]5|be20[12][59])\b/i,/(?:one)?(?:plus)? (a\d0\d\d)(?: b|\))/i],[c,[d,"OnePlus"],[h,v]],[/(alexa)webm/i,/(kf[a-z]{2}wi)( bui|\))/i,/(kf[a-z]+)( bui|\)).+silk\//i],[c,[d,w],[h,b]],[/((?:sd|kf)[0349hijorstuw]+)( bui|\)).+silk\//i],[[c,/(.+)/g,"Fire Phone $1"],[d,w],[h,v]],[/(playbook);[-\w\),; ]+(rim)/i],[c,d,[h,b]],[/\b((?:bb[a-f]|st[hv])100-\d)/i,/\(bb10; (\w+)/i],[c,[d,k],[h,v]],[/(?:\b|asus_)(transfo[prime ]{4,10} \w+|eeepc|slider \w+|nexus 7|padfone|p00[cj])/i],[c,[d,S],[h,b]],[/ (z[bes]6[027][012][km][ls]|zenfone \d\w?)\b/i],[c,[d,S],[h,v]],[/(nexus 9)/i],[c,[d,"HTC"],[h,b]],[/(htc)[-;_ ]{1,2}([\w ]+(?=\)| bui)|\w+)/i,/(zte)[- ]([\w ]+?)(?: bui|\/|\))/i,/(alcatel|geeksphone|nexian|panasonic|sony(?!-bra))[-_ ]?([-\w]*)/i],[d,[c,/_/g," "],[h,v]],[/droid.+; ([ab][1-7]-?[0178a]\d\d?)/i],[c,[d,"Acer"],[h,b]],[/droid.+; (m[1-5] note) bui/i,/\bmz-([-\w]{2,})/i],[c,[d,"Meizu"],[h,v]],[/\b(sh-?[altvz]?\d\d[a-ekm]?)/i],[c,[d,M],[h,v]],[/(blackberry|benq|palm(?=\-)|sonyericsson|acer|asus|dell|meizu|motorola|polytron)[-_ ]?([-\w]*)/i,/(hp) ([\w ]+\w)/i,/(asus)-?(\w+)/i,/(microsoft); (lumia[\w ]+)/i,/(lenovo)[-_ ]?([-\w]+)/i,/(jolla)/i,/(oppo) ?([\w ]+) bui/i],[d,c,[h,v]],[/(archos) (gamepad2?)/i,/(hp).+(touchpad(?!.+tablet)|tablet)/i,/(kindle)\/([\w\.]+)/i,/(nook)[\w ]+build\/(\w+)/i,/(dell) (strea[kpr\d ]*[\dko])/i,/(le[- ]+pan)[- ]+(\w{1,9}) bui/i,/(trinity)[- ]*(t\d{3}) bui/i,/(gigaset)[- ]+(q\w{1,9}) bui/i,/(vodafone) ([\w ]+)(?:\)| bui)/i],[d,c,[h,b]],[/(surface duo)/i],[c,[d,R],[h,b]],[/droid [\d\.]+; (fp\du?)(?: b|\))/i],[c,[d,"Fairphone"],[h,v]],[/(u304aa)/i],[c,[d,"AT&T"],[h,v]],[/\bsie-(\w*)/i],[c,[d,"Siemens"],[h,v]],[/\b(rct\w+) b/i],[c,[d,"RCA"],[h,b]],[/\b(venue[\d ]{2,7}) b/i],[c,[d,"Dell"],[h,b]],[/\b(q(?:mv|ta)\w+) b/i],[c,[d,"Verizon"],[h,b]],[/\b(?:barnes[& ]+noble |bn[rt])([\w\+ ]*) b/i],[c,[d,"Barnes & Noble"],[h,b]],[/\b(tm\d{3}\w+) b/i],[c,[d,"NuVision"],[h,b]],[/\b(k88) b/i],[c,[d,"ZTE"],[h,b]],[/\b(nx\d{3}j) b/i],[c,[d,"ZTE"],[h,v]],[/\b(gen\d{3}) b.+49h/i],[c,[d,"Swiss"],[h,v]],[/\b(zur\d{3}) b/i],[c,[d,"Swiss"],[h,b]],[/\b((zeki)?tb.*\b) b/i],[c,[d,"Zeki"],[h,b]],[/\b([yr]\d{2}) b/i,/\b(dragon[- ]+touch |dt)(\w{5}) b/i],[[d,"Dragon Touch"],c,[h,b]],[/\b(ns-?\w{0,9}) b/i],[c,[d,"Insignia"],[h,b]],[/\b((nxa|next)-?\w{0,9}) b/i],[c,[d,"NextBook"],[h,b]],[/\b(xtreme\_)?(v(1[045]|2[015]|[3469]0|7[05])) b/i],[[d,"Voice"],c,[h,v]],[/\b(lvtel\-)?(v1[12]) b/i],[[d,"LvTel"],c,[h,v]],[/\b(ph-1) /i],[c,[d,"Essential"],[h,v]],[/\b(v(100md|700na|7011|917g).*\b) b/i],[c,[d,"Envizen"],[h,b]],[/\b(trio[-\w\. ]+) b/i],[c,[d,"MachSpeed"],[h,b]],[/\btu_(1491) b/i],[c,[d,"Rotor"],[h,b]],[/(shield[\w ]+) b/i],[c,[d,"Nvidia"],[h,b]],[/(sprint) (\w+)/i],[d,c,[h,v]],[/(kin\.[onetw]{3})/i],[[c,/\./g," "],[d,R],[h,v]],[/droid.+; (cc6666?|et5[16]|mc[239][23]x?|vc8[03]x?)\)/i],[c,[d,P],[h,b]],[/droid.+; (ec30|ps20|tc[2-8]\d[kx])\)/i],[c,[d,P],[h,v]],[/(ouya)/i,/(nintendo) ([wids3utch]+)/i],[d,c,[h,p]],[/droid.+; (shield) bui/i],[c,[d,"Nvidia"],[h,p]],[/(playstation [345portablevi]+)/i],[c,[d,q],[h,p]],[/\b(xbox(?: one)?(?!; xbox))[\); ]/i],[c,[d,R],[h,p]],[/smart-tv.+(samsung)/i],[d,[h,m]],[/hbbtv.+maple;(\d+)/i],[[c,/^/,"SmartTV"],[d,j],[h,m]],[/(nux; netcast.+smarttv|lg (netcast\.tv-201\d|android tv))/i],[[d,T],[h,m]],[/(apple) ?tv/i],[d,[c,$+" TV"],[h,m]],[/crkey/i],[[c,x+"cast"],[d,A],[h,m]],[/droid.+aft(\w)( bui|\))/i],[c,[d,w],[h,m]],[/\(dtv[\);].+(aquos)/i,/(aquos-tv[\w ]+)\)/i],[c,[d,M],[h,m]],[/(bravia[\w ]+)( bui|\))/i],[c,[d,q],[h,m]],[/(mitv-\w{5}) bui/i],[c,[d,N],[h,m]],[/\b(roku)[\dx]*[\)\/]((?:dvp-)?[\d\.]*)/i,/hbbtv\/\d+\.\d+\.\d+ +\([\w ]*; *(\w[^;]*);([^;]*)/i],[[d,H],[c,H],[h,m]],[/\b(android tv|smart[- ]?tv|opera tv|tv; rv:)\b/i],[[h,m]],[/((pebble))app/i],[d,c,[h,g]],[/droid.+; (glass) \d/i],[c,[d,A],[h,g]],[/droid.+; (wt63?0{2,3})\)/i],[c,[d,P],[h,g]],[/(quest( 2)?)/i],[c,[d,D],[h,g]],[/(tesla)(?: qtcarbrowser|\/[-\w\.]+)/i],[d,[h,y]],[/droid .+?; ([^;]+?)(?: bui|\) applew).+? mobile safari/i],[c,[h,v]],[/droid .+?; ([^;]+?)(?: bui|\) applew).+?(?! mobile) safari/i],[c,[h,b]],[/\b((tablet|tab)[;\/]|focus\/\d(?!.+mobile))/i],[[h,b]],[/(phone|mobile(?:[;\/]| [ \w\/\.]*safari)|pda(?=.+windows ce))/i],[[h,v]],[/(android[-\w\. ]{0,9});.+buil/i],[c,[d,"Generic"]]],engine:[[/windows.+ edge\/([\w\.]+)/i],[f,[u,"EdgeHTML"]],[/webkit\/537\.36.+chrome\/(?!27)([\w\.]+)/i],[f,[u,"Blink"]],[/(presto)\/([\w\.]+)/i,/(webkit|trident|netfront|netsurf|amaya|lynx|w3m|goanna)\/([\w\.]+)/i,/ekioh(flow)\/([\w\.]+)/i,/(khtml|tasman|links)[\/ ]\(?([\w\.]+)/i,/(icab)[\/ ]([23]\.[\d\.]+)/i],[u,f],[/rv\:([\w\.]{1,9})\b.+(gecko)/i],[f,u]],os:[[/microsoft (windows) (vista|xp)/i],[u,f],[/(windows) nt 6\.2; (arm)/i,/(windows (?:phone(?: os)?|mobile))[\/ ]?([\d\.\w ]*)/i,/(windows)[\/ ]?([ntce\d\. ]+\w)(?!.+xbox)/i],[u,[f,V,G]],[/(win(?=3|9|n)|win 9x )([nt\d\.]+)/i],[[u,"Windows"],[f,V,G]],[/ip[honead]{2,4}\b(?:.*os ([\w]+) like mac|; opera)/i,/cfnetwork\/.+darwin/i],[[f,/_/g,"."],[u,"iOS"]],[/(mac os x) ?([\w\. ]*)/i,/(macintosh|mac_powerpc\b)(?!.+haiku)/i],[[u,"Mac OS"],[f,/_/g,"."]],[/droid ([\w\.]+)\b.+(android[- ]x86|harmonyos)/i],[f,u],[/(android|webos|qnx|bada|rim tablet os|maemo|meego|sailfish)[-\/ ]?([\w\.]*)/i,/(blackberry)\w*\/([\w\.]*)/i,/(tizen|kaios)[\/ ]([\w\.]+)/i,/\((series40);/i],[u,f],[/\(bb(10);/i],[f,[u,k]],[/(?:symbian ?os|symbos|s60(?=;)|series60)[-\/ ]?([\w\.]*)/i],[f,[u,"Symbian"]],[/mozilla\/[\d\.]+ \((?:mobile|tablet|tv|mobile; [\w ]+); rv:.+ gecko\/([\w\.]+)/i],[f,[u,C+" OS"]],[/web0s;.+rt(tv)/i,/\b(?:hp)?wos(?:browser)?\/([\w\.]+)/i],[f,[u,"webOS"]],[/crkey\/([\d\.]+)/i],[f,[u,x+"cast"]],[/(cros) [\w]+ ([\w\.]+\w)/i],[[u,"Chromium OS"],f],[/(nintendo|playstation) ([wids345portablevuch]+)/i,/(xbox); +xbox ([^\);]+)/i,/\b(joli|palm)\b ?(?:os)?\/?([\w\.]*)/i,/(mint)[\/\(\) ]?(\w*)/i,/(mageia|vectorlinux)[; ]/i,/([kxln]?ubuntu|debian|suse|opensuse|gentoo|arch(?= linux)|slackware|fedora|mandriva|centos|pclinuxos|red ?hat|zenwalk|linpus|raspbian|plan 9|minix|risc os|contiki|deepin|manjaro|elementary os|sabayon|linspire)(?: gnu\/linux)?(?: enterprise)?(?:[- ]linux)?(?:-gnu)?[-\/ ]?(?!chrom|package)([-\w\.]*)/i,/(hurd|linux) ?([\w\.]*)/i,/(gnu) ?([\w\.]*)/i,/\b([-frentopcghs]{0,5}bsd|dragonfly)[\/ ]?(?!amd|[ix346]{1,2}86)([\w\.]*)/i,/(haiku) (\w+)/i],[u,f],[/(sunos) ?([\w\.\d]*)/i],[[u,"Solaris"],f],[/((?:open)?solaris)[-\/ ]?([\w\.]*)/i,/(aix) ((\d)(?=\.|\)| )[\w\.])*/i,/\b(beos|os\/2|amigaos|morphos|openvms|fuchsia|hp-ux)/i,/(unix) ?([\w\.]*)/i],[u,f]]},W=function(e,t){if(typeof e===o&&(t=e,e=i),!(this instanceof W))return new W(e,t).getResult();var n=e||(typeof r!==s&&r.navigator&&r.navigator.userAgent?r.navigator.userAgent:""),p=t?function(e,t){var r={};for(var i in e)t[i]&&t[i].length%2==0?r[i]=t[i].concat(e[i]):r[i]=e[i];return r}(K,t):K;return this.getBrowser=function(){var e={};return e[u]=i,e[f]=i,U.call(e,n,p.browser),e.major=function(e){return typeof e===a?e.replace(/[^\d\.]/g,"").split(".")[0]:i}(e.version),e},this.getCPU=function(){var e={};return e[l]=i,U.call(e,n,p.cpu),e},this.getDevice=function(){var e={};return e[d]=i,e[c]=i,e[h]=i,U.call(e,n,p.device),e},this.getEngine=function(){var e={};return e[u]=i,e[f]=i,U.call(e,n,p.engine),e},this.getOS=function(){var e={};return e[u]=i,e[f]=i,U.call(e,n,p.os),e},this.getResult=function(){return{ua:this.getUA(),browser:this.getBrowser(),engine:this.getEngine(),os:this.getOS(),device:this.getDevice(),cpu:this.getCPU()}},this.getUA=function(){return n},this.setUA=function(e){return n=typeof e===a&&e.length>350?H(e,350):e,this},this.setUA(n),this};W.VERSION="1.0.32",W.BROWSER=L([u,f,"major"]),W.CPU=L([l]),W.DEVICE=L([c,d,h,p,v,m,b,g,y]),W.ENGINE=W.OS=L([u,f]),e.exports&&(t=e.exports=W),t.UAParser=W;var z=typeof r!==s&&(r.jQuery||r.Zepto);if(z&&!z.ua){var X=new W;z.ua=X.getResult(),z.ua.get=function(){return X.getUA()},z.ua.set=function(e){X.setUA(e);var t=X.getResult();for(var r in t)z.ua[r]=t[r]}}}("object"==typeof window?window:commonjsGlobal)}(uaParser,uaParserExports);var a$8=uaParserExports;const b$3=new a$8,c$3=b$3.getOS(),d$3=b$3.getCPU(),e$4=b$3.getDevice(),f$5=b$3.getBrowser();function e$3(e){return["ERR_NETWORK","ECONNABORTED","ETIMEDOUT"].includes(e.code)}function formatError(e){return e.isAxiosError?g$3(e):e instanceof MError?e:void 0!==e.code&&void 0!==e.name?f$4(e):(GlobalLogger.error("format error fail",e),new MError(exports.ErrorCode.UnexpectedError,"sdk unexpected error, please upload sdk log",e))}function f$4(e){for(const t in MEDIA_ERROR){const r=MEDIA_ERROR[t];if(r.code===e.code&&r.name.toLocaleUpperCase()===e.name.toLocaleUpperCase())return new MError(r.returnCode,r.name,e)}return GlobalLogger.error("unexpected media error code",e.code,e.name),new MError(e.code,e.name,e)}function g$3(e){var t,r,i,n,s;if(!e.response||e$3(e))return new MError(exports.ErrorCode.NetworkError,"network error");const o=null===(t=e.response)||void 0===t||null===(r=t.data)||void 0===r?void 0:r.code,a=null===(i=e.response)||void 0===i||null===(n=i.data)||void 0===n?void 0:n.message;return new MError(o,a,null===(s=e.response)||void 0===s?void 0:s.data)}const a$7={ne:{method:"post",url:"/passport/api/token?grant_type=client_credentials"},se:{method:"post",url:"/passport/api/token?grant_type=password"},oe:{method:"post",url:"/passport/api/token?grant_type=thirdparty"}},a$6={ae:{method:"post",url:"/mldatahub/api/v2/events"}};var a$5;const l$1=[a$6.ae.url],m=(null===(a$5=c$3.name)||void 0===a$5?void 0:a$5.toLocaleLowerCase().replace(/ /g,""))||"unKnow",n=b$4.create({headers:{"Content-Type":"application/json","x-os-type":m,"x-platform-type":"web","x-device-info":"web","x-client-ver":`${e$6.version}.${e$6.commit}`},timeout:1e4});function createApiFun(e){const t={};return Object.keys(e).forEach((r=>{t[r]=t=>{let{path:i,data:s,params:o,headers:a}=t;const c={...e[r]};return i&&Object.keys(i).forEach((e=>{c.url=c.url.replace(new RegExp(`{{${e}}}`,"g"),i[e])})),n({...c,data:s,params:o,headers:a}).catch((e=>{throw formatError(e)}))}})),t}n.interceptors.request.use((e=>{e.baseURL=e$6.ServerUri.apiProxy;const t=v4().replace(/-/g,"");return e.headers={...e.headers,...e$6.HeaderConfig,"x-apm-traceid":t,"x-timestamp":+new Date,Authorization:e.url===a$7.ne.url?"Basic Y2ZlMjJkYTktYzgzYS00ZmVlLTg2NDItYWUyMTkxNzQyYzk0OmM5ZWhHMjBuWkxNMVNKdjA=":e.url===a$7.se.url?`Bearer ${getClientToken().access_token}`:e.url===a$7.oe.url?`Bearer ${e.data.authCode}`:`Bearer ${getAuthToken().access_token}`},l$1.includes(e.url||"")||(ApiLogger.info(t,e.method,e.url),ApiLogger.debug(e.data)),e})),n.interceptors.response.use((e=>(e.data&&ApiLogger.debug(e.data),e)),(e=>{var t;throw ApiLogger.warn(e.config.headers&&e.config.headers["x-apm-traceid"],e.config.method,e.config.url,e.message,null===(t=e.response)||void 0===t?void 0:t.data),e}));var a$4=createApiFun(a$7);const a$3={ce:{method:"post",url:"/rsc/api/v2/user/sessions/actions/join"},ue:{method:"post",url:"/rsc/api/v2/user/sessions"},he:{method:"get",url:"/rsc/api/v2/user/sessions/{{sessionId}}/endpoints"},de:{method:"post",url:"/rsc/api/v1/user/sessions/{{sessionId}}/endpoints/{{endpointId}}/actions/mute"},fe:{method:"post",url:"/rsc/api/v1/user/sessions/{{sessionId}}/endpoints/{{endpointId}}/actions/unmute"},le:{method:"delete",url:"/rsc/api/v1/user/sessions/{{sessionId}}/endpoints/{{endpointId}}"},pe:{method:"delete",url:"/rsc/api/v1/user/sessions/{{sessionId}}"},ve:{method:"post",url:"/rsc/api/v3/user/sessions/{{sessionId}}/records/actions/start"},be:{method:"post",url:"/rsc/api/v2/user/sessions/{{sessionId}}/records/actions/stop"},me:{method:"patch",url:"/rsc/api/v1/user/sessions/{{sessionId}}/endpoints/actions/mute-all"},ge:{method:"post",url:"/rsc/api/v2/user/sessions/{{sessionId}}/endpoints/actions/unmute-all"},ye:{method:"post",url:"/rsc/api/v1/user/sessions/{{sessionId}}/endpoints/{{endpointId}}/mlb/videos"},we:{method:"delete",url:"/rsc/api/v1/user/sessions/{{sessionId}}/endpoints/{{endpointId}}/mlb/videos"},$e:{method:"post",url:"/rsc/api/v1/user/sessions/{{sessionId}}/endpoints/{{endpointId}}/actions/turn-video-off"},Se:{method:"post",url:"/rsc/api/v1/user/sessions/{{sessionId}}/endpoints/{{endpointId}}/actions/turn-video-on"},ke:{method:"patch",url:"/rsc/api/v1/user/sessions/{{sessionId}}/actions/change-mode"},Ee:{method:"post",url:"/rsc/api/v2/user/sessions/{{sessionId}}/endpoints/actions/batch-remove"},xe:{method:"patch",url:"/rsc/api/v1/user/sessions/{{sessionId}}/endpoints/{{endpointId}}/main-venue"},Ce:{method:"patch",url:"/rsc/api/v2/user/sessions/{{sessionId}}/endpoints/{{endpointId}}/role"},Ae:{method:"post",url:"/rsc/api/v1/user/sessions/{{sessionId}}/endpoints/{{endpointId}}/actions/reject-unmute"},_e:{method:"post",url:"/rsc/api/v1/user/sessions/{{sessionId}}/endpoints/actions/reject-turn-on-video"},Te:{method:"get",url:"/rsc/api/v2/user/sessions/{{sessionId}}"},Re:{method:"get",url:"/rsc/api/v1/user/sessions/{{sessionId}}/options"},Oe:{method:"patch",url:"/rsc/api/v1/user/sessions/{{sessionId}}/options"},Ie:{method:"post",url:"/rsc/api/v1/user/sessions/{{sessionId}}/endpoints/{{endpointId}}/actions/mute-speaker"},je:{method:"post",url:"/rsc/api/v1/user/sessions/{{sessionId}}/endpoints/{{endpointId}}/actions/unmute-speaker"},Me:{method:"patch",url:"/rsc/api/v2/user/sessions/{{sessionId}}/endpoints/{{endpointId}}/nickname"},qe:{method:"post",url:"/rsc/api/v1/user/sessions/{{sessionId}}/endpoints/actions/hang-up"},Ne:{method:"post",url:"/rsc/api/v1/user/sessions/{{sessionId}}/endpoints/actions/hang-on"},Pe:{method:"post",url:"/rsc/api/v2/user/sessions/{{sessionId}}/actions/turn-on-video-mode"},De:{method:"post",url:"/rsc/api/v2/user/sessions/{{sessionId}}/actions/turn-off-video-mode"}};var b$2=createApiFun(a$3),c$2=createApiFun(a$6),a$2={Auth:a$4,RSC:b$2,dataHub:c$2};const API={Auth:a$4,RSC:b$2,dataHub:c$2};let SocketHandler$1=class{constructor(e){this.Le={[SocketConfServiceEvents.EndpointPermissionUpdate]:e=>[RoomEventType.PERMISSION_UPDATED,e.body],[SocketConfServiceEvents.RoleChange]:e=>{const t=e.body,r=this.Be.endpointId,i=t.find((e=>e.endpointId===r));return i&&this.Be.updateSelfState({permissions:i.permissions}),[RoomEventType.ROLE_UPDATED,t.map((e=>({endpointId:e.endpointId,permissions:e.permissions,type:e.type,operator:e.operator,reason:e.reason})))]},[SocketConfServiceEvents.RoomJoin]:e=>{const{options:t,...r}=e.body,i={...r,endpointId:r.roomEndpointId,isAudioMute:t.isMute,isVideoMute:t.isVideoOff,isSpeakerMute:t.isSpeakerMute};return this.Be.insertMember({nickname:r.nickname,userId:r.userId,deviceId:r.deviceId,endpointId:r.roomEndpointId,options:{isMute:t.isMute,isVideoOff:t.isVideoOff,audiossrc:t.audiossrc,videossrc:t.videossrc,sharessrc:t.sharessrc,isSpeakerMute:t.isSpeakerMute},multiStreamInfo:r.multiStreamInfo}),[RoomEventType.USER_JOINED,i]},[SocketConfServiceEvents.RoomEndpointMuteAllV2]:e=>[RoomEventType.AUDIO_MUTE_ALL,{excludeEndpoints:e.body.excludeEndpoints,operator:e.body.operator}],[SocketConfServiceEvents.RoomEndpointKickOut]:e=>(this.Be.delMember(e.body.roomEndpointId),[RoomEventType.USER_KICK_OUT,{endpointId:e.body.roomEndpointId,operator:e.body.operator}]),[SocketConfServiceEvents.RoomEndpointQuitRoom]:e=>(this.Be.delMember(e.body.roomEndpointId),[RoomEventType.USER_LEFT,{endpointId:e.body.roomEndpointId,isDisconnect:!1}]),[SocketConfServiceEvents.AudioModeSwitch]:e=>[RoomEventType.ROOM_MODE_AUDIO_UPDATED,{sessionId:e.body.sessionId,isAudioMode:e.body.isAudioMode}],[SocketConfServiceEvents.RoomEndpointDisconnect]:e=>(this.Be.delMember(e.body.roomEndpointId),[RoomEventType.USER_LEFT,{endpointId:e.body.roomEndpointId,isDisconnect:!0}]),[SocketConfServiceEvents.RoomEndpointMuteV2]:e=>(this.Be.updateMember(e.body.roomEndpointId,{options:{isMute:!0}}),[RoomEventType.USER_UNPUBLISHED,{endpointId:e.body.roomEndpointId,mediaType:"audio",operator:e.body.operator}]),[SocketConfServiceEvents.NicknameChanged]:e=>[RoomEventType.USER_NICKNAME_UPDATED,{endpointId:e.body.endpointId,nickname:e.body.nickname,operator:e.body.operator}],[SocketConfServiceEvents.MuteAllSpeaker]:e=>[RoomEventType.SPEAKER_MUTE_ALL,{operator:e.body.operator,excludeEndpoints:e.body.excludeEndpoints}],[SocketConfServiceEvents.UnmuteAllSpeaker]:e=>[RoomEventType.SPEAKER_UNMUTE_ALL,{operator:e.body.operator}],[SocketConfServiceEvents.MuteSpeaker]:e=>[RoomEventType.USER_SPEAKER_MUTED,{endpointId:e.body.endpointId,operator:e.body.operator}],[SocketConfServiceEvents.UnmuteSpeaker]:e=>[RoomEventType.USER_SPEAKER_UNMUTED,{endpointId:e.body.endpointId,operator:e.body.operator}],[SocketConfServiceEvents.RoomEndpointTurnVideoOff]:e=>(this.Be.updateMember(e.body.roomEndpointId,{options:{isVideoOff:!0}}),[RoomEventType.USER_UNPUBLISHED,{endpointId:e.body.roomEndpointId,mediaType:"video",operator:e.body.operator}]),[SocketConfServiceEvents.RoomEndpointTurnVideoOn]:e=>(this.Be.updateMember(e.body.roomEndpointId,{options:{isVideoOff:!1}}),[RoomEventType.USER_PUBLISHED,{endpointId:e.body.roomEndpointId,mediaType:"video"}]),[SocketConfServiceEvents.RoomEndpointUnmuteV2]:e=>(this.Be.updateMember(e.body.roomEndpointId,{options:{isMute:!1}}),[RoomEventType.USER_PUBLISHED,{endpointId:e.body.roomEndpointId,mediaType:"audio"}]),[SocketConfServiceEvents.MediaRejectUnmute]:e=>[RoomEventType.AUDIO_REJECT_UNMUTE,e.body],[SocketConfServiceEvents.MediaRejectUnmuteVideo]:e=>[RoomEventType.VIDEO_REJECT_TURNON,e.body],[SocketConfServiceEvents.RoomChangeView]:e=>(this.Be.updateRoomState({presenter:e.body.presenter,viewState:e.body.viewState}),[RoomEventType.ROOM_VIEW_UPDATED,e.body]),[SocketConfServiceEvents.RoomClose]:e=>[RoomEventType.ROOM_CLOSE,null],[SocketConfServiceEvents.SessionRecordStatusUpdate]:e=>[RoomEventType.ROOM_RECORD_STATUS_UPDATED,e.body],[SocketConfServiceEvents.SessionMainVenueUpdate]:e=>[RoomEventType.ROOM_MAIN_VENUE_UPDATED,e.body],[SocketConfServiceEvents.RoomInfoUpdate]:e=>[RoomEventType.ROOM_INFO_UPDATED,e.body],[SocketConfServiceEvents.RoomLayoutChanged]:e=>[RoomEventType.ROOM_LAYOUT_UPDATED,e.body],[SocketConfServiceEvents.RoomOptionUpdate]:e=>[RoomEventType.ROOM_OPTION_UPDATED,e.body],[SocketConfServiceEvents.MediaRequestUnmute]:e=>{const{operator:t,autoAccept:r}=e.body;return[RoomEventType.AUDIO_REQUEST_UNMUTE,{autoAccept:r,operator:t}]},[SocketConfServiceEvents.MediaRequestUnmuteVideo]:e=>[RoomEventType.VIDEO_REQUEST_TURNON,e.body],[SocketConfServiceEvents.SessionClose]:e=>[RoomEventType.ROOM_CLOSE,null],[SocketConfServiceEvents.HangupStatusUpdated]:e=>[RoomEventType.USER_HANG_STATUS_UPDATED,e.body],[SocketConfServiceEvents.SocketStateChange]:e=>[RoomEventType.CONNECTION_STATE_CHANGE,{...e}]},this.te=e.socket,this.J=e.emitter,this.Be=e.model}registerSocketEvent(){this.te.onAll(((e,t)=>{const r=this.Le[e];if("function"==typeof r){const e=r(t);this.J.emit(e[0],e[1])}}))}};var cryptoJsExports={},cryptoJs={get exports(){return cryptoJsExports},set exports(e){cryptoJsExports=e}};function commonjsRequire(e){throw new Error('Could not dynamically require "'+e+'". Please configure the dynamicRequireTargets or/and ignoreDynamicRequires option of @rollup/plugin-commonjs appropriately for this require call to work.')}var coreExports={},core={get exports(){return coreExports},set exports(e){coreExports=e}},hasRequiredCore;function requireCore(){return hasRequiredCore||(hasRequiredCore=1,function(e,t){var r;e.exports=(r=r||function(e,t){var r;if("undefined"!=typeof window&&window.crypto&&(r=window.crypto),"undefined"!=typeof self&&self.crypto&&(r=self.crypto),"undefined"!=typeof globalThis&&globalThis.crypto&&(r=globalThis.crypto),!r&&"undefined"!=typeof window&&window.msCrypto&&(r=window.msCrypto),!r&&void 0!==commonjsGlobal&&commonjsGlobal.crypto&&(r=commonjsGlobal.crypto),!r&&"function"==typeof commonjsRequire)try{r=require$$0}catch(e){}var i=function(){if(r){if("function"==typeof r.getRandomValues)try{return r.getRandomValues(new Uint32Array(1))[0]}catch(e){}if("function"==typeof r.randomBytes)try{return r.randomBytes(4).readInt32LE()}catch(e){}}throw new Error("Native crypto module could not be used to get secure random number.")},n=Object.create||function(){function e(){}return function(t){var r;return e.prototype=t,r=new e,e.prototype=null,r}}(),s={},o=s.lib={},a=o.Base={extend:function(e){var t=n(this);return e&&t.mixIn(e),t.hasOwnProperty("init")&&this.init!==t.init||(t.init=function(){t.$super.init.apply(this,arguments)}),t.init.prototype=t,t.$super=this,t},create:function(){var e=this.extend();return e.init.apply(e,arguments),e},init:function(){},mixIn:function(e){for(var t in e)e.hasOwnProperty(t)&&(this[t]=e[t]);e.hasOwnProperty("toString")&&(this.toString=e.toString)},clone:function(){return this.init.prototype.extend(this)}},c=o.WordArray=a.extend({init:function(e,t){e=this.words=e||[],this.sigBytes=null!=t?t:4*e.length},toString:function(e){return(e||h).stringify(this)},concat:function(e){var t=this.words,r=e.words,i=this.sigBytes,n=e.sigBytes;if(this.clamp(),i%4)for(var s=0;s<n;s++){var o=r[s>>>2]>>>24-s%4*8&255;t[i+s>>>2]|=o<<24-(i+s)%4*8}else for(var a=0;a<n;a+=4)t[i+a>>>2]=r[a>>>2];return this.sigBytes+=n,this},clamp:function(){var t=this.words,r=this.sigBytes;t[r>>>2]&=4294967295<<32-r%4*8,t.length=e.ceil(r/4)},clone:function(){var e=a.clone.call(this);return e.words=this.words.slice(0),e},random:function(e){for(var t=[],r=0;r<e;r+=4)t.push(i());return new c.init(t,e)}}),u=s.enc={},h=u.Hex={stringify:function(e){for(var t=e.words,r=e.sigBytes,i=[],n=0;n<r;n++){var s=t[n>>>2]>>>24-n%4*8&255;i.push((s>>>4).toString(16)),i.push((15&s).toString(16))}return i.join("")},parse:function(e){for(var t=e.length,r=[],i=0;i<t;i+=2)r[i>>>3]|=parseInt(e.substr(i,2),16)<<24-i%8*4;return new c.init(r,t/2)}},d=u.Latin1={stringify:function(e){for(var t=e.words,r=e.sigBytes,i=[],n=0;n<r;n++){var s=t[n>>>2]>>>24-n%4*8&255;i.push(String.fromCharCode(s))}return i.join("")},parse:function(e){for(var t=e.length,r=[],i=0;i<t;i++)r[i>>>2]|=(255&e.charCodeAt(i))<<24-i%4*8;return new c.init(r,t)}},f=u.Utf8={stringify:function(e){try{return decodeURIComponent(escape(d.stringify(e)))}catch(e){throw new Error("Malformed UTF-8 data")}},parse:function(e){return d.parse(unescape(encodeURIComponent(e)))}},l=o.BufferedBlockAlgorithm=a.extend({reset:function(){this.Fe=new c.init,this.He=0},Ue:function(e){"string"==typeof e&&(e=f.parse(e)),this.Fe.concat(e),this.He+=e.sigBytes},Ve:function(t){var r,i=this.Fe,n=i.words,s=i.sigBytes,o=this.blockSize,a=s/(4*o),u=(a=t?e.ceil(a):e.max((0|a)-this.Ge,0))*o,h=e.min(4*u,s);if(u){for(var d=0;d<u;d+=o)this.Ke(n,d);r=n.splice(0,u),i.sigBytes-=h}return new c.init(r,h)},clone:function(){var e=a.clone.call(this);return e.Fe=this.Fe.clone(),e},Ge:0});o.Hasher=l.extend({cfg:a.extend(),init:function(e){this.cfg=this.cfg.extend(e),this.reset()},reset:function(){l.reset.call(this),this.We()},update:function(e){return this.Ue(e),this.Ve(),this},finalize:function(e){return e&&this.Ue(e),this.ze()},blockSize:16,Xe:function(e){return function(t,r){return new e.init(r).finalize(t)}},Je:function(e){return function(t,r){return new p.HMAC.init(e,r).finalize(t)}}});var p=s.algo={};return s}(Math),r)}(core)),coreExports}var x64CoreExports={},x64Core={get exports(){return x64CoreExports},set exports(e){x64CoreExports=e}},hasRequiredX64Core;function requireX64Core(){return hasRequiredX64Core||(hasRequiredX64Core=1,function(e,t){var r,i,n,s,o,a;e.exports=(i=(r=a=requireCore()).lib,n=i.Base,s=i.WordArray,(o=r.x64={}).Word=n.extend({init:function(e,t){this.high=e,this.low=t}}),o.WordArray=n.extend({init:function(e,t){e=this.words=e||[],this.sigBytes=null!=t?t:8*e.length},toX32:function(){for(var e=this.words,t=e.length,r=[],i=0;i<t;i++){var n=e[i];r.push(n.high),r.push(n.low)}return s.create(r,this.sigBytes)},clone:function(){for(var e=n.clone.call(this),t=e.words=this.words.slice(0),r=t.length,i=0;i<r;i++)t[i]=t[i].clone();return e}}),a)}(x64Core)),x64CoreExports}var libTypedarraysExports={},libTypedarrays={get exports(){return libTypedarraysExports},set exports(e){libTypedarraysExports=e}},hasRequiredLibTypedarrays;function requireLibTypedarrays(){return hasRequiredLibTypedarrays||(hasRequiredLibTypedarrays=1,function(e,t){var r;e.exports=(r=requireCore(),function(){if("function"==typeof ArrayBuffer){var e=r.lib.WordArray,t=e.init,i=e.init=function(e){if(e instanceof ArrayBuffer&&(e=new Uint8Array(e)),(e instanceof Int8Array||"undefined"!=typeof Uint8ClampedArray&&e instanceof Uint8ClampedArray||e instanceof Int16Array||e instanceof Uint16Array||e instanceof Int32Array||e instanceof Uint32Array||e instanceof Float32Array||e instanceof Float64Array)&&(e=new Uint8Array(e.buffer,e.byteOffset,e.byteLength)),e instanceof Uint8Array){for(var r=e.byteLength,i=[],n=0;n<r;n++)i[n>>>2]|=e[n]<<24-n%4*8;t.call(this,i,r)}else t.apply(this,arguments)};i.prototype=e}}(),r.lib.WordArray)}(libTypedarrays)),libTypedarraysExports}var encUtf16Exports={},encUtf16={get exports(){return encUtf16Exports},set exports(e){encUtf16Exports=e}},hasRequiredEncUtf16;function requireEncUtf16(){return hasRequiredEncUtf16||(hasRequiredEncUtf16=1,function(e,t){var r;e.exports=(r=requireCore(),function(){var e=r,t=e.lib.WordArray,i=e.enc;function n(e){return e<<8&4278255360|e>>>8&16711935}i.Utf16=i.Utf16BE={stringify:function(e){for(var t=e.words,r=e.sigBytes,i=[],n=0;n<r;n+=2){var s=t[n>>>2]>>>16-n%4*8&65535;i.push(String.fromCharCode(s))}return i.join("")},parse:function(e){for(var r=e.length,i=[],n=0;n<r;n++)i[n>>>1]|=e.charCodeAt(n)<<16-n%2*16;return t.create(i,2*r)}},i.Utf16LE={stringify:function(e){for(var t=e.words,r=e.sigBytes,i=[],s=0;s<r;s+=2){var o=n(t[s>>>2]>>>16-s%4*8&65535);i.push(String.fromCharCode(o))}return i.join("")},parse:function(e){for(var r=e.length,i=[],s=0;s<r;s++)i[s>>>1]|=n(e.charCodeAt(s)<<16-s%2*16);return t.create(i,2*r)}}}(),r.enc.Utf16)}(encUtf16)),encUtf16Exports}var encBase64Exports={},encBase64={get exports(){return encBase64Exports},set exports(e){encBase64Exports=e}},hasRequiredEncBase64;function requireEncBase64(){return hasRequiredEncBase64||(hasRequiredEncBase64=1,function(e,t){var r,i,n;e.exports=(r=requireCore(),n=(i=r).lib.WordArray,i.enc.Base64={stringify:function(e){var t=e.words,r=e.sigBytes,i=this.Ye;e.clamp();for(var n=[],s=0;s<r;s+=3)for(var o=(t[s>>>2]>>>24-s%4*8&255)<<16|(t[s+1>>>2]>>>24-(s+1)%4*8&255)<<8|t[s+2>>>2]>>>24-(s+2)%4*8&255,a=0;a<4&&s+.75*a<r;a++)n.push(i.charAt(o>>>6*(3-a)&63));var c=i.charAt(64);if(c)for(;n.length%4;)n.push(c);return n.join("")},parse:function(e){var t=e.length,r=this.Ye,i=this.Ze;if(!i){i=this.Ze=[];for(var s=0;s<r.length;s++)i[r.charCodeAt(s)]=s}var o=r.charAt(64);if(o){var a=e.indexOf(o);-1!==a&&(t=a)}return function(e,t,r){for(var i=[],s=0,o=0;o<t;o++)if(o%4){var a=r[e.charCodeAt(o-1)]<<o%4*2|r[e.charCodeAt(o)]>>>6-o%4*2;i[s>>>2]|=a<<24-s%4*8,s++}return n.create(i,s)}(e,t,i)},Ye:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/="},r.enc.Base64)}(encBase64)),encBase64Exports}var encBase64urlExports={},encBase64url={get exports(){return encBase64urlExports},set exports(e){encBase64urlExports=e}},hasRequiredEncBase64url;function requireEncBase64url(){return hasRequiredEncBase64url||(hasRequiredEncBase64url=1,function(e,t){var r,i,n;e.exports=(r=requireCore(),n=(i=r).lib.WordArray,i.enc.Base64url={stringify:function(e,t=!0){var r=e.words,i=e.sigBytes,n=t?this.Qe:this.Ye;e.clamp();for(var s=[],o=0;o<i;o+=3)for(var a=(r[o>>>2]>>>24-o%4*8&255)<<16|(r[o+1>>>2]>>>24-(o+1)%4*8&255)<<8|r[o+2>>>2]>>>24-(o+2)%4*8&255,c=0;c<4&&o+.75*c<i;c++)s.push(n.charAt(a>>>6*(3-c)&63));var u=n.charAt(64);if(u)for(;s.length%4;)s.push(u);return s.join("")},parse:function(e,t=!0){var r=e.length,i=t?this.Qe:this.Ye,s=this.Ze;if(!s){s=this.Ze=[];for(var o=0;o<i.length;o++)s[i.charCodeAt(o)]=o}var a=i.charAt(64);if(a){var c=e.indexOf(a);-1!==c&&(r=c)}return function(e,t,r){for(var i=[],s=0,o=0;o<t;o++)if(o%4){var a=r[e.charCodeAt(o-1)]<<o%4*2|r[e.charCodeAt(o)]>>>6-o%4*2;i[s>>>2]|=a<<24-s%4*8,s++}return n.create(i,s)}(e,r,s)},Ye:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=",Qe:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789-_"},r.enc.Base64url)}(encBase64url)),encBase64urlExports}var md5Exports={},md5={get exports(){return md5Exports},set exports(e){md5Exports=e}},hasRequiredMd5;function requireMd5(){return hasRequiredMd5||(hasRequiredMd5=1,function(e,t){var r;e.exports=(r=requireCore(),function(e){var t=r,i=t.lib,n=i.WordArray,s=i.Hasher,o=t.algo,a=[];!function(){for(var t=0;t<64;t++)a[t]=4294967296*e.abs(e.sin(t+1))|0}();var c=o.MD5=s.extend({We:function(){this.et=new n.init([1732584193,4023233417,2562383102,271733878])},Ke:function(e,t){for(var r=0;r<16;r++){var i=t+r,n=e[i];e[i]=16711935&(n<<8|n>>>24)|4278255360&(n<<24|n>>>8)}var s=this.et.words,o=e[t+0],c=e[t+1],l=e[t+2],p=e[t+3],v=e[t+4],b=e[t+5],m=e[t+6],g=e[t+7],y=e[t+8],w=e[t+9],$=e[t+10],S=e[t+11],k=e[t+12],E=e[t+13],x=e[t+14],C=e[t+15],A=s[0],_=s[1],T=s[2],R=s[3];A=u(A,_,T,R,o,7,a[0]),R=u(R,A,_,T,c,12,a[1]),T=u(T,R,A,_,l,17,a[2]),_=u(_,T,R,A,p,22,a[3]),A=u(A,_,T,R,v,7,a[4]),R=u(R,A,_,T,b,12,a[5]),T=u(T,R,A,_,m,17,a[6]),_=u(_,T,R,A,g,22,a[7]),A=u(A,_,T,R,y,7,a[8]),R=u(R,A,_,T,w,12,a[9]),T=u(T,R,A,_,$,17,a[10]),_=u(_,T,R,A,S,22,a[11]),A=u(A,_,T,R,k,7,a[12]),R=u(R,A,_,T,E,12,a[13]),T=u(T,R,A,_,x,17,a[14]),A=h(A,_=u(_,T,R,A,C,22,a[15]),T,R,c,5,a[16]),R=h(R,A,_,T,m,9,a[17]),T=h(T,R,A,_,S,14,a[18]),_=h(_,T,R,A,o,20,a[19]),A=h(A,_,T,R,b,5,a[20]),R=h(R,A,_,T,$,9,a[21]),T=h(T,R,A,_,C,14,a[22]),_=h(_,T,R,A,v,20,a[23]),A=h(A,_,T,R,w,5,a[24]),R=h(R,A,_,T,x,9,a[25]),T=h(T,R,A,_,p,14,a[26]),_=h(_,T,R,A,y,20,a[27]),A=h(A,_,T,R,E,5,a[28]),R=h(R,A,_,T,l,9,a[29]),T=h(T,R,A,_,g,14,a[30]),A=d(A,_=h(_,T,R,A,k,20,a[31]),T,R,b,4,a[32]),R=d(R,A,_,T,y,11,a[33]),T=d(T,R,A,_,S,16,a[34]),_=d(_,T,R,A,x,23,a[35]),A=d(A,_,T,R,c,4,a[36]),R=d(R,A,_,T,v,11,a[37]),T=d(T,R,A,_,g,16,a[38]),_=d(_,T,R,A,$,23,a[39]),A=d(A,_,T,R,E,4,a[40]),R=d(R,A,_,T,o,11,a[41]),T=d(T,R,A,_,p,16,a[42]),_=d(_,T,R,A,m,23,a[43]),A=d(A,_,T,R,w,4,a[44]),R=d(R,A,_,T,k,11,a[45]),T=d(T,R,A,_,C,16,a[46]),A=f(A,_=d(_,T,R,A,l,23,a[47]),T,R,o,6,a[48]),R=f(R,A,_,T,g,10,a[49]),T=f(T,R,A,_,x,15,a[50]),_=f(_,T,R,A,b,21,a[51]),A=f(A,_,T,R,k,6,a[52]),R=f(R,A,_,T,p,10,a[53]),T=f(T,R,A,_,$,15,a[54]),_=f(_,T,R,A,c,21,a[55]),A=f(A,_,T,R,y,6,a[56]),R=f(R,A,_,T,C,10,a[57]),T=f(T,R,A,_,m,15,a[58]),_=f(_,T,R,A,E,21,a[59]),A=f(A,_,T,R,v,6,a[60]),R=f(R,A,_,T,S,10,a[61]),T=f(T,R,A,_,l,15,a[62]),_=f(_,T,R,A,w,21,a[63]),s[0]=s[0]+A|0,s[1]=s[1]+_|0,s[2]=s[2]+T|0,s[3]=s[3]+R|0},ze:function(){var t=this.Fe,r=t.words,i=8*this.He,n=8*t.sigBytes;r[n>>>5]|=128<<24-n%32;var s=e.floor(i/4294967296),o=i;r[15+(n+64>>>9<<4)]=16711935&(s<<8|s>>>24)|4278255360&(s<<24|s>>>8),r[14+(n+64>>>9<<4)]=16711935&(o<<8|o>>>24)|4278255360&(o<<24|o>>>8),t.sigBytes=4*(r.length+1),this.Ve();for(var a=this.et,c=a.words,u=0;u<4;u++){var h=c[u];c[u]=16711935&(h<<8|h>>>24)|4278255360&(h<<24|h>>>8)}return a},clone:function(){var e=s.clone.call(this);return e.et=this.et.clone(),e}});function u(e,t,r,i,n,s,o){var a=e+(t&r|~t&i)+n+o;return(a<<s|a>>>32-s)+t}function h(e,t,r,i,n,s,o){var a=e+(t&i|r&~i)+n+o;return(a<<s|a>>>32-s)+t}function d(e,t,r,i,n,s,o){var a=e+(t^r^i)+n+o;return(a<<s|a>>>32-s)+t}function f(e,t,r,i,n,s,o){var a=e+(r^(t|~i))+n+o;return(a<<s|a>>>32-s)+t}t.MD5=s.Xe(c),t.HmacMD5=s.Je(c)}(Math),r.MD5)}(md5)),md5Exports}var sha1Exports={},sha1={get exports(){return sha1Exports},set exports(e){sha1Exports=e}},hasRequiredSha1;function requireSha1(){return hasRequiredSha1||(hasRequiredSha1=1,function(e,t){var r,i,n,s,o,a,c,u;e.exports=(i=(r=u=requireCore()).lib,n=i.WordArray,s=i.Hasher,o=r.algo,a=[],c=o.SHA1=s.extend({We:function(){this.et=new n.init([1732584193,4023233417,2562383102,271733878,3285377520])},Ke:function(e,t){for(var r=this.et.words,i=r[0],n=r[1],s=r[2],o=r[3],c=r[4],u=0;u<80;u++){if(u<16)a[u]=0|e[t+u];else{var h=a[u-3]^a[u-8]^a[u-14]^a[u-16];a[u]=h<<1|h>>>31}var d=(i<<5|i>>>27)+c+a[u];d+=u<20?1518500249+(n&s|~n&o):u<40?1859775393+(n^s^o):u<60?(n&s|n&o|s&o)-1894007588:(n^s^o)-899497514,c=o,o=s,s=n<<30|n>>>2,n=i,i=d}r[0]=r[0]+i|0,r[1]=r[1]+n|0,r[2]=r[2]+s|0,r[3]=r[3]+o|0,r[4]=r[4]+c|0},ze:function(){var e=this.Fe,t=e.words,r=8*this.He,i=8*e.sigBytes;return t[i>>>5]|=128<<24-i%32,t[14+(i+64>>>9<<4)]=Math.floor(r/4294967296),t[15+(i+64>>>9<<4)]=r,e.sigBytes=4*t.length,this.Ve(),this.et},clone:function(){var e=s.clone.call(this);return e.et=this.et.clone(),e}}),r.SHA1=s.Xe(c),r.HmacSHA1=s.Je(c),u.SHA1)}(sha1)),sha1Exports}var sha256Exports$1={},sha256$1={get exports(){return sha256Exports$1},set exports(e){sha256Exports$1=e}},hasRequiredSha256;function requireSha256(){return hasRequiredSha256||(hasRequiredSha256=1,function(e,t){var r;e.exports=(r=requireCore(),function(e){var t=r,i=t.lib,n=i.WordArray,s=i.Hasher,o=t.algo,a=[],c=[];!function(){function t(t){for(var r=e.sqrt(t),i=2;i<=r;i++)if(!(t%i))return!1;return!0}function r(e){return 4294967296*(e-(0|e))|0}for(var i=2,n=0;n<64;)t(i)&&(n<8&&(a[n]=r(e.pow(i,.5))),c[n]=r(e.pow(i,1/3)),n++),i++}();var u=[],h=o.SHA256=s.extend({We:function(){this.et=new n.init(a.slice(0))},Ke:function(e,t){for(var r=this.et.words,i=r[0],n=r[1],s=r[2],o=r[3],a=r[4],h=r[5],d=r[6],f=r[7],l=0;l<64;l++){if(l<16)u[l]=0|e[t+l];else{var p=u[l-15],v=(p<<25|p>>>7)^(p<<14|p>>>18)^p>>>3,b=u[l-2],m=(b<<15|b>>>17)^(b<<13|b>>>19)^b>>>10;u[l]=v+u[l-7]+m+u[l-16]}var g=i&n^i&s^n&s,y=(i<<30|i>>>2)^(i<<19|i>>>13)^(i<<10|i>>>22),w=f+((a<<26|a>>>6)^(a<<21|a>>>11)^(a<<7|a>>>25))+(a&h^~a&d)+c[l]+u[l];f=d,d=h,h=a,a=o+w|0,o=s,s=n,n=i,i=w+(y+g)|0}r[0]=r[0]+i|0,r[1]=r[1]+n|0,r[2]=r[2]+s|0,r[3]=r[3]+o|0,r[4]=r[4]+a|0,r[5]=r[5]+h|0,r[6]=r[6]+d|0,r[7]=r[7]+f|0},ze:function(){var t=this.Fe,r=t.words,i=8*this.He,n=8*t.sigBytes;return r[n>>>5]|=128<<24-n%32,r[14+(n+64>>>9<<4)]=e.floor(i/4294967296),r[15+(n+64>>>9<<4)]=i,t.sigBytes=4*r.length,this.Ve(),this.et},clone:function(){var e=s.clone.call(this);return e.et=this.et.clone(),e}});t.SHA256=s.Xe(h),t.HmacSHA256=s.Je(h)}(Math),r.SHA256)}(sha256$1)),sha256Exports$1}var sha224Exports={},sha224={get exports(){return sha224Exports},set exports(e){sha224Exports=e}},hasRequiredSha224;function requireSha224(){return hasRequiredSha224||(hasRequiredSha224=1,function(e,t){var r,i,n,s,o,a;e.exports=(a=requireCore(),requireSha256(),i=(r=a).lib.WordArray,n=r.algo,s=n.SHA256,o=n.SHA224=s.extend({We:function(){this.et=new i.init([3238371032,914150663,812702999,4144912697,4290775857,1750603025,1694076839,3204075428])},ze:function(){var e=s.ze.call(this);return e.sigBytes-=4,e}}),r.SHA224=s.Xe(o),r.HmacSHA224=s.Je(o),a.SHA224)}(sha224)),sha224Exports}var sha512Exports={},sha512={get exports(){return sha512Exports},set exports(e){sha512Exports=e}},hasRequiredSha512;function requireSha512(){return hasRequiredSha512||(hasRequiredSha512=1,function(e,t){var r;e.exports=(r=requireCore(),requireX64Core(),function(){var e=r,t=e.lib.Hasher,i=e.x64,n=i.Word,s=i.WordArray,o=e.algo;function a(){return n.create.apply(n,arguments)}var c=[a(1116352408,3609767458),a(1899447441,602891725),a(3049323471,3964484399),a(3921009573,2173295548),a(961987163,4081628472),a(1508970993,3053834265),a(2453635748,2937671579),a(2870763221,3664609560),a(3624381080,2734883394),a(310598401,1164996542),a(607225278,1323610764),a(1426881987,3590304994),a(1925078388,4068182383),a(2162078206,991336113),a(2614888103,633803317),a(3248222580,3479774868),a(3835390401,2666613458),a(4022224774,944711139),a(264347078,2341262773),a(604807628,2007800933),a(770255983,1495990901),a(1249150122,1856431235),a(1555081692,3175218132),a(1996064986,2198950837),a(2554220882,3999719339),a(2821834349,766784016),a(2952996808,2566594879),a(3210313671,3203337956),a(3336571891,1034457026),a(3584528711,2466948901),a(113926993,3758326383),a(338241895,168717936),a(666307205,1188179964),a(773529912,1546045734),a(1294757372,1522805485),a(1396182291,2643833823),a(1695183700,2343527390),a(1986661051,1014477480),a(2177026350,1206759142),a(2456956037,344077627),a(2730485921,1290863460),a(2820302411,3158454273),a(3259730800,3505952657),a(3345764771,106217008),a(3516065817,3606008344),a(3600352804,1432725776),a(4094571909,1467031594),a(275423344,851169720),a(430227734,3100823752),a(506948616,1363258195),a(659060556,3750685593),a(883997877,3785050280),a(958139571,3318307427),a(1322822218,3812723403),a(1537002063,2003034995),a(1747873779,3602036899),a(1955562222,1575990012),a(2024104815,1125592928),a(2227730452,2716904306),a(2361852424,442776044),a(2428436474,593698344),a(2756734187,3733110249),a(3204031479,2999351573),a(3329325298,3815920427),a(3391569614,3928383900),a(3515267271,566280711),a(3940187606,3454069534),a(4118630271,4000239992),a(116418474,1914138554),a(174292421,2731055270),a(289380356,3203993006),a(460393269,320620315),a(685471733,587496836),a(852142971,1086792851),a(1017036298,365543100),a(1126000580,2618297676),a(1288033470,3409855158),a(1501505948,4234509866),a(1607167915,987167468),a(1816402316,1246189591)],u=[];!function(){for(var e=0;e<80;e++)u[e]=a()}();var h=o.SHA512=t.extend({We:function(){this.et=new s.init([new n.init(1779033703,4089235720),new n.init(3144134277,2227873595),new n.init(1013904242,4271175723),new n.init(2773480762,1595750129),new n.init(1359893119,2917565137),new n.init(2600822924,725511199),new n.init(528734635,4215389547),new n.init(1541459225,327033209)])},Ke:function(e,t){for(var r=this.et.words,i=r[0],n=r[1],s=r[2],o=r[3],a=r[4],h=r[5],d=r[6],f=r[7],l=i.high,p=i.low,v=n.high,b=n.low,m=s.high,g=s.low,y=o.high,w=o.low,$=a.high,S=a.low,k=h.high,E=h.low,x=d.high,C=d.low,A=f.high,_=f.low,T=l,R=p,O=v,I=b,j=m,M=g,q=y,N=w,P=$,D=S,L=k,B=E,F=x,H=C,U=A,V=_,G=0;G<80;G++){var K,W,z=u[G];if(G<16)W=z.high=0|e[t+2*G],K=z.low=0|e[t+2*G+1];else{var X=u[G-15],J=X.high,Y=X.low,Z=(J>>>1|Y<<31)^(J>>>8|Y<<24)^J>>>7,Q=(Y>>>1|J<<31)^(Y>>>8|J<<24)^(Y>>>7|J<<25),ee=u[G-2],te=ee.high,re=ee.low,ie=(te>>>19|re<<13)^(te<<3|re>>>29)^te>>>6,ne=(re>>>19|te<<13)^(re<<3|te>>>29)^(re>>>6|te<<26),se=u[G-7],oe=se.high,ae=se.low,ce=u[G-16],ue=ce.high,he=ce.low;W=(W=(W=Z+oe+((K=Q+ae)>>>0<Q>>>0?1:0))+ie+((K+=ne)>>>0<ne>>>0?1:0))+ue+((K+=he)>>>0<he>>>0?1:0),z.high=W,z.low=K}var de,fe=P&L^~P&F,le=D&B^~D&H,pe=T&O^T&j^O&j,ve=R&I^R&M^I&M,be=(T>>>28|R<<4)^(T<<30|R>>>2)^(T<<25|R>>>7),me=(R>>>28|T<<4)^(R<<30|T>>>2)^(R<<25|T>>>7),ge=(P>>>14|D<<18)^(P>>>18|D<<14)^(P<<23|D>>>9),ye=(D>>>14|P<<18)^(D>>>18|P<<14)^(D<<23|P>>>9),we=c[G],$e=we.high,Se=we.low,ke=U+ge+((de=V+ye)>>>0<V>>>0?1:0),Ee=me+ve;U=F,V=H,F=L,H=B,L=P,B=D,P=q+(ke=(ke=(ke=ke+fe+((de+=le)>>>0<le>>>0?1:0))+$e+((de+=Se)>>>0<Se>>>0?1:0))+W+((de+=K)>>>0<K>>>0?1:0))+((D=N+de|0)>>>0<N>>>0?1:0)|0,q=j,N=M,j=O,M=I,O=T,I=R,T=ke+(be+pe+(Ee>>>0<me>>>0?1:0))+((R=de+Ee|0)>>>0<de>>>0?1:0)|0}p=i.low=p+R,i.high=l+T+(p>>>0<R>>>0?1:0),b=n.low=b+I,n.high=v+O+(b>>>0<I>>>0?1:0),g=s.low=g+M,s.high=m+j+(g>>>0<M>>>0?1:0),w=o.low=w+N,o.high=y+q+(w>>>0<N>>>0?1:0),S=a.low=S+D,a.high=$+P+(S>>>0<D>>>0?1:0),E=h.low=E+B,h.high=k+L+(E>>>0<B>>>0?1:0),C=d.low=C+H,d.high=x+F+(C>>>0<H>>>0?1:0),_=f.low=_+V,f.high=A+U+(_>>>0<V>>>0?1:0)},ze:function(){var e=this.Fe,t=e.words,r=8*this.He,i=8*e.sigBytes;return t[i>>>5]|=128<<24-i%32,t[30+(i+128>>>10<<5)]=Math.floor(r/4294967296),t[31+(i+128>>>10<<5)]=r,e.sigBytes=4*t.length,this.Ve(),this.et.toX32()},clone:function(){var e=t.clone.call(this);return e.et=this.et.clone(),e},blockSize:32});e.SHA512=t.Xe(h),e.HmacSHA512=t.Je(h)}(),r.SHA512)}(sha512)),sha512Exports}var sha384Exports={},sha384={get exports(){return sha384Exports},set exports(e){sha384Exports=e}},hasRequiredSha384;function requireSha384(){return hasRequiredSha384||(hasRequiredSha384=1,function(e,t){var r,i,n,s,o,a,c,u;e.exports=(u=requireCore(),requireX64Core(),requireSha512(),i=(r=u).x64,n=i.Word,s=i.WordArray,o=r.algo,a=o.SHA512,c=o.SHA384=a.extend({We:function(){this.et=new s.init([new n.init(3418070365,3238371032),new n.init(1654270250,914150663),new n.init(2438529370,812702999),new n.init(355462360,4144912697),new n.init(1731405415,4290775857),new n.init(2394180231,1750603025),new n.init(3675008525,1694076839),new n.init(1203062813,3204075428)])},ze:function(){var e=a.ze.call(this);return e.sigBytes-=16,e}}),r.SHA384=a.Xe(c),r.HmacSHA384=a.Je(c),u.SHA384)}(sha384)),sha384Exports}var sha3Exports={},sha3={get exports(){return sha3Exports},set exports(e){sha3Exports=e}},hasRequiredSha3;function requireSha3(){return hasRequiredSha3||(hasRequiredSha3=1,function(e,t){var r;e.exports=(r=requireCore(),requireX64Core(),function(e){var t=r,i=t.lib,n=i.WordArray,s=i.Hasher,o=t.x64.Word,a=t.algo,c=[],u=[],h=[];!function(){for(var e=1,t=0,r=0;r<24;r++){c[e+5*t]=(r+1)*(r+2)/2%64;var i=(2*e+3*t)%5;e=t%5,t=i}for(e=0;e<5;e++)for(t=0;t<5;t++)u[e+5*t]=t+(2*e+3*t)%5*5;for(var n=1,s=0;s<24;s++){for(var a=0,d=0,f=0;f<7;f++){if(1&n){var l=(1<<f)-1;l<32?d^=1<<l:a^=1<<l-32}128&n?n=n<<1^113:n<<=1}h[s]=o.create(a,d)}}();var d=[];!function(){for(var e=0;e<25;e++)d[e]=o.create()}();var f=a.SHA3=s.extend({cfg:s.cfg.extend({outputLength:512}),We:function(){for(var e=this.tt=[],t=0;t<25;t++)e[t]=new o.init;this.blockSize=(1600-2*this.cfg.outputLength)/32},Ke:function(e,t){for(var r=this.tt,i=this.blockSize/2,n=0;n<i;n++){var s=e[t+2*n],o=e[t+2*n+1];s=16711935&(s<<8|s>>>24)|4278255360&(s<<24|s>>>8),o=16711935&(o<<8|o>>>24)|4278255360&(o<<24|o>>>8),(_=r[n]).high^=o,_.low^=s}for(var a=0;a<24;a++){for(var f=0;f<5;f++){for(var l=0,p=0,v=0;v<5;v++)l^=(_=r[f+5*v]).high,p^=_.low;var b=d[f];b.high=l,b.low=p}for(f=0;f<5;f++){var m=d[(f+4)%5],g=d[(f+1)%5],y=g.high,w=g.low;for(l=m.high^(y<<1|w>>>31),p=m.low^(w<<1|y>>>31),v=0;v<5;v++)(_=r[f+5*v]).high^=l,_.low^=p}for(var $=1;$<25;$++){var S=(_=r[$]).high,k=_.low,E=c[$];E<32?(l=S<<E|k>>>32-E,p=k<<E|S>>>32-E):(l=k<<E-32|S>>>64-E,p=S<<E-32|k>>>64-E);var x=d[u[$]];x.high=l,x.low=p}var C=d[0],A=r[0];for(C.high=A.high,C.low=A.low,f=0;f<5;f++)for(v=0;v<5;v++){var _=r[$=f+5*v],T=d[$],R=d[(f+1)%5+5*v],O=d[(f+2)%5+5*v];_.high=T.high^~R.high&O.high,_.low=T.low^~R.low&O.low}_=r[0];var I=h[a];_.high^=I.high,_.low^=I.low}},ze:function(){var t=this.Fe,r=t.words;this.He;var i=8*t.sigBytes,s=32*this.blockSize;r[i>>>5]|=1<<24-i%32,r[(e.ceil((i+1)/s)*s>>>5)-1]|=128,t.sigBytes=4*r.length,this.Ve();for(var o=this.tt,a=this.cfg.outputLength/8,c=a/8,u=[],h=0;h<c;h++){var d=o[h],f=d.high,l=d.low;f=16711935&(f<<8|f>>>24)|4278255360&(f<<24|f>>>8),l=16711935&(l<<8|l>>>24)|4278255360&(l<<24|l>>>8),u.push(l),u.push(f)}return new n.init(u,a)},clone:function(){for(var e=s.clone.call(this),t=e.tt=this.tt.slice(0),r=0;r<25;r++)t[r]=t[r].clone();return e}});t.SHA3=s.Xe(f),t.HmacSHA3=s.Je(f)}(Math),r.SHA3)}(sha3)),sha3Exports}var ripemd160Exports={},ripemd160={get exports(){return ripemd160Exports},set exports(e){ripemd160Exports=e}},hasRequiredRipemd160;function requireRipemd160(){return hasRequiredRipemd160||(hasRequiredRipemd160=1,function(e,t){var r;e.exports=(r=requireCore(),
/** @preserve
  		  (c) 2012 by Cédric Mesnil. All rights reserved.
  		  	Redistribution and use in source and binary forms, with or without modification, are permitted provided that the following conditions are met:
  		  	    - Redistributions of source code must retain the above copyright notice, this list of conditions and the following disclaimer.
  		      - Redistributions in binary form must reproduce the above copyright notice, this list of conditions and the following disclaimer in the documentation and/or other materials provided with the distribution.
  		  	THIS SOFTWARE IS PROVIDED BY THE COPYRIGHT HOLDERS AND CONTRIBUTORS "AS IS" AND ANY EXPRESS OR IMPLIED WARRANTIES, INCLUDING, BUT NOT LIMITED TO, THE IMPLIED WARRANTIES OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE ARE DISCLAIMED. IN NO EVENT SHALL THE COPYRIGHT HOLDER OR CONTRIBUTORS BE LIABLE FOR ANY DIRECT, INDIRECT, INCIDENTAL, SPECIAL, EXEMPLARY, OR CONSEQUENTIAL DAMAGES (INCLUDING, BUT NOT LIMITED TO, PROCUREMENT OF SUBSTITUTE GOODS OR SERVICES; LOSS OF USE, DATA, OR PROFITS; OR BUSINESS INTERRUPTION) HOWEVER CAUSED AND ON ANY THEORY OF LIABILITY, WHETHER IN CONTRACT, STRICT LIABILITY, OR TORT (INCLUDING NEGLIGENCE OR OTHERWISE) ARISING IN ANY WAY OUT OF THE USE OF THIS SOFTWARE, EVEN IF ADVISED OF THE POSSIBILITY OF SUCH DAMAGE.
  		  */
function(e){var t=r,i=t.lib,n=i.WordArray,s=i.Hasher,o=t.algo,a=n.create([0,1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,7,4,13,1,10,6,15,3,12,0,9,5,2,14,11,8,3,10,14,4,9,15,8,1,2,7,0,6,13,11,5,12,1,9,11,10,0,8,12,4,13,3,7,15,14,5,6,2,4,0,5,9,7,12,2,10,14,1,3,8,11,6,15,13]),c=n.create([5,14,7,0,9,2,11,4,13,6,15,8,1,10,3,12,6,11,3,7,0,13,5,10,14,15,8,12,4,9,1,2,15,5,1,3,7,14,6,9,11,8,12,2,10,0,4,13,8,6,4,1,3,11,15,0,5,12,2,13,9,7,10,14,12,15,10,4,1,5,8,7,6,2,13,14,0,3,9,11]),u=n.create([11,14,15,12,5,8,7,9,11,13,14,15,6,7,9,8,7,6,8,13,11,9,7,15,7,12,15,9,11,7,13,12,11,13,6,7,14,9,13,15,14,8,13,6,5,12,7,5,11,12,14,15,14,15,9,8,9,14,5,6,8,6,5,12,9,15,5,11,6,8,13,12,5,12,13,14,11,8,5,6]),h=n.create([8,9,9,11,13,15,15,5,7,7,8,11,14,14,12,6,9,13,15,7,12,8,9,11,7,7,12,7,6,15,13,11,9,7,15,11,8,6,6,14,12,13,5,14,13,13,7,5,15,5,8,11,14,14,6,14,6,9,12,9,12,5,15,8,8,5,12,9,12,5,14,6,8,13,6,5,15,13,11,11]),d=n.create([0,1518500249,1859775393,2400959708,2840853838]),f=n.create([1352829926,1548603684,1836072691,2053994217,0]),l=o.RIPEMD160=s.extend({We:function(){this.et=n.create([1732584193,4023233417,2562383102,271733878,3285377520])},Ke:function(e,t){for(var r=0;r<16;r++){var i=t+r,n=e[i];e[i]=16711935&(n<<8|n>>>24)|4278255360&(n<<24|n>>>8)}var s,o,l,w,$,S,k,E,x,C,A,_=this.et.words,T=d.words,R=f.words,O=a.words,I=c.words,j=u.words,M=h.words;for(S=s=_[0],k=o=_[1],E=l=_[2],x=w=_[3],C=$=_[4],r=0;r<80;r+=1)A=s+e[t+O[r]]|0,A+=r<16?p(o,l,w)+T[0]:r<32?v(o,l,w)+T[1]:r<48?b(o,l,w)+T[2]:r<64?m(o,l,w)+T[3]:g(o,l,w)+T[4],A=(A=y(A|=0,j[r]))+$|0,s=$,$=w,w=y(l,10),l=o,o=A,A=S+e[t+I[r]]|0,A+=r<16?g(k,E,x)+R[0]:r<32?m(k,E,x)+R[1]:r<48?b(k,E,x)+R[2]:r<64?v(k,E,x)+R[3]:p(k,E,x)+R[4],A=(A=y(A|=0,M[r]))+C|0,S=C,C=x,x=y(E,10),E=k,k=A;A=_[1]+l+x|0,_[1]=_[2]+w+C|0,_[2]=_[3]+$+S|0,_[3]=_[4]+s+k|0,_[4]=_[0]+o+E|0,_[0]=A},ze:function(){var e=this.Fe,t=e.words,r=8*this.He,i=8*e.sigBytes;t[i>>>5]|=128<<24-i%32,t[14+(i+64>>>9<<4)]=16711935&(r<<8|r>>>24)|4278255360&(r<<24|r>>>8),e.sigBytes=4*(t.length+1),this.Ve();for(var n=this.et,s=n.words,o=0;o<5;o++){var a=s[o];s[o]=16711935&(a<<8|a>>>24)|4278255360&(a<<24|a>>>8)}return n},clone:function(){var e=s.clone.call(this);return e.et=this.et.clone(),e}});function p(e,t,r){return e^t^r}function v(e,t,r){return e&t|~e&r}function b(e,t,r){return(e|~t)^r}function m(e,t,r){return e&r|t&~r}function g(e,t,r){return e^(t|~r)}function y(e,t){return e<<t|e>>>32-t}t.RIPEMD160=s.Xe(l),t.HmacRIPEMD160=s.Je(l)}(),r.RIPEMD160)}(ripemd160)),ripemd160Exports}var hmacExports={},hmac={get exports(){return hmacExports},set exports(e){hmacExports=e}},hasRequiredHmac;function requireHmac(){return hasRequiredHmac||(hasRequiredHmac=1,function(e,t){var r,i,n;e.exports=(i=(r=requireCore()).lib.Base,n=r.enc.Utf8,void(r.algo.HMAC=i.extend({init:function(e,t){e=this.rt=new e.init,"string"==typeof t&&(t=n.parse(t));var r=e.blockSize,i=4*r;t.sigBytes>i&&(t=e.finalize(t)),t.clamp();for(var s=this.it=t.clone(),o=this.nt=t.clone(),a=s.words,c=o.words,u=0;u<r;u++)a[u]^=1549556828,c[u]^=909522486;s.sigBytes=o.sigBytes=i,this.reset()},reset:function(){var e=this.rt;e.reset(),e.update(this.nt)},update:function(e){return this.rt.update(e),this},finalize:function(e){var t=this.rt,r=t.finalize(e);return t.reset(),t.finalize(this.it.clone().concat(r))}})))}(hmac)),hmacExports}var pbkdf2Exports={},pbkdf2={get exports(){return pbkdf2Exports},set exports(e){pbkdf2Exports=e}},hasRequiredPbkdf2;function requirePbkdf2(){return hasRequiredPbkdf2||(hasRequiredPbkdf2=1,function(e,t){var r,i,n,s,o,a,c,u,h;e.exports=(h=requireCore(),requireSha1(),requireHmac(),n=(i=(r=h).lib).Base,s=i.WordArray,a=(o=r.algo).SHA1,c=o.HMAC,u=o.PBKDF2=n.extend({cfg:n.extend({keySize:4,hasher:a,iterations:1}),init:function(e){this.cfg=this.cfg.extend(e)},compute:function(e,t){for(var r=this.cfg,i=c.create(r.hasher,e),n=s.create(),o=s.create([1]),a=n.words,u=o.words,h=r.keySize,d=r.iterations;a.length<h;){var f=i.update(t).finalize(o);i.reset();for(var l=f.words,p=l.length,v=f,b=1;b<d;b++){v=i.finalize(v),i.reset();for(var m=v.words,g=0;g<p;g++)l[g]^=m[g]}n.concat(f),u[0]++}return n.sigBytes=4*h,n}}),r.PBKDF2=function(e,t,r){return u.create(r).compute(e,t)},h.PBKDF2)}(pbkdf2)),pbkdf2Exports}var evpkdfExports={},evpkdf={get exports(){return evpkdfExports},set exports(e){evpkdfExports=e}},hasRequiredEvpkdf;function requireEvpkdf(){return hasRequiredEvpkdf||(hasRequiredEvpkdf=1,function(e,t){var r,i,n,s,o,a,c,u;e.exports=(u=requireCore(),requireSha1(),requireHmac(),n=(i=(r=u).lib).Base,s=i.WordArray,a=(o=r.algo).MD5,c=o.EvpKDF=n.extend({cfg:n.extend({keySize:4,hasher:a,iterations:1}),init:function(e){this.cfg=this.cfg.extend(e)},compute:function(e,t){for(var r,i=this.cfg,n=i.hasher.create(),o=s.create(),a=o.words,c=i.keySize,u=i.iterations;a.length<c;){r&&n.update(r),r=n.update(e).finalize(t),n.reset();for(var h=1;h<u;h++)r=n.finalize(r),n.reset();o.concat(r)}return o.sigBytes=4*c,o}}),r.EvpKDF=function(e,t,r){return c.create(r).compute(e,t)},u.EvpKDF)}(evpkdf)),evpkdfExports}var cipherCoreExports={},cipherCore={get exports(){return cipherCoreExports},set exports(e){cipherCoreExports=e}},hasRequiredCipherCore;function requireCipherCore(){return hasRequiredCipherCore||(hasRequiredCipherCore=1,function(e,t){var r;e.exports=(r=requireCore(),requireEvpkdf(),void(r.lib.Cipher||function(e){var t=r,i=t.lib,n=i.Base,s=i.WordArray,o=i.BufferedBlockAlgorithm,a=t.enc;a.Utf8;var c=a.Base64,u=t.algo.EvpKDF,h=i.Cipher=o.extend({cfg:n.extend(),createEncryptor:function(e,t){return this.create(this.st,e,t)},createDecryptor:function(e,t){return this.create(this.ot,e,t)},init:function(e,t,r){this.cfg=this.cfg.extend(r),this.ct=e,this.ut=t,this.reset()},reset:function(){o.reset.call(this),this.We()},process:function(e){return this.Ue(e),this.Ve()},finalize:function(e){return e&&this.Ue(e),this.ze()},keySize:4,ivSize:4,st:1,ot:2,Xe:function(){function e(e){return"string"==typeof e?y:m}return function(t){return{encrypt:function(r,i,n){return e(i).encrypt(t,r,i,n)},decrypt:function(r,i,n){return e(i).decrypt(t,r,i,n)}}}}()});i.StreamCipher=h.extend({ze:function(){return this.Ve(!0)},blockSize:1});var d=t.mode={},f=i.BlockCipherMode=n.extend({createEncryptor:function(e,t){return this.Encryptor.create(e,t)},createDecryptor:function(e,t){return this.Decryptor.create(e,t)},init:function(e,t){this.ht=e,this.dt=t}}),l=d.CBC=function(){var t=f.extend();function r(t,r,i){var n,s=this.dt;s?(n=s,this.dt=e):n=this.ft;for(var o=0;o<i;o++)t[r+o]^=n[o]}return t.Encryptor=t.extend({processBlock:function(e,t){var i=this.ht,n=i.blockSize;r.call(this,e,t,n),i.encryptBlock(e,t),this.ft=e.slice(t,t+n)}}),t.Decryptor=t.extend({processBlock:function(e,t){var i=this.ht,n=i.blockSize,s=e.slice(t,t+n);i.decryptBlock(e,t),r.call(this,e,t,n),this.ft=s}}),t}(),p=(t.pad={}).Pkcs7={pad:function(e,t){for(var r=4*t,i=r-e.sigBytes%r,n=i<<24|i<<16|i<<8|i,o=[],a=0;a<i;a+=4)o.push(n);var c=s.create(o,i);e.concat(c)},unpad:function(e){var t=255&e.words[e.sigBytes-1>>>2];e.sigBytes-=t}};i.BlockCipher=h.extend({cfg:h.cfg.extend({mode:l,padding:p}),reset:function(){var e;h.reset.call(this);var t=this.cfg,r=t.iv,i=t.mode;this.ct==this.st?e=i.createEncryptor:(e=i.createDecryptor,this.Ge=1),this.lt&&this.lt.__creator==e?this.lt.init(this,r&&r.words):(this.lt=e.call(i,this,r&&r.words),this.lt.__creator=e)},Ke:function(e,t){this.lt.processBlock(e,t)},ze:function(){var e,t=this.cfg.padding;return this.ct==this.st?(t.pad(this.Fe,this.blockSize),e=this.Ve(!0)):(e=this.Ve(!0),t.unpad(e)),e},blockSize:4});var v=i.CipherParams=n.extend({init:function(e){this.mixIn(e)},toString:function(e){return(e||this.formatter).stringify(this)}}),b=(t.format={}).OpenSSL={stringify:function(e){var t=e.ciphertext,r=e.salt;return(r?s.create([1398893684,1701076831]).concat(r).concat(t):t).toString(c)},parse:function(e){var t,r=c.parse(e),i=r.words;return 1398893684==i[0]&&1701076831==i[1]&&(t=s.create(i.slice(2,4)),i.splice(0,4),r.sigBytes-=16),v.create({ciphertext:r,salt:t})}},m=i.SerializableCipher=n.extend({cfg:n.extend({format:b}),encrypt:function(e,t,r,i){i=this.cfg.extend(i);var n=e.createEncryptor(r,i),s=n.finalize(t),o=n.cfg;return v.create({ciphertext:s,key:r,iv:o.iv,algorithm:e,mode:o.mode,padding:o.padding,blockSize:e.blockSize,formatter:i.format})},decrypt:function(e,t,r,i){return i=this.cfg.extend(i),t=this.vt(t,i.format),e.createDecryptor(r,i).finalize(t.ciphertext)},vt:function(e,t){return"string"==typeof e?t.parse(e,this):e}}),g=(t.kdf={}).OpenSSL={execute:function(e,t,r,i){i||(i=s.random(8));var n=u.create({keySize:t+r}).compute(e,i),o=s.create(n.words.slice(t),4*r);return n.sigBytes=4*t,v.create({key:n,iv:o,salt:i})}},y=i.PasswordBasedCipher=m.extend({cfg:m.cfg.extend({kdf:g}),encrypt:function(e,t,r,i){var n=(i=this.cfg.extend(i)).kdf.execute(r,e.keySize,e.ivSize);i.iv=n.iv;var s=m.encrypt.call(this,e,t,n.key,i);return s.mixIn(n),s},decrypt:function(e,t,r,i){i=this.cfg.extend(i),t=this.vt(t,i.format);var n=i.kdf.execute(r,e.keySize,e.ivSize,t.salt);return i.iv=n.iv,m.decrypt.call(this,e,t,n.key,i)}})}()))}(cipherCore)),cipherCoreExports}var modeCfbExports={},modeCfb={get exports(){return modeCfbExports},set exports(e){modeCfbExports=e}},hasRequiredModeCfb;function requireModeCfb(){return hasRequiredModeCfb||(hasRequiredModeCfb=1,function(e,t){var r;e.exports=(r=requireCore(),requireCipherCore(),r.mode.CFB=function(){var e=r.lib.BlockCipherMode.extend();function t(e,t,r,i){var n,s=this.dt;s?(n=s.slice(0),this.dt=void 0):n=this.ft,i.encryptBlock(n,0);for(var o=0;o<r;o++)e[t+o]^=n[o]}return e.Encryptor=e.extend({processBlock:function(e,r){var i=this.ht,n=i.blockSize;t.call(this,e,r,n,i),this.ft=e.slice(r,r+n)}}),e.Decryptor=e.extend({processBlock:function(e,r){var i=this.ht,n=i.blockSize,s=e.slice(r,r+n);t.call(this,e,r,n,i),this.ft=s}}),e}(),r.mode.CFB)}(modeCfb)),modeCfbExports}var modeCtrExports={},modeCtr={get exports(){return modeCtrExports},set exports(e){modeCtrExports=e}},hasRequiredModeCtr;function requireModeCtr(){return hasRequiredModeCtr||(hasRequiredModeCtr=1,function(e,t){var r,i,n;e.exports=(n=requireCore(),requireCipherCore(),n.mode.CTR=(i=(r=n.lib.BlockCipherMode.extend()).Encryptor=r.extend({processBlock:function(e,t){var r=this.ht,i=r.blockSize,n=this.dt,s=this.bt;n&&(s=this.bt=n.slice(0),this.dt=void 0);var o=s.slice(0);r.encryptBlock(o,0),s[i-1]=s[i-1]+1|0;for(var a=0;a<i;a++)e[t+a]^=o[a]}}),r.Decryptor=i,r),n.mode.CTR)}(modeCtr)),modeCtrExports}var modeCtrGladmanExports={},modeCtrGladman={get exports(){return modeCtrGladmanExports},set exports(e){modeCtrGladmanExports=e}},hasRequiredModeCtrGladman;function requireModeCtrGladman(){return hasRequiredModeCtrGladman||(hasRequiredModeCtrGladman=1,function(e,t){var r;e.exports=(r=requireCore(),requireCipherCore(),
/** @preserve
  		   * Counter block mode compatible with  Dr Brian Gladman fileenc.c
  		   * derived from CryptoJS.mode.CTR
  		   * Jan Hruby jhruby.web@gmail.com
  		   */
r.mode.CTRGladman=function(){var e=r.lib.BlockCipherMode.extend();function t(e){if(255==(e>>24&255)){var t=e>>16&255,r=e>>8&255,i=255&e;255===t?(t=0,255===r?(r=0,255===i?i=0:++i):++r):++t,e=0,e+=t<<16,e+=r<<8,e+=i}else e+=1<<24;return e}var i=e.Encryptor=e.extend({processBlock:function(e,r){var i=this.ht,n=i.blockSize,s=this.dt,o=this.bt;s&&(o=this.bt=s.slice(0),this.dt=void 0),function(e){0===(e[0]=t(e[0]))&&(e[1]=t(e[1]))}(o);var a=o.slice(0);i.encryptBlock(a,0);for(var c=0;c<n;c++)e[r+c]^=a[c]}});return e.Decryptor=i,e}(),r.mode.CTRGladman)}(modeCtrGladman)),modeCtrGladmanExports}var modeOfbExports={},modeOfb={get exports(){return modeOfbExports},set exports(e){modeOfbExports=e}},hasRequiredModeOfb;function requireModeOfb(){return hasRequiredModeOfb||(hasRequiredModeOfb=1,function(e,t){var r,i,n;e.exports=(n=requireCore(),requireCipherCore(),n.mode.OFB=(i=(r=n.lib.BlockCipherMode.extend()).Encryptor=r.extend({processBlock:function(e,t){var r=this.ht,i=r.blockSize,n=this.dt,s=this.gt;n&&(s=this.gt=n.slice(0),this.dt=void 0),r.encryptBlock(s,0);for(var o=0;o<i;o++)e[t+o]^=s[o]}}),r.Decryptor=i,r),n.mode.OFB)}(modeOfb)),modeOfbExports}var modeEcbExports={},modeEcb={get exports(){return modeEcbExports},set exports(e){modeEcbExports=e}},hasRequiredModeEcb;function requireModeEcb(){return hasRequiredModeEcb||(hasRequiredModeEcb=1,function(e,t){var r,i;e.exports=(i=requireCore(),requireCipherCore(),i.mode.ECB=((r=i.lib.BlockCipherMode.extend()).Encryptor=r.extend({processBlock:function(e,t){this.ht.encryptBlock(e,t)}}),r.Decryptor=r.extend({processBlock:function(e,t){this.ht.decryptBlock(e,t)}}),r),i.mode.ECB)}(modeEcb)),modeEcbExports}var padAnsix923Exports={},padAnsix923={get exports(){return padAnsix923Exports},set exports(e){padAnsix923Exports=e}},hasRequiredPadAnsix923;function requirePadAnsix923(){return hasRequiredPadAnsix923||(hasRequiredPadAnsix923=1,function(e,t){var r;e.exports=(r=requireCore(),requireCipherCore(),r.pad.AnsiX923={pad:function(e,t){var r=e.sigBytes,i=4*t,n=i-r%i,s=r+n-1;e.clamp(),e.words[s>>>2]|=n<<24-s%4*8,e.sigBytes+=n},unpad:function(e){var t=255&e.words[e.sigBytes-1>>>2];e.sigBytes-=t}},r.pad.Ansix923)}(padAnsix923)),padAnsix923Exports}var padIso10126Exports={},padIso10126={get exports(){return padIso10126Exports},set exports(e){padIso10126Exports=e}},hasRequiredPadIso10126;function requirePadIso10126(){return hasRequiredPadIso10126||(hasRequiredPadIso10126=1,function(e,t){var r;e.exports=(r=requireCore(),requireCipherCore(),r.pad.Iso10126={pad:function(e,t){var i=4*t,n=i-e.sigBytes%i;e.concat(r.lib.WordArray.random(n-1)).concat(r.lib.WordArray.create([n<<24],1))},unpad:function(e){var t=255&e.words[e.sigBytes-1>>>2];e.sigBytes-=t}},r.pad.Iso10126)}(padIso10126)),padIso10126Exports}var padIso97971Exports={},padIso97971={get exports(){return padIso97971Exports},set exports(e){padIso97971Exports=e}},hasRequiredPadIso97971;function requirePadIso97971(){return hasRequiredPadIso97971||(hasRequiredPadIso97971=1,function(e,t){var r;e.exports=(r=requireCore(),requireCipherCore(),r.pad.Iso97971={pad:function(e,t){e.concat(r.lib.WordArray.create([2147483648],1)),r.pad.ZeroPadding.pad(e,t)},unpad:function(e){r.pad.ZeroPadding.unpad(e),e.sigBytes--}},r.pad.Iso97971)}(padIso97971)),padIso97971Exports}var padZeropaddingExports={},padZeropadding={get exports(){return padZeropaddingExports},set exports(e){padZeropaddingExports=e}},hasRequiredPadZeropadding;function requirePadZeropadding(){return hasRequiredPadZeropadding||(hasRequiredPadZeropadding=1,function(e,t){var r;e.exports=(r=requireCore(),requireCipherCore(),r.pad.ZeroPadding={pad:function(e,t){var r=4*t;e.clamp(),e.sigBytes+=r-(e.sigBytes%r||r)},unpad:function(e){var t=e.words,r=e.sigBytes-1;for(r=e.sigBytes-1;r>=0;r--)if(t[r>>>2]>>>24-r%4*8&255){e.sigBytes=r+1;break}}},r.pad.ZeroPadding)}(padZeropadding)),padZeropaddingExports}var padNopaddingExports={},padNopadding={get exports(){return padNopaddingExports},set exports(e){padNopaddingExports=e}},hasRequiredPadNopadding;function requirePadNopadding(){return hasRequiredPadNopadding||(hasRequiredPadNopadding=1,function(e,t){var r;e.exports=(r=requireCore(),requireCipherCore(),r.pad.NoPadding={pad:function(){},unpad:function(){}},r.pad.NoPadding)}(padNopadding)),padNopaddingExports}var formatHexExports={},formatHex={get exports(){return formatHexExports},set exports(e){formatHexExports=e}},hasRequiredFormatHex;function requireFormatHex(){return hasRequiredFormatHex||(hasRequiredFormatHex=1,function(e,t){var r,i,n,s;e.exports=(s=requireCore(),requireCipherCore(),i=(r=s).lib.CipherParams,n=r.enc.Hex,r.format.Hex={stringify:function(e){return e.ciphertext.toString(n)},parse:function(e){var t=n.parse(e);return i.create({ciphertext:t})}},s.format.Hex)}(formatHex)),formatHexExports}var aesExports={},aes={get exports(){return aesExports},set exports(e){aesExports=e}},hasRequiredAes;function requireAes(){return hasRequiredAes||(hasRequiredAes=1,function(e,t){var r;e.exports=(r=requireCore(),requireEncBase64(),requireMd5(),requireEvpkdf(),requireCipherCore(),function(){var e=r,t=e.lib.BlockCipher,i=e.algo,n=[],s=[],o=[],a=[],c=[],u=[],h=[],d=[],f=[],l=[];!function(){for(var e=[],t=0;t<256;t++)e[t]=t<128?t<<1:t<<1^283;var r=0,i=0;for(t=0;t<256;t++){var p=i^i<<1^i<<2^i<<3^i<<4;p=p>>>8^255&p^99,n[r]=p,s[p]=r;var v=e[r],b=e[v],m=e[b],g=257*e[p]^16843008*p;o[r]=g<<24|g>>>8,a[r]=g<<16|g>>>16,c[r]=g<<8|g>>>24,u[r]=g,g=16843009*m^65537*b^257*v^16843008*r,h[p]=g<<24|g>>>8,d[p]=g<<16|g>>>16,f[p]=g<<8|g>>>24,l[p]=g,r?(r=v^e[e[e[m^v]]],i^=e[e[i]]):r=i=1}}();var p=[0,1,2,4,8,16,32,64,128,27,54],v=i.AES=t.extend({We:function(){if(!this.yt||this.wt!==this.ut){for(var e=this.wt=this.ut,t=e.words,r=e.sigBytes/4,i=4*((this.yt=r+6)+1),s=this.$t=[],o=0;o<i;o++)o<r?s[o]=t[o]:(u=s[o-1],o%r?r>6&&o%r==4&&(u=n[u>>>24]<<24|n[u>>>16&255]<<16|n[u>>>8&255]<<8|n[255&u]):(u=n[(u=u<<8|u>>>24)>>>24]<<24|n[u>>>16&255]<<16|n[u>>>8&255]<<8|n[255&u],u^=p[o/r|0]<<24),s[o]=s[o-r]^u);for(var a=this.St=[],c=0;c<i;c++){if(o=i-c,c%4)var u=s[o];else u=s[o-4];a[c]=c<4||o<=4?u:h[n[u>>>24]]^d[n[u>>>16&255]]^f[n[u>>>8&255]]^l[n[255&u]]}}},encryptBlock:function(e,t){this.kt(e,t,this.$t,o,a,c,u,n)},decryptBlock:function(e,t){var r=e[t+1];e[t+1]=e[t+3],e[t+3]=r,this.kt(e,t,this.St,h,d,f,l,s),r=e[t+1],e[t+1]=e[t+3],e[t+3]=r},kt:function(e,t,r,i,n,s,o,a){for(var c=this.yt,u=e[t]^r[0],h=e[t+1]^r[1],d=e[t+2]^r[2],f=e[t+3]^r[3],l=4,p=1;p<c;p++){var v=i[u>>>24]^n[h>>>16&255]^s[d>>>8&255]^o[255&f]^r[l++],b=i[h>>>24]^n[d>>>16&255]^s[f>>>8&255]^o[255&u]^r[l++],m=i[d>>>24]^n[f>>>16&255]^s[u>>>8&255]^o[255&h]^r[l++],g=i[f>>>24]^n[u>>>16&255]^s[h>>>8&255]^o[255&d]^r[l++];u=v,h=b,d=m,f=g}v=(a[u>>>24]<<24|a[h>>>16&255]<<16|a[d>>>8&255]<<8|a[255&f])^r[l++],b=(a[h>>>24]<<24|a[d>>>16&255]<<16|a[f>>>8&255]<<8|a[255&u])^r[l++],m=(a[d>>>24]<<24|a[f>>>16&255]<<16|a[u>>>8&255]<<8|a[255&h])^r[l++],g=(a[f>>>24]<<24|a[u>>>16&255]<<16|a[h>>>8&255]<<8|a[255&d])^r[l++],e[t]=v,e[t+1]=b,e[t+2]=m,e[t+3]=g},keySize:8});e.AES=t.Xe(v)}(),r.AES)}(aes)),aesExports}var tripledesExports={},tripledes={get exports(){return tripledesExports},set exports(e){tripledesExports=e}},hasRequiredTripledes;function requireTripledes(){return hasRequiredTripledes||(hasRequiredTripledes=1,function(e,t){var r;e.exports=(r=requireCore(),requireEncBase64(),requireMd5(),requireEvpkdf(),requireCipherCore(),function(){var e=r,t=e.lib,i=t.WordArray,n=t.BlockCipher,s=e.algo,o=[57,49,41,33,25,17,9,1,58,50,42,34,26,18,10,2,59,51,43,35,27,19,11,3,60,52,44,36,63,55,47,39,31,23,15,7,62,54,46,38,30,22,14,6,61,53,45,37,29,21,13,5,28,20,12,4],a=[14,17,11,24,1,5,3,28,15,6,21,10,23,19,12,4,26,8,16,7,27,20,13,2,41,52,31,37,47,55,30,40,51,45,33,48,44,49,39,56,34,53,46,42,50,36,29,32],c=[1,2,4,6,8,10,12,14,15,17,19,21,23,25,27,28],u=[{0:8421888,268435456:32768,536870912:8421378,805306368:2,1073741824:512,1342177280:8421890,1610612736:8389122,1879048192:8388608,2147483648:514,2415919104:8389120,2684354560:33280,2952790016:8421376,3221225472:32770,3489660928:8388610,3758096384:0,4026531840:33282,134217728:0,402653184:8421890,671088640:33282,939524096:32768,1207959552:8421888,1476395008:512,1744830464:8421378,2013265920:2,2281701376:8389120,2550136832:33280,2818572288:8421376,3087007744:8389122,3355443200:8388610,3623878656:32770,3892314112:514,4160749568:8388608,1:32768,268435457:2,536870913:8421888,805306369:8388608,1073741825:8421378,1342177281:33280,1610612737:512,1879048193:8389122,2147483649:8421890,2415919105:8421376,2684354561:8388610,2952790017:33282,3221225473:514,3489660929:8389120,3758096385:32770,4026531841:0,134217729:8421890,402653185:8421376,671088641:8388608,939524097:512,1207959553:32768,1476395009:8388610,1744830465:2,2013265921:33282,2281701377:32770,2550136833:8389122,2818572289:514,3087007745:8421888,3355443201:8389120,3623878657:0,3892314113:33280,4160749569:8421378},{0:1074282512,16777216:16384,33554432:524288,50331648:1074266128,67108864:1073741840,83886080:1074282496,100663296:1073758208,117440512:16,134217728:540672,150994944:1073758224,167772160:1073741824,184549376:540688,201326592:524304,218103808:0,234881024:16400,251658240:1074266112,8388608:1073758208,25165824:540688,41943040:16,58720256:1073758224,75497472:1074282512,92274688:1073741824,109051904:524288,125829120:1074266128,142606336:524304,159383552:0,176160768:16384,192937984:1074266112,209715200:1073741840,226492416:540672,243269632:1074282496,260046848:16400,268435456:0,285212672:1074266128,301989888:1073758224,318767104:1074282496,335544320:1074266112,352321536:16,369098752:540688,385875968:16384,402653184:16400,419430400:524288,436207616:524304,452984832:1073741840,469762048:540672,486539264:1073758208,503316480:1073741824,520093696:1074282512,276824064:540688,293601280:524288,310378496:1074266112,327155712:16384,343932928:1073758208,360710144:1074282512,377487360:16,394264576:1073741824,411041792:1074282496,427819008:1073741840,444596224:1073758224,461373440:524304,478150656:0,494927872:16400,511705088:1074266128,528482304:540672},{0:260,1048576:0,2097152:67109120,3145728:65796,4194304:65540,5242880:67108868,6291456:67174660,7340032:67174400,8388608:67108864,9437184:67174656,10485760:65792,11534336:67174404,12582912:67109124,13631488:65536,14680064:4,15728640:256,524288:67174656,1572864:67174404,2621440:0,3670016:67109120,4718592:67108868,5767168:65536,6815744:65540,7864320:260,8912896:4,9961472:256,11010048:67174400,12058624:65796,13107200:65792,14155776:67109124,15204352:67174660,16252928:67108864,16777216:67174656,17825792:65540,18874368:65536,19922944:67109120,20971520:256,22020096:67174660,23068672:67108868,24117248:0,25165824:67109124,26214400:67108864,27262976:4,28311552:65792,29360128:67174400,30408704:260,31457280:65796,32505856:67174404,17301504:67108864,18350080:260,19398656:67174656,20447232:0,21495808:65540,22544384:67109120,23592960:256,24641536:67174404,25690112:65536,26738688:67174660,27787264:65796,28835840:67108868,29884416:67109124,30932992:67174400,31981568:4,33030144:65792},{0:2151682048,65536:2147487808,131072:4198464,196608:2151677952,262144:0,327680:4198400,393216:2147483712,458752:4194368,524288:2147483648,589824:4194304,655360:64,720896:2147487744,786432:2151678016,851968:4160,917504:4096,983040:2151682112,32768:2147487808,98304:64,163840:2151678016,229376:2147487744,294912:4198400,360448:2151682112,425984:0,491520:2151677952,557056:4096,622592:2151682048,688128:4194304,753664:4160,819200:2147483648,884736:4194368,950272:4198464,1015808:2147483712,1048576:4194368,1114112:4198400,1179648:2147483712,1245184:0,1310720:4160,1376256:2151678016,1441792:2151682048,1507328:2147487808,1572864:2151682112,1638400:2147483648,1703936:2151677952,1769472:4198464,1835008:2147487744,1900544:4194304,1966080:64,2031616:4096,1081344:2151677952,1146880:2151682112,1212416:0,1277952:4198400,1343488:4194368,1409024:2147483648,1474560:2147487808,1540096:64,1605632:2147483712,1671168:4096,1736704:2147487744,1802240:2151678016,1867776:4160,1933312:2151682048,1998848:4194304,2064384:4198464},{0:128,4096:17039360,8192:262144,12288:536870912,16384:537133184,20480:16777344,24576:553648256,28672:262272,32768:16777216,36864:537133056,40960:536871040,45056:553910400,49152:553910272,53248:0,57344:17039488,61440:553648128,2048:17039488,6144:553648256,10240:128,14336:17039360,18432:262144,22528:537133184,26624:553910272,30720:536870912,34816:537133056,38912:0,43008:553910400,47104:16777344,51200:536871040,55296:553648128,59392:16777216,63488:262272,65536:262144,69632:128,73728:536870912,77824:553648256,81920:16777344,86016:553910272,90112:537133184,94208:16777216,98304:553910400,102400:553648128,106496:17039360,110592:537133056,114688:262272,118784:536871040,122880:0,126976:17039488,67584:553648256,71680:16777216,75776:17039360,79872:537133184,83968:536870912,88064:17039488,92160:128,96256:553910272,100352:262272,104448:553910400,108544:0,112640:553648128,116736:16777344,120832:262144,124928:537133056,129024:536871040},{0:268435464,256:8192,512:270532608,768:270540808,1024:268443648,1280:2097152,1536:2097160,1792:268435456,2048:0,2304:268443656,2560:2105344,2816:8,3072:270532616,3328:2105352,3584:8200,3840:270540800,128:270532608,384:270540808,640:8,896:2097152,1152:2105352,1408:268435464,1664:268443648,1920:8200,2176:2097160,2432:8192,2688:268443656,2944:270532616,3200:0,3456:270540800,3712:2105344,3968:268435456,4096:268443648,4352:270532616,4608:270540808,4864:8200,5120:2097152,5376:268435456,5632:268435464,5888:2105344,6144:2105352,6400:0,6656:8,6912:270532608,7168:8192,7424:268443656,7680:270540800,7936:2097160,4224:8,4480:2105344,4736:2097152,4992:268435464,5248:268443648,5504:8200,5760:270540808,6016:270532608,6272:270540800,6528:270532616,6784:8192,7040:2105352,7296:2097160,7552:0,7808:268435456,8064:268443656},{0:1048576,16:33555457,32:1024,48:1049601,64:34604033,80:0,96:1,112:34603009,128:33555456,144:1048577,160:33554433,176:34604032,192:34603008,208:1025,224:1049600,240:33554432,8:34603009,24:0,40:33555457,56:34604032,72:1048576,88:33554433,104:33554432,120:1025,136:1049601,152:33555456,168:34603008,184:1048577,200:1024,216:34604033,232:1,248:1049600,256:33554432,272:1048576,288:33555457,304:34603009,320:1048577,336:33555456,352:34604032,368:1049601,384:1025,400:34604033,416:1049600,432:1,448:0,464:34603008,480:33554433,496:1024,264:1049600,280:33555457,296:34603009,312:1,328:33554432,344:1048576,360:1025,376:34604032,392:33554433,408:34603008,424:0,440:34604033,456:1049601,472:1024,488:33555456,504:1048577},{0:134219808,1:131072,2:134217728,3:32,4:131104,5:134350880,6:134350848,7:2048,8:134348800,9:134219776,10:133120,11:134348832,12:2080,13:0,14:134217760,15:133152,2147483648:2048,2147483649:134350880,2147483650:134219808,2147483651:134217728,2147483652:134348800,2147483653:133120,2147483654:133152,2147483655:32,2147483656:134217760,2147483657:2080,2147483658:131104,2147483659:134350848,2147483660:0,2147483661:134348832,2147483662:134219776,2147483663:131072,16:133152,17:134350848,18:32,19:2048,20:134219776,21:134217760,22:134348832,23:131072,24:0,25:131104,26:134348800,27:134219808,28:134350880,29:133120,30:2080,31:134217728,2147483664:131072,2147483665:2048,2147483666:134348832,2147483667:133152,2147483668:32,2147483669:134348800,2147483670:134217728,2147483671:134219808,2147483672:134350880,2147483673:134217760,2147483674:134219776,2147483675:0,2147483676:133120,2147483677:2080,2147483678:131104,2147483679:134350848}],h=[4160749569,528482304,33030144,2064384,129024,8064,504,2147483679],d=s.DES=n.extend({We:function(){for(var e=this.ut.words,t=[],r=0;r<56;r++){var i=o[r]-1;t[r]=e[i>>>5]>>>31-i%32&1}for(var n=this.Et=[],s=0;s<16;s++){var u=n[s]=[],h=c[s];for(r=0;r<24;r++)u[r/6|0]|=t[(a[r]-1+h)%28]<<31-r%6,u[4+(r/6|0)]|=t[28+(a[r+24]-1+h)%28]<<31-r%6;for(u[0]=u[0]<<1|u[0]>>>31,r=1;r<7;r++)u[r]=u[r]>>>4*(r-1)+3;u[7]=u[7]<<5|u[7]>>>27}var d=this.xt=[];for(r=0;r<16;r++)d[r]=n[15-r]},encryptBlock:function(e,t){this.kt(e,t,this.Et)},decryptBlock:function(e,t){this.kt(e,t,this.xt)},kt:function(e,t,r){this.Ct=e[t],this.At=e[t+1],f.call(this,4,252645135),f.call(this,16,65535),l.call(this,2,858993459),l.call(this,8,16711935),f.call(this,1,1431655765);for(var i=0;i<16;i++){for(var n=r[i],s=this.Ct,o=this.At,a=0,c=0;c<8;c++)a|=u[c][((o^n[c])&h[c])>>>0];this.Ct=o,this.At=s^a}var d=this.Ct;this.Ct=this.At,this.At=d,f.call(this,1,1431655765),l.call(this,8,16711935),l.call(this,2,858993459),f.call(this,16,65535),f.call(this,4,252645135),e[t]=this.Ct,e[t+1]=this.At},keySize:2,ivSize:2,blockSize:2});function f(e,t){var r=(this.Ct>>>e^this.At)&t;this.At^=r,this.Ct^=r<<e}function l(e,t){var r=(this.At>>>e^this.Ct)&t;this.Ct^=r,this.At^=r<<e}e.DES=n.Xe(d);var p=s.TripleDES=n.extend({We:function(){var e=this.ut.words;if(2!==e.length&&4!==e.length&&e.length<6)throw new Error("Invalid key length - 3DES requires the key length to be 64, 128, 192 or >192.");var t=e.slice(0,2),r=e.length<4?e.slice(0,2):e.slice(2,4),n=e.length<6?e.slice(0,2):e.slice(4,6);this._t=d.createEncryptor(i.create(t)),this.Tt=d.createEncryptor(i.create(r)),this.Rt=d.createEncryptor(i.create(n))},encryptBlock:function(e,t){this._t.encryptBlock(e,t),this.Tt.decryptBlock(e,t),this.Rt.encryptBlock(e,t)},decryptBlock:function(e,t){this.Rt.decryptBlock(e,t),this.Tt.encryptBlock(e,t),this._t.decryptBlock(e,t)},keySize:6,ivSize:2,blockSize:2});e.TripleDES=n.Xe(p)}(),r.TripleDES)}(tripledes)),tripledesExports}var rc4Exports={},rc4={get exports(){return rc4Exports},set exports(e){rc4Exports=e}},hasRequiredRc4;function requireRc4(){return hasRequiredRc4||(hasRequiredRc4=1,function(e,t){var r;e.exports=(r=requireCore(),requireEncBase64(),requireMd5(),requireEvpkdf(),requireCipherCore(),function(){var e=r,t=e.lib.StreamCipher,i=e.algo,n=i.RC4=t.extend({We:function(){for(var e=this.ut,t=e.words,r=e.sigBytes,i=this.Ot=[],n=0;n<256;n++)i[n]=n;n=0;for(var s=0;n<256;n++){var o=n%r,a=t[o>>>2]>>>24-o%4*8&255;s=(s+i[n]+a)%256;var c=i[n];i[n]=i[s],i[s]=c}this.It=this.jt=0},Ke:function(e,t){e[t]^=s.call(this)},keySize:8,ivSize:0});function s(){for(var e=this.Ot,t=this.It,r=this.jt,i=0,n=0;n<4;n++){r=(r+e[t=(t+1)%256])%256;var s=e[t];e[t]=e[r],e[r]=s,i|=e[(e[t]+e[r])%256]<<24-8*n}return this.It=t,this.jt=r,i}e.RC4=t.Xe(n);var o=i.RC4Drop=n.extend({cfg:n.cfg.extend({drop:192}),We:function(){n.We.call(this);for(var e=this.cfg.drop;e>0;e--)s.call(this)}});e.RC4Drop=t.Xe(o)}(),r.RC4)}(rc4)),rc4Exports}var rabbitExports={},rabbit={get exports(){return rabbitExports},set exports(e){rabbitExports=e}},hasRequiredRabbit;function requireRabbit(){return hasRequiredRabbit||(hasRequiredRabbit=1,function(e,t){var r;e.exports=(r=requireCore(),requireEncBase64(),requireMd5(),requireEvpkdf(),requireCipherCore(),function(){var e=r,t=e.lib.StreamCipher,i=e.algo,n=[],s=[],o=[],a=i.Rabbit=t.extend({We:function(){for(var e=this.ut.words,t=this.cfg.iv,r=0;r<4;r++)e[r]=16711935&(e[r]<<8|e[r]>>>24)|4278255360&(e[r]<<24|e[r]>>>8);var i=this.Mt=[e[0],e[3]<<16|e[2]>>>16,e[1],e[0]<<16|e[3]>>>16,e[2],e[1]<<16|e[0]>>>16,e[3],e[2]<<16|e[1]>>>16],n=this.qt=[e[2]<<16|e[2]>>>16,4294901760&e[0]|65535&e[1],e[3]<<16|e[3]>>>16,4294901760&e[1]|65535&e[2],e[0]<<16|e[0]>>>16,4294901760&e[2]|65535&e[3],e[1]<<16|e[1]>>>16,4294901760&e[3]|65535&e[0]];for(this.Nt=0,r=0;r<4;r++)c.call(this);for(r=0;r<8;r++)n[r]^=i[r+4&7];if(t){var s=t.words,o=s[0],a=s[1],u=16711935&(o<<8|o>>>24)|4278255360&(o<<24|o>>>8),h=16711935&(a<<8|a>>>24)|4278255360&(a<<24|a>>>8),d=u>>>16|4294901760&h,f=h<<16|65535&u;for(n[0]^=u,n[1]^=d,n[2]^=h,n[3]^=f,n[4]^=u,n[5]^=d,n[6]^=h,n[7]^=f,r=0;r<4;r++)c.call(this)}},Ke:function(e,t){var r=this.Mt;c.call(this),n[0]=r[0]^r[5]>>>16^r[3]<<16,n[1]=r[2]^r[7]>>>16^r[5]<<16,n[2]=r[4]^r[1]>>>16^r[7]<<16,n[3]=r[6]^r[3]>>>16^r[1]<<16;for(var i=0;i<4;i++)n[i]=16711935&(n[i]<<8|n[i]>>>24)|4278255360&(n[i]<<24|n[i]>>>8),e[t+i]^=n[i]},blockSize:4,ivSize:2});function c(){for(var e=this.Mt,t=this.qt,r=0;r<8;r++)s[r]=t[r];for(t[0]=t[0]+1295307597+this.Nt|0,t[1]=t[1]+3545052371+(t[0]>>>0<s[0]>>>0?1:0)|0,t[2]=t[2]+886263092+(t[1]>>>0<s[1]>>>0?1:0)|0,t[3]=t[3]+1295307597+(t[2]>>>0<s[2]>>>0?1:0)|0,t[4]=t[4]+3545052371+(t[3]>>>0<s[3]>>>0?1:0)|0,t[5]=t[5]+886263092+(t[4]>>>0<s[4]>>>0?1:0)|0,t[6]=t[6]+1295307597+(t[5]>>>0<s[5]>>>0?1:0)|0,t[7]=t[7]+3545052371+(t[6]>>>0<s[6]>>>0?1:0)|0,this.Nt=t[7]>>>0<s[7]>>>0?1:0,r=0;r<8;r++){var i=e[r]+t[r],n=65535&i,a=i>>>16,c=((n*n>>>17)+n*a>>>15)+a*a,u=((4294901760&i)*i|0)+((65535&i)*i|0);o[r]=c^u}e[0]=o[0]+(o[7]<<16|o[7]>>>16)+(o[6]<<16|o[6]>>>16)|0,e[1]=o[1]+(o[0]<<8|o[0]>>>24)+o[7]|0,e[2]=o[2]+(o[1]<<16|o[1]>>>16)+(o[0]<<16|o[0]>>>16)|0,e[3]=o[3]+(o[2]<<8|o[2]>>>24)+o[1]|0,e[4]=o[4]+(o[3]<<16|o[3]>>>16)+(o[2]<<16|o[2]>>>16)|0,e[5]=o[5]+(o[4]<<8|o[4]>>>24)+o[3]|0,e[6]=o[6]+(o[5]<<16|o[5]>>>16)+(o[4]<<16|o[4]>>>16)|0,e[7]=o[7]+(o[6]<<8|o[6]>>>24)+o[5]|0}e.Rabbit=t.Xe(a)}(),r.Rabbit)}(rabbit)),rabbitExports}var rabbitLegacyExports={},rabbitLegacy={get exports(){return rabbitLegacyExports},set exports(e){rabbitLegacyExports=e}},hasRequiredRabbitLegacy;function requireRabbitLegacy(){return hasRequiredRabbitLegacy||(hasRequiredRabbitLegacy=1,function(e,t){var r;e.exports=(r=requireCore(),requireEncBase64(),requireMd5(),requireEvpkdf(),requireCipherCore(),function(){var e=r,t=e.lib.StreamCipher,i=e.algo,n=[],s=[],o=[],a=i.RabbitLegacy=t.extend({We:function(){var e=this.ut.words,t=this.cfg.iv,r=this.Mt=[e[0],e[3]<<16|e[2]>>>16,e[1],e[0]<<16|e[3]>>>16,e[2],e[1]<<16|e[0]>>>16,e[3],e[2]<<16|e[1]>>>16],i=this.qt=[e[2]<<16|e[2]>>>16,4294901760&e[0]|65535&e[1],e[3]<<16|e[3]>>>16,4294901760&e[1]|65535&e[2],e[0]<<16|e[0]>>>16,4294901760&e[2]|65535&e[3],e[1]<<16|e[1]>>>16,4294901760&e[3]|65535&e[0]];this.Nt=0;for(var n=0;n<4;n++)c.call(this);for(n=0;n<8;n++)i[n]^=r[n+4&7];if(t){var s=t.words,o=s[0],a=s[1],u=16711935&(o<<8|o>>>24)|4278255360&(o<<24|o>>>8),h=16711935&(a<<8|a>>>24)|4278255360&(a<<24|a>>>8),d=u>>>16|4294901760&h,f=h<<16|65535&u;for(i[0]^=u,i[1]^=d,i[2]^=h,i[3]^=f,i[4]^=u,i[5]^=d,i[6]^=h,i[7]^=f,n=0;n<4;n++)c.call(this)}},Ke:function(e,t){var r=this.Mt;c.call(this),n[0]=r[0]^r[5]>>>16^r[3]<<16,n[1]=r[2]^r[7]>>>16^r[5]<<16,n[2]=r[4]^r[1]>>>16^r[7]<<16,n[3]=r[6]^r[3]>>>16^r[1]<<16;for(var i=0;i<4;i++)n[i]=16711935&(n[i]<<8|n[i]>>>24)|4278255360&(n[i]<<24|n[i]>>>8),e[t+i]^=n[i]},blockSize:4,ivSize:2});function c(){for(var e=this.Mt,t=this.qt,r=0;r<8;r++)s[r]=t[r];for(t[0]=t[0]+1295307597+this.Nt|0,t[1]=t[1]+3545052371+(t[0]>>>0<s[0]>>>0?1:0)|0,t[2]=t[2]+886263092+(t[1]>>>0<s[1]>>>0?1:0)|0,t[3]=t[3]+1295307597+(t[2]>>>0<s[2]>>>0?1:0)|0,t[4]=t[4]+3545052371+(t[3]>>>0<s[3]>>>0?1:0)|0,t[5]=t[5]+886263092+(t[4]>>>0<s[4]>>>0?1:0)|0,t[6]=t[6]+1295307597+(t[5]>>>0<s[5]>>>0?1:0)|0,t[7]=t[7]+3545052371+(t[6]>>>0<s[6]>>>0?1:0)|0,this.Nt=t[7]>>>0<s[7]>>>0?1:0,r=0;r<8;r++){var i=e[r]+t[r],n=65535&i,a=i>>>16,c=((n*n>>>17)+n*a>>>15)+a*a,u=((4294901760&i)*i|0)+((65535&i)*i|0);o[r]=c^u}e[0]=o[0]+(o[7]<<16|o[7]>>>16)+(o[6]<<16|o[6]>>>16)|0,e[1]=o[1]+(o[0]<<8|o[0]>>>24)+o[7]|0,e[2]=o[2]+(o[1]<<16|o[1]>>>16)+(o[0]<<16|o[0]>>>16)|0,e[3]=o[3]+(o[2]<<8|o[2]>>>24)+o[1]|0,e[4]=o[4]+(o[3]<<16|o[3]>>>16)+(o[2]<<16|o[2]>>>16)|0,e[5]=o[5]+(o[4]<<8|o[4]>>>24)+o[3]|0,e[6]=o[6]+(o[5]<<16|o[5]>>>16)+(o[4]<<16|o[4]>>>16)|0,e[7]=o[7]+(o[6]<<8|o[6]>>>24)+o[5]|0}e.RabbitLegacy=t.Xe(a)}(),r.RabbitLegacy)}(rabbitLegacy)),rabbitLegacyExports}!function(e,t){var r;e.exports=(r=requireCore(),requireX64Core(),requireLibTypedarrays(),requireEncUtf16(),requireEncBase64(),requireEncBase64url(),requireMd5(),requireSha1(),requireSha256(),requireSha224(),requireSha512(),requireSha384(),requireSha3(),requireRipemd160(),requireHmac(),requirePbkdf2(),requireEvpkdf(),requireCipherCore(),requireModeCfb(),requireModeCtr(),requireModeCtrGladman(),requireModeOfb(),requireModeEcb(),requirePadAnsix923(),requirePadIso10126(),requirePadIso97971(),requirePadZeropadding(),requirePadNopadding(),requireFormatHex(),requireAes(),requireTripledes(),requireRc4(),requireRabbit(),requireRabbitLegacy(),r)}(cryptoJs);class i{constructor(){this.Pt=[],this.Dt=!1}start(e){this.Lt?metricsLogger.warn("metrics had started"):(this.lt=e,this.Bt())}stop(){this.Lt&&(this.Ft(),clearTimeout(this.Lt),this.Lt=void 0,this.lt=void 0,this.Pt=[])}post(e,t){return this.lt&&!this.Dt&&this.Pt.push({additional:{...t,confNum:this.lt.roomCode,nn:this.lt.nickName,epid:this.lt.endpointId,userId:this.lt.userId,sessionId:this.lt.sessionId},device_ts:Date.now(),event_code:e,path:"SDK"}),this}Bt(){this.Lt=window.setTimeout((()=>{this.Ft(),this.Bt()}),25e3)}Ft(){if(!this.Dt&&this.lt&&this.Pt.length){const e=this.Pt;this.Pt=[];const t=JSON.stringify({device_name:f$5.name,network_mode:"unknow",machine_id:"unknow",sdk_version:`${e$6.version}.${e$6.commit}`,os_version:c$3.version,os_type:c$3.name,device_model:e$4.vendor,device_brand:e$4.model,device_cpu_model:d$3.architecture,platform:e$4.type,user_type:1,events:e});this.Ht(this.lt.sessionId,t,cryptoJsExports.MD5(t+"32a787de-7003-4eed-bfae-86f728cbf887").toString())}}async Ht(e,t,r){let i=arguments.length>3&&void 0!==arguments[3]?arguments[3]:0;try{await API.dataHub.ae({headers:{"x-session-id":e,"x-mldatahub-topic":"video","x-mldatahub-ver":"2.0","Content-Type":"application/gzip;utf-8","Content-Encoding":"gzip","x-mldatahub-signature":r},data:t})}catch(n){i<5&&this.Lt&&(404===n.context.status?(this.Dt=!0,this.stop()):n.context.status<500&&400127002!==n.code&&400127001!==n.code&&4011e3!==n.code&&setTimeout((()=>{this.Ht(e,t,r,i+1)}),10*(i+1)*1e3))}}}const metrics=new i;var a$1,Events;!function(e){e[e.DEVICE_UNKNOWN=0]="DEVICE_UNKNOWN",e[e.DEVICE_AUDIO_RECORD=1]="DEVICE_AUDIO_RECORD",e[e.DEVICE_AUDIO_PLAYOUT=2]="DEVICE_AUDIO_PLAYOUT",e[e.DEVICE_AUDIO_LOOPBACK=3]="DEVICE_AUDIO_LOOPBACK",e[e.DEVICE_VIDEO_INPUT=4]="DEVICE_VIDEO_INPUT"}(a$1||(a$1={})),function(e){e.SIMULCAST_CHANGED="SIMULCAST_CHANGED",e.MUTE_AUDIO="MUTE_AUDIO",e.UNMUTE_AUDIO="UNMUTE_AUDIO",e.MUTE_ALL_AUDIO="MUTE_ALL_AUDIO",e.UNMUTE_ALL_AUDIO="UNMUTE_ALL_AUDIO",e.MUTE_VIDEO="MUTE_VIDEO",e.UNMUTE_VIDEO="UNMUTE_VIDEO",e.JOIN_CONFERENCE="JOIN_CONFERENCE",e.LEAVE_CONFERENCE="LEAVE_CONFERENCE",e.SIO_CONNECTED="SIO_CONNECTED",e.SIO_DISCONNECTED="SIO_DISCONNECTED",e.OPEN_DESKTOP_SHARE_QUALITY_MODE="OPEN_DESKTOP_SHARE_QUALITY_MODE",e.CLOSE_DESKTOP_SHARE="CLOSE_DESKTOP_SHARE",e.OPEN_AUDIO_SHARE="OPEN_AUDIO_SHARE",e.CLOSE_AUDIO_SHARE="CLOSE_AUDIO_SHARE",e.CANCEL_RECEIVE_DESKTOP_SHARE="CANCEL_RECEIVE_DESKTOP_SHARE",e.START_LOCAL_RECORD="START_LOCAL_RECORD",e.STOP_LOCAL_RECORD="STOP_LOCAL_RECORD",e.START_CLOUD_RECORD="START_CLOUD_RECORD",e.STOP_CLOUD_RECORD="STOP_CLOUD_RECORD",e.ICE_CONNECTED="ICE_CONNECTED",e.ICE_DISCONNECTED="ICE_DISCONNECTED",e.ICE_RECONNECTED="ICE_RECONNECTED",e.DESKTOP_FIRST_FRAME="DESKTOP_FIRST_FRAME",e.DESKTOP_NETWORK_BAD="DESKTOP_NETWORK_BAD",e.REOPEN_DESKTOP="REOPEN_DESKTOP",e.SUBSCRIBE_DESKTOP="SUBSCRIBE_DESKTOP",e.VIDEO_SUBSCRIBE="VIDEO_SUBSCRIBE",e.VIDEO_UNSUBSCRIBE="VIDEO_UNSUBSCRIBE",e.CHANGE_NICKNAME="CHANGE_NICKNAME",e.VIDEO_FIRST_FRAME="VIDEO_FIRST_FRAME",e.NETWORK="NETWORK",e.VIDEO_NETWORK="VIDEO_NETWORK",e.AUDIO_NETWORK="AUDIO_NETWORK",e.VIDEO_RECV="VIDEO_RECV",e.VIDEO_SEND="VIDEO_SEND",e.AUDIO_SEND="AUDIO_SEND",e.AUDIO_RECV="AUDIO_RECV"}(Events||(Events={}));class RoomService{constructor(e){const{socket:t,model:r}=e;this.Be=r,this.te=t}registerSocketEvent(e){this.Ut=new SocketHandler$1({emitter:e,socket:this.te,model:this.Be}),this.Ut.registerSocketEvent()}async startCloudRecord(e){await a$2.RSC.ve({path:{sessionId:this.Be.sessionId},data:e,headers:{"x-endpoint-id":this.Be.endpointId}})}async setMainVenue(e){await a$2.RSC.xe({path:{sessionId:this.Be.sessionId,endpointId:e.endpointId},data:{value:e.value},headers:{"x-endpoint-id":this.Be.endpointId}})}async changeRole(e){await a$2.RSC.Ce({path:{sessionId:this.Be.sessionId,endpointId:e.endpointId},data:{role:e.role},headers:{"x-endpoint-id":this.Be.endpointId}})}async batchKickOut(e){await a$2.RSC.Ee({path:{sessionId:this.Be.sessionId},data:e,headers:{"x-endpoint-id":this.Be.endpointId}})}async rejectUnmute(){await a$2.RSC.Ae({path:{sessionId:this.Be.sessionId,endpointId:this.Be.endpointId},headers:{"x-endpoint-id":this.Be.endpointId}})}async rejectTurnonVideo(){await a$2.RSC._e({path:{sessionId:this.Be.sessionId},headers:{"x-endpoint-id":this.Be.endpointId}})}async turnonVideo(e){await a$2.RSC.Se({path:{sessionId:this.Be.sessionId,endpointId:e},headers:{"x-endpoint-id":this.Be.endpointId}})}async turnoffVideo(e){await a$2.RSC.$e({path:{sessionId:this.Be.sessionId,endpointId:e},headers:{"x-endpoint-id":this.Be.endpointId}})}async stopCloudRecord(){await a$2.RSC.be({path:{sessionId:this.Be.sessionId},headers:{"x-endpoint-id":this.Be.endpointId}})}async kickOut(e){let{endpointId:t,canRejoin:r=!0}=e;if(this.Be.permissions.indexOf(exports.Permission.kickOutOtherEnable))return await a$2.RSC.le({path:{sessionId:this.Be.sessionId,endpointId:t},headers:{"x-endpoint-id":this.Be.endpointId},data:{canRejoin:r}})}async muteAll(e){if(!this.Be.permissions.indexOf(exports.Permission.muteAllEnable))return;const t=Date.now(),r=await a$2.RSC.me({path:{sessionId:this.Be.sessionId},headers:{"x-endpoint-id":this.Be.endpointId},data:{muted:null==e?void 0:e.muted,unmuteSelfEnabled:null==e?void 0:e.unmuteSelfEnabled}});return metrics.post(Events.MUTE_ALL_AUDIO,{consume:Date.now()-t}),r}async unmuteAll(){return await a$2.RSC.ge({path:{sessionId:this.Be.sessionId},headers:{"x-endpoint-id":this.Be.endpointId}})}async unmute(e){return await a$2.RSC.fe({path:{sessionId:this.Be.sessionId,endpointId:e},headers:{"x-endpoint-id":this.Be.endpointId}})}async mute(e){return await a$2.RSC.de({path:{sessionId:this.Be.sessionId,endpointId:e},headers:{"x-endpoint-id":this.Be.endpointId}})}async muteSpeaker(e){return await a$2.RSC.Ie({path:{sessionId:this.Be.sessionId,endpointId:e},headers:{"x-endpoint-id":this.Be.endpointId}})}async unmuteSpeaker(e){return await a$2.RSC.je({path:{sessionId:this.Be.sessionId,endpointId:e},headers:{"x-endpoint-id":this.Be.endpointId}})}async getMembers(){const e=await a$2.RSC.he({path:{sessionId:this.Be.sessionId},headers:{"x-endpoint-id":this.Be.endpointId},params:{size:9999}}),t=e.data.data.map((e=>{const{mediaOpts:t,...r}=e;return{...r,endpointId:r.id}}));return this.Be.setMembers(e.data.data),t}async getRoomInfo(){const{data:e}=await a$2.RSC.Te({path:{sessionId:this.Be.sessionId},headers:{operator:this.Be.endpointId}});return e}async getRoomOptions(){const{data:e}=await a$2.RSC.Re({path:{sessionId:this.Be.sessionId},headers:{"x-endpoint-id":this.Be.endpointId}});return e}async setRoomOptions(e){const{data:t}=await a$2.RSC.Oe({path:{sessionId:this.Be.sessionId},headers:{"x-endpoint-id":this.Be.endpointId},data:e});return t}async changeNickname(e){let{endpointId:t,nickname:r}=e;const{data:i}=await a$2.RSC.Me({path:{sessionId:this.Be.sessionId,endpointId:t},headers:{"x-endpoint-id":this.Be.endpointId},data:{nickname:r}});return i}async hangUp(){const{data:e}=await a$2.RSC.qe({path:{sessionId:this.Be.sessionId},headers:{"x-endpoint-id":this.Be.endpointId}});return e}async hangOn(){const{data:e}=await a$2.RSC.Ne({path:{sessionId:this.Be.sessionId},headers:{"x-endpoint-id":this.Be.endpointId}});return e}async turnOffAudioMode(){const{data:e}=await a$2.RSC.De({path:{sessionId:this.Be.sessionId},headers:{"x-endpoint-id":this.Be.endpointId}});return e}async turnOnAudioMode(){const{data:e}=await a$2.RSC.Pe({path:{sessionId:this.Be.sessionId},headers:{"x-endpoint-id":this.Be.endpointId}});return e}}var lib={},parser$1={},grammarExports={},grammar$2={get exports(){return grammarExports},set exports(e){grammarExports=e}},grammar$1=grammar$2.exports={v:[{name:"version",reg:/^(\d*)$/}],o:[{name:"origin",reg:/^(\S*) (\d*) (\d*) (\S*) IP(\d) (\S*)/,names:["username","sessionId","sessionVersion","netType","ipVer","address"],format:"%s %s %d %s IP%d %s"}],s:[{name:"name"}],i:[{name:"description"}],u:[{name:"uri"}],e:[{name:"email"}],p:[{name:"phone"}],z:[{name:"timezones"}],r:[{name:"repeats"}],t:[{name:"timing",reg:/^(\d*) (\d*)/,names:["start","stop"],format:"%d %d"}],c:[{name:"connection",reg:/^IN IP(\d) (\S*)/,names:["version","ip"],format:"IN IP%d %s"}],b:[{push:"bandwidth",reg:/^(TIAS|AS|CT|RR|RS):(\d*)/,names:["type","limit"],format:"%s:%s"}],m:[{reg:/^(\w*) (\d*) ([\w/]*)(?: (.*))?/,names:["type","port","protocol","payloads"],format:"%s %d %s %s"}],a:[{push:"rtp",reg:/^rtpmap:(\d*) ([\w\-.]*)(?:\s*\/(\d*)(?:\s*\/(\S*))?)?/,names:["payload","codec","rate","encoding"],format:function(e){return e.encoding?"rtpmap:%d %s/%s/%s":e.rate?"rtpmap:%d %s/%s":"rtpmap:%d %s"}},{push:"fmtp",reg:/^fmtp:(\d*) ([\S| ]*)/,names:["payload","config"],format:"fmtp:%d %s"},{name:"control",reg:/^control:(.*)/,format:"control:%s"},{name:"rtcp",reg:/^rtcp:(\d*)(?: (\S*) IP(\d) (\S*))?/,names:["port","netType","ipVer","address"],format:function(e){return null!=e.address?"rtcp:%d %s IP%d %s":"rtcp:%d"}},{push:"rtcpFbTrrInt",reg:/^rtcp-fb:(\*|\d*) trr-int (\d*)/,names:["payload","value"],format:"rtcp-fb:%s trr-int %d"},{push:"rtcpFb",reg:/^rtcp-fb:(\*|\d*) ([\w-_]*)(?: ([\w-_]*))?/,names:["payload","type","subtype"],format:function(e){return null!=e.subtype?"rtcp-fb:%s %s %s":"rtcp-fb:%s %s"}},{push:"ext",reg:/^extmap:(\d+)(?:\/(\w+))?(?: (urn:ietf:params:rtp-hdrext:encrypt))? (\S*)(?: (\S*))?/,names:["value","direction","encrypt-uri","uri","config"],format:function(e){return"extmap:%d"+(e.direction?"/%s":"%v")+(e["encrypt-uri"]?" %s":"%v")+" %s"+(e.config?" %s":"")}},{name:"extmapAllowMixed",reg:/^(extmap-allow-mixed)/},{push:"crypto",reg:/^crypto:(\d*) ([\w_]*) (\S*)(?: (\S*))?/,names:["id","suite","config","sessionConfig"],format:function(e){return null!=e.sessionConfig?"crypto:%d %s %s %s":"crypto:%d %s %s"}},{name:"setup",reg:/^setup:(\w*)/,format:"setup:%s"},{name:"connectionType",reg:/^connection:(new|existing)/,format:"connection:%s"},{name:"mid",reg:/^mid:([^\s]*)/,format:"mid:%s"},{name:"msid",reg:/^msid:(.*)/,format:"msid:%s"},{name:"ptime",reg:/^ptime:(\d*(?:\.\d*)*)/,format:"ptime:%d"},{name:"maxptime",reg:/^maxptime:(\d*(?:\.\d*)*)/,format:"maxptime:%d"},{name:"direction",reg:/^(sendrecv|recvonly|sendonly|inactive)/},{name:"icelite",reg:/^(ice-lite)/},{name:"iceUfrag",reg:/^ice-ufrag:(\S*)/,format:"ice-ufrag:%s"},{name:"icePwd",reg:/^ice-pwd:(\S*)/,format:"ice-pwd:%s"},{name:"fingerprint",reg:/^fingerprint:(\S*) (\S*)/,names:["type","hash"],format:"fingerprint:%s %s"},{push:"candidates",reg:/^candidate:(\S*) (\d*) (\S*) (\d*) (\S*) (\d*) typ (\S*)(?: raddr (\S*) rport (\d*))?(?: tcptype (\S*))?(?: generation (\d*))?(?: network-id (\d*))?(?: network-cost (\d*))?/,names:["foundation","component","transport","priority","ip","port","type","raddr","rport","tcptype","generation","network-id","network-cost"],format:function(e){var t="candidate:%s %d %s %d %s %d typ %s";return t+=null!=e.raddr?" raddr %s rport %d":"%v%v",t+=null!=e.tcptype?" tcptype %s":"%v",null!=e.generation&&(t+=" generation %d"),(t+=null!=e["network-id"]?" network-id %d":"%v")+(null!=e["network-cost"]?" network-cost %d":"%v")}},{name:"endOfCandidates",reg:/^(end-of-candidates)/},{name:"remoteCandidates",reg:/^remote-candidates:(.*)/,format:"remote-candidates:%s"},{name:"iceOptions",reg:/^ice-options:(\S*)/,format:"ice-options:%s"},{push:"ssrcs",reg:/^ssrc:(\d*) ([\w_-]*)(?::(.*))?/,names:["id","attribute","value"],format:function(e){var t="ssrc:%d";return null!=e.attribute&&(t+=" %s",null!=e.value&&(t+=":%s")),t}},{push:"ssrcGroups",reg:/^ssrc-group:([\x21\x23\x24\x25\x26\x27\x2A\x2B\x2D\x2E\w]*) (.*)/,names:["semantics","ssrcs"],format:"ssrc-group:%s %s"},{name:"msidSemantic",reg:/^msid-semantic:\s?(\w*) (\S*)/,names:["semantic","token"],format:"msid-semantic: %s %s"},{push:"groups",reg:/^group:(\w*) (.*)/,names:["type","mids"],format:"group:%s %s"},{name:"rtcpMux",reg:/^(rtcp-mux)/},{name:"rtcpRsize",reg:/^(rtcp-rsize)/},{name:"sctpmap",reg:/^sctpmap:([\w_/]*) (\S*)(?: (\S*))?/,names:["sctpmapNumber","app","maxMessageSize"],format:function(e){return null!=e.maxMessageSize?"sctpmap:%s %s %s":"sctpmap:%s %s"}},{name:"xGoogleFlag",reg:/^x-google-flag:([^\s]*)/,format:"x-google-flag:%s"},{push:"rids",reg:/^rid:([\d\w]+) (\w+)(?: ([\S| ]*))?/,names:["id","direction","params"],format:function(e){return e.params?"rid:%s %s %s":"rid:%s %s"}},{push:"imageattrs",reg:new RegExp("^imageattr:(\\d+|\\*)[\\s\\t]+(send|recv)[\\s\\t]+(\\*|\\[\\S+\\](?:[\\s\\t]+\\[\\S+\\])*)(?:[\\s\\t]+(recv|send)[\\s\\t]+(\\*|\\[\\S+\\](?:[\\s\\t]+\\[\\S+\\])*))?"),names:["pt","dir1","attrs1","dir2","attrs2"],format:function(e){return"imageattr:%s %s %s"+(e.dir2?" %s %s":"")}},{name:"simulcast",reg:new RegExp("^simulcast:(send|recv) ([a-zA-Z0-9\\-_~;,]+)(?:\\s?(send|recv) ([a-zA-Z0-9\\-_~;,]+))?$"),names:["dir1","list1","dir2","list2"],format:function(e){return"simulcast:%s %s"+(e.dir2?" %s %s":"")}},{name:"simulcast_03",reg:/^simulcast:[\s\t]+([\S+\s\t]+)$/,names:["value"],format:"simulcast: %s"},{name:"framerate",reg:/^framerate:(\d+(?:$|\.\d+))/,format:"framerate:%s"},{name:"sourceFilter",reg:/^source-filter: *(excl|incl) (\S*) (IP4|IP6|\*) (\S*) (.*)/,names:["filterMode","netType","addressTypes","destAddress","srcList"],format:"source-filter: %s %s %s %s %s"},{name:"bundleOnly",reg:/^(bundle-only)/},{name:"label",reg:/^label:(.+)/,format:"label:%s"},{name:"sctpPort",reg:/^sctp-port:(\d+)$/,format:"sctp-port:%s"},{name:"maxMessageSize",reg:/^max-message-size:(\d+)$/,format:"max-message-size:%s"},{push:"tsRefClocks",reg:/^ts-refclk:([^\s=]*)(?:=(\S*))?/,names:["clksrc","clksrcExt"],format:function(e){return"ts-refclk:%s"+(null!=e.clksrcExt?"=%s":"")}},{name:"mediaClk",reg:/^mediaclk:(?:id=(\S*))? *([^\s=]*)(?:=(\S*))?(?: *rate=(\d+)\/(\d+))?/,names:["id","mediaClockName","mediaClockValue","rateNumerator","rateDenominator"],format:function(e){var t="mediaclk:";return t+=null!=e.id?"id=%s %s":"%v%s",t+=null!=e.mediaClockValue?"=%s":"",(t+=null!=e.rateNumerator?" rate=%s":"")+(null!=e.rateDenominator?"/%s":"")}},{name:"keywords",reg:/^keywds:(.+)$/,format:"keywds:%s"},{name:"content",reg:/^content:(.+)/,format:"content:%s"},{name:"bfcpFloorCtrl",reg:/^floorctrl:(c-only|s-only|c-s)/,format:"floorctrl:%s"},{name:"bfcpConfId",reg:/^confid:(\d+)/,format:"confid:%s"},{name:"bfcpUserId",reg:/^userid:(\d+)/,format:"userid:%s"},{name:"bfcpFloorId",reg:/^floorid:(.+) (?:m-stream|mstrm):(.+)/,names:["id","mStream"],format:"floorid:%s mstrm:%s"},{push:"invalid",names:["value"]}]};Object.keys(grammar$1).forEach((function(e){grammar$1[e].forEach((function(e){e.reg||(e.reg=/(.*)/),e.format||(e.format="%s")}))})),function(e){var t=function(e){return String(Number(e))===e?Number(e):e},r=function(e,r,i){var n=e.name&&e.names;e.push&&!r[e.push]?r[e.push]=[]:n&&!r[e.name]&&(r[e.name]={});var s=e.push?{}:n?r[e.name]:r;!function(e,r,i,n){if(n&&!i)r[n]=t(e[1]);else for(var s=0;s<i.length;s+=1)null!=e[s+1]&&(r[i[s]]=t(e[s+1]))}(i.match(e.reg),s,e.names,e.name),e.push&&r[e.push].push(s)},i=grammarExports,n=RegExp.prototype.test.bind(/^([a-z])=(.*)/);e.parse=function(e){var t={},s=[],o=t;return e.split(/(\r\n|\r|\n)/).filter(n).forEach((function(e){var t=e[0],n=e.slice(2);"m"===t&&(s.push({rtp:[],fmtp:[]}),o=s[s.length-1]);for(var a=0;a<(i[t]||[]).length;a+=1){var c=i[t][a];if(c.reg.test(n))return r(c,o,n)}})),t.media=s,t};var s=function(e,r){var i=r.split(/=(.+)/,2);return 2===i.length?e[i[0]]=t(i[1]):1===i.length&&r.length>1&&(e[i[0]]=void 0),e};e.parseParams=function(e){return e.split(/;\s?/).reduce(s,{})},e.parseFmtpConfig=e.parseParams,e.parsePayloads=function(e){return e.toString().split(" ").map(Number)},e.parseRemoteCandidates=function(e){for(var r=[],i=e.split(" ").map(t),n=0;n<i.length;n+=3)r.push({component:i[n],ip:i[n+1],port:i[n+2]});return r},e.parseImageAttributes=function(e){return e.split(" ").map((function(e){return e.substring(1,e.length-1).split(",").reduce(s,{})}))},e.parseSimulcastStreamList=function(e){return e.split(";").map((function(e){return e.split(",").map((function(e){var r,i=!1;return"~"!==e[0]?r=t(e):(r=t(e.substring(1,e.length)),i=!0),{scid:r,paused:i}}))}))}}(parser$1);var grammar=grammarExports,formatRegExp=/%[sdv%]/g,format=function(e){var t=1,r=arguments,i=r.length;return e.replace(formatRegExp,(function(e){if(t>=i)return e;var n=r[t];switch(t+=1,e){case"%%":return"%";case"%s":return String(n);case"%d":return Number(n);case"%v":return""}}))},makeLine=function(e,t,r){var i=[e+"="+(t.format instanceof Function?t.format(t.push?r:r[t.name]):t.format)];if(t.names)for(var n=0;n<t.names.length;n+=1){var s=t.names[n];t.name?i.push(r[t.name][s]):i.push(r[t.names[n]])}else i.push(r[t.name]);return format.apply(null,i)},defaultOuterOrder=["v","o","s","i","u","e","p","c","b","t","r","z","a"],defaultInnerOrder=["i","c","b","a"],writer$2=function(e,t){t=t||{},null==e.version&&(e.version=0),null==e.name&&(e.name=" "),e.media.forEach((function(e){null==e.payloads&&(e.payloads="")}));var r=t.outerOrder||defaultOuterOrder,i=t.innerOrder||defaultInnerOrder,n=[];return r.forEach((function(t){grammar[t].forEach((function(r){r.name in e&&null!=e[r.name]?n.push(makeLine(t,r,e)):r.push in e&&null!=e[r.push]&&e[r.push].forEach((function(e){n.push(makeLine(t,r,e))}))}))})),e.media.forEach((function(e){n.push(makeLine("m",grammar.m[0],e)),i.forEach((function(t){grammar[t].forEach((function(r){r.name in e&&null!=e[r.name]?n.push(makeLine(t,r,e)):r.push in e&&null!=e[r.push]&&e[r.push].forEach((function(e){n.push(makeLine(t,r,e))}))}))}))})),n.join("\r\n")+"\r\n"},parser=parser$1,writer$1=writer$2,PeerEvents;function listCacheClear$1(){this.__data__=[],this.size=0}lib.write=writer$1,lib.parse=parser.parse,lib.parseParams=parser.parseParams,lib.parseFmtpConfig=parser.parseFmtpConfig,lib.parsePayloads=parser.parsePayloads,lib.parseRemoteCandidates=parser.parseRemoteCandidates,lib.parseImageAttributes=parser.parseImageAttributes,lib.parseSimulcastStreamList=parser.parseSimulcastStreamList,exports.NetworkQuality=void 0,function(e){e[e.Online=0]="Online",e[e.Excellent=1]="Excellent",e[e.Good=2]="Good",e[e.SmallFlaw=3]="SmallFlaw",e[e.NotFluent=4]="NotFluent",e[e.Bad=5]="Bad",e[e.Offline=6]="Offline"}(exports.NetworkQuality||(exports.NetworkQuality={})),function(e){e.OnICECandidate="OnICECandidate",e.ConnectionState="ConnectionState",e.RemoteStreamAdded="RemoteStreamAdded",e.DataChannelMessage="DataChannelMessage",e.DataChannelOpen="DataChannelOpen",e.DataChannelError="DataChannelError",e.DataChannelClose="DataChannelClose",e.NetworkQuality="NetworkQuality",e.RTCStats="RTCStats"}(PeerEvents||(PeerEvents={}));var _listCacheClear=listCacheClear$1;function eq$5(e,t){return e===t||e!=e&&t!=t}var eq_1=eq$5,eq$4=eq_1;function assocIndexOf$4(e,t){for(var r=e.length;r--;)if(eq$4(e[r][0],t))return r;return-1}var _assocIndexOf=assocIndexOf$4,assocIndexOf$3=_assocIndexOf,arrayProto=Array.prototype,splice=arrayProto.splice;function listCacheDelete$1(e){var t=this.__data__,r=assocIndexOf$3(t,e);return!(r<0||(r==t.length-1?t.pop():splice.call(t,r,1),--this.size,0))}var _listCacheDelete=listCacheDelete$1,assocIndexOf$2=_assocIndexOf;function listCacheGet$1(e){var t=this.__data__,r=assocIndexOf$2(t,e);return r<0?void 0:t[r][1]}var _listCacheGet=listCacheGet$1,assocIndexOf$1=_assocIndexOf;function listCacheHas$1(e){return assocIndexOf$1(this.__data__,e)>-1}var _listCacheHas=listCacheHas$1,assocIndexOf=_assocIndexOf;function listCacheSet$1(e,t){var r=this.__data__,i=assocIndexOf(r,e);return i<0?(++this.size,r.push([e,t])):r[i][1]=t,this}var _listCacheSet=listCacheSet$1,listCacheClear=_listCacheClear,listCacheDelete=_listCacheDelete,listCacheGet=_listCacheGet,listCacheHas=_listCacheHas,listCacheSet=_listCacheSet;function ListCache$4(e){var t=-1,r=null==e?0:e.length;for(this.clear();++t<r;){var i=e[t];this.set(i[0],i[1])}}ListCache$4.prototype.clear=listCacheClear,ListCache$4.prototype.delete=listCacheDelete,ListCache$4.prototype.get=listCacheGet,ListCache$4.prototype.has=listCacheHas,ListCache$4.prototype.set=listCacheSet;var _ListCache=ListCache$4,ListCache$3=_ListCache;function stackClear$1(){this.__data__=new ListCache$3,this.size=0}var _stackClear=stackClear$1;function stackDelete$1(e){var t=this.__data__,r=t.delete(e);return this.size=t.size,r}var _stackDelete=stackDelete$1;function stackGet$1(e){return this.__data__.get(e)}var _stackGet=stackGet$1;function stackHas$1(e){return this.__data__.has(e)}var _stackHas=stackHas$1,freeGlobal$1="object"==typeof commonjsGlobal&&commonjsGlobal&&commonjsGlobal.Object===Object&&commonjsGlobal,_freeGlobal=freeGlobal$1,freeGlobal=_freeGlobal,freeSelf="object"==typeof self&&self&&self.Object===Object&&self,root$8=freeGlobal||freeSelf||Function("return this")(),_root=root$8,root$7=_root,Symbol$5=root$7.Symbol,_Symbol=Symbol$5,Symbol$4=_Symbol,objectProto$f=Object.prototype,hasOwnProperty$c=objectProto$f.hasOwnProperty,nativeObjectToString$1=objectProto$f.toString,symToStringTag$1=Symbol$4?Symbol$4.toStringTag:void 0;function getRawTag$1(e){var t=hasOwnProperty$c.call(e,symToStringTag$1),r=e[symToStringTag$1];try{e[symToStringTag$1]=void 0;var i=!0}catch(e){}var n=nativeObjectToString$1.call(e);return i&&(t?e[symToStringTag$1]=r:delete e[symToStringTag$1]),n}var _getRawTag=getRawTag$1,objectProto$e=Object.prototype,nativeObjectToString=objectProto$e.toString;function objectToString$1(e){return nativeObjectToString.call(e)}var _objectToString=objectToString$1,Symbol$3=_Symbol,getRawTag=_getRawTag,objectToString=_objectToString,nullTag="[object Null]",undefinedTag="[object Undefined]",symToStringTag=Symbol$3?Symbol$3.toStringTag:void 0;function baseGetTag$5(e){return null==e?void 0===e?undefinedTag:nullTag:symToStringTag&&symToStringTag in Object(e)?getRawTag(e):objectToString(e)}var _baseGetTag=baseGetTag$5;function isObject$8(e){var t=typeof e;return null!=e&&("object"==t||"function"==t)}var isObject_1=isObject$8,baseGetTag$4=_baseGetTag,isObject$7=isObject_1,asyncTag="[object AsyncFunction]",funcTag$2="[object Function]",genTag$1="[object GeneratorFunction]",proxyTag="[object Proxy]";function isFunction$3(e){if(!isObject$7(e))return!1;var t=baseGetTag$4(e);return t==funcTag$2||t==genTag$1||t==asyncTag||t==proxyTag}var isFunction_1=isFunction$3,root$6=_root,coreJsData$1=root$6["__core-js_shared__"],_coreJsData=coreJsData$1,coreJsData=_coreJsData,maskSrcKey=(uid=/[^.]+$/.exec(coreJsData&&coreJsData.keys&&coreJsData.keys.IE_PROTO||""),uid?"Symbol(src)_1."+uid:""),uid;function isMasked$1(e){return!!maskSrcKey&&maskSrcKey in e}var _isMasked=isMasked$1,funcProto$2=Function.prototype,funcToString$2=funcProto$2.toString;function toSource$2(e){if(null!=e){try{return funcToString$2.call(e)}catch(e){}try{return e+""}catch(e){}}return""}var _toSource=toSource$2,isFunction$2=isFunction_1,isMasked=_isMasked,isObject$6=isObject_1,toSource$1=_toSource,reRegExpChar=/[\\^$.*+?()[\]{}|]/g,reIsHostCtor=/^\[object .+?Constructor\]$/,funcProto$1=Function.prototype,objectProto$d=Object.prototype,funcToString$1=funcProto$1.toString,hasOwnProperty$b=objectProto$d.hasOwnProperty,reIsNative=RegExp("^"+funcToString$1.call(hasOwnProperty$b).replace(reRegExpChar,"\\$&").replace(/hasOwnProperty|(function).*?(?=\\\()| for .+?(?=\\\])/g,"$1.*?")+"$");function baseIsNative$1(e){return!(!isObject$6(e)||isMasked(e))&&(isFunction$2(e)?reIsNative:reIsHostCtor).test(toSource$1(e))}var _baseIsNative=baseIsNative$1;function getValue$1(e,t){return null==e?void 0:e[t]}var _getValue=getValue$1,baseIsNative=_baseIsNative,getValue=_getValue;function getNative$7(e,t){var r=getValue(e,t);return baseIsNative(r)?r:void 0}var _getNative=getNative$7,getNative$6=_getNative,root$5=_root,Map$4=getNative$6(root$5,"Map"),_Map=Map$4,getNative$5=_getNative,nativeCreate$4=getNative$5(Object,"create"),_nativeCreate=nativeCreate$4,nativeCreate$3=_nativeCreate;function hashClear$1(){this.__data__=nativeCreate$3?nativeCreate$3(null):{},this.size=0}var _hashClear=hashClear$1;function hashDelete$1(e){var t=this.has(e)&&delete this.__data__[e];return this.size-=t?1:0,t}var _hashDelete=hashDelete$1,nativeCreate$2=_nativeCreate,HASH_UNDEFINED$2="__lodash_hash_undefined__",objectProto$c=Object.prototype,hasOwnProperty$a=objectProto$c.hasOwnProperty;function hashGet$1(e){var t=this.__data__;if(nativeCreate$2){var r=t[e];return r===HASH_UNDEFINED$2?void 0:r}return hasOwnProperty$a.call(t,e)?t[e]:void 0}var _hashGet=hashGet$1,nativeCreate$1=_nativeCreate,objectProto$b=Object.prototype,hasOwnProperty$9=objectProto$b.hasOwnProperty;function hashHas$1(e){var t=this.__data__;return nativeCreate$1?void 0!==t[e]:hasOwnProperty$9.call(t,e)}var _hashHas=hashHas$1,nativeCreate=_nativeCreate,HASH_UNDEFINED$1="__lodash_hash_undefined__";function hashSet$1(e,t){var r=this.__data__;return this.size+=this.has(e)?0:1,r[e]=nativeCreate&&void 0===t?HASH_UNDEFINED$1:t,this}var _hashSet=hashSet$1,hashClear=_hashClear,hashDelete=_hashDelete,hashGet=_hashGet,hashHas=_hashHas,hashSet=_hashSet;function Hash$1(e){var t=-1,r=null==e?0:e.length;for(this.clear();++t<r;){var i=e[t];this.set(i[0],i[1])}}Hash$1.prototype.clear=hashClear,Hash$1.prototype.delete=hashDelete,Hash$1.prototype.get=hashGet,Hash$1.prototype.has=hashHas,Hash$1.prototype.set=hashSet;var _Hash=Hash$1,Hash=_Hash,ListCache$2=_ListCache,Map$3=_Map;function mapCacheClear$1(){this.size=0,this.__data__={hash:new Hash,map:new(Map$3||ListCache$2),string:new Hash}}var _mapCacheClear=mapCacheClear$1;function isKeyable$1(e){var t=typeof e;return"string"==t||"number"==t||"symbol"==t||"boolean"==t?"__proto__"!==e:null===e}var _isKeyable=isKeyable$1,isKeyable=_isKeyable;function getMapData$4(e,t){var r=e.__data__;return isKeyable(t)?r["string"==typeof t?"string":"hash"]:r.map}var _getMapData=getMapData$4,getMapData$3=_getMapData;function mapCacheDelete$1(e){var t=getMapData$3(this,e).delete(e);return this.size-=t?1:0,t}var _mapCacheDelete=mapCacheDelete$1,getMapData$2=_getMapData;function mapCacheGet$1(e){return getMapData$2(this,e).get(e)}var _mapCacheGet=mapCacheGet$1,getMapData$1=_getMapData;function mapCacheHas$1(e){return getMapData$1(this,e).has(e)}var _mapCacheHas=mapCacheHas$1,getMapData=_getMapData;function mapCacheSet$1(e,t){var r=getMapData(this,e),i=r.size;return r.set(e,t),this.size+=r.size==i?0:1,this}var _mapCacheSet=mapCacheSet$1,mapCacheClear=_mapCacheClear,mapCacheDelete=_mapCacheDelete,mapCacheGet=_mapCacheGet,mapCacheHas=_mapCacheHas,mapCacheSet=_mapCacheSet;function MapCache$2(e){var t=-1,r=null==e?0:e.length;for(this.clear();++t<r;){var i=e[t];this.set(i[0],i[1])}}MapCache$2.prototype.clear=mapCacheClear,MapCache$2.prototype.delete=mapCacheDelete,MapCache$2.prototype.get=mapCacheGet,MapCache$2.prototype.has=mapCacheHas,MapCache$2.prototype.set=mapCacheSet;var _MapCache=MapCache$2,ListCache$1=_ListCache,Map$2=_Map,MapCache$1=_MapCache,LARGE_ARRAY_SIZE=200;function stackSet$1(e,t){var r=this.__data__;if(r instanceof ListCache$1){var i=r.__data__;if(!Map$2||i.length<LARGE_ARRAY_SIZE-1)return i.push([e,t]),this.size=++r.size,this;r=this.__data__=new MapCache$1(i)}return r.set(e,t),this.size=r.size,this}var _stackSet=stackSet$1,ListCache=_ListCache,stackClear=_stackClear,stackDelete=_stackDelete,stackGet=_stackGet,stackHas=_stackHas,stackSet=_stackSet;function Stack$3(e){var t=this.__data__=new ListCache(e);this.size=t.size}Stack$3.prototype.clear=stackClear,Stack$3.prototype.delete=stackDelete,Stack$3.prototype.get=stackGet,Stack$3.prototype.has=stackHas,Stack$3.prototype.set=stackSet;var _Stack=Stack$3;function arrayEach$1(e,t){for(var r=-1,i=null==e?0:e.length;++r<i&&!1!==t(e[r],r,e););return e}var _arrayEach=arrayEach$1,getNative$4=_getNative,defineProperty$2=function(){try{var e=getNative$4(Object,"defineProperty");return e({},"",{}),e}catch(e){}}(),_defineProperty=defineProperty$2,defineProperty$1=_defineProperty;function baseAssignValue$3(e,t,r){"__proto__"==t&&defineProperty$1?defineProperty$1(e,t,{configurable:!0,enumerable:!0,value:r,writable:!0}):e[t]=r}var _baseAssignValue=baseAssignValue$3,baseAssignValue$2=_baseAssignValue,eq$3=eq_1,objectProto$a=Object.prototype,hasOwnProperty$8=objectProto$a.hasOwnProperty;function assignValue$2(e,t,r){var i=e[t];hasOwnProperty$8.call(e,t)&&eq$3(i,r)&&(void 0!==r||t in e)||baseAssignValue$2(e,t,r)}var _assignValue=assignValue$2,assignValue$1=_assignValue,baseAssignValue$1=_baseAssignValue;function copyObject$5(e,t,r,i){var n=!r;r||(r={});for(var s=-1,o=t.length;++s<o;){var a=t[s],c=i?i(r[a],e[a],a,r,e):void 0;void 0===c&&(c=e[a]),n?baseAssignValue$1(r,a,c):assignValue$1(r,a,c)}return r}var _copyObject=copyObject$5;function baseTimes$1(e,t){for(var r=-1,i=Array(e);++r<e;)i[r]=t(r);return i}var _baseTimes=baseTimes$1;function isObjectLike$8(e){return null!=e&&"object"==typeof e}var isObjectLike_1=isObjectLike$8,baseGetTag$3=_baseGetTag,isObjectLike$7=isObjectLike_1,argsTag$3="[object Arguments]";function baseIsArguments$1(e){return isObjectLike$7(e)&&baseGetTag$3(e)==argsTag$3}var _baseIsArguments=baseIsArguments$1,baseIsArguments=_baseIsArguments,isObjectLike$6=isObjectLike_1,objectProto$9=Object.prototype,hasOwnProperty$7=objectProto$9.hasOwnProperty,propertyIsEnumerable$1=objectProto$9.propertyIsEnumerable,isArguments$2=baseIsArguments(function(){return arguments}())?baseIsArguments:function(e){return isObjectLike$6(e)&&hasOwnProperty$7.call(e,"callee")&&!propertyIsEnumerable$1.call(e,"callee")},isArguments_1=isArguments$2,isArray$5=Array.isArray,isArray_1=isArray$5,isBufferExports={},isBuffer$4={get exports(){return isBufferExports},set exports(e){isBufferExports=e}};function stubFalse(){return!1}var stubFalse_1=stubFalse;!function(e,t){var r=_root,i=stubFalse_1,n=t&&!t.nodeType&&t,s=n&&e&&!e.nodeType&&e,o=s&&s.exports===n?r.Buffer:void 0,a=(o?o.isBuffer:void 0)||i;e.exports=a}(isBuffer$4,isBufferExports);var MAX_SAFE_INTEGER$1=9007199254740991,reIsUint=/^(?:0|[1-9]\d*)$/;function isIndex$2(e,t){var r=typeof e;return!!(t=null==t?MAX_SAFE_INTEGER$1:t)&&("number"==r||"symbol"!=r&&reIsUint.test(e))&&e>-1&&e%1==0&&e<t}var _isIndex=isIndex$2,MAX_SAFE_INTEGER=9007199254740991;function isLength$2(e){return"number"==typeof e&&e>-1&&e%1==0&&e<=MAX_SAFE_INTEGER}var isLength_1=isLength$2,baseGetTag$2=_baseGetTag,isLength$1=isLength_1,isObjectLike$5=isObjectLike_1,argsTag$2="[object Arguments]",arrayTag$2="[object Array]",boolTag$3="[object Boolean]",dateTag$3="[object Date]",errorTag$2="[object Error]",funcTag$1="[object Function]",mapTag$5="[object Map]",numberTag$3="[object Number]",objectTag$4="[object Object]",regexpTag$3="[object RegExp]",setTag$5="[object Set]",stringTag$3="[object String]",weakMapTag$2="[object WeakMap]",arrayBufferTag$3="[object ArrayBuffer]",dataViewTag$4="[object DataView]",float32Tag$2="[object Float32Array]",float64Tag$2="[object Float64Array]",int8Tag$2="[object Int8Array]",int16Tag$2="[object Int16Array]",int32Tag$2="[object Int32Array]",uint8Tag$2="[object Uint8Array]",uint8ClampedTag$2="[object Uint8ClampedArray]",uint16Tag$2="[object Uint16Array]",uint32Tag$2="[object Uint32Array]",typedArrayTags={};function baseIsTypedArray$1(e){return isObjectLike$5(e)&&isLength$1(e.length)&&!!typedArrayTags[baseGetTag$2(e)]}typedArrayTags[float32Tag$2]=typedArrayTags[float64Tag$2]=typedArrayTags[int8Tag$2]=typedArrayTags[int16Tag$2]=typedArrayTags[int32Tag$2]=typedArrayTags[uint8Tag$2]=typedArrayTags[uint8ClampedTag$2]=typedArrayTags[uint16Tag$2]=typedArrayTags[uint32Tag$2]=!0,typedArrayTags[argsTag$2]=typedArrayTags[arrayTag$2]=typedArrayTags[arrayBufferTag$3]=typedArrayTags[boolTag$3]=typedArrayTags[dataViewTag$4]=typedArrayTags[dateTag$3]=typedArrayTags[errorTag$2]=typedArrayTags[funcTag$1]=typedArrayTags[mapTag$5]=typedArrayTags[numberTag$3]=typedArrayTags[objectTag$4]=typedArrayTags[regexpTag$3]=typedArrayTags[setTag$5]=typedArrayTags[stringTag$3]=typedArrayTags[weakMapTag$2]=!1;var _baseIsTypedArray=baseIsTypedArray$1;function baseUnary$3(e){return function(t){return e(t)}}var _baseUnary=baseUnary$3,_nodeUtilExports={},_nodeUtil={get exports(){return _nodeUtilExports},set exports(e){_nodeUtilExports=e}};!function(e,t){var r=_freeGlobal,i=t&&!t.nodeType&&t,n=i&&e&&!e.nodeType&&e,s=n&&n.exports===i&&r.process,o=function(){try{return n&&n.require&&n.require("util").types||s&&s.binding&&s.binding("util")}catch(e){}}();e.exports=o}(_nodeUtil,_nodeUtilExports);var baseIsTypedArray=_baseIsTypedArray,baseUnary$2=_baseUnary,nodeUtil$2=_nodeUtilExports,nodeIsTypedArray=nodeUtil$2&&nodeUtil$2.isTypedArray,isTypedArray$3=nodeIsTypedArray?baseUnary$2(nodeIsTypedArray):baseIsTypedArray,isTypedArray_1=isTypedArray$3,baseTimes=_baseTimes,isArguments$1=isArguments_1,isArray$4=isArray_1,isBuffer$3=isBufferExports,isIndex$1=_isIndex,isTypedArray$2=isTypedArray_1,objectProto$8=Object.prototype,hasOwnProperty$6=objectProto$8.hasOwnProperty;function arrayLikeKeys$2(e,t){var r=isArray$4(e),i=!r&&isArguments$1(e),n=!r&&!i&&isBuffer$3(e),s=!r&&!i&&!n&&isTypedArray$2(e),o=r||i||n||s,a=o?baseTimes(e.length,String):[],c=a.length;for(var u in e)!t&&!hasOwnProperty$6.call(e,u)||o&&("length"==u||n&&("offset"==u||"parent"==u)||s&&("buffer"==u||"byteLength"==u||"byteOffset"==u)||isIndex$1(u,c))||a.push(u);return a}var _arrayLikeKeys=arrayLikeKeys$2,objectProto$7=Object.prototype;function isPrototype$3(e){var t=e&&e.constructor;return e===("function"==typeof t&&t.prototype||objectProto$7)}var _isPrototype=isPrototype$3;function overArg$2(e,t){return function(r){return e(t(r))}}var _overArg=overArg$2,overArg$1=_overArg,nativeKeys$1=overArg$1(Object.keys,Object),_nativeKeys=nativeKeys$1,isPrototype$2=_isPrototype,nativeKeys=_nativeKeys,objectProto$6=Object.prototype,hasOwnProperty$5=objectProto$6.hasOwnProperty;function baseKeys$1(e){if(!isPrototype$2(e))return nativeKeys(e);var t=[];for(var r in Object(e))hasOwnProperty$5.call(e,r)&&"constructor"!=r&&t.push(r);return t}var _baseKeys=baseKeys$1,isFunction$1=isFunction_1,isLength=isLength_1;function isArrayLike$4(e){return null!=e&&isLength(e.length)&&!isFunction$1(e)}var isArrayLike_1=isArrayLike$4,arrayLikeKeys$1=_arrayLikeKeys,baseKeys=_baseKeys,isArrayLike$3=isArrayLike_1;function keys$3(e){return isArrayLike$3(e)?arrayLikeKeys$1(e):baseKeys(e)}var keys_1=keys$3,copyObject$4=_copyObject,keys$2=keys_1;function baseAssign$1(e,t){return e&&copyObject$4(t,keys$2(t),e)}var _baseAssign=baseAssign$1;function nativeKeysIn$1(e){var t=[];if(null!=e)for(var r in Object(e))t.push(r);return t}var _nativeKeysIn=nativeKeysIn$1,isObject$5=isObject_1,isPrototype$1=_isPrototype,nativeKeysIn=_nativeKeysIn,objectProto$5=Object.prototype,hasOwnProperty$4=objectProto$5.hasOwnProperty;function baseKeysIn$1(e){if(!isObject$5(e))return nativeKeysIn(e);var t=isPrototype$1(e),r=[];for(var i in e)("constructor"!=i||!t&&hasOwnProperty$4.call(e,i))&&r.push(i);return r}var _baseKeysIn=baseKeysIn$1,arrayLikeKeys=_arrayLikeKeys,baseKeysIn=_baseKeysIn,isArrayLike$2=isArrayLike_1;function keysIn$5(e){return isArrayLike$2(e)?arrayLikeKeys(e,!0):baseKeysIn(e)}var keysIn_1=keysIn$5,copyObject$3=_copyObject,keysIn$4=keysIn_1;function baseAssignIn$1(e,t){return e&&copyObject$3(t,keysIn$4(t),e)}var _baseAssignIn=baseAssignIn$1,_cloneBufferExports={},_cloneBuffer={get exports(){return _cloneBufferExports},set exports(e){_cloneBufferExports=e}};function copyArray$2(e,t){var r=-1,i=e.length;for(t||(t=Array(i));++r<i;)t[r]=e[r];return t}!function(e,t){var r=_root,i=t&&!t.nodeType&&t,n=i&&e&&!e.nodeType&&e,s=n&&n.exports===i?r.Buffer:void 0,o=s?s.allocUnsafe:void 0;e.exports=function(e,t){if(t)return e.slice();var r=e.length,i=o?o(r):new e.constructor(r);return e.copy(i),i}}(_cloneBuffer,_cloneBufferExports);var _copyArray=copyArray$2;function arrayFilter$1(e,t){for(var r=-1,i=null==e?0:e.length,n=0,s=[];++r<i;){var o=e[r];t(o,r,e)&&(s[n++]=o)}return s}var _arrayFilter=arrayFilter$1;function stubArray$2(){return[]}var stubArray_1=stubArray$2,arrayFilter=_arrayFilter,stubArray$1=stubArray_1,objectProto$4=Object.prototype,propertyIsEnumerable=objectProto$4.propertyIsEnumerable,nativeGetSymbols$1=Object.getOwnPropertySymbols,getSymbols$3=nativeGetSymbols$1?function(e){return null==e?[]:(e=Object(e),arrayFilter(nativeGetSymbols$1(e),(function(t){return propertyIsEnumerable.call(e,t)})))}:stubArray$1,_getSymbols=getSymbols$3,copyObject$2=_copyObject,getSymbols$2=_getSymbols;function copySymbols$1(e,t){return copyObject$2(e,getSymbols$2(e),t)}var _copySymbols=copySymbols$1;function arrayPush$2(e,t){for(var r=-1,i=t.length,n=e.length;++r<i;)e[n+r]=t[r];return e}var _arrayPush=arrayPush$2,overArg=_overArg,getPrototype$3=overArg(Object.getPrototypeOf,Object),_getPrototype=getPrototype$3,arrayPush$1=_arrayPush,getPrototype$2=_getPrototype,getSymbols$1=_getSymbols,stubArray=stubArray_1,nativeGetSymbols=Object.getOwnPropertySymbols,getSymbolsIn$2=nativeGetSymbols?function(e){for(var t=[];e;)arrayPush$1(t,getSymbols$1(e)),e=getPrototype$2(e);return t}:stubArray,_getSymbolsIn=getSymbolsIn$2,copyObject$1=_copyObject,getSymbolsIn$1=_getSymbolsIn;function copySymbolsIn$1(e,t){return copyObject$1(e,getSymbolsIn$1(e),t)}var _copySymbolsIn=copySymbolsIn$1,arrayPush=_arrayPush,isArray$3=isArray_1;function baseGetAllKeys$2(e,t,r){var i=t(e);return isArray$3(e)?i:arrayPush(i,r(e))}var _baseGetAllKeys=baseGetAllKeys$2,baseGetAllKeys$1=_baseGetAllKeys,getSymbols=_getSymbols,keys$1=keys_1;function getAllKeys$2(e){return baseGetAllKeys$1(e,keys$1,getSymbols)}var _getAllKeys=getAllKeys$2,baseGetAllKeys=_baseGetAllKeys,getSymbolsIn=_getSymbolsIn,keysIn$3=keysIn_1;function getAllKeysIn$1(e){return baseGetAllKeys(e,keysIn$3,getSymbolsIn)}var _getAllKeysIn=getAllKeysIn$1,getNative$3=_getNative,root$4=_root,DataView$2=getNative$3(root$4,"DataView"),_DataView=DataView$2,getNative$2=_getNative,root$3=_root,Promise$2=getNative$2(root$3,"Promise"),_Promise=Promise$2,getNative$1=_getNative,root$2=_root,Set$2=getNative$1(root$2,"Set"),_Set=Set$2,getNative=_getNative,root$1=_root,WeakMap$1=getNative(root$1,"WeakMap"),_WeakMap=WeakMap$1,DataView$1=_DataView,Map$1=_Map,Promise$1=_Promise,Set$1=_Set,WeakMap=_WeakMap,baseGetTag$1=_baseGetTag,toSource=_toSource,mapTag$4="[object Map]",objectTag$3="[object Object]",promiseTag="[object Promise]",setTag$4="[object Set]",weakMapTag$1="[object WeakMap]",dataViewTag$3="[object DataView]",dataViewCtorString=toSource(DataView$1),mapCtorString=toSource(Map$1),promiseCtorString=toSource(Promise$1),setCtorString=toSource(Set$1),weakMapCtorString=toSource(WeakMap),getTag$4=baseGetTag$1;(DataView$1&&getTag$4(new DataView$1(new ArrayBuffer(1)))!=dataViewTag$3||Map$1&&getTag$4(new Map$1)!=mapTag$4||Promise$1&&getTag$4(Promise$1.resolve())!=promiseTag||Set$1&&getTag$4(new Set$1)!=setTag$4||WeakMap&&getTag$4(new WeakMap)!=weakMapTag$1)&&(getTag$4=function(e){var t=baseGetTag$1(e),r=t==objectTag$3?e.constructor:void 0,i=r?toSource(r):"";if(i)switch(i){case dataViewCtorString:return dataViewTag$3;case mapCtorString:return mapTag$4;case promiseCtorString:return promiseTag;case setCtorString:return setTag$4;case weakMapCtorString:return weakMapTag$1}return t});var _getTag=getTag$4,objectProto$3=Object.prototype,hasOwnProperty$3=objectProto$3.hasOwnProperty;function initCloneArray$1(e){var t=e.length,r=new e.constructor(t);return t&&"string"==typeof e[0]&&hasOwnProperty$3.call(e,"index")&&(r.index=e.index,r.input=e.input),r}var _initCloneArray=initCloneArray$1,root=_root,Uint8Array$3=root.Uint8Array,_Uint8Array=Uint8Array$3,Uint8Array$2=_Uint8Array;function cloneArrayBuffer$3(e){var t=new e.constructor(e.byteLength);return new Uint8Array$2(t).set(new Uint8Array$2(e)),t}var _cloneArrayBuffer=cloneArrayBuffer$3,cloneArrayBuffer$2=_cloneArrayBuffer;function cloneDataView$1(e,t){var r=t?cloneArrayBuffer$2(e.buffer):e.buffer;return new e.constructor(r,e.byteOffset,e.byteLength)}var _cloneDataView=cloneDataView$1,reFlags=/\w*$/;function cloneRegExp$1(e){var t=new e.constructor(e.source,reFlags.exec(e));return t.lastIndex=e.lastIndex,t}var _cloneRegExp=cloneRegExp$1,Symbol$2=_Symbol,symbolProto$1=Symbol$2?Symbol$2.prototype:void 0,symbolValueOf$1=symbolProto$1?symbolProto$1.valueOf:void 0;function cloneSymbol$1(e){return symbolValueOf$1?Object(symbolValueOf$1.call(e)):{}}var _cloneSymbol=cloneSymbol$1,cloneArrayBuffer$1=_cloneArrayBuffer;function cloneTypedArray$2(e,t){var r=t?cloneArrayBuffer$1(e.buffer):e.buffer;return new e.constructor(r,e.byteOffset,e.length)}var _cloneTypedArray=cloneTypedArray$2,cloneArrayBuffer=_cloneArrayBuffer,cloneDataView=_cloneDataView,cloneRegExp=_cloneRegExp,cloneSymbol=_cloneSymbol,cloneTypedArray$1=_cloneTypedArray,boolTag$2="[object Boolean]",dateTag$2="[object Date]",mapTag$3="[object Map]",numberTag$2="[object Number]",regexpTag$2="[object RegExp]",setTag$3="[object Set]",stringTag$2="[object String]",symbolTag$2="[object Symbol]",arrayBufferTag$2="[object ArrayBuffer]",dataViewTag$2="[object DataView]",float32Tag$1="[object Float32Array]",float64Tag$1="[object Float64Array]",int8Tag$1="[object Int8Array]",int16Tag$1="[object Int16Array]",int32Tag$1="[object Int32Array]",uint8Tag$1="[object Uint8Array]",uint8ClampedTag$1="[object Uint8ClampedArray]",uint16Tag$1="[object Uint16Array]",uint32Tag$1="[object Uint32Array]";function initCloneByTag$1(e,t,r){var i=e.constructor;switch(t){case arrayBufferTag$2:return cloneArrayBuffer(e);case boolTag$2:case dateTag$2:return new i(+e);case dataViewTag$2:return cloneDataView(e,r);case float32Tag$1:case float64Tag$1:case int8Tag$1:case int16Tag$1:case int32Tag$1:case uint8Tag$1:case uint8ClampedTag$1:case uint16Tag$1:case uint32Tag$1:return cloneTypedArray$1(e,r);case mapTag$3:return new i;case numberTag$2:case stringTag$2:return new i(e);case regexpTag$2:return cloneRegExp(e);case setTag$3:return new i;case symbolTag$2:return cloneSymbol(e)}}var _initCloneByTag=initCloneByTag$1,isObject$4=isObject_1,objectCreate=Object.create,baseCreate$1=function(){function e(){}return function(t){if(!isObject$4(t))return{};if(objectCreate)return objectCreate(t);e.prototype=t;var r=new e;return e.prototype=void 0,r}}(),_baseCreate=baseCreate$1,baseCreate=_baseCreate,getPrototype$1=_getPrototype,isPrototype=_isPrototype;function initCloneObject$2(e){return"function"!=typeof e.constructor||isPrototype(e)?{}:baseCreate(getPrototype$1(e))}var _initCloneObject=initCloneObject$2,getTag$3=_getTag,isObjectLike$4=isObjectLike_1,mapTag$2="[object Map]";function baseIsMap$1(e){return isObjectLike$4(e)&&getTag$3(e)==mapTag$2}var _baseIsMap=baseIsMap$1,baseIsMap=_baseIsMap,baseUnary$1=_baseUnary,nodeUtil$1=_nodeUtilExports,nodeIsMap=nodeUtil$1&&nodeUtil$1.isMap,isMap$1=nodeIsMap?baseUnary$1(nodeIsMap):baseIsMap,isMap_1=isMap$1,getTag$2=_getTag,isObjectLike$3=isObjectLike_1,setTag$2="[object Set]";function baseIsSet$1(e){return isObjectLike$3(e)&&getTag$2(e)==setTag$2}var _baseIsSet=baseIsSet$1,baseIsSet=_baseIsSet,baseUnary=_baseUnary,nodeUtil=_nodeUtilExports,nodeIsSet=nodeUtil&&nodeUtil.isSet,isSet$1=nodeIsSet?baseUnary(nodeIsSet):baseIsSet,isSet_1=isSet$1,Stack$2=_Stack,arrayEach=_arrayEach,assignValue=_assignValue,baseAssign=_baseAssign,baseAssignIn=_baseAssignIn,cloneBuffer$1=_cloneBufferExports,copyArray$1=_copyArray,copySymbols=_copySymbols,copySymbolsIn=_copySymbolsIn,getAllKeys$1=_getAllKeys,getAllKeysIn=_getAllKeysIn,getTag$1=_getTag,initCloneArray=_initCloneArray,initCloneByTag=_initCloneByTag,initCloneObject$1=_initCloneObject,isArray$2=isArray_1,isBuffer$2=isBufferExports,isMap=isMap_1,isObject$3=isObject_1,isSet=isSet_1,keys=keys_1,keysIn$2=keysIn_1,CLONE_DEEP_FLAG$1=1,CLONE_FLAT_FLAG=2,CLONE_SYMBOLS_FLAG$1=4,argsTag$1="[object Arguments]",arrayTag$1="[object Array]",boolTag$1="[object Boolean]",dateTag$1="[object Date]",errorTag$1="[object Error]",funcTag="[object Function]",genTag="[object GeneratorFunction]",mapTag$1="[object Map]",numberTag$1="[object Number]",objectTag$2="[object Object]",regexpTag$1="[object RegExp]",setTag$1="[object Set]",stringTag$1="[object String]",symbolTag$1="[object Symbol]",weakMapTag="[object WeakMap]",arrayBufferTag$1="[object ArrayBuffer]",dataViewTag$1="[object DataView]",float32Tag="[object Float32Array]",float64Tag="[object Float64Array]",int8Tag="[object Int8Array]",int16Tag="[object Int16Array]",int32Tag="[object Int32Array]",uint8Tag="[object Uint8Array]",uint8ClampedTag="[object Uint8ClampedArray]",uint16Tag="[object Uint16Array]",uint32Tag="[object Uint32Array]",cloneableTags={};function baseClone$1(e,t,r,i,n,s){var o,a=t&CLONE_DEEP_FLAG$1,c=t&CLONE_FLAT_FLAG,u=t&CLONE_SYMBOLS_FLAG$1;if(r&&(o=n?r(e,i,n,s):r(e)),void 0!==o)return o;if(!isObject$3(e))return e;var h=isArray$2(e);if(h){if(o=initCloneArray(e),!a)return copyArray$1(e,o)}else{var d=getTag$1(e),f=d==funcTag||d==genTag;if(isBuffer$2(e))return cloneBuffer$1(e,a);if(d==objectTag$2||d==argsTag$1||f&&!n){if(o=c||f?{}:initCloneObject$1(e),!a)return c?copySymbolsIn(e,baseAssignIn(o,e)):copySymbols(e,baseAssign(o,e))}else{if(!cloneableTags[d])return n?e:{};o=initCloneByTag(e,d,a)}}s||(s=new Stack$2);var l=s.get(e);if(l)return l;s.set(e,o),isSet(e)?e.forEach((function(i){o.add(baseClone$1(i,t,r,i,e,s))})):isMap(e)&&e.forEach((function(i,n){o.set(n,baseClone$1(i,t,r,n,e,s))}));var p=h?void 0:(u?c?getAllKeysIn:getAllKeys$1:c?keysIn$2:keys)(e);return arrayEach(p||e,(function(i,n){p&&(i=e[n=i]),assignValue(o,n,baseClone$1(i,t,r,n,e,s))})),o}cloneableTags[argsTag$1]=cloneableTags[arrayTag$1]=cloneableTags[arrayBufferTag$1]=cloneableTags[dataViewTag$1]=cloneableTags[boolTag$1]=cloneableTags[dateTag$1]=cloneableTags[float32Tag]=cloneableTags[float64Tag]=cloneableTags[int8Tag]=cloneableTags[int16Tag]=cloneableTags[int32Tag]=cloneableTags[mapTag$1]=cloneableTags[numberTag$1]=cloneableTags[objectTag$2]=cloneableTags[regexpTag$1]=cloneableTags[setTag$1]=cloneableTags[stringTag$1]=cloneableTags[symbolTag$1]=cloneableTags[uint8Tag]=cloneableTags[uint8ClampedTag]=cloneableTags[uint16Tag]=cloneableTags[uint32Tag]=!0,cloneableTags[errorTag$1]=cloneableTags[funcTag]=cloneableTags[weakMapTag]=!1;var _baseClone=baseClone$1,baseClone=_baseClone,CLONE_DEEP_FLAG=1,CLONE_SYMBOLS_FLAG=4;function cloneDeep(e){return baseClone(e,CLONE_DEEP_FLAG|CLONE_SYMBOLS_FLAG)}var cloneDeep_1=cloneDeep;const b$1=["RTCPeerConnection","RTCSessionDescription","RTCIceCandidate","RTCRtpSender"];let c$1=!b$1.find((e=>!window[e])),d$2;async function e$2(){if(c$1){const e=new RTCPeerConnection;try{e.addTransceiver("video",{direction:"sendrecv"});const{sdp:t}=await e.createOffer();return!!t&&/H264/.test(t.toUpperCase())}catch(e){return c$1=!1,!1}finally{e.close()}}return!1}const checkSystem=async function(){return void 0===d$2&&(d$2=await e$2()),{browser:adapter.browserDetails.browser,version:adapter.browserDetails.version,isSupportRTC:c$1,isSupportMedia:!!navigator.mediaDevices,isSupportH264:d$2}},u={bundlePolicy:"max-compat"};function f$3(e,t){const r=e.sender.getParameters();e.sender.setParameters(Object.assign(r,t))}class Peer{constructor(e){this.J=a$9(),this.Vt=new RTCPeerConnection(u),this.Gt=!0,this.Kt=0,this.Wt=0,this.zt=0,this.Xt=0,this.Jt=[],this.Yt=[{mbps:180,constraints:{height:180,frameRate:15}},{mbps:360,constraints:{height:360,frameRate:20}},{mbps:720,constraints:{height:720,frameRate:25}}],this.Zt=new Map([[180,18e4],[360,6e5],[720,18e5],[1080,25e5]]),this.Qt=new Map([[180,!1],[360,!1],[720,!1]]),this.er=new Map,this.tr=new Map,this.rr=Math.floor(497958101*Math.random()+1602202100),this.ir={offerToReceiveAudio:!0,offerToReceiveVideo:!0,iceRestart:!0},this.nr={ordered:!0},this.sr=async()=>{"closed"===this.Vt.signalingState&&(this.Vt=new RTCPeerConnection(u));const{isSupportH264:e}=await checkSystem();return this.ir.offerToReceiveVideo=e,this.Vt.onicecandidate=e=>{e.candidate&&this.J.emit(PeerEvents.OnICECandidate,e.candidate)},this.Vt.onconnectionstatechange=()=>{this.J.emit(PeerEvents.ConnectionState,this.Vt.connectionState)},this.Vt.onicecandidateerror=()=>{peerLogger.error("ice candidate error")},this.Vt.ontrack=e=>{var t;if(!e.streams||!e.track.id||!e.transceiver.mid)return;const r=e.track.id,i=e.transceiver.mid;for(const t of this.Jt)if(t.mid===Number.parseInt(i)){t.trackId=r,t.stream=e.streams[0],t.transceiver=e.transceiver;break}(null===(t=this.ar)||void 0===t?void 0:t.mid)===Number.parseInt(i)&&(this.ar.trackId=r,this.ar.stream=e.streams[0],this.ar.transceiver=e.transceiver),peerLogger.info(`New ${e.track.kind} ${e.track.id} track added`),this.J.emit(PeerEvents.RemoteStreamAdded,e)},this.Vt.ondatachannel=e=>{peerLogger.info("ondataChannel",e),this.createDataChannel(e.channel)},this.cr(),this.ur=this.hr(),this.createDataChannel(),()=>{var e;this.ur&&this.ur(),this.Vt.close(),this.Vt.onicecandidate=null,this.Vt.onconnectionstatechange=null,this.Vt.onicecandidateerror=null,this.Vt.ontrack=null,this.Vt.ondatachannel=null,null===(e=this.dr)||void 0===e||e.close(),this.dr=void 0}},this.cr=()=>{new Array(2).fill("").forEach(((e,t)=>{const r=this.Vt.addTransceiver("audio",{direction:"sendrecv"});0===t?this.lr=r:this.pr=r})),this.ir.offerToReceiveVideo&&new Array(e$6.maxEndpoint+1).fill("").forEach(((e,t)=>{const r=this.Vt.addTransceiver("video",{direction:t<4?"sendrecv":"recvonly"});t<3?this.tr.set(this.Yt[t].mbps,r):3===t&&(this.vr=r)}))},this.hr=()=>{let e=0,t=0,r=0,i=0,n=0,s=0,o={},a={},c={},u={},h=exports.NetworkQuality.Online,d=0,f=0;const l=window.setInterval((async()=>{if(navigator.onLine&&"disconnected"!==this.Vt.connectionState&&"closed"!==this.Vt.connectionState&&"failed"!==this.Vt.connectionState&&"disconnected"!==this.Vt.iceConnectionState&&"failed"!==this.Vt.iceConnectionState&&"closed"!==this.Vt.iceConnectionState){h=exports.NetworkQuality.Online;let f=0,p=0;const v={},b={},m={},g={};let y=0;const w=[];let $=0,S=0,k=0,E=0,x=0,C=0,A=0;if(this.lr){const e=this.lr;(await e.receiver.getStats()).forEach((t=>{"inbound-rtp"===t.type&&(f+=t.packetsLost,p+=t.packetsReceived,null!=e&&e.mid&&(g[e.mid]={streamType:"VOICE",bytesReceived:t.bytesReceived,packetsReceived:t.packetsReceived,nackCount:t.nackCount})),"candidate-pair"===t.type&&(y=t.totalRoundTripTime/t.responsesReceived*1e3)})),e.sender.track?(await e.sender.getStats()).forEach((t=>{"remote-inbound-rtp"===t.type&&w.push(t.fractionLost),"outbound-rtp"===t.type&&null!=e&&e.mid&&(b[e.mid]={streamType:"VOICE",bytesSent:t.bytesSent,packetsSent:t.packetsSent,retransmittedBytesSent:t.retransmittedBytesSent,retransmittedPacketsSent:t.retransmittedPacketsSent,targetBitrate:t.targetBitrate})})):e.mid&&(u[e.mid]=void 0)}if(this.pr){const e=this.pr;(await e.receiver.getStats()).forEach((t=>{"inbound-rtp"===t.type&&(f+=t.packetsLost,p+=t.packetsReceived,null!=e&&e.mid&&(g[e.mid]={streamType:"SHARE_AUDIO",bytesReceived:t.bytesReceived,packetsReceived:t.packetsReceived,nackCount:t.nackCount}))})),e.sender.track?(await e.sender.getStats()).forEach((t=>{"remote-inbound-rtp"===t.type&&w.push(t.fractionLost),"outbound-rtp"===t.type&&null!=e&&e.mid&&(b[e.mid]={streamType:"SHARE_AUDIO",bytesSent:t.bytesSent,packetsSent:t.packetsSent,retransmittedBytesSent:t.retransmittedBytesSent,retransmittedPacketsSent:t.retransmittedPacketsSent,targetBitrate:t.targetBitrate})})):e.mid&&(u[e.mid]=void 0)}const _=this.Jt.filter((e=>e.transceiver));for(const{transceiver:e,used:t,ssrc:r}of _)if(e){const i=await e.receiver.getStats();let n=0,s=0,o=0,a=0,u=0,h=0,d=0,l="";if(i.forEach((r=>{if("inbound-rtp"===r.type){t&&(f+=r.packetsLost,p+=r.packetsReceived);const i=null==e?void 0:e.receiver.getContributingSources();i.length&&(n=i[0].source),s=r.bytesReceived,o=r.packetsLost,a=r.framesPerSecond,u=r.frameWidth,h=r.frameHeight,d=r.jitterBufferDelay}"codec"===r.type&&(l=r.mimeType)})),t&&e.mid&&(m[e.mid]={streamType:"VIDEO",ssrc:r,csrc:n,bytesReceived:s,packetsLost:o,frameRate:a,width:u,height:h,jitterBufferDelay:d,codec:l}),e.sender.track){const t=await e.sender.getStats();let r=0,i=0,n=0,s=0,o=0,a=0,c=0,u=0,h=0,d=0,f=0,l=0,p="";t.forEach((t=>{"remote-inbound-rtp"===t.type&&w.push(t.fractionLost),e.mid&&("outbound-rtp"===t.type&&(i=t.bytesSent,r=t.ssrc,a=t.frameWidth,c=t.frameHeight,u=t.framesPerSecond,h=t.totalPacketSendDelay,d=t.totalEncodeTime,f=t.retransmittedBytesSent,l=t.keyFramesEncoded,p=t.encoderImplementation),"media-source"===t.type&&(n=t.framesPerSecond,s=t.width,o=t.height))})),e.mid&&(v[e.mid]={streamType:"VIDEO",ssrc:r,csrc:this.Be.selfMediaOpts.videossrc[Number(e.mid)-2]||0,bytesSent:i,framesRate:n,width:s,height:o,encodedWidth:a,encodedHeight:c,encodeFrameRate:u,totalPacketSendDelay:h,totalEncodeTime:d,retransmittedBytesSent:f,keyFramesEncoded:l,codec:p})}else e.mid&&(c[e.mid]=void 0)}if(this.vr){var l;const e=this.vr,t=await e.receiver.getStats();let r=0,i=0,n=0,s=0,o=0,a=0,u=0,h="";if(t.forEach((t=>{if("inbound-rtp"===t.type){f+=t.packetsLost,p+=t.packetsReceived;const c=null==e?void 0:e.receiver.getContributingSources();c.length&&(r=c[0].source),i=t.bytesReceived,n=t.packetsLost,s=t.framesPerSecond,o=t.frameWidth,a=t.frameHeight,u=t.jitterBufferDelay}"codec"===t.type&&(h=t.mimeType)})),null!==(l=this.ar)&&void 0!==l&&l.used&&e.mid&&(m[e.mid]={streamType:"VIDEO",ssrc:this.ar.ssrc,csrc:r,bytesReceived:i,packetsLost:n,frameRate:s,width:o,height:a,jitterBufferDelay:u,codec:h}),e.sender.track){const t=await e.sender.getStats();let r=0,i=0,n=0,s=0,o=0,a=0,c=0,u=0,h=0,d=0,f=0,l=0,p="";t.forEach((t=>{"remote-inbound-rtp"===t.type&&w.push(t.fractionLost),e.mid&&("outbound-rtp"===t.type&&(i=t.bytesSent,r=t.ssrc,a=t.frameWidth,c=t.frameHeight,u=t.framesPerSecond,h=t.totalPacketSendDelay,d=t.totalEncodeTime,f=t.retransmittedBytesSent,l=t.keyFramesEncoded,p=t.encoderImplementation),"media-source"===t.type&&(n=t.framesPerSecond,s=t.width,o=t.height))})),e.mid&&(v[e.mid]={streamType:"VIDEO",ssrc:r,csrc:this.Be.selfMediaOpts.sharessrc,bytesSent:i,framesRate:n,width:s,height:o,encodedWidth:a,encodedHeight:c,encodeFrameRate:u,totalPacketSendDelay:h,totalEncodeTime:d,retransmittedBytesSent:f,keyFramesEncoded:l,codec:p})}else e.mid&&(c[e.mid]=void 0)}if(p-t!=0){$=(f-e)/(p-t);const r=f-e==0?0:(f-e)/(p-t)*.7+.3*d;h=r>.25?exports.NetworkQuality.Bad:r>.1?exports.NetworkQuality.NotFluent:r>.05?exports.NetworkQuality.SmallFlaw:r>0?exports.NetworkQuality.Good:exports.NetworkQuality.Excellent,e=f,t=p,d=r}C=Object.entries(g).reduce(((e,t)=>{var r;let[i,n]=t;const s=(null===(r=a[i])||void 0===r?void 0:r.bytesReceived)||0;return e+(n&&a[i]?Math.max(n.bytesReceived-s,0):0)}),0),E=Object.entries(m).reduce(((e,t)=>{var r;let[i,n]=t;const s=(null===(r=o[i])||void 0===r?void 0:r.bytesReceived)||0;return e+(n&&o[i]?Math.max(n.bytesReceived-s,0):0)}),0),x=Object.entries(v).reduce(((e,t)=>{var r;let[i,n]=t;const s=(null===(r=c[i])||void 0===r?void 0:r.bytesSent)||0;return e+(n&&c[i]?Math.max(n.bytesSent-s,0):0)}),0),A=Object.entries(b).reduce(((e,t)=>{var r;let[i,n]=t;const s=(null===(r=u[i])||void 0===r?void 0:r.bytesSent)||0;return e+(n&&u[i]?Math.max(n.bytesSent-s,0):0)}),0),S=x+A,k=C+E,metrics.post(Events.NETWORK,{rtt:y,fractionLost:w.reduce(((e,t)=>e+t),0),recvLost:$,transmitBitrate:S,receiveBitrate:k}).post(Events.VIDEO_NETWORK,{totalRecv:E,totalSend:x}).post(Events.AUDIO_NETWORK,{totalRecv:C,totalSend:A}),Object.entries(v).forEach((e=>{let[t,r]=e;const i=c[t];r&&i&&metrics.post(Events.VIDEO_SEND,{ssrc:r.ssrc,csrc:r.csrc,streamType:r.streamType,frameRateInput:r.framesRate,width:r.width,height:r.height,encodedWidth:r.encodedWidth,encodedHeight:r.encodedHeight,avgEncodeTime:r.totalEncodeTime,sendAvgDelayMs:r.totalPacketSendDelay-i.totalPacketSendDelay,encodeFrameRate:r.encodeFrameRate,frameRate:r.encodeFrameRate,totalBitrate:r.bytesSent-i.bytesSent,retansmitBitrate:r.retransmittedBytesSent-i.retransmittedBytesSent,recvKFrameReqPerSecond:i.keyFramesEncoded-r.keyFramesEncoded,codec:r.codec})})),Object.entries(b).forEach((e=>{let[t,r]=e;const i=u[t];r&&i&&metrics.post(Events.AUDIO_SEND,{streamType:r.streamType,audioBitrate:r.bytesSent-i.bytesSent,packetCountInSecond:r.packetsSent-i.packetsSent,mediaBitrateKbps:r.bytesSent-i.bytesSent,meidaPacketCountInSecond:r.packetsSent-i.packetsSent,retransmitBitrateKbps:r.retransmittedBytesSent-i.retransmittedBytesSent,retransmitPacketCountInSecond:r.retransmittedPacketsSent-i.retransmittedPacketsSent,audioSendAllocatedBitrate:r.targetBitrate})})),Object.entries(m).forEach((e=>{let[t,r]=e;const i=o[t];r&&i&&metrics.post(Events.VIDEO_RECV,{ssrc:r.ssrc,csrc:r.csrc,streamType:r.streamType,lossRateSingleStream:r.packetsLost-i.packetsLost,decodeFrameRate:r.frameRate,width:r.width,height:r.height,jitterMs:r.jitterBufferDelay,codec:r.codec})})),Object.entries(g).forEach((e=>{let[t,r]=e;const i=a[t];r&&i&&metrics.post(Events.AUDIO_RECV,{streamType:r.streamType,audioBitrate:r.bytesReceived-i.bytesReceived,meidaPacketCountInSecond:r.packetsReceived-i.packetsReceived,nackCountInSecond:r.nackCount-i.nackCount})})),r+=x,i+=A,n+=E,s+=C,this.J.emit(PeerEvents.RTCStats,{rtt:y,sendBitrate:S,recvBitrate:k,sendBytes:r+i,recvBytes:n+s,videoSendBitrate:x,videoRecvBitrate:E,videoSendBytes:r,videoRecvBytes:n,audioSendBitrate:A,audioRecvBitrate:C,audioSendBytes:i,audioRecvBytes:s}),c=v,u=b,o=m,a=g}else h=exports.NetworkQuality.Offline;f%2==0?this.J.emit(PeerEvents.NetworkQuality,{quality:h}):h===exports.NetworkQuality.Offline&&this.J.emit(PeerEvents.RTCStats,{rtt:0,sendBitrate:0,recvBitrate:0,videoSendBitrate:0,videoRecvBitrate:0,audioSendBitrate:0,audioRecvBitrate:0,sendBytes:r+i,recvBytes:n+s,videoSendBytes:r,videoRecvBytes:n,audioSendBytes:i,audioRecvBytes:s}),f=f%2+1}),1e3);return()=>window.clearInterval(l)},this.getIdleVideoReceivers=()=>this.Jt.filter((e=>!e.used)),this.getIdleShareReceiver=()=>this.ar,this.releaseShareSSRC=()=>{this.ar&&(this.ar.used=!1)},this.releaseVideoSSRC=e=>{this.Jt.forEach((t=>{e.includes(t.ssrc)&&(t.used=!1)}))},this.sendData=e=>{var t;"open"===(null===(t=this.dr)||void 0===t?void 0:t.readyState)&&this.dr.send(e)},this.createDataChannel=e=>{e||(e=this.Vt.createDataChannel("dataChannel",this.nr),peerLogger.info("create dataChannel.")),e.binaryType="arraybuffer",e.onopen=e=>{channelLogger.info("Received open change on data channel:",e),this.J.emit(PeerEvents.DataChannelOpen)},e.onmessage=async e=>{this.J.emit(PeerEvents.DataChannelMessage,e.data)},e.onclose=e=>{var t;null===(t=this.dr)||void 0===t||t.close(),channelLogger.info("Received close change on data channel: ",e),this.J.emit(PeerEvents.DataChannelClose)},e.onerror=e=>{channelLogger.info("Got error on data channel:",e),this.J.emit(PeerEvents.DataChannelError)},this.dr=e},this.createOffer=async()=>{this.br&&this.br(),this.br=await this.sr();const e=await this.Vt.createOffer(this.ir);return e.sdp=this.mr(e.sdp||""),this.gr=e.sdp,await this.Vt.setLocalDescription(new RTCSessionDescription(e)),peerLogger.info("setLocalDescription success"),this.Gt&&(peerLogger.info("offer sdp(unified):\n"+e.sdp),e.sdp=this.yr(e.sdp||""),peerLogger.info("send sfu offer sdp(planB):\n"+e.sdp)),e},this.handleAnswer=async e=>{this.Gt&&(peerLogger.info("recv answer sdp(planB):\n"+e),e=this.wr(e,this.Kt,this.zt),peerLogger.info("recv answer sdp(unified):\n"+e)),this.$r=e,await this.Vt.setRemoteDescription(new RTCSessionDescription({type:"answer",sdp:this.$r}))},this.changeSimulcast=e=>{let t="simulcast sending [ ";for(const[r,i]of e)this.Qt.set(r,i),t+="("+r+":"+i+") ";trackLogger.info(t+="]"),this.tr.size&&this.er.forEach((async(e,t)=>{const r=this.tr.get(t);r&&this.Qt.has(t)&&(!0===this.Qt.get(t)?r.sender.track||(e.track.enabled=!0,r.sender.replaceTrack(e.track)):(e.track.enabled=!1,r.sender.replaceTrack(null)))}))},this.removeTrack=e=>{if("closed"!==this.Vt.signalingState){switch(e.id){case this.Sr:return this.er.forEach((e=>{e.track.stop()})),this.tr.forEach((e=>{e.sender.S||(e.sender.S=this.Vt),e.sender.replaceTrack(null),this.Vt.removeTrack(e.sender)})),this.Sr=void 0,!0;case this.kr:return this.lr&&(this.lr.sender.S||(this.lr.sender.S=this.Vt),this.lr.sender.replaceTrack(null),this.Vt.removeTrack(this.lr.sender)),this.kr=void 0,!0;case this.Er:return this.vr&&(this.vr.sender.S||(this.vr.sender.S=this.Vt),this.vr.sender.replaceTrack(null),this.Vt.removeTrack(this.vr.sender)),this.Er=void 0,!0;case this.Cr:return this.pr&&(this.pr.sender.S||(this.pr.sender.S=this.Vt),this.pr.sender.replaceTrack(null),this.Vt.removeTrack(this.pr.sender)),this.Cr=void 0,!0}return!1}return!1},this.setLocalAudio=async e=>"audio"===e.kind?(this.kr=e.id,this.lr&&await this.lr.sender.replaceTrack(e),!0):(trackLogger.warn("should not run to this."),!1),this.setLocalVideo=async(e,t)=>{if("video"===e.kind){this.Sr=e.id;const{aspectRatio:r,width:i,height:n}=e.getSettings(),s=r||(Number.isNaN((i||0)/(n||0))?16/9:(i||0)/(n||0));return this.Yt.forEach((async t=>{var r;const i=e.clone();i.applyConstraints({width:t.constraints.height*s,...t.constraints}),null===(r=this.er.get(t.mbps))||void 0===r||r.track.stop(),this.er.set(t.mbps,{enable:this.Qt.get(t.mbps),track:i})})),this.tr.size&&this.er.forEach((async(e,r)=>{const i=this.tr.get(r);i&&(e.enable?(e.track.enabled=!0,await i.sender.replaceTrack(e.track)):e.track.enabled=!1,this.Ar(r,i,{degradationPreference:t}))})),!0}return trackLogger.warn("should not run to this."),!1},this.setLocalShareVideo=async(e,t)=>"video"===e.kind?(this.Er=e.id,this.vr&&(await this.vr.sender.replaceTrack(e),this.Ar(1080,this.vr,{degradationPreference:t})),!0):(trackLogger.warn("should not run to this."),!1),this.setLocalShareAudio=async e=>"audio"===e.kind?(this.Cr=e.id,this.pr&&await this.pr.sender.replaceTrack(e),!0):(trackLogger.warn("should not run to this."),!1),this.addSdpCandidate=async()=>{if(!this.gr||!this.$r)throw new Error("offer or answer is null");const e=void 0,t=lib.parse(this.$r).media;for(let i=0;i<t.length;i++){var r;const n=t[i],s=n.iceUfrag,o=n.icePwd,a=null===(r=n.connection)||void 0===r?void 0:r.ip,c=n.port,u=n.mid,h=126*Math.pow(2,24)+65535*Math.pow(2,8)+255,d=new RTCIceCandidate({candidate:"candidate:0 1 udp "+h+" "+a+" "+c+" typ host generation 0",sdpMid:u,sdpMLineIndex:i,usernameFragment:s,password:o});try{await this.Vt.addIceCandidate(d),peerLogger.info("addIceCandidate success")}catch(e){throw peerLogger.info("addIceCandidate error",e),e}}},this.close=()=>{this.er.forEach((e=>{e.track.stop()})),"closed"!==this.Vt.signalingState&&this.br&&this.br()},this.on=(e,t)=>(this.J.on(e,t),this),this.off=(e,t)=>(this.J.off(e,t),this),this.wr=(e,t,r)=>{this.Jt=[];const i=lib.parse(e),n=i.media;let s="",o=0,a=0,c=0,u=0;const h=new Map;if(n.forEach(((e,t)=>{"audio"===e.type&&"share-audio"!==e.mid?a=t:"audio"===e.type&&"share-audio"===e.mid?u=t:"video"===e.type&&"share"!==e.mid?o=t:"video"===e.type&&"share"===e.mid&&(c=t),e.ext&&(e.ext=e.ext.filter((e=>!e.uri.includes("video-orientation"))))})),t>=1){let e=this.rr;const i=n[a].ssrcs;i&&i[0]&&i[0].id&&(e=Number(i[0].id)+101);for(let i=a;i<t+a;++i){const t=e.toString(),o="audio_"+e,c=[{id:e,attribute:"cname",value:"As"+e},{id:e,attribute:"msid",value:`${t} ${o}`},{id:e,attribute:"mslabel",value:t},{id:e,attribute:"label",value:o}];if(i===a||i===u){i===a&&(n[i].mid=i.toString(),n[i].ssrcs||(n[i].ssrcs=c,e+=101),r<1&&(s=s+" "+i)),i===u&&(n[i].mid=this.Wt.toString(),n[i].ssrcs||(n[i].ssrcs=c,e+=101));{const e=n[i].ssrcs;if(e)for(const t of e)"mslabel"===t.attribute&&(t.value=t.id.toString()),"label"===t.attribute&&(t.value="audio_"+t.id.toString()),"msid"===t.attribute&&(t.value=t.id.toString()+" audio_"+t.id.toString())}continue}const d=cloneDeep_1(n[a]);d.mid=i.toString(),d.ssrcs=c,h.set(i,d),e+=101}}if(r>=1){let e=this.rr+1e3;const t=n[o].ssrcs;t&&t[0]&&t[0].id&&(e=Number(t[0].id));for(let t=o;t<o+r;++t){const r=e+1,i=e+100,a=e.toString(),u="video_"+e,f=`${a} ${u}`,l="ML"+e,p=[{semantics:"FEC-FR",ssrcs:`${e} ${r}`},{semantics:"FID",ssrcs:`${e} ${i}`}],v=[{id:e,attribute:"cname",value:l},{id:e,attribute:"msid",value:f},{id:e,attribute:"mslabel",value:a},{id:e,attribute:"label",value:u},{id:r,attribute:"cname",value:l},{id:r,attribute:"msid",value:f},{id:r,attribute:"mslabel",value:a},{id:r,attribute:"label",value:u},{id:i,attribute:"cname",value:l},{id:i,attribute:"msid",value:f},{id:i,attribute:"mslabel",value:a},{id:i,attribute:"label",value:u}];if(t===o){this.Jt.push({ssrc:e,trackId:"",mid:o,used:!1}),n[t].mid=t.toString(),s=s+" "+t,void 0!==n[o].ssrcs&&void 0!==n[o].ssrcGroups||(n[t].ssrcGroups=p,n[t].ssrcs=v),e+=101;continue}if(t===this.Xt){if(n[c].mid=t.toString(),n[c].ssrcs&&n[c].ssrcGroups){const e=n[c].ssrcs;if(e)for(const t of e)"mslabel"===t.attribute&&(t.value="61317484-2ed4-49d7-9eb7-1414322a7aae"),"label"===t.attribute&&(t.value="b94006c5-cade-4e0a-9ed9-d3e6747be7d9"),"msid"===t.attribute&&(t.value="61317484-2ed4-49d7-9eb7-1414322a7aae b94006c5-cade-4e0a-9ed9-d3e6747be7d9")}else n[c].ssrcGroups=p,n[c].ssrcs=v,e+=101;var d;n[c].ssrcs&&(this.ar={ssrc:null===(d=n[c].ssrcs)||void 0===d?void 0:d[0].id,trackId:"",mid:t,stream:void 0,used:!1});continue}const b=cloneDeep_1(n[o]);b.mid=t.toString(),b.ssrcGroups=p,b.ssrcs=v,t>=6&&(b.direction="sendonly"),h.set(t,b),s=s+" "+t,this.Jt.push({ssrc:e,trackId:"",mid:t,used:!1}),e+=101}}if(this._r){const e=r>0?o+r:a+t,i=r>0?o:a;this._r.connection=n[i].connection,this._r.fingerprint=n[i].fingerprint,this._r.icePwd=n[i].icePwd,this._r.iceUfrag=n[i].iceUfrag,this._r.sctpPort=n[i].port,this._r.port=n[i].port,this._r.setup="active",h.set(e,this._r),s=s+" "+e}return h.forEach(((e,t)=>{n.splice(t,0,e)})),s=s.replace(/(^\s*)|(\s*$)/g,""),i.groups&&i.groups.length>0?i.groups[0].mids&&(i.groups[0].mids=s):(i.groups=[],i.groups[0]={type:"BUNDLE",mids:s}),lib.write(i)},this.yr=e=>{const t=lib.parse(e),r=t.media,i=[];let n="",s=0,o=0,a=0,c="";if(r.forEach((e=>{"audio"===e.type&&s++,"video"===e.type&&o++,"application"===e.type&&(this._r=cloneDeep_1(e))})),s)for(let e=0;e<r.length;++e){if("video"===r[e].type){a=e;break}0===e?(r[e].mid=r[e].type,n=n+" "+r[e].mid):1===e?(this.Wt=Number(r[e].mid),r[e].mid="share-audio"):(r[0].ssrcGroups=[...r[0].ssrcGroups||[],...r[e].ssrcGroups||[]],r[0].ssrcs=[...r[0].ssrcs||[],...r[e].ssrcs||[]],i.push(e))}if(o){for(let e=a;e<r.length;++e){var u;if(e===a)r[e].mid=r[e].type,n=n+" "+r[e].mid,c=(null===(u=r[e].ssrcs)||void 0===u?void 0:u[0].id.toString())||"";else if(e===a+this.Yt.length)this.Xt=Number(r[e].mid),r[e].mid="share";else{var h,d,f,l;null!==(h=r[e].ssrcGroups)&&void 0!==h&&h.length&&(null===(d=r[e].ssrcGroups)||void 0===d||d.forEach((e=>{var t;null===(t=r[a].ssrcGroups)||void 0===t||t.push(e)})),null===(f=r[e].ssrcs)||void 0===f||f.forEach((e=>{var t;null===(t=r[a].ssrcs)||void 0===t||t.push(e)})),c=c+" "+(null===(l=r[e].ssrcs)||void 0===l?void 0:l[0].id.toString())),i.push(e)}}if(c){var p;const e={semantics:"SIM",ssrcs:c};null===(p=r[a].ssrcGroups)||void 0===p||p.push(e)}}return i.sort(((e,t)=>t-e)),i.forEach((e=>{r.splice(e,1)})),n=n.replace(/(^\s*)|(\s*$)/g,""),t.groups&&t.groups.length>0&&t.groups[0].mids&&(t.groups[0].mids=n),this.Kt=s,this.zt=o,lib.write(t)},this.mr=e=>{const t=e.split("\n");for(let e=0;e<t.length;++e)if(0===t[e].indexOf("a=extmap-allow-mixed")){t.splice(e,1);break}e=t.join("\n");const r=lib.parse(e),i=e$6.ipv6?6:4,n=e$6.ipv6?"::":"0.0.0.0";r.connection={version:i,ip:n},r.origin&&(r.origin.ipVer=i,r.origin.address=n);const s=r.media;for(const e of s){e.connection={version:i,ip:n},e.rtcp&&(e.rtcp.ipVer=i,e.rtcp.address=n);let t=0;if("audio"===e.type&&e.rtp)for(const r of e.rtp)if("opus"===r.codec){t=r.payload;break}var o;t&&(null===(o=e.rtcpFb)||void 0===o||o.push({payload:t,type:"nack"}))}{let e=!1;for(const t of s)if("video"===t.type&&t.fmtp)for(const r of t.fmtp)if(-1!=r.config.indexOf("profile-level-id=42e01f")){e=!0;break}if(e){const e=[];for(const t of s)if("video"===t.type){for(const r of t.rtp)"H264"===r.codec&&e.push(r.payload);break}for(const t of s){if(t.fmtp)for(const r of t.fmtp)-1!=e.indexOf(r.payload)&&-1!=r.config.indexOf("profile-level-id=42001f")&&(r.config=r.config.replace("profile-level-id=42001f","profile-level-id=42e01f"));t.ext&&(t.ext=t.ext.filter((e=>!e.uri.includes("video-orientation"))))}}}{let e=0,t=102;for(const r of s)if("video"===r.type){if(r.fmtp)for(const e of r.fmtp)if(e.config.indexOf("profile-level-id=42e01f")>-1&&e.config.indexOf("packetization-mode=1")>-1){t=e.payload;break}var a;if(r.ssrcGroups&&r.ssrcGroups.length>0)if(e<this.Yt.length)null===(a=r.ssrcs)||void 0===a||a.push({id:r.ssrcs[0].id,attribute:"fmtp",value:t+" max-mbps="+this.Yt[e].mbps}),e++;else if(e===this.Yt.length){var c;null===(c=r.ssrcs)||void 0===c||c.push({id:r.ssrcs[0].id,attribute:"fmtp",value:t+" max-mbps=1080"}),e++}}}return lib.write(r)},this.Ar=(e,t,r)=>{if(!t.sender)return;const i=t.sender.getParameters();r&&Object.assign(i,r),i.encodings||(i.encodings=[]),this.Zt.has(e)&&(i.encodings[0]={...i.encodings[0]||{},maxBitrate:this.Zt.get(e)},t.sender.setParameters(i))},this.Be=e}get datachannelState(){var e;return null===(e=this.dr)||void 0===e?void 0:e.readyState}applySendParameters(e){let{degradationPreference:t,type:r}=e;"video"===r?this.tr.forEach((e=>{f$3(e,{degradationPreference:t})})):this.vr&&f$3(this.vr,{degradationPreference:t})}}var HASH_UNDEFINED="__lodash_hash_undefined__";function setCacheAdd$1(e){return this.__data__.set(e,HASH_UNDEFINED),this}var _setCacheAdd=setCacheAdd$1;function setCacheHas$1(e){return this.__data__.has(e)}var _setCacheHas=setCacheHas$1,MapCache=_MapCache,setCacheAdd=_setCacheAdd,setCacheHas=_setCacheHas;function SetCache$1(e){var t=-1,r=null==e?0:e.length;for(this.__data__=new MapCache;++t<r;)this.add(e[t])}SetCache$1.prototype.add=SetCache$1.prototype.push=setCacheAdd,SetCache$1.prototype.has=setCacheHas;var _SetCache=SetCache$1;function arraySome$1(e,t){for(var r=-1,i=null==e?0:e.length;++r<i;)if(t(e[r],r,e))return!0;return!1}var _arraySome=arraySome$1;function cacheHas$1(e,t){return e.has(t)}var _cacheHas=cacheHas$1,SetCache=_SetCache,arraySome=_arraySome,cacheHas=_cacheHas,COMPARE_PARTIAL_FLAG$3=1,COMPARE_UNORDERED_FLAG$1=2;function equalArrays$2(e,t,r,i,n,s){var o=r&COMPARE_PARTIAL_FLAG$3,a=e.length,c=t.length;if(a!=c&&!(o&&c>a))return!1;var u=s.get(e),h=s.get(t);if(u&&h)return u==t&&h==e;var d=-1,f=!0,l=r&COMPARE_UNORDERED_FLAG$1?new SetCache:void 0;for(s.set(e,t),s.set(t,e);++d<a;){var p=e[d],v=t[d];if(i)var b=o?i(v,p,d,t,e,s):i(p,v,d,e,t,s);if(void 0!==b){if(b)continue;f=!1;break}if(l){if(!arraySome(t,(function(e,t){if(!cacheHas(l,t)&&(p===e||n(p,e,r,i,s)))return l.push(t)}))){f=!1;break}}else if(p!==v&&!n(p,v,r,i,s)){f=!1;break}}return s.delete(e),s.delete(t),f}var _equalArrays=equalArrays$2;function mapToArray$1(e){var t=-1,r=Array(e.size);return e.forEach((function(e,i){r[++t]=[i,e]})),r}var _mapToArray=mapToArray$1;function setToArray$1(e){var t=-1,r=Array(e.size);return e.forEach((function(e){r[++t]=e})),r}var _setToArray=setToArray$1,Symbol$1=_Symbol,Uint8Array$1=_Uint8Array,eq$2=eq_1,equalArrays$1=_equalArrays,mapToArray=_mapToArray,setToArray=_setToArray,COMPARE_PARTIAL_FLAG$2=1,COMPARE_UNORDERED_FLAG=2,boolTag="[object Boolean]",dateTag="[object Date]",errorTag="[object Error]",mapTag="[object Map]",numberTag="[object Number]",regexpTag="[object RegExp]",setTag="[object Set]",stringTag="[object String]",symbolTag="[object Symbol]",arrayBufferTag="[object ArrayBuffer]",dataViewTag="[object DataView]",symbolProto=Symbol$1?Symbol$1.prototype:void 0,symbolValueOf=symbolProto?symbolProto.valueOf:void 0;function equalByTag$1(e,t,r,i,n,s,o){switch(r){case dataViewTag:if(e.byteLength!=t.byteLength||e.byteOffset!=t.byteOffset)return!1;e=e.buffer,t=t.buffer;case arrayBufferTag:return!(e.byteLength!=t.byteLength||!s(new Uint8Array$1(e),new Uint8Array$1(t)));case boolTag:case dateTag:case numberTag:return eq$2(+e,+t);case errorTag:return e.name==t.name&&e.message==t.message;case regexpTag:case stringTag:return e==t+"";case mapTag:var a=mapToArray;case setTag:var c=i&COMPARE_PARTIAL_FLAG$2;if(a||(a=setToArray),e.size!=t.size&&!c)return!1;var u=o.get(e);if(u)return u==t;i|=COMPARE_UNORDERED_FLAG,o.set(e,t);var h=equalArrays$1(a(e),a(t),i,n,s,o);return o.delete(e),h;case symbolTag:if(symbolValueOf)return symbolValueOf.call(e)==symbolValueOf.call(t)}return!1}var _equalByTag=equalByTag$1,getAllKeys=_getAllKeys,COMPARE_PARTIAL_FLAG$1=1,objectProto$2=Object.prototype,hasOwnProperty$2=objectProto$2.hasOwnProperty;function equalObjects$1(e,t,r,i,n,s){var o=r&COMPARE_PARTIAL_FLAG$1,a=getAllKeys(e),c=a.length;if(c!=getAllKeys(t).length&&!o)return!1;for(var u=c;u--;){var h=a[u];if(!(o?h in t:hasOwnProperty$2.call(t,h)))return!1}var d=s.get(e),f=s.get(t);if(d&&f)return d==t&&f==e;var l=!0;s.set(e,t),s.set(t,e);for(var p=o;++u<c;){var v=e[h=a[u]],b=t[h];if(i)var m=o?i(b,v,h,t,e,s):i(v,b,h,e,t,s);if(!(void 0===m?v===b||n(v,b,r,i,s):m)){l=!1;break}p||(p="constructor"==h)}if(l&&!p){var g=e.constructor,y=t.constructor;g==y||!("constructor"in e)||!("constructor"in t)||"function"==typeof g&&g instanceof g&&"function"==typeof y&&y instanceof y||(l=!1)}return s.delete(e),s.delete(t),l}var _equalObjects=equalObjects$1,Stack$1=_Stack,equalArrays=_equalArrays,equalByTag=_equalByTag,equalObjects=_equalObjects,getTag=_getTag,isArray$1=isArray_1,isBuffer$1=isBufferExports,isTypedArray$1=isTypedArray_1,COMPARE_PARTIAL_FLAG=1,argsTag="[object Arguments]",arrayTag="[object Array]",objectTag$1="[object Object]",objectProto$1=Object.prototype,hasOwnProperty$1=objectProto$1.hasOwnProperty;function baseIsEqualDeep$1(e,t,r,i,n,s){var o=isArray$1(e),a=isArray$1(t),c=o?arrayTag:getTag(e),u=a?arrayTag:getTag(t),h=(c=c==argsTag?objectTag$1:c)==objectTag$1,d=(u=u==argsTag?objectTag$1:u)==objectTag$1,f=c==u;if(f&&isBuffer$1(e)){if(!isBuffer$1(t))return!1;o=!0,h=!1}if(f&&!h)return s||(s=new Stack$1),o||isTypedArray$1(e)?equalArrays(e,t,r,i,n,s):equalByTag(e,t,c,r,i,n,s);if(!(r&COMPARE_PARTIAL_FLAG)){var l=h&&hasOwnProperty$1.call(e,"__wrapped__"),p=d&&hasOwnProperty$1.call(t,"__wrapped__");if(l||p){var v=l?e.value():e,b=p?t.value():t;return s||(s=new Stack$1),n(v,b,r,i,s)}}return!!f&&(s||(s=new Stack$1),equalObjects(e,t,r,i,n,s))}var _baseIsEqualDeep=baseIsEqualDeep$1,baseIsEqualDeep=_baseIsEqualDeep,isObjectLike$2=isObjectLike_1;function baseIsEqual$1(e,t,r,i,n){return e===t||(null==e||null==t||!isObjectLike$2(e)&&!isObjectLike$2(t)?e!=e&&t!=t:baseIsEqualDeep(e,t,r,i,baseIsEqual$1,n))}var _baseIsEqual=baseIsEqual$1,baseIsEqual=_baseIsEqual;function isEqual(e,t){return baseIsEqual(e,t)}var isEqual_1=isEqual;class VideoProcessorDestination{constructor(){this.Tr=a$9()}get id(){return"0"}get name(){return"VideoProcessorDestination"}get kind(){return"video"}get enabled(){return!0}get input(){return this.Rr}setOptimizationMode(e){this.Or=e,this.input&&(this.input.contentHint=e||"")}pipe(e){throw new Error("VideoProcessorDestination cannot pipe to any other Processor")}unpipe(){throw new Error("VideoProcessorDestination cannot pipe to any other Processor")}disable(){}enable(){}on(e,t){return this.Tr.on(e,t),this}off(e,t){return this.Tr.off(e,t),this}updateInput(e){let{track:t}=e;t!==this.Rr&&(t.contentHint=this.Or||"",this.Rr=t,this.Tr.emit("on-track",t))}reset(){this.Rr=void 0,this.Tr.emit("on-track",void 0),this.Tr.all=new Map}}let d$1;class Player{constructor(e){this.Ir=null,this.jr=new Set,this.isPlaying=!1,this.kind=e,void 0===d$1&&(d$1=!!(new Audio).setSinkId)}create(){this.jr.size||this.Mr||(this.Mr=document.createElement(this.kind),this.Mr instanceof HTMLVideoElement&&(this.Mr.disablePictureInPicture=!0,this.Mr.playsInline=!0,this.Mr.setAttribute("webkit-playsinline","")),this.Mr.style.width="100%",this.Mr.style.height="100%",this.Mr.volume=1,this.Mr.autoplay=!0,"video"===this.kind&&(this.Mr.muted=!0),this.qr&&d$1&&this.Mr.setSinkId(sinkId))}attachCustomPlayer(e){if(this.Mr)throw new Error("inner player exist");this.jr.add(e),this.qr&&d$1&&e.setSinkId&&e.setSinkId(this.qr)}detachCustomPlayer(e){this.jr.size&&(this.jr.delete(e),!this.jr.size&&this.isPlaying&&(this.isPlaying=!1))}append(e){this.Mr&&this.Nr!==e&&(this.Nr=e,e.appendChild(this.Mr))}stop(){this.Mr?(this.isPlaying&&(this.Mr.pause(),this.Mr.srcObject=null,this.isPlaying=!1),this.Mr.remove(),this.Mr=void 0,this.Nr=void 0):this.jr.forEach((e=>{e.stop()}))}async play(e){try{e&&(this.Ir=e),this.Mr&&(!this.isPlaying||this.Mr.paused)&&this.Ir?(this.Mr.srcObject=this.Ir,console.log("wzw 111",this.Mr.readyState),this.Mr.readyState>=2?await this.Mr.play():(this.Mr.oncanplaythrough=()=>{var e;console.log("wzw 333",this.isPlaying,null===(e=this.Mr)||void 0===e?void 0:e.paused)},this.Mr.oncanplay=async()=>{var e,t;if(console.log("wzw 222",this.isPlaying,null===(e=this.Mr)||void 0===e?void 0:e.paused),this.isPlaying&&null!==(t=this.Mr)&&void 0!==t&&t.paused)try{await this.Mr.play()}catch(e){this.onPlayFailed&&this.onPlayFailed(e)}this.Mr&&(this.Mr.oncanplay=null)}),this.isPlaying=!0,void 0!==this.qr&&this.setSinkId(this.qr)):!this.isPlaying&&this.Ir&&this.jr.size&&(this.isPlaying=!0,this.jr.forEach((e=>{this.Ir&&e.play(this.Ir)})))}catch(e){this.onPlayFailed&&this.onPlayFailed(e)}}async setSinkId(e){if(!d$1||this.qr===e)throw new MError(exports.ErrorCode.NotSupport,"not support setSinkId");if(this.qr=e,this.Mr)try{await this.Mr.setSinkId(e)}catch(e){throw new MError(exports.ErrorCode.SetSinkIdFail,"set sink id fail",e)}else this.jr.forEach((t=>{t.setSinkId&&t.setSinkId(e)}))}async changeSource(e){if(this.Ir=e,this.jr.forEach((t=>{t.changeSource(e)})),this.isPlaying&&this.Mr){this.Mr.srcObject=e;try{this.Mr.readyState>=2?await this.Mr.play():this.Mr.oncanplay=async()=>{var e;if(this.isPlaying&&null!==(e=this.Mr)&&void 0!==e&&e.paused)try{await this.Mr.play()}catch(e){this.onPlayFailed&&this.onPlayFailed(e)}this.Mr&&(this.Mr.oncanplay=null)}}catch(e){this.onPlayFailed&&this.onPlayFailed(e)}}}getCurrentFrameData(){if(!this.isPlaying)throw new MError(exports.ErrorCode.TrackNotPlaying,"create canvas context failed!");if(this.Mr instanceof HTMLVideoElement){const e=document.createElement("canvas"),t=this.Mr;e.width=t.videoWidth,e.height=t.videoHeight;const r=e.getContext("2d");if(!r)throw new MError(exports.ErrorCode.CanvasContextFail,"create canvas context failed!");r.drawImage(t,0,0,e.width,e.height);const i=r.getImageData(0,0,e.width,e.height);return e.remove(),i}{const e=[...this.jr.values()];for(let t=0;t<e.length;t++){const r=e[t];try{if(r.getCurrentFrameData){const e=r.getCurrentFrameData();if(e)return e}}catch(e){trackLogger.warn("custom player error",e)}}throw new Error("custom player get frame data empty")}}close(){this.stop(),this.jr.clear()}}class Track{constructor(e,t){this.J=a$9(),this.Pr=!1,this.Dr=e,this.Ir=t,this.Mr=new Player(e.kind),this.Mr.onPlayFailed=e=>{this.J.emit("play-failed",e),trackLogger.error("auto play error",this.trackKind,"name:",null==e?void 0:e.name,"code:",null==e?void 0:e.code,"message:",null==e?void 0:e.message)},this.Lr=this.Lr.bind(this),this.Br()}get trackKind(){return this.Dr.kind}get isPlaying(){return this.Mr.isPlaying}get closed(){return this.Pr}get trackId(){return this.Dr.id}get mediaStreamTrack(){return this.Dr}Lr(){trackLogger.info("track ended"),this.J.emit("track-ended",void 0)}Fr(){if(this.Pr)throw new MError(exports.ErrorCode.TrackClosed,"track was closed")}Br(){this.Dr.addEventListener("ended",this.Lr)}Hr(){this.Dr.removeEventListener("ended",this.Lr)}once(e,t){const r=i=>{this.J.off(e,r),t(i)};return this.J.on(e,r),this}on(e,t){return this.J.on(e,t),this}off(e,t){return this.J.off(e,t),this}has(e){return this.J.all.get(e)}Ur(){this.J.all.clear()}async play(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:this.Ir;trackLogger.info("track play"),this.Fr(),this.Mr.create(),e&&this.Mr.append(e),await this.Mr.play(t)}attachCustomPlayer(){return this.Mr.attachCustomPlayer(...arguments)}detachCustomPlayer(){return this.Mr.detachCustomPlayer(...arguments)}stop(){this.Mr.stop()}close(){this.Pr||(this.Mr.close(),this.Hr(),this.Dr.stop(),this.J.emit("closed",void 0),this.Ur(),this.Pr=!0)}}class LocalTrack extends Track{constructor(e,t){super(e,t),this.Vr=!1,this.Gr=!1,this.Kr=!0,this.Wr=e.getConstraints(),this.zr=e.getSettings()}get publishMediaStreamTrack(){return this.mediaStreamTrack}get muted(){return this.Gr}get enabled(){return this.Kr}get published(){return this.Vr}set __published(e){this.Vr=e}Xr(e){this.Fr();const t="audio"===this.trackKind?e.getAudioTracks()[0]:e.getVideoTracks()[0];if(!t)throw new MError(exports.ErrorCode.ChangeSourceTrackNull);this.Hr(),this.Dr.stop(),this.Ir=e,this.Dr=t,this.Br(),this.zr=t.getSettings(),this.Wr=t.getConstraints(),!this.muted&&this.enabled&&this.J.emit("source-changed",void 0),this.Mr.changeSource(new MediaStream([this.publishMediaStreamTrack]))}setEnabled(e){this.Fr(),this.Kr!==e&&(this.Kr=e,e?(this.Br(),this.J.emit("enabled",void 0)):(this.stop(),this.Hr(),this.Dr.stop(),this.J.emit("disabled",void 0)))}setMuted(e){this.Fr(),this.Gr!==e&&(this.Gr=e,this.Dr.enabled=!e,e?(this.stop(),this.J.emit("muted",void 0)):this.J.emit("unmuted",void 0))}async play(e){this.Fr(),await super.play(e,new MediaStream([this.publishMediaStreamTrack]))}stop(){this.Fr(),super.stop()}}class LocalVideoTrack extends LocalTrack{get publishMediaStreamTrack(){return this.processorDestination.input||super.publishMediaStreamTrack}get optimizationMode(){return this.Or}constructor(e,t){super(e,t),this.processorDestination=new VideoProcessorDestination,this.Jr=e=>{!this.muted&&this.enabled&&this.J.emit("source-changed",void 0),this.Mr.changeSource(e?new MediaStream([e]):this.Ir)}}Xr(){throw new MError(exports.ErrorCode.UnexpectedCall)}setOptimizationMode(e){this.mediaStreamTrack.contentHint=e||"",this.processorDestination.setOptimizationMode(e),this.Or=e,this.J.emit("optimization-mode-changed",this.optimizationMode)}setEnabled(e){this.Fr(),this.Kr!==e&&(super.setEnabled(e),this.Yr&&(e?(this.Yr.updateInput({track:this.Dr}),this.Yr.enable()):this.Yr.disable()))}setMuted(e){this.Fr(),this.Gr!==e&&(super.setMuted(e),this.Yr&&(e?this.Yr.disable():(this.Yr.updateInput({track:this.Dr}),this.Yr.enable())))}changeSource(e){super.Xr(e),this.mediaStreamTrack.contentHint=this.Or||"",this.Yr&&this.Yr.updateInput({track:this.Dr})}getCurrentFrameData(){return this.Mr.getCurrentFrameData()}pipe(e){if(this.Fr(),this.Yr===e)return e;if(e.source)throw new MError(exports.ErrorCode.ProcessorPiped,"Processor ".concat(e.name," already piped, please call unpipe beforehand."));return this.unpipe(),this.Yr=e,this.Yr.source=this.processorDestination,this.processorDestination.on("on-track",this.Jr),this.enabled&&!this.muted&&e.updateInput({track:this.Dr}),e}unpipe(){this.Yr&&(this.Yr.source=void 0,this.Yr.reset(),this.Yr=void 0,this.processorDestination.off("on-track",this.Jr))}async play(e){super.play(e)}close(){this.unpipe(),super.close()}}class CameraVideoTrack extends LocalVideoTrack{constructor(e,t){super(e,t),this.Zr=this.Wr}get facingMode(){return this.zr.facingMode}get deviceId(){return this.zr.deviceId}Qr(){"live"===this.Dr.readyState&&(this.Hr(),this.Dr.stop())}changeSource(){throw new MError(exports.ErrorCode.UnexpectedCall)}async setDevice(e){if(this.Fr(),this.enabled){if(e.deviceId&&isEqual_1(e.deviceId,this.Zr.deviceId)||e.facingMode&&isEqual_1(e.facingMode,this.Zr.facingMode))try{return void await this.Dr.applyConstraints(e)}catch(e){trackLogger.warn("camera track set device constraints applyConstraints error",e)}this.Zr=e,this.Qr();try{const t=await navigator.mediaDevices.getUserMedia({video:e,audio:!1});isEqual_1(this.Zr,e)?super.changeSource(t):(t.getVideoTracks()[0].stop(),trackLogger.warn("camera track set device constraints different params"))}catch(e){throw this.Lr(),e}}else this.Zr=e}async setEnabled(e){if(this.Fr(),this.Kr!==e)if(e){const t=await navigator.mediaDevices.getUserMedia({video:this.Wr,audio:!1});this.Ir=t,this.Dr=t.getVideoTracks()[0],this.zr=this.Dr.getSettings(),super.setEnabled(e)}else super.setEnabled(e)}}const a="volume-meter",b=new Blob([`\n  const SMOOTHING_FACTOR = 0.8;\n  const FRAME_PER_SECOND = 10;\n  const FRAME_INTERVAL = 1 / FRAME_PER_SECOND;\n  class VolumeMeter extends AudioWorkletProcessor {\n    constructor() {\n      super();\n      this._lastUpdate = currentTime;\n      this._volume = 0;\n    }\n\n    calculateRMS(inputChannelData) {\n      if(!inputChannelData) return;\n      let sum = 0;\n      for (let i = 0; i < inputChannelData.length; i++) {\n        sum += inputChannelData[i] * inputChannelData[i];\n      }\n      let rms = Math.sqrt(sum / inputChannelData.length);\n      this._volume = Math.max(rms, this._volume * SMOOTHING_FACTOR);\n    }\n\n    process(inputs, outputs) {\n      const inputChannelData = inputs[0][0];\n      // Post a message to the node every 1/10 s.\n      if (currentTime - this._lastUpdate > FRAME_INTERVAL) {\n        this.calculateRMS(inputChannelData);\n        this.port.postMessage(this._volume * 800);\n        this._lastUpdate = currentTime;\n      }\n      return true;\n    }\n  }\n\n  registerProcessor("${a}", VolumeMeter);\n`],{type:"application/javascript"}),createVolumeMeter=async function(e,t){let r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:null;const i=new AudioContext;try{const n=URL.createObjectURL(b);await i.audioWorklet.addModule(n);const s=i.createMediaStreamSource(e),o=new AudioWorkletNode(i,a);return o.port.onmessage=t,o.port.onmessageerror=r,s.connect(o).connect(i.destination),()=>{"closed"!==i.state&&(i.close(),URL.revokeObjectURL(n),s.disconnect(),o.port.close())}}catch(e){throw i.close(),e}};class LocalAudioTrack extends LocalTrack{constructor(e,t){super(e,t),this.ei=0,this.ti()}async ti(){try{this.ri=await createVolumeMeter(this.Ir,(e=>{let{data:t}=e;this.ei=t}))}catch(e){trackLogger.error("init volume meter error",e)}}Xr(){throw new MError(exports.ErrorCode.UnexpectedCall)}changeSource(e){super.Xr(e),this.ri&&this.ri(),this.ti()}getVolumeLevel(){return Math.min(Math.max(this.ei,0),100)}setPlaybackDevice(e){return this.Fr(),this.Mr.setSinkId(e)}setEnabled(e){this.Fr(),this.Kr!==e&&(e?this.ti():this.ri&&this.ri()),super.setEnabled(e)}close(){this.closed?trackLogger.warn("track closed"):(this.ri&&this.ri(),super.close())}}const f$2={noiseSuppression:!0,echoCancellation:!0,autoGainControl:!0};class MicrophoneAudioTrack extends LocalAudioTrack{constructor(e,t){super(e,t),this.Zr=this.Wr}get deviceId(){return this.zr.deviceId}changeSource(){throw new MError(exports.ErrorCode.UnexpectedCall)}async setDevice(e){if(this.Fr(),this.enabled){if(e.deviceId&&isEqual_1(e.deviceId,this.Zr.deviceId)||e.facingMode&&isEqual_1(e.facingMode,this.Zr.facingMode))try{return void await this.Dr.applyConstraints(e)}catch(e){trackLogger.warn("camera track set device constraints applyConstraints error",e)}this.Zr=e;const t=await navigator.mediaDevices.getUserMedia({audio:{...f$2,...e},video:!1});isEqual_1(this.Zr,e)?super.changeSource(t):(t.getAudioTracks()[0].stop(),trackLogger.warn("microphone track set device constraints different params"))}else this.Zr=e}async setEnabled(e){if(this.Fr(),this.Kr!==e)if(e){const t=await navigator.mediaDevices.getUserMedia({video:!1,audio:{...f$2,...this.Wr}});this.Ir=t,this.Dr=t.getAudioTracks()[0],this.zr=this.Dr.getSettings(),this.Wr=this.Dr.getConstraints(),super.setEnabled(e)}else super.setEnabled(e)}}class ScreenVideoTrack extends LocalVideoTrack{constructor(e,t){super(e,t),this.setOptimizationMode("detail")}async changeScreen(){let e=!(arguments.length>0&&void 0!==arguments[0])||arguments[0],t=!(arguments.length>1&&void 0!==arguments[1])||arguments[1],r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{};const i=await navigator.mediaDevices.getDisplayMedia({...r,video:e,audio:!1===t?t:{...!0===t?{}:t}}),n=i.getAudioTracks().length?i.clone():void 0,s=i;return s.getAudioTracks().forEach((e=>{s.removeTrack(e)})),null==n||n.getVideoTracks().forEach((e=>{n.removeTrack(e)})),super.changeSource(s),n}}class ScreenAudioTrack extends LocalAudioTrack{constructor(e,t){super(e,t)}}class ElectronScreenVideoTrack extends LocalVideoTrack{constructor(e,t){super(e,t),this.setOptimizationMode("detail")}async changeScreen(e){const t=await navigator.mediaDevices.getUserMedia({video:{mandatory:e}});super.changeSource(t)}}class RemoteTrack extends Track{constructor(e,t){super(e,t)}}class RemoteVideoTrack extends RemoteTrack{constructor(e,t,r,i,n,s){super(e,t),this.ii=!1,this.ni=!0,this.si=r,this.oi=i,this.ai=n,this.ci=s,this.ui()}get forwarded(){return this.ii}async di(){let e;return(await this.oi.getStats()).forEach((t=>{"inbound-rtp"===t.type&&(e=t)})),e||{framesDecoded:0}}async ui(e){if(!this.ni)return;const t=e||(await this.di()).framesDecoded;this.fi=window.setTimeout((async()=>{const e=(await this.di()).framesDecoded,r=this.oi.getContributingSources();e-t>0&&(!this.ci||!this.ci.length||null!=r&&r.length&&this.ci.includes(r[0].source))?(trackLogger.info(this.si.toString(),"emit forward-state-change true"),trackLogger.info(this.si.toString(),"first frame csrc",this.oi.getContributingSources().map((e=>e.source)).join(";")),this.ii=!0,this.J.emit("forward-state-change",!0)):await this.ui(e)}),50)}videoForwardChange(e){e!==this.ni&&(this.ni=e,e?this.ui():(this.ii=e,this.J.emit("forward-state-change",e),window.clearTimeout(this.fi)))}getCurrentFrameData(){return this.Mr.getCurrentFrameData()}async updateSubscribeResolution(e){this.Fr(),await this.ai(e),this.ui()}close(){window.clearTimeout(this.fi),super.close()}}class RemoteMemberVideoTrack extends RemoteVideoTrack{constructor(e,t,r,i,n,s,o){super(e,t,r,i,n,s),this.li=o}get uuid(){return this.si}get captureSourceId(){return this.li}}class RemoteAudioTrack extends RemoteTrack{constructor(e,t){super(e,t),this.ei=0,this.ti()}async ti(){try{this.ri=await createVolumeMeter(this.Ir,(e=>{let{data:t}=e;this.ei=t}))}catch(e){trackLogger.error("init volume meter error",e)}}getVolumeLevel(){return Math.min(Math.max(this.ei,0),100)}setPlaybackDevice(e){return this.Fr(),this.Mr.setSinkId(e)}getEndpointId(){throw new Error("remote audio can not get endpoint id yet")}async play(){await super.play()}close(){this.ri&&this.ri(),super.close()}}const ShareUuid=Symbol("share"),ActiveVideoUuid=Symbol("active-video");class RemoteActiveVideoTrack extends RemoteVideoTrack{constructor(e,t,r,i,n){super(e,t,ActiveVideoUuid,r,n),this.pi=()=>{void 0===this.Lt&&(this.Lt=window.setInterval((()=>{const e=this.vi();e&&(this.bi={...this.bi,...e},this.J.emit("video-active-updated",e))}),200))},this.vi=i}get uuid(){return ActiveVideoUuid}on(e,t){return"video-active-updated"===e&&this.pi(),this.J.on(e,t),this}off(e,t){var r;return"video-active-updated"!==e||null!==(r=this.has(e))&&void 0!==r&&r.length||window.clearInterval(this.Lt),this.J.off(e,t),this}videoActiveForwardedChange(e){this.bi=e,setTimeout((()=>{this.J.emit("video-active-updated",e)}))}async play(e){await super.play(e)}close(){window.clearInterval(this.Lt),super.close()}}class RemoteScreenVideoTrack extends RemoteVideoTrack{constructor(e,t,r,i){super(e,t,ShareUuid,r,i)}get uuid(){return ShareUuid}}var EndpointEvents;!function(e){e.SimulSubscribe="SimulSubscribe",e.SimulNotification="SimulNotification",e.ForwardNotification="ForwardNotification",e.QualityNotification="QualityNotification",e.MuteStateNotification="MuteStateNotification",e.DesktopSimulNotification="DesktopSimulNotification",e.RecvStreamSSRCNotification="RecvStreamSSRCNotification",e.ActiveAudiosNotification="ActiveAudiosNotification",e.EndpointSyncNotification="EndpointSyncNotification",e.ShareSyncNotification="ShareSyncNotification",e.DtlsSubscribeNotification="DtlsSubscribeNotification",e.VideoSyncNotification="VideoSyncNotification",e.MediaNetworkStatusNotification="MediaNetworkStatusNotification",e.FocusVideoNotification="FocusVideoNotification",e.DesktopResolutionLimitNotification="DesktopResolutionLimitNotification",e.RSSNRNotification="RSSNRNotification"}(EndpointEvents||(EndpointEvents={}));var simulprotoExports={},simulproto$1={get exports(){return simulprotoExports},set exports(e){simulprotoExports=e}},minimalExports={},minimal$1={get exports(){return minimalExports},set exports(e){minimalExports=e}},indexMinimal={},minimal={},aspromise,hasRequiredAspromise;function requireAspromise(){return hasRequiredAspromise||(hasRequiredAspromise=1,aspromise=function(e,t){for(var r=new Array(arguments.length-1),i=0,n=2,s=!0;n<arguments.length;)r[i++]=arguments[n++];return new Promise((function(n,o){r[i]=function(e){if(s)if(s=!1,e)o(e);else{for(var t=new Array(arguments.length-1),r=0;r<t.length;)t[r++]=arguments[r];n.apply(null,t)}};try{e.apply(t||null,r)}catch(e){s&&(s=!1,o(e))}}))}),aspromise}var base64={},hasRequiredBase64,eventemitter,hasRequiredEventemitter,float,hasRequiredFloat,inquire_1,hasRequiredInquire;function requireBase64(){return hasRequiredBase64||(hasRequiredBase64=1,function(e){var t=e;t.length=function(e){var t=e.length;if(!t)return 0;for(var r=0;--t%4>1&&"="===e.charAt(t);)++r;return Math.ceil(3*e.length)/4-r};for(var r=new Array(64),i=new Array(123),n=0;n<64;)i[r[n]=n<26?n+65:n<52?n+71:n<62?n-4:n-59|43]=n++;t.encode=function(e,t,i){for(var n,s=null,o=[],a=0,c=0;t<i;){var u=e[t++];switch(c){case 0:o[a++]=r[u>>2],n=(3&u)<<4,c=1;break;case 1:o[a++]=r[n|u>>4],n=(15&u)<<2,c=2;break;case 2:o[a++]=r[n|u>>6],o[a++]=r[63&u],c=0}a>8191&&((s||(s=[])).push(String.fromCharCode.apply(String,o)),a=0)}return c&&(o[a++]=r[n],o[a++]=61,1===c&&(o[a++]=61)),s?(a&&s.push(String.fromCharCode.apply(String,o.slice(0,a))),s.join("")):String.fromCharCode.apply(String,o.slice(0,a))};var s="invalid encoding";t.decode=function(e,t,r){for(var n,o=r,a=0,c=0;c<e.length;){var u=e.charCodeAt(c++);if(61===u&&a>1)break;if(void 0===(u=i[u]))throw Error(s);switch(a){case 0:n=u,a=1;break;case 1:t[r++]=n<<2|(48&u)>>4,n=u,a=2;break;case 2:t[r++]=(15&n)<<4|(60&u)>>2,n=u,a=3;break;case 3:t[r++]=(3&n)<<6|u,a=0}}if(1===a)throw Error(s);return r-o},t.test=function(e){return/^(?:[A-Za-z0-9+/]{4})*(?:[A-Za-z0-9+/]{2}==|[A-Za-z0-9+/]{3}=)?$/.test(e)}}(base64)),base64}function requireEventemitter(){if(hasRequiredEventemitter)return eventemitter;function e(){this.ie={}}return hasRequiredEventemitter=1,eventemitter=e,e.prototype.on=function(e,t,r){return(this.ie[e]||(this.ie[e]=[])).push({fn:t,ctx:r||this}),this},e.prototype.off=function(e,t){if(void 0===e)this.ie={};else if(void 0===t)this.ie[e]=[];else for(var r=this.ie[e],i=0;i<r.length;)r[i].fn===t?r.splice(i,1):++i;return this},e.prototype.emit=function(e){var t=this.ie[e];if(t){for(var r=[],i=1;i<arguments.length;)r.push(arguments[i++]);for(i=0;i<t.length;)t[i].fn.apply(t[i++].ctx,r)}return this},eventemitter}function requireFloat(){if(hasRequiredFloat)return float;function e(e){return"undefined"!=typeof Float32Array?function(){var t=new Float32Array([-0]),r=new Uint8Array(t.buffer),i=128===r[3];function n(e,i,n){t[0]=e,i[n]=r[0],i[n+1]=r[1],i[n+2]=r[2],i[n+3]=r[3]}function s(e,i,n){t[0]=e,i[n]=r[3],i[n+1]=r[2],i[n+2]=r[1],i[n+3]=r[0]}function o(e,i){return r[0]=e[i],r[1]=e[i+1],r[2]=e[i+2],r[3]=e[i+3],t[0]}function a(e,i){return r[3]=e[i],r[2]=e[i+1],r[1]=e[i+2],r[0]=e[i+3],t[0]}e.writeFloatLE=i?n:s,e.writeFloatBE=i?s:n,e.readFloatLE=i?o:a,e.readFloatBE=i?a:o}():function(){function s(e,t,r,i){var n=t<0?1:0;if(n&&(t=-t),0===t)e(1/t>0?0:2147483648,r,i);else if(isNaN(t))e(2143289344,r,i);else if(t>34028234663852886e22)e((n<<31|2139095040)>>>0,r,i);else if(t<11754943508222875e-54)e((n<<31|Math.round(t/1401298464324817e-60))>>>0,r,i);else{var s=Math.floor(Math.log(t)/Math.LN2);e((n<<31|s+127<<23|8388607&Math.round(t*Math.pow(2,-s)*8388608))>>>0,r,i)}}function o(e,t,r){var i=e(t,r),n=2*(i>>31)+1,s=i>>>23&255,o=8388607&i;return 255===s?o?NaN:n*(1/0):0===s?1401298464324817e-60*n*o:n*Math.pow(2,s-150)*(o+8388608)}e.writeFloatLE=s.bind(null,t),e.writeFloatBE=s.bind(null,r),e.readFloatLE=o.bind(null,i),e.readFloatBE=o.bind(null,n)}(),"undefined"!=typeof Float64Array?function(){var t=new Float64Array([-0]),r=new Uint8Array(t.buffer),i=128===r[7];function n(e,i,n){t[0]=e,i[n]=r[0],i[n+1]=r[1],i[n+2]=r[2],i[n+3]=r[3],i[n+4]=r[4],i[n+5]=r[5],i[n+6]=r[6],i[n+7]=r[7]}function s(e,i,n){t[0]=e,i[n]=r[7],i[n+1]=r[6],i[n+2]=r[5],i[n+3]=r[4],i[n+4]=r[3],i[n+5]=r[2],i[n+6]=r[1],i[n+7]=r[0]}function o(e,i){return r[0]=e[i],r[1]=e[i+1],r[2]=e[i+2],r[3]=e[i+3],r[4]=e[i+4],r[5]=e[i+5],r[6]=e[i+6],r[7]=e[i+7],t[0]}function a(e,i){return r[7]=e[i],r[6]=e[i+1],r[5]=e[i+2],r[4]=e[i+3],r[3]=e[i+4],r[2]=e[i+5],r[1]=e[i+6],r[0]=e[i+7],t[0]}e.writeDoubleLE=i?n:s,e.writeDoubleBE=i?s:n,e.readDoubleLE=i?o:a,e.readDoubleBE=i?a:o}():function(){function s(e,t,r,i,n,s){var o=i<0?1:0;if(o&&(i=-i),0===i)e(0,n,s+t),e(1/i>0?0:2147483648,n,s+r);else if(isNaN(i))e(0,n,s+t),e(2146959360,n,s+r);else if(i>17976931348623157e292)e(0,n,s+t),e((o<<31|2146435072)>>>0,n,s+r);else{var a;if(i<22250738585072014e-324)e((a=i/5e-324)>>>0,n,s+t),e((o<<31|a/4294967296)>>>0,n,s+r);else{var c=Math.floor(Math.log(i)/Math.LN2);1024===c&&(c=1023),e(4503599627370496*(a=i*Math.pow(2,-c))>>>0,n,s+t),e((o<<31|c+1023<<20|1048576*a&1048575)>>>0,n,s+r)}}}function o(e,t,r,i,n){var s=e(i,n+t),o=e(i,n+r),a=2*(o>>31)+1,c=o>>>20&2047,u=4294967296*(1048575&o)+s;return 2047===c?u?NaN:a*(1/0):0===c?5e-324*a*u:a*Math.pow(2,c-1075)*(u+4503599627370496)}e.writeDoubleLE=s.bind(null,t,0,4),e.writeDoubleBE=s.bind(null,r,4,0),e.readDoubleLE=o.bind(null,i,0,4),e.readDoubleBE=o.bind(null,n,4,0)}(),e}function t(e,t,r){t[r]=255&e,t[r+1]=e>>>8&255,t[r+2]=e>>>16&255,t[r+3]=e>>>24}function r(e,t,r){t[r]=e>>>24,t[r+1]=e>>>16&255,t[r+2]=e>>>8&255,t[r+3]=255&e}function i(e,t){return(e[t]|e[t+1]<<8|e[t+2]<<16|e[t+3]<<24)>>>0}function n(e,t){return(e[t]<<24|e[t+1]<<16|e[t+2]<<8|e[t+3])>>>0}return hasRequiredFloat=1,float=e(e)}function requireInquire(){if(hasRequiredInquire)return inquire_1;function inquire(moduleName){try{var mod=eval("quire".replace(/^/,"re"))(moduleName);if(mod&&(mod.length||Object.keys(mod).length))return mod}catch(e){}return null}return hasRequiredInquire=1,inquire_1=inquire,inquire_1}var utf8={},hasRequiredUtf8,pool_1,hasRequiredPool,longbits,hasRequiredLongbits,hasRequiredMinimal$1,writer,hasRequiredWriter,writer_buffer,hasRequiredWriter_buffer,reader,hasRequiredReader,reader_buffer,hasRequiredReader_buffer;function requireUtf8(){return hasRequiredUtf8||(hasRequiredUtf8=1,function(e){var t=e;t.length=function(e){for(var t=0,r=0,i=0;i<e.length;++i)(r=e.charCodeAt(i))<128?t+=1:r<2048?t+=2:55296==(64512&r)&&56320==(64512&e.charCodeAt(i+1))?(++i,t+=4):t+=3;return t},t.read=function(e,t,r){if(r-t<1)return"";for(var i,n=null,s=[],o=0;t<r;)(i=e[t++])<128?s[o++]=i:i>191&&i<224?s[o++]=(31&i)<<6|63&e[t++]:i>239&&i<365?(i=((7&i)<<18|(63&e[t++])<<12|(63&e[t++])<<6|63&e[t++])-65536,s[o++]=55296+(i>>10),s[o++]=56320+(1023&i)):s[o++]=(15&i)<<12|(63&e[t++])<<6|63&e[t++],o>8191&&((n||(n=[])).push(String.fromCharCode.apply(String,s)),o=0);return n?(o&&n.push(String.fromCharCode.apply(String,s.slice(0,o))),n.join("")):String.fromCharCode.apply(String,s.slice(0,o))},t.write=function(e,t,r){for(var i,n,s=r,o=0;o<e.length;++o)(i=e.charCodeAt(o))<128?t[r++]=i:i<2048?(t[r++]=i>>6|192,t[r++]=63&i|128):55296==(64512&i)&&56320==(64512&(n=e.charCodeAt(o+1)))?(i=65536+((1023&i)<<10)+(1023&n),++o,t[r++]=i>>18|240,t[r++]=i>>12&63|128,t[r++]=i>>6&63|128,t[r++]=63&i|128):(t[r++]=i>>12|224,t[r++]=i>>6&63|128,t[r++]=63&i|128);return r-s}}(utf8)),utf8}function requirePool(){return hasRequiredPool||(hasRequiredPool=1,pool_1=function(e,t,r){var i=r||8192,n=i>>>1,s=null,o=i;return function(r){if(r<1||r>n)return e(r);o+r>i&&(s=e(i),o=0);var a=t.call(s,o,o+=r);return 7&o&&(o=1+(7|o)),a}}),pool_1}function requireLongbits(){if(hasRequiredLongbits)return longbits;hasRequiredLongbits=1,longbits=t;var e=requireMinimal$1();function t(e,t){this.lo=e>>>0,this.hi=t>>>0}var r=t.zero=new t(0,0);r.toNumber=function(){return 0},r.zzEncode=r.zzDecode=function(){return this},r.length=function(){return 1};var i=t.zeroHash="\0\0\0\0\0\0\0\0";t.fromNumber=function(e){if(0===e)return r;var i=e<0;i&&(e=-e);var n=e>>>0,s=(e-n)/4294967296>>>0;return i&&(s=~s>>>0,n=~n>>>0,++n>4294967295&&(n=0,++s>4294967295&&(s=0))),new t(n,s)},t.from=function(i){if("number"==typeof i)return t.fromNumber(i);if(e.isString(i)){if(!e.Long)return t.fromNumber(parseInt(i,10));i=e.Long.fromString(i)}return i.low||i.high?new t(i.low>>>0,i.high>>>0):r},t.prototype.toNumber=function(e){if(!e&&this.hi>>>31){var t=1+~this.lo>>>0,r=~this.hi>>>0;return t||(r=r+1>>>0),-(t+4294967296*r)}return this.lo+4294967296*this.hi},t.prototype.toLong=function(t){return e.Long?new e.Long(0|this.lo,0|this.hi,Boolean(t)):{low:0|this.lo,high:0|this.hi,unsigned:Boolean(t)}};var n=String.prototype.charCodeAt;return t.fromHash=function(e){return e===i?r:new t((n.call(e,0)|n.call(e,1)<<8|n.call(e,2)<<16|n.call(e,3)<<24)>>>0,(n.call(e,4)|n.call(e,5)<<8|n.call(e,6)<<16|n.call(e,7)<<24)>>>0)},t.prototype.toHash=function(){return String.fromCharCode(255&this.lo,this.lo>>>8&255,this.lo>>>16&255,this.lo>>>24,255&this.hi,this.hi>>>8&255,this.hi>>>16&255,this.hi>>>24)},t.prototype.zzEncode=function(){var e=this.hi>>31;return this.hi=((this.hi<<1|this.lo>>>31)^e)>>>0,this.lo=(this.lo<<1^e)>>>0,this},t.prototype.zzDecode=function(){var e=-(1&this.lo);return this.lo=((this.lo>>>1|this.hi<<31)^e)>>>0,this.hi=(this.hi>>>1^e)>>>0,this},t.prototype.length=function(){var e=this.lo,t=(this.lo>>>28|this.hi<<4)>>>0,r=this.hi>>>24;return 0===r?0===t?e<16384?e<128?1:2:e<2097152?3:4:t<16384?t<128?5:6:t<2097152?7:8:r<128?9:10},longbits}function requireMinimal$1(){return hasRequiredMinimal$1||(hasRequiredMinimal$1=1,function(e){var t=e;function r(e,t,r){for(var i=Object.keys(t),n=0;n<i.length;++n)void 0!==e[i[n]]&&r||(e[i[n]]=t[i[n]]);return e}function i(e){function t(e,i){if(!(this instanceof t))return new t(e,i);Object.defineProperty(this,"message",{get:function(){return e}}),Error.captureStackTrace?Error.captureStackTrace(this,t):Object.defineProperty(this,"stack",{value:(new Error).stack||""}),i&&r(this,i)}return(t.prototype=Object.create(Error.prototype)).constructor=t,Object.defineProperty(t.prototype,"name",{get:function(){return e}}),t.prototype.toString=function(){return this.name+": "+this.message},t}t.asPromise=requireAspromise(),t.base64=requireBase64(),t.EventEmitter=requireEventemitter(),t.float=requireFloat(),t.inquire=requireInquire(),t.utf8=requireUtf8(),t.pool=requirePool(),t.LongBits=requireLongbits(),t.isNode=Boolean(void 0!==commonjsGlobal&&commonjsGlobal&&commonjsGlobal.process&&commonjsGlobal.process.versions&&commonjsGlobal.process.versions.node),t.global=t.isNode&&commonjsGlobal||"undefined"!=typeof window&&window||"undefined"!=typeof self&&self||commonjsGlobal,t.emptyArray=Object.freeze?Object.freeze([]):[],t.emptyObject=Object.freeze?Object.freeze({}):{},t.isInteger=Number.isInteger||function(e){return"number"==typeof e&&isFinite(e)&&Math.floor(e)===e},t.isString=function(e){return"string"==typeof e||e instanceof String},t.isObject=function(e){return e&&"object"==typeof e},t.isset=t.isSet=function(e,t){var r=e[t];return!(null==r||!e.hasOwnProperty(t))&&("object"!=typeof r||(Array.isArray(r)?r.length:Object.keys(r).length)>0)},t.Buffer=function(){try{var e=t.inquire("buffer").Buffer;return e.prototype.utf8Write?e:null}catch(e){return null}}(),t.mi=null,t.gi=null,t.newBuffer=function(e){return"number"==typeof e?t.Buffer?t.gi(e):new t.Array(e):t.Buffer?t.mi(e):"undefined"==typeof Uint8Array?e:new Uint8Array(e)},t.Array="undefined"!=typeof Uint8Array?Uint8Array:Array,t.Long=t.global.dcodeIO&&t.global.dcodeIO.Long||t.global.Long||t.inquire("long"),t.key2Re=/^true|false|0|1$/,t.key32Re=/^-?(?:0|[1-9][0-9]*)$/,t.key64Re=/^(?:[\\x00-\\xff]{8}|-?(?:0|[1-9][0-9]*))$/,t.longToHash=function(e){return e?t.LongBits.from(e).toHash():t.LongBits.zeroHash},t.longFromHash=function(e,r){var i=t.LongBits.fromHash(e);return t.Long?t.Long.fromBits(i.lo,i.hi,r):i.toNumber(Boolean(r))},t.merge=r,t.lcFirst=function(e){return e.charAt(0).toLowerCase()+e.substring(1)},t.newError=i,t.ProtocolError=i("ProtocolError"),t.oneOfGetter=function(e){for(var t={},r=0;r<e.length;++r)t[e[r]]=1;return function(){for(var e=Object.keys(this),r=e.length-1;r>-1;--r)if(1===t[e[r]]&&void 0!==this[e[r]]&&null!==this[e[r]])return e[r]}},t.oneOfSetter=function(e){return function(t){for(var r=0;r<e.length;++r)e[r]!==t&&delete this[e[r]]}},t.toJSONOptions={longs:String,enums:String,bytes:String,json:!0},t.yi=function(){var e=t.Buffer;e?(t.mi=e.from!==Uint8Array.from&&e.from||function(t,r){return new e(t,r)},t.gi=e.allocUnsafe||function(t){return new e(t)}):t.mi=t.gi=null}}(minimal)),minimal}function requireWriter(){if(hasRequiredWriter)return writer;hasRequiredWriter=1,writer=c;var e,t=requireMinimal$1(),r=t.LongBits,i=t.base64,n=t.utf8;function s(e,t,r){this.fn=e,this.len=t,this.next=void 0,this.val=r}function o(){}function a(e){this.head=e.head,this.tail=e.tail,this.len=e.len,this.next=e.states}function c(){this.len=0,this.head=new s(o,0,0),this.tail=this.head,this.states=null}var u=function(){return t.Buffer?function(){return(c.create=function(){return new e})()}:function(){return new c}};function h(e,t,r){t[r]=255&e}function d(e,t){this.len=e,this.next=void 0,this.val=t}function f(e,t,r){for(;e.hi;)t[r++]=127&e.lo|128,e.lo=(e.lo>>>7|e.hi<<25)>>>0,e.hi>>>=7;for(;e.lo>127;)t[r++]=127&e.lo|128,e.lo=e.lo>>>7;t[r++]=e.lo}function l(e,t,r){t[r]=255&e,t[r+1]=e>>>8&255,t[r+2]=e>>>16&255,t[r+3]=e>>>24}c.create=u(),c.alloc=function(e){return new t.Array(e)},t.Array!==Array&&(c.alloc=t.pool(c.alloc,t.Array.prototype.subarray)),c.prototype.wi=function(e,t,r){return this.tail=this.tail.next=new s(e,t,r),this.len+=t,this},d.prototype=Object.create(s.prototype),d.prototype.fn=function(e,t,r){for(;e>127;)t[r++]=127&e|128,e>>>=7;t[r]=e},c.prototype.uint32=function(e){return this.len+=(this.tail=this.tail.next=new d((e>>>=0)<128?1:e<16384?2:e<2097152?3:e<268435456?4:5,e)).len,this},c.prototype.int32=function(e){return e<0?this.wi(f,10,r.fromNumber(e)):this.uint32(e)},c.prototype.sint32=function(e){return this.uint32((e<<1^e>>31)>>>0)},c.prototype.uint64=function(e){var t=r.from(e);return this.wi(f,t.length(),t)},c.prototype.int64=c.prototype.uint64,c.prototype.sint64=function(e){var t=r.from(e).zzEncode();return this.wi(f,t.length(),t)},c.prototype.bool=function(e){return this.wi(h,1,e?1:0)},c.prototype.fixed32=function(e){return this.wi(l,4,e>>>0)},c.prototype.sfixed32=c.prototype.fixed32,c.prototype.fixed64=function(e){var t=r.from(e);return this.wi(l,4,t.lo).wi(l,4,t.hi)},c.prototype.sfixed64=c.prototype.fixed64,c.prototype.float=function(e){return this.wi(t.float.writeFloatLE,4,e)},c.prototype.double=function(e){return this.wi(t.float.writeDoubleLE,8,e)};var p=t.Array.prototype.set?function(e,t,r){t.set(e,r)}:function(e,t,r){for(var i=0;i<e.length;++i)t[r+i]=e[i]};return c.prototype.bytes=function(e){var r=e.length>>>0;if(!r)return this.wi(h,1,0);if(t.isString(e)){var n=c.alloc(r=i.length(e));i.decode(e,n,0),e=n}return this.uint32(r).wi(p,r,e)},c.prototype.string=function(e){var t=n.length(e);return t?this.uint32(t).wi(n.write,t,e):this.wi(h,1,0)},c.prototype.fork=function(){return this.states=new a(this),this.head=this.tail=new s(o,0,0),this.len=0,this},c.prototype.reset=function(){return this.states?(this.head=this.states.head,this.tail=this.states.tail,this.len=this.states.len,this.states=this.states.next):(this.head=this.tail=new s(o,0,0),this.len=0),this},c.prototype.ldelim=function(){var e=this.head,t=this.tail,r=this.len;return this.reset().uint32(r),r&&(this.tail.next=e.next,this.tail=t,this.len+=r),this},c.prototype.finish=function(){for(var e=this.head.next,t=this.constructor.alloc(this.len),r=0;e;)e.fn(e.val,t,r),r+=e.len,e=e.next;return t},c.yi=function(t){e=t,c.create=u(),e.yi()},writer}function requireWriter_buffer(){if(hasRequiredWriter_buffer)return writer_buffer;hasRequiredWriter_buffer=1,writer_buffer=r;var e=requireWriter();(r.prototype=Object.create(e.prototype)).constructor=r;var t=requireMinimal$1();function r(){e.call(this)}function i(e,r,i){e.length<40?t.utf8.write(e,r,i):r.utf8Write?r.utf8Write(e,i):r.write(e,i)}return r.yi=function(){r.alloc=t.gi,r.writeBytesBuffer=t.Buffer&&t.Buffer.prototype instanceof Uint8Array&&"set"===t.Buffer.prototype.set.name?function(e,t,r){t.set(e,r)}:function(e,t,r){if(e.copy)e.copy(t,r,0,e.length);else for(var i=0;i<e.length;)t[r++]=e[i++]}},r.prototype.bytes=function(e){t.isString(e)&&(e=t.mi(e,"base64"));var i=e.length>>>0;return this.uint32(i),i&&this.wi(r.writeBytesBuffer,i,e),this},r.prototype.string=function(e){var r=t.Buffer.byteLength(e);return this.uint32(r),r&&this.wi(i,r,e),this},r.yi(),writer_buffer}function requireReader(){if(hasRequiredReader)return reader;hasRequiredReader=1,reader=s;var e,t=requireMinimal$1(),r=t.LongBits,i=t.utf8;function n(e,t){return RangeError("index out of range: "+e.pos+" + "+(t||1)+" > "+e.len)}function s(e){this.buf=e,this.pos=0,this.len=e.length}var o,a="undefined"!=typeof Uint8Array?function(e){if(e instanceof Uint8Array||Array.isArray(e))return new s(e);throw Error("illegal buffer")}:function(e){if(Array.isArray(e))return new s(e);throw Error("illegal buffer")},c=function(){return t.Buffer?function(r){return(s.create=function(r){return t.Buffer.isBuffer(r)?new e(r):a(r)})(r)}:a};function u(){var e=new r(0,0),t=0;if(!(this.len-this.pos>4)){for(;t<3;++t){if(this.pos>=this.len)throw n(this);if(e.lo=(e.lo|(127&this.buf[this.pos])<<7*t)>>>0,this.buf[this.pos++]<128)return e}return e.lo=(e.lo|(127&this.buf[this.pos++])<<7*t)>>>0,e}for(;t<4;++t)if(e.lo=(e.lo|(127&this.buf[this.pos])<<7*t)>>>0,this.buf[this.pos++]<128)return e;if(e.lo=(e.lo|(127&this.buf[this.pos])<<28)>>>0,e.hi=(e.hi|(127&this.buf[this.pos])>>4)>>>0,this.buf[this.pos++]<128)return e;if(t=0,this.len-this.pos>4){for(;t<5;++t)if(e.hi=(e.hi|(127&this.buf[this.pos])<<7*t+3)>>>0,this.buf[this.pos++]<128)return e}else for(;t<5;++t){if(this.pos>=this.len)throw n(this);if(e.hi=(e.hi|(127&this.buf[this.pos])<<7*t+3)>>>0,this.buf[this.pos++]<128)return e}throw Error("invalid varint encoding")}function h(e,t){return(e[t-4]|e[t-3]<<8|e[t-2]<<16|e[t-1]<<24)>>>0}function d(){if(this.pos+8>this.len)throw n(this,8);return new r(h(this.buf,this.pos+=4),h(this.buf,this.pos+=4))}return s.create=c(),s.prototype.$i=t.Array.prototype.subarray||t.Array.prototype.slice,s.prototype.uint32=(o=4294967295,function(){if(o=(127&this.buf[this.pos])>>>0,this.buf[this.pos++]<128)return o;if(o=(o|(127&this.buf[this.pos])<<7)>>>0,this.buf[this.pos++]<128)return o;if(o=(o|(127&this.buf[this.pos])<<14)>>>0,this.buf[this.pos++]<128)return o;if(o=(o|(127&this.buf[this.pos])<<21)>>>0,this.buf[this.pos++]<128)return o;if(o=(o|(15&this.buf[this.pos])<<28)>>>0,this.buf[this.pos++]<128)return o;if((this.pos+=5)>this.len)throw this.pos=this.len,n(this,10);return o}),s.prototype.int32=function(){return 0|this.uint32()},s.prototype.sint32=function(){var e=this.uint32();return e>>>1^-(1&e)|0},s.prototype.bool=function(){return 0!==this.uint32()},s.prototype.fixed32=function(){if(this.pos+4>this.len)throw n(this,4);return h(this.buf,this.pos+=4)},s.prototype.sfixed32=function(){if(this.pos+4>this.len)throw n(this,4);return 0|h(this.buf,this.pos+=4)},s.prototype.float=function(){if(this.pos+4>this.len)throw n(this,4);var e=t.float.readFloatLE(this.buf,this.pos);return this.pos+=4,e},s.prototype.double=function(){if(this.pos+8>this.len)throw n(this,4);var e=t.float.readDoubleLE(this.buf,this.pos);return this.pos+=8,e},s.prototype.bytes=function(){var e=this.uint32(),t=this.pos,r=this.pos+e;if(r>this.len)throw n(this,e);return this.pos+=e,Array.isArray(this.buf)?this.buf.slice(t,r):t===r?new this.buf.constructor(0):this.$i.call(this.buf,t,r)},s.prototype.string=function(){var e=this.bytes();return i.read(e,0,e.length)},s.prototype.skip=function(e){if("number"==typeof e){if(this.pos+e>this.len)throw n(this,e);this.pos+=e}else do{if(this.pos>=this.len)throw n(this)}while(128&this.buf[this.pos++]);return this},s.prototype.skipType=function(e){switch(e){case 0:this.skip();break;case 1:this.skip(8);break;case 2:this.skip(this.uint32());break;case 3:for(;4!=(e=7&this.uint32());)this.skipType(e);break;case 5:this.skip(4);break;default:throw Error("invalid wire type "+e+" at offset "+this.pos)}return this},s.yi=function(r){e=r,s.create=c(),e.yi();var i=t.Long?"toLong":"toNumber";t.merge(s.prototype,{int64:function(){return u.call(this)[i](!1)},uint64:function(){return u.call(this)[i](!0)},sint64:function(){return u.call(this).zzDecode()[i](!1)},fixed64:function(){return d.call(this)[i](!0)},sfixed64:function(){return d.call(this)[i](!1)}})},reader}function requireReader_buffer(){if(hasRequiredReader_buffer)return reader_buffer;hasRequiredReader_buffer=1,reader_buffer=r;var e=requireReader();(r.prototype=Object.create(e.prototype)).constructor=r;var t=requireMinimal$1();function r(t){e.call(this,t)}return r.yi=function(){t.Buffer&&(r.prototype.$i=t.Buffer.prototype.slice)},r.prototype.string=function(){var e=this.uint32();return this.buf.utf8Slice?this.buf.utf8Slice(this.pos,this.pos=Math.min(this.pos+e,this.len)):this.buf.toString("utf-8",this.pos,this.pos=Math.min(this.pos+e,this.len))},r.yi(),reader_buffer}var rpc={},service,hasRequiredService,hasRequiredRpc,roots,hasRequiredRoots,hasRequiredIndexMinimal,hasRequiredMinimal;function requireService(){if(hasRequiredService)return service;hasRequiredService=1,service=t;var e=requireMinimal$1();function t(t,r,i){if("function"!=typeof t)throw TypeError("rpcImpl must be a function");e.EventEmitter.call(this),this.rpcImpl=t,this.requestDelimited=Boolean(r),this.responseDelimited=Boolean(i)}return(t.prototype=Object.create(e.EventEmitter.prototype)).constructor=t,t.prototype.rpcCall=function t(r,i,n,s,o){if(!s)throw TypeError("request must be specified");var a=this;if(!o)return e.asPromise(t,a,r,i,n,s);if(a.rpcImpl)try{return a.rpcImpl(r,i[a.requestDelimited?"encodeDelimited":"encode"](s).finish(),(function(e,t){if(e)return a.emit("error",e,r),o(e);if(null!==t){if(!(t instanceof n))try{t=n[a.responseDelimited?"decodeDelimited":"decode"](t)}catch(e){return a.emit("error",e,r),o(e)}return a.emit("data",t,r),o(null,t)}a.end(!0)}))}catch(e){return a.emit("error",e,r),void setTimeout((function(){o(e)}),0)}else setTimeout((function(){o(Error("already ended"))}),0)},t.prototype.end=function(e){return this.rpcImpl&&(e||this.rpcImpl(null,null,null),this.rpcImpl=null,this.emit("end").off()),this},service}function requireRpc(){return hasRequiredRpc||(hasRequiredRpc=1,function(e){e.Service=requireService()}(rpc)),rpc}function requireRoots(){return hasRequiredRoots?roots:(hasRequiredRoots=1,roots={})}function requireIndexMinimal(){return hasRequiredIndexMinimal||(hasRequiredIndexMinimal=1,function(e){var t=e;function r(){t.util.yi(),t.Writer.yi(t.BufferWriter),t.Reader.yi(t.BufferReader)}t.build="minimal",t.Writer=requireWriter(),t.BufferWriter=requireWriter_buffer(),t.Reader=requireReader(),t.BufferReader=requireReader_buffer(),t.util=requireMinimal$1(),t.rpc=requireRpc(),t.roots=requireRoots(),t.configure=r,r()}(indexMinimal)),indexMinimal}function requireMinimal(){return hasRequiredMinimal||(hasRequiredMinimal=1,function(e){e.exports=requireIndexMinimal()}(minimal$1)),minimalExports}!function(e){"function"==typeof commonjsRequire&&e&&e.exports&&(e.exports=function(e){var t=e.Reader,r=e.Writer,i=e.util,n=e.roots.default||(e.roots.default={});return n.simulcast=function(){var s={};return s.SimulcastLayer=function(){function s(e){if(e)for(var t=Object.keys(e),r=0;r<t.length;++r)null!=e[t[r]]&&(this[t[r]]=e[t[r]])}return s.prototype.ssrc=0,s.prototype.mbps=0,s.prototype.enable=!1,s.prototype.targetKbps=0,s.prototype.minKbps=0,s.prototype.maxKbps=0,s.prototype.frameRate=0,s.prototype.count=0,s.prototype.codeType="",s.prototype.csid="",s.prototype.csi=0,s.create=function(e){return new s(e)},s.encode=function(e,t){return t||(t=r.create()),null!=e.ssrc&&Object.hasOwnProperty.call(e,"ssrc")&&t.uint32(8).uint32(e.ssrc),null!=e.mbps&&Object.hasOwnProperty.call(e,"mbps")&&t.uint32(16).uint32(e.mbps),null!=e.enable&&Object.hasOwnProperty.call(e,"enable")&&t.uint32(24).bool(e.enable),null!=e.targetKbps&&Object.hasOwnProperty.call(e,"targetKbps")&&t.uint32(32).uint32(e.targetKbps),null!=e.minKbps&&Object.hasOwnProperty.call(e,"minKbps")&&t.uint32(40).uint32(e.minKbps),null!=e.maxKbps&&Object.hasOwnProperty.call(e,"maxKbps")&&t.uint32(48).uint32(e.maxKbps),null!=e.frameRate&&Object.hasOwnProperty.call(e,"frameRate")&&t.uint32(56).uint32(e.frameRate),null!=e.count&&Object.hasOwnProperty.call(e,"count")&&t.uint32(64).uint32(e.count),null!=e.codeType&&Object.hasOwnProperty.call(e,"codeType")&&t.uint32(74).string(e.codeType),null!=e.csid&&Object.hasOwnProperty.call(e,"csid")&&t.uint32(82).string(e.csid),null!=e.csi&&Object.hasOwnProperty.call(e,"csi")&&t.uint32(88).uint32(e.csi),t},s.encodeDelimited=function(e,t){return this.encode(e,t).ldelim()},s.decode=function(e,r){e instanceof t||(e=t.create(e));for(var i=void 0===r?e.len:e.pos+r,s=new n.simulcast.SimulcastLayer;e.pos<i;){var o=e.uint32();switch(o>>>3){case 1:s.ssrc=e.uint32();break;case 2:s.mbps=e.uint32();break;case 3:s.enable=e.bool();break;case 4:s.targetKbps=e.uint32();break;case 5:s.minKbps=e.uint32();break;case 6:s.maxKbps=e.uint32();break;case 7:s.frameRate=e.uint32();break;case 8:s.count=e.uint32();break;case 9:s.codeType=e.string();break;case 10:s.csid=e.string();break;case 11:s.csi=e.uint32();break;default:e.skipType(7&o)}}return s},s.decodeDelimited=function(e){return e instanceof t||(e=new t(e)),this.decode(e,e.uint32())},s.verify=function(e){return"object"!=typeof e||null===e?"object expected":null!=e.ssrc&&e.hasOwnProperty("ssrc")&&!i.isInteger(e.ssrc)?"ssrc: integer expected":null!=e.mbps&&e.hasOwnProperty("mbps")&&!i.isInteger(e.mbps)?"mbps: integer expected":null!=e.enable&&e.hasOwnProperty("enable")&&"boolean"!=typeof e.enable?"enable: boolean expected":null!=e.targetKbps&&e.hasOwnProperty("targetKbps")&&!i.isInteger(e.targetKbps)?"targetKbps: integer expected":null!=e.minKbps&&e.hasOwnProperty("minKbps")&&!i.isInteger(e.minKbps)?"minKbps: integer expected":null!=e.maxKbps&&e.hasOwnProperty("maxKbps")&&!i.isInteger(e.maxKbps)?"maxKbps: integer expected":null!=e.frameRate&&e.hasOwnProperty("frameRate")&&!i.isInteger(e.frameRate)?"frameRate: integer expected":null!=e.count&&e.hasOwnProperty("count")&&!i.isInteger(e.count)?"count: integer expected":null!=e.codeType&&e.hasOwnProperty("codeType")&&!i.isString(e.codeType)?"codeType: string expected":null!=e.csid&&e.hasOwnProperty("csid")&&!i.isString(e.csid)?"csid: string expected":null!=e.csi&&e.hasOwnProperty("csi")&&!i.isInteger(e.csi)?"csi: integer expected":null},s.fromObject=function(e){if(e instanceof n.simulcast.SimulcastLayer)return e;var t=new n.simulcast.SimulcastLayer;return null!=e.ssrc&&(t.ssrc=e.ssrc>>>0),null!=e.mbps&&(t.mbps=e.mbps>>>0),null!=e.enable&&(t.enable=Boolean(e.enable)),null!=e.targetKbps&&(t.targetKbps=e.targetKbps>>>0),null!=e.minKbps&&(t.minKbps=e.minKbps>>>0),null!=e.maxKbps&&(t.maxKbps=e.maxKbps>>>0),null!=e.frameRate&&(t.frameRate=e.frameRate>>>0),null!=e.count&&(t.count=e.count>>>0),null!=e.codeType&&(t.codeType=String(e.codeType)),null!=e.csid&&(t.csid=String(e.csid)),null!=e.csi&&(t.csi=e.csi>>>0),t},s.toObject=function(e,t){t||(t={});var r={};return t.defaults&&(r.ssrc=0,r.mbps=0,r.enable=!1,r.targetKbps=0,r.minKbps=0,r.maxKbps=0,r.frameRate=0,r.count=0,r.codeType="",r.csid="",r.csi=0),null!=e.ssrc&&e.hasOwnProperty("ssrc")&&(r.ssrc=e.ssrc),null!=e.mbps&&e.hasOwnProperty("mbps")&&(r.mbps=e.mbps),null!=e.enable&&e.hasOwnProperty("enable")&&(r.enable=e.enable),null!=e.targetKbps&&e.hasOwnProperty("targetKbps")&&(r.targetKbps=e.targetKbps),null!=e.minKbps&&e.hasOwnProperty("minKbps")&&(r.minKbps=e.minKbps),null!=e.maxKbps&&e.hasOwnProperty("maxKbps")&&(r.maxKbps=e.maxKbps),null!=e.frameRate&&e.hasOwnProperty("frameRate")&&(r.frameRate=e.frameRate),null!=e.count&&e.hasOwnProperty("count")&&(r.count=e.count),null!=e.codeType&&e.hasOwnProperty("codeType")&&(r.codeType=e.codeType),null!=e.csid&&e.hasOwnProperty("csid")&&(r.csid=e.csid),null!=e.csi&&e.hasOwnProperty("csi")&&(r.csi=e.csi),r},s.prototype.toJSON=function(){return this.constructor.toObject(this,e.util.toJSONOptions)},s.getTypeUrl=function(e){return void 0===e&&(e="type.googleapis.com"),e+"/simulcast.SimulcastLayer"},s}(),s.SimulSubscribe=function(){function s(e){if(this.layers=[],e)for(var t=Object.keys(e),r=0;r<t.length;++r)null!=e[t[r]]&&(this[t[r]]=e[t[r]])}return s.prototype.layers=i.emptyArray,s.prototype.ratioWidth=0,s.prototype.ratioHeight=0,s.prototype.subscriber="",s.prototype.mediaType=0,s.create=function(e){return new s(e)},s.encode=function(e,t){if(t||(t=r.create()),null!=e.layers&&e.layers.length)for(var i=0;i<e.layers.length;++i)n.simulcast.SimulcastLayer.encode(e.layers[i],t.uint32(10).fork()).ldelim();return null!=e.ratioWidth&&Object.hasOwnProperty.call(e,"ratioWidth")&&t.uint32(16).int32(e.ratioWidth),null!=e.ratioHeight&&Object.hasOwnProperty.call(e,"ratioHeight")&&t.uint32(24).int32(e.ratioHeight),null!=e.subscriber&&Object.hasOwnProperty.call(e,"subscriber")&&t.uint32(34).string(e.subscriber),null!=e.mediaType&&Object.hasOwnProperty.call(e,"mediaType")&&t.uint32(40).int32(e.mediaType),t},s.encodeDelimited=function(e,t){return this.encode(e,t).ldelim()},s.decode=function(e,r){e instanceof t||(e=t.create(e));for(var i=void 0===r?e.len:e.pos+r,s=new n.simulcast.SimulSubscribe;e.pos<i;){var o=e.uint32();switch(o>>>3){case 1:s.layers&&s.layers.length||(s.layers=[]),s.layers.push(n.simulcast.SimulcastLayer.decode(e,e.uint32()));break;case 2:s.ratioWidth=e.int32();break;case 3:s.ratioHeight=e.int32();break;case 4:s.subscriber=e.string();break;case 5:s.mediaType=e.int32();break;default:e.skipType(7&o)}}return s},s.decodeDelimited=function(e){return e instanceof t||(e=new t(e)),this.decode(e,e.uint32())},s.verify=function(e){if("object"!=typeof e||null===e)return"object expected";if(null!=e.layers&&e.hasOwnProperty("layers")){if(!Array.isArray(e.layers))return"layers: array expected";for(var t=0;t<e.layers.length;++t){var r=n.simulcast.SimulcastLayer.verify(e.layers[t]);if(r)return"layers."+r}}if(null!=e.ratioWidth&&e.hasOwnProperty("ratioWidth")&&!i.isInteger(e.ratioWidth))return"ratioWidth: integer expected";if(null!=e.ratioHeight&&e.hasOwnProperty("ratioHeight")&&!i.isInteger(e.ratioHeight))return"ratioHeight: integer expected";if(null!=e.subscriber&&e.hasOwnProperty("subscriber")&&!i.isString(e.subscriber))return"subscriber: string expected";if(null!=e.mediaType&&e.hasOwnProperty("mediaType"))switch(e.mediaType){default:return"mediaType: enum value expected";case 0:case 1:case 2:}return null},s.fromObject=function(e){if(e instanceof n.simulcast.SimulSubscribe)return e;var t=new n.simulcast.SimulSubscribe;if(e.layers){if(!Array.isArray(e.layers))throw TypeError(".simulcast.SimulSubscribe.layers: array expected");t.layers=[];for(var r=0;r<e.layers.length;++r){if("object"!=typeof e.layers[r])throw TypeError(".simulcast.SimulSubscribe.layers: object expected");t.layers[r]=n.simulcast.SimulcastLayer.fromObject(e.layers[r])}}switch(null!=e.ratioWidth&&(t.ratioWidth=0|e.ratioWidth),null!=e.ratioHeight&&(t.ratioHeight=0|e.ratioHeight),null!=e.subscriber&&(t.subscriber=String(e.subscriber)),e.mediaType){default:if("number"==typeof e.mediaType){t.mediaType=e.mediaType;break}break;case"INVAILD":case 0:t.mediaType=0;break;case"VIDEO":case 1:t.mediaType=1;break;case"SHARE":case 2:t.mediaType=2}return t},s.toObject=function(e,t){t||(t={});var r={};if((t.arrays||t.defaults)&&(r.layers=[]),t.defaults&&(r.ratioWidth=0,r.ratioHeight=0,r.subscriber="",r.mediaType=t.enums===String?"INVAILD":0),e.layers&&e.layers.length){r.layers=[];for(var i=0;i<e.layers.length;++i)r.layers[i]=n.simulcast.SimulcastLayer.toObject(e.layers[i],t)}return null!=e.ratioWidth&&e.hasOwnProperty("ratioWidth")&&(r.ratioWidth=e.ratioWidth),null!=e.ratioHeight&&e.hasOwnProperty("ratioHeight")&&(r.ratioHeight=e.ratioHeight),null!=e.subscriber&&e.hasOwnProperty("subscriber")&&(r.subscriber=e.subscriber),null!=e.mediaType&&e.hasOwnProperty("mediaType")&&(r.mediaType=t.enums===String?void 0===n.simulcast.SimulSubscribe.MediaType[e.mediaType]?e.mediaType:n.simulcast.SimulSubscribe.MediaType[e.mediaType]:e.mediaType),r},s.prototype.toJSON=function(){return this.constructor.toObject(this,e.util.toJSONOptions)},s.getTypeUrl=function(e){return void 0===e&&(e="type.googleapis.com"),e+"/simulcast.SimulSubscribe"},s.MediaType=function(){var e={},t=Object.create(e);return t[e[0]="INVAILD"]=0,t[e[1]="VIDEO"]=1,t[e[2]="SHARE"]=2,t}(),s}(),s.SimulNotification=function(){function s(e){if(this.layers=[],e)for(var t=Object.keys(e),r=0;r<t.length;++r)null!=e[t[r]]&&(this[t[r]]=e[t[r]])}return s.prototype.layers=i.emptyArray,s.create=function(e){return new s(e)},s.encode=function(e,t){if(t||(t=r.create()),null!=e.layers&&e.layers.length)for(var i=0;i<e.layers.length;++i)n.simulcast.SimulcastLayer.encode(e.layers[i],t.uint32(10).fork()).ldelim();return t},s.encodeDelimited=function(e,t){return this.encode(e,t).ldelim()},s.decode=function(e,r){e instanceof t||(e=t.create(e));for(var i=void 0===r?e.len:e.pos+r,s=new n.simulcast.SimulNotification;e.pos<i;){var o=e.uint32();o>>>3==1?(s.layers&&s.layers.length||(s.layers=[]),s.layers.push(n.simulcast.SimulcastLayer.decode(e,e.uint32()))):e.skipType(7&o)}return s},s.decodeDelimited=function(e){return e instanceof t||(e=new t(e)),this.decode(e,e.uint32())},s.verify=function(e){if("object"!=typeof e||null===e)return"object expected";if(null!=e.layers&&e.hasOwnProperty("layers")){if(!Array.isArray(e.layers))return"layers: array expected";for(var t=0;t<e.layers.length;++t){var r=n.simulcast.SimulcastLayer.verify(e.layers[t]);if(r)return"layers."+r}}return null},s.fromObject=function(e){if(e instanceof n.simulcast.SimulNotification)return e;var t=new n.simulcast.SimulNotification;if(e.layers){if(!Array.isArray(e.layers))throw TypeError(".simulcast.SimulNotification.layers: array expected");t.layers=[];for(var r=0;r<e.layers.length;++r){if("object"!=typeof e.layers[r])throw TypeError(".simulcast.SimulNotification.layers: object expected");t.layers[r]=n.simulcast.SimulcastLayer.fromObject(e.layers[r])}}return t},s.toObject=function(e,t){t||(t={});var r={};if((t.arrays||t.defaults)&&(r.layers=[]),e.layers&&e.layers.length){r.layers=[];for(var i=0;i<e.layers.length;++i)r.layers[i]=n.simulcast.SimulcastLayer.toObject(e.layers[i],t)}return r},s.prototype.toJSON=function(){return this.constructor.toObject(this,e.util.toJSONOptions)},s.getTypeUrl=function(e){return void 0===e&&(e="type.googleapis.com"),e+"/simulcast.SimulNotification"},s}(),s.ForwardInfo=function(){function s(e){if(e)for(var t=Object.keys(e),r=0;r<t.length;++r)null!=e[t[r]]&&(this[t[r]]=e[t[r]])}return s.prototype.ssrc=0,s.prototype.forward=!1,s.prototype.csrc=0,s.prototype.srcEndpointpId="",s.prototype.state=0,s.create=function(e){return new s(e)},s.encode=function(e,t){return t||(t=r.create()),null!=e.ssrc&&Object.hasOwnProperty.call(e,"ssrc")&&t.uint32(8).uint32(e.ssrc),null!=e.forward&&Object.hasOwnProperty.call(e,"forward")&&t.uint32(16).bool(e.forward),null!=e.csrc&&Object.hasOwnProperty.call(e,"csrc")&&t.uint32(24).uint32(e.csrc),null!=e.srcEndpointpId&&Object.hasOwnProperty.call(e,"srcEndpointpId")&&t.uint32(34).string(e.srcEndpointpId),null!=e.state&&Object.hasOwnProperty.call(e,"state")&&t.uint32(40).int32(e.state),t},s.encodeDelimited=function(e,t){return this.encode(e,t).ldelim()},s.decode=function(e,r){e instanceof t||(e=t.create(e));for(var i=void 0===r?e.len:e.pos+r,s=new n.simulcast.ForwardInfo;e.pos<i;){var o=e.uint32();switch(o>>>3){case 1:s.ssrc=e.uint32();break;case 2:s.forward=e.bool();break;case 3:s.csrc=e.uint32();break;case 4:s.srcEndpointpId=e.string();break;case 5:s.state=e.int32();break;default:e.skipType(7&o)}}return s},s.decodeDelimited=function(e){return e instanceof t||(e=new t(e)),this.decode(e,e.uint32())},s.verify=function(e){if("object"!=typeof e||null===e)return"object expected";if(null!=e.ssrc&&e.hasOwnProperty("ssrc")&&!i.isInteger(e.ssrc))return"ssrc: integer expected";if(null!=e.forward&&e.hasOwnProperty("forward")&&"boolean"!=typeof e.forward)return"forward: boolean expected";if(null!=e.csrc&&e.hasOwnProperty("csrc")&&!i.isInteger(e.csrc))return"csrc: integer expected";if(null!=e.srcEndpointpId&&e.hasOwnProperty("srcEndpointpId")&&!i.isString(e.srcEndpointpId))return"srcEndpointpId: string expected";if(null!=e.state&&e.hasOwnProperty("state"))switch(e.state){default:return"state: enum value expected";case 0:case 1:case 2:case 3:case 4:case 5:case 6:}return null},s.fromObject=function(e){if(e instanceof n.simulcast.ForwardInfo)return e;var t=new n.simulcast.ForwardInfo;switch(null!=e.ssrc&&(t.ssrc=e.ssrc>>>0),null!=e.forward&&(t.forward=Boolean(e.forward)),null!=e.csrc&&(t.csrc=e.csrc>>>0),null!=e.srcEndpointpId&&(t.srcEndpointpId=String(e.srcEndpointpId)),e.state){default:if("number"==typeof e.state){t.state=e.state;break}break;case"kForwarded":case 0:t.state=0;break;case"kNotForwardedVideoMuted":case 1:t.state=1;break;case"kNotForwardedNoUplinkData":case 2:t.state=2;break;case"kNotForwardedNoDownlinkBpsAllocated":case 3:t.state=3;break;case"kAbandonedNotForwardedNoSuitableVideoSource":case 4:t.state=4;break;case"kNotForwardedSelfActiveVideoSource":case 5:t.state=5;break;case"kNotForwardedNoSuitableVideoSource":case 6:t.state=6}return t},s.toObject=function(e,t){t||(t={});var r={};return t.defaults&&(r.ssrc=0,r.forward=!1,r.csrc=0,r.srcEndpointpId="",r.state=t.enums===String?"kForwarded":0),null!=e.ssrc&&e.hasOwnProperty("ssrc")&&(r.ssrc=e.ssrc),null!=e.forward&&e.hasOwnProperty("forward")&&(r.forward=e.forward),null!=e.csrc&&e.hasOwnProperty("csrc")&&(r.csrc=e.csrc),null!=e.srcEndpointpId&&e.hasOwnProperty("srcEndpointpId")&&(r.srcEndpointpId=e.srcEndpointpId),null!=e.state&&e.hasOwnProperty("state")&&(r.state=t.enums===String?void 0===n.simulcast.ForwardInfo.ForwardState[e.state]?e.state:n.simulcast.ForwardInfo.ForwardState[e.state]:e.state),r},s.prototype.toJSON=function(){return this.constructor.toObject(this,e.util.toJSONOptions)},s.getTypeUrl=function(e){return void 0===e&&(e="type.googleapis.com"),e+"/simulcast.ForwardInfo"},s.ForwardState=function(){var e={},t=Object.create(e);return t[e[0]="kForwarded"]=0,t[e[1]="kNotForwardedVideoMuted"]=1,t[e[2]="kNotForwardedNoUplinkData"]=2,t[e[3]="kNotForwardedNoDownlinkBpsAllocated"]=3,t[e[4]="kAbandonedNotForwardedNoSuitableVideoSource"]=4,t[e[5]="kNotForwardedSelfActiveVideoSource"]=5,t[e[6]="kNotForwardedNoSuitableVideoSource"]=6,t}(),s}(),s.ForwardNotification=function(){function s(e){if(this.forwards=[],e)for(var t=Object.keys(e),r=0;r<t.length;++r)null!=e[t[r]]&&(this[t[r]]=e[t[r]])}return s.prototype.forwards=i.emptyArray,s.create=function(e){return new s(e)},s.encode=function(e,t){if(t||(t=r.create()),null!=e.forwards&&e.forwards.length)for(var i=0;i<e.forwards.length;++i)n.simulcast.ForwardInfo.encode(e.forwards[i],t.uint32(10).fork()).ldelim();return t},s.encodeDelimited=function(e,t){return this.encode(e,t).ldelim()},s.decode=function(e,r){e instanceof t||(e=t.create(e));for(var i=void 0===r?e.len:e.pos+r,s=new n.simulcast.ForwardNotification;e.pos<i;){var o=e.uint32();o>>>3==1?(s.forwards&&s.forwards.length||(s.forwards=[]),s.forwards.push(n.simulcast.ForwardInfo.decode(e,e.uint32()))):e.skipType(7&o)}return s},s.decodeDelimited=function(e){return e instanceof t||(e=new t(e)),this.decode(e,e.uint32())},s.verify=function(e){if("object"!=typeof e||null===e)return"object expected";if(null!=e.forwards&&e.hasOwnProperty("forwards")){if(!Array.isArray(e.forwards))return"forwards: array expected";for(var t=0;t<e.forwards.length;++t){var r=n.simulcast.ForwardInfo.verify(e.forwards[t]);if(r)return"forwards."+r}}return null},s.fromObject=function(e){if(e instanceof n.simulcast.ForwardNotification)return e;var t=new n.simulcast.ForwardNotification;if(e.forwards){if(!Array.isArray(e.forwards))throw TypeError(".simulcast.ForwardNotification.forwards: array expected");t.forwards=[];for(var r=0;r<e.forwards.length;++r){if("object"!=typeof e.forwards[r])throw TypeError(".simulcast.ForwardNotification.forwards: object expected");t.forwards[r]=n.simulcast.ForwardInfo.fromObject(e.forwards[r])}}return t},s.toObject=function(e,t){t||(t={});var r={};if((t.arrays||t.defaults)&&(r.forwards=[]),e.forwards&&e.forwards.length){r.forwards=[];for(var i=0;i<e.forwards.length;++i)r.forwards[i]=n.simulcast.ForwardInfo.toObject(e.forwards[i],t)}return r},s.prototype.toJSON=function(){return this.constructor.toObject(this,e.util.toJSONOptions)},s.getTypeUrl=function(e){return void 0===e&&(e="type.googleapis.com"),e+"/simulcast.ForwardNotification"},s}(),s.QualityInfo=function(){function s(e){if(e)for(var t=Object.keys(e),r=0;r<t.length;++r)null!=e[t[r]]&&(this[t[r]]=e[t[r]])}return s.prototype.type=0,s.prototype.ssrc=0,s.prototype.satisfied=!1,s.prototype.csrc=0,s.prototype.actualMbps=0,s.create=function(e){return new s(e)},s.encode=function(e,t){return t||(t=r.create()),null!=e.type&&Object.hasOwnProperty.call(e,"type")&&t.uint32(8).int32(e.type),null!=e.ssrc&&Object.hasOwnProperty.call(e,"ssrc")&&t.uint32(16).uint32(e.ssrc),null!=e.satisfied&&Object.hasOwnProperty.call(e,"satisfied")&&t.uint32(24).bool(e.satisfied),null!=e.csrc&&Object.hasOwnProperty.call(e,"csrc")&&t.uint32(32).uint32(e.csrc),null!=e.actualMbps&&Object.hasOwnProperty.call(e,"actualMbps")&&t.uint32(40).uint32(e.actualMbps),t},s.encodeDelimited=function(e,t){return this.encode(e,t).ldelim()},s.decode=function(e,r){e instanceof t||(e=t.create(e));for(var i=void 0===r?e.len:e.pos+r,s=new n.simulcast.QualityInfo;e.pos<i;){var o=e.uint32();switch(o>>>3){case 1:s.type=e.int32();break;case 2:s.ssrc=e.uint32();break;case 3:s.satisfied=e.bool();break;case 4:s.csrc=e.uint32();break;case 5:s.actualMbps=e.uint32();break;default:e.skipType(7&o)}}return s},s.decodeDelimited=function(e){return e instanceof t||(e=new t(e)),this.decode(e,e.uint32())},s.verify=function(e){if("object"!=typeof e||null===e)return"object expected";if(null!=e.type&&e.hasOwnProperty("type"))switch(e.type){default:return"type: enum value expected";case 0:case 1:case 2:}return null!=e.ssrc&&e.hasOwnProperty("ssrc")&&!i.isInteger(e.ssrc)?"ssrc: integer expected":null!=e.satisfied&&e.hasOwnProperty("satisfied")&&"boolean"!=typeof e.satisfied?"satisfied: boolean expected":null!=e.csrc&&e.hasOwnProperty("csrc")&&!i.isInteger(e.csrc)?"csrc: integer expected":null!=e.actualMbps&&e.hasOwnProperty("actualMbps")&&!i.isInteger(e.actualMbps)?"actualMbps: integer expected":null},s.fromObject=function(e){if(e instanceof n.simulcast.QualityInfo)return e;var t=new n.simulcast.QualityInfo;switch(e.type){default:if("number"==typeof e.type){t.type=e.type;break}break;case"kUplinkBad":case 0:t.type=0;break;case"kDownlinkBad":case 1:t.type=1;break;case"kBothGood":case 2:t.type=2}return null!=e.ssrc&&(t.ssrc=e.ssrc>>>0),null!=e.satisfied&&(t.satisfied=Boolean(e.satisfied)),null!=e.csrc&&(t.csrc=e.csrc>>>0),null!=e.actualMbps&&(t.actualMbps=e.actualMbps>>>0),t},s.toObject=function(e,t){t||(t={});var r={};return t.defaults&&(r.type=t.enums===String?"kUplinkBad":0,r.ssrc=0,r.satisfied=!1,r.csrc=0,r.actualMbps=0),null!=e.type&&e.hasOwnProperty("type")&&(r.type=t.enums===String?void 0===n.simulcast.QualityInfo.QualityType[e.type]?e.type:n.simulcast.QualityInfo.QualityType[e.type]:e.type),null!=e.ssrc&&e.hasOwnProperty("ssrc")&&(r.ssrc=e.ssrc),null!=e.satisfied&&e.hasOwnProperty("satisfied")&&(r.satisfied=e.satisfied),null!=e.csrc&&e.hasOwnProperty("csrc")&&(r.csrc=e.csrc),null!=e.actualMbps&&e.hasOwnProperty("actualMbps")&&(r.actualMbps=e.actualMbps),r},s.prototype.toJSON=function(){return this.constructor.toObject(this,e.util.toJSONOptions)},s.getTypeUrl=function(e){return void 0===e&&(e="type.googleapis.com"),e+"/simulcast.QualityInfo"},s.QualityType=function(){var e={},t=Object.create(e);return t[e[0]="kUplinkBad"]=0,t[e[1]="kDownlinkBad"]=1,t[e[2]="kBothGood"]=2,t}(),s}(),s.QualityNotification=function(){function s(e){if(this.qualityInfos=[],e)for(var t=Object.keys(e),r=0;r<t.length;++r)null!=e[t[r]]&&(this[t[r]]=e[t[r]])}return s.prototype.qualityInfos=i.emptyArray,s.create=function(e){return new s(e)},s.encode=function(e,t){if(t||(t=r.create()),null!=e.qualityInfos&&e.qualityInfos.length)for(var i=0;i<e.qualityInfos.length;++i)n.simulcast.QualityInfo.encode(e.qualityInfos[i],t.uint32(10).fork()).ldelim();return t},s.encodeDelimited=function(e,t){return this.encode(e,t).ldelim()},s.decode=function(e,r){e instanceof t||(e=t.create(e));for(var i=void 0===r?e.len:e.pos+r,s=new n.simulcast.QualityNotification;e.pos<i;){var o=e.uint32();o>>>3==1?(s.qualityInfos&&s.qualityInfos.length||(s.qualityInfos=[]),s.qualityInfos.push(n.simulcast.QualityInfo.decode(e,e.uint32()))):e.skipType(7&o)}return s},s.decodeDelimited=function(e){return e instanceof t||(e=new t(e)),this.decode(e,e.uint32())},s.verify=function(e){if("object"!=typeof e||null===e)return"object expected";if(null!=e.qualityInfos&&e.hasOwnProperty("qualityInfos")){if(!Array.isArray(e.qualityInfos))return"qualityInfos: array expected";for(var t=0;t<e.qualityInfos.length;++t){var r=n.simulcast.QualityInfo.verify(e.qualityInfos[t]);if(r)return"qualityInfos."+r}}return null},s.fromObject=function(e){if(e instanceof n.simulcast.QualityNotification)return e;var t=new n.simulcast.QualityNotification;if(e.qualityInfos){if(!Array.isArray(e.qualityInfos))throw TypeError(".simulcast.QualityNotification.qualityInfos: array expected");t.qualityInfos=[];for(var r=0;r<e.qualityInfos.length;++r){if("object"!=typeof e.qualityInfos[r])throw TypeError(".simulcast.QualityNotification.qualityInfos: object expected");t.qualityInfos[r]=n.simulcast.QualityInfo.fromObject(e.qualityInfos[r])}}return t},s.toObject=function(e,t){t||(t={});var r={};if((t.arrays||t.defaults)&&(r.qualityInfos=[]),e.qualityInfos&&e.qualityInfos.length){r.qualityInfos=[];for(var i=0;i<e.qualityInfos.length;++i)r.qualityInfos[i]=n.simulcast.QualityInfo.toObject(e.qualityInfos[i],t)}return r},s.prototype.toJSON=function(){return this.constructor.toObject(this,e.util.toJSONOptions)},s.getTypeUrl=function(e){return void 0===e&&(e="type.googleapis.com"),e+"/simulcast.QualityNotification"},s}(),s.MuteStateNotification=function(){function s(e){if(e)for(var t=Object.keys(e),r=0;r<t.length;++r)null!=e[t[r]]&&(this[t[r]]=e[t[r]])}return s.prototype.videoMuted=!1,s.prototype.endpoint="",s.create=function(e){return new s(e)},s.encode=function(e,t){return t||(t=r.create()),null!=e.videoMuted&&Object.hasOwnProperty.call(e,"videoMuted")&&t.uint32(8).bool(e.videoMuted),null!=e.endpoint&&Object.hasOwnProperty.call(e,"endpoint")&&t.uint32(18).string(e.endpoint),t},s.encodeDelimited=function(e,t){return this.encode(e,t).ldelim()},s.decode=function(e,r){e instanceof t||(e=t.create(e));for(var i=void 0===r?e.len:e.pos+r,s=new n.simulcast.MuteStateNotification;e.pos<i;){var o=e.uint32();switch(o>>>3){case 1:s.videoMuted=e.bool();break;case 2:s.endpoint=e.string();break;default:e.skipType(7&o)}}return s},s.decodeDelimited=function(e){return e instanceof t||(e=new t(e)),this.decode(e,e.uint32())},s.verify=function(e){return"object"!=typeof e||null===e?"object expected":null!=e.videoMuted&&e.hasOwnProperty("videoMuted")&&"boolean"!=typeof e.videoMuted?"videoMuted: boolean expected":null!=e.endpoint&&e.hasOwnProperty("endpoint")&&!i.isString(e.endpoint)?"endpoint: string expected":null},s.fromObject=function(e){if(e instanceof n.simulcast.MuteStateNotification)return e;var t=new n.simulcast.MuteStateNotification;return null!=e.videoMuted&&(t.videoMuted=Boolean(e.videoMuted)),null!=e.endpoint&&(t.endpoint=String(e.endpoint)),t},s.toObject=function(e,t){t||(t={});var r={};return t.defaults&&(r.videoMuted=!1,r.endpoint=""),null!=e.videoMuted&&e.hasOwnProperty("videoMuted")&&(r.videoMuted=e.videoMuted),null!=e.endpoint&&e.hasOwnProperty("endpoint")&&(r.endpoint=e.endpoint),r},s.prototype.toJSON=function(){return this.constructor.toObject(this,e.util.toJSONOptions)},s.getTypeUrl=function(e){return void 0===e&&(e="type.googleapis.com"),e+"/simulcast.MuteStateNotification"},s}(),s.MuteAudioNotification=function(){function s(e){if(e)for(var t=Object.keys(e),r=0;r<t.length;++r)null!=e[t[r]]&&(this[t[r]]=e[t[r]])}return s.prototype.audioMuted=!1,s.prototype.endpoint="",s.create=function(e){return new s(e)},s.encode=function(e,t){return t||(t=r.create()),null!=e.audioMuted&&Object.hasOwnProperty.call(e,"audioMuted")&&t.uint32(8).bool(e.audioMuted),null!=e.endpoint&&Object.hasOwnProperty.call(e,"endpoint")&&t.uint32(18).string(e.endpoint),t},s.encodeDelimited=function(e,t){return this.encode(e,t).ldelim()},s.decode=function(e,r){e instanceof t||(e=t.create(e));for(var i=void 0===r?e.len:e.pos+r,s=new n.simulcast.MuteAudioNotification;e.pos<i;){var o=e.uint32();switch(o>>>3){case 1:s.audioMuted=e.bool();break;case 2:s.endpoint=e.string();break;default:e.skipType(7&o)}}return s},s.decodeDelimited=function(e){return e instanceof t||(e=new t(e)),this.decode(e,e.uint32())},s.verify=function(e){return"object"!=typeof e||null===e?"object expected":null!=e.audioMuted&&e.hasOwnProperty("audioMuted")&&"boolean"!=typeof e.audioMuted?"audioMuted: boolean expected":null!=e.endpoint&&e.hasOwnProperty("endpoint")&&!i.isString(e.endpoint)?"endpoint: string expected":null},s.fromObject=function(e){if(e instanceof n.simulcast.MuteAudioNotification)return e;var t=new n.simulcast.MuteAudioNotification;return null!=e.audioMuted&&(t.audioMuted=Boolean(e.audioMuted)),null!=e.endpoint&&(t.endpoint=String(e.endpoint)),t},s.toObject=function(e,t){t||(t={});var r={};return t.defaults&&(r.audioMuted=!1,r.endpoint=""),null!=e.audioMuted&&e.hasOwnProperty("audioMuted")&&(r.audioMuted=e.audioMuted),null!=e.endpoint&&e.hasOwnProperty("endpoint")&&(r.endpoint=e.endpoint),r},s.prototype.toJSON=function(){return this.constructor.toObject(this,e.util.toJSONOptions)},s.getTypeUrl=function(e){return void 0===e&&(e="type.googleapis.com"),e+"/simulcast.MuteAudioNotification"},s}(),s.DesktopSimulcastNotification=function(){function s(e){if(e)for(var t=Object.keys(e),r=0;r<t.length;++r)null!=e[t[r]]&&(this[t[r]]=e[t[r]])}return s.prototype.enabled=0,s.prototype.type=0,s.create=function(e){return new s(e)},s.encode=function(e,t){return t||(t=r.create()),null!=e.enabled&&Object.hasOwnProperty.call(e,"enabled")&&t.uint32(8).int32(e.enabled),null!=e.type&&Object.hasOwnProperty.call(e,"type")&&t.uint32(16).int32(e.type),t},s.encodeDelimited=function(e,t){return this.encode(e,t).ldelim()},s.decode=function(e,r){e instanceof t||(e=t.create(e));for(var i=void 0===r?e.len:e.pos+r,s=new n.simulcast.DesktopSimulcastNotification;e.pos<i;){var o=e.uint32();switch(o>>>3){case 1:s.enabled=e.int32();break;case 2:s.type=e.int32();break;default:e.skipType(7&o)}}return s},s.decodeDelimited=function(e){return e instanceof t||(e=new t(e)),this.decode(e,e.uint32())},s.verify=function(e){if("object"!=typeof e||null===e)return"object expected";if(null!=e.enabled&&e.hasOwnProperty("enabled")&&!i.isInteger(e.enabled))return"enabled: integer expected";if(null!=e.type&&e.hasOwnProperty("type"))switch(e.type){default:return"type: enum value expected";case 0:case 1:}return null},s.fromObject=function(e){if(e instanceof n.simulcast.DesktopSimulcastNotification)return e;var t=new n.simulcast.DesktopSimulcastNotification;switch(null!=e.enabled&&(t.enabled=0|e.enabled),e.type){default:if("number"==typeof e.type){t.type=e.type;break}break;case"kModeFluency":case 0:t.type=0;break;case"kModeQuality":case 1:t.type=1}return t},s.toObject=function(e,t){t||(t={});var r={};return t.defaults&&(r.enabled=0,r.type=t.enums===String?"kModeFluency":0),null!=e.enabled&&e.hasOwnProperty("enabled")&&(r.enabled=e.enabled),null!=e.type&&e.hasOwnProperty("type")&&(r.type=t.enums===String?void 0===n.simulcast.DesktopSimulcastNotification.DesktopModeType[e.type]?e.type:n.simulcast.DesktopSimulcastNotification.DesktopModeType[e.type]:e.type),r},s.prototype.toJSON=function(){return this.constructor.toObject(this,e.util.toJSONOptions)},s.getTypeUrl=function(e){return void 0===e&&(e="type.googleapis.com"),e+"/simulcast.DesktopSimulcastNotification"},s.DesktopModeType=function(){var e={},t=Object.create(e);return t[e[0]="kModeFluency"]=0,t[e[1]="kModeQuality"]=1,t}(),s}(),s.VideoSyncNotification=function(){function i(e){if(e)for(var t=Object.keys(e),r=0;r<t.length;++r)null!=e[t[r]]&&(this[t[r]]=e[t[r]])}return i.prototype.activeSubType=0,i.create=function(e){return new i(e)},i.encode=function(e,t){return t||(t=r.create()),null!=e.activeSubType&&Object.hasOwnProperty.call(e,"activeSubType")&&t.uint32(8).int32(e.activeSubType),t},i.encodeDelimited=function(e,t){return this.encode(e,t).ldelim()},i.decode=function(e,r){e instanceof t||(e=t.create(e));for(var i=void 0===r?e.len:e.pos+r,s=new n.simulcast.VideoSyncNotification;e.pos<i;){var o=e.uint32();o>>>3==1?s.activeSubType=e.int32():e.skipType(7&o)}return s},i.decodeDelimited=function(e){return e instanceof t||(e=new t(e)),this.decode(e,e.uint32())},i.verify=function(e){if("object"!=typeof e||null===e)return"object expected";if(null!=e.activeSubType&&e.hasOwnProperty("activeSubType"))switch(e.activeSubType){default:return"activeSubType: enum value expected";case 0:case 1:}return null},i.fromObject=function(e){if(e instanceof n.simulcast.VideoSyncNotification)return e;var t=new n.simulcast.VideoSyncNotification;switch(e.activeSubType){default:if("number"==typeof e.activeSubType){t.activeSubType=e.activeSubType;break}break;case"VideoSubcribeActiveNormal":case 0:t.activeSubType=0;break;case"VideoSubcribeActiveWithSelfNotify":case 1:t.activeSubType=1}return t},i.toObject=function(e,t){t||(t={});var r={};return t.defaults&&(r.activeSubType=t.enums===String?"VideoSubcribeActiveNormal":0),null!=e.activeSubType&&e.hasOwnProperty("activeSubType")&&(r.activeSubType=t.enums===String?void 0===n.simulcast.VideoSyncNotification.VideoSubscribeActiveType[e.activeSubType]?e.activeSubType:n.simulcast.VideoSyncNotification.VideoSubscribeActiveType[e.activeSubType]:e.activeSubType),r},i.prototype.toJSON=function(){return this.constructor.toObject(this,e.util.toJSONOptions)},i.getTypeUrl=function(e){return void 0===e&&(e="type.googleapis.com"),e+"/simulcast.VideoSyncNotification"},i.VideoSubscribeActiveType=function(){var e={},t=Object.create(e);return t[e[0]="VideoSubcribeActiveNormal"]=0,t[e[1]="VideoSubcribeActiveWithSelfNotify"]=1,t}(),i}(),s.ShareSyncNotification=function(){function s(e){if(e)for(var t=Object.keys(e),r=0;r<t.length;++r)null!=e[t[r]]&&(this[t[r]]=e[t[r]])}return s.prototype.enabled=!1,s.prototype.endpoint="",s.prototype.sequence=0n,s.create=function(e){return new s(e)},s.encode=function(e,t){return t||(t=r.create()),null!=e.enabled&&Object.hasOwnProperty.call(e,"enabled")&&t.uint32(8).bool(e.enabled),null!=e.endpoint&&Object.hasOwnProperty.call(e,"endpoint")&&t.uint32(18).string(e.endpoint),null!=e.sequence&&Object.hasOwnProperty.call(e,"sequence")&&t.uint32(24).int64(e.sequence),t},s.encodeDelimited=function(e,t){return this.encode(e,t).ldelim()},s.decode=function(e,r){e instanceof t||(e=t.create(e));for(var i=void 0===r?e.len:e.pos+r,s=new n.simulcast.ShareSyncNotification;e.pos<i;){var o=e.uint32();switch(o>>>3){case 1:s.enabled=e.bool();break;case 2:s.endpoint=e.string();break;case 3:s.sequence=e.int64();break;default:e.skipType(7&o)}}return s},s.decodeDelimited=function(e){return e instanceof t||(e=new t(e)),this.decode(e,e.uint32())},s.verify=function(e){return"object"!=typeof e||null===e?"object expected":null!=e.enabled&&e.hasOwnProperty("enabled")&&"boolean"!=typeof e.enabled?"enabled: boolean expected":null!=e.endpoint&&e.hasOwnProperty("endpoint")&&!i.isString(e.endpoint)?"endpoint: string expected":null!=e.sequence&&e.hasOwnProperty("sequence")&&!(i.isInteger(e.sequence)||e.sequence&&i.isInteger(e.sequence.low)&&i.isInteger(e.sequence.high))?"sequence: integer|Long expected":null},s.fromObject=function(e){if(e instanceof n.simulcast.ShareSyncNotification)return e;var t=new n.simulcast.ShareSyncNotification;return null!=e.enabled&&(t.enabled=Boolean(e.enabled)),null!=e.endpoint&&(t.endpoint=String(e.endpoint)),null!=e.sequence&&(i.Long?(t.sequence=i.Long.fromValue(e.sequence)).unsigned=!1:"string"==typeof e.sequence?t.sequence=parseInt(e.sequence,10):"number"==typeof e.sequence?t.sequence=e.sequence:"object"==typeof e.sequence&&(t.sequence=new i.LongBits(e.sequence.low>>>0,e.sequence.high>>>0).toNumber())),t},s.toObject=function(e,t){t||(t={});var r={};if(t.defaults)if(r.enabled=!1,r.endpoint="",i.Long){var n=new i.Long(0,0,!1);r.sequence=t.longs===String?n.toString():t.longs===Number?n.toNumber():n}else r.sequence=t.longs===String?"0":0;return null!=e.enabled&&e.hasOwnProperty("enabled")&&(r.enabled=e.enabled),null!=e.endpoint&&e.hasOwnProperty("endpoint")&&(r.endpoint=e.endpoint),null!=e.sequence&&e.hasOwnProperty("sequence")&&("number"==typeof e.sequence?r.sequence=t.longs===String?String(e.sequence):e.sequence:r.sequence=t.longs===String?i.Long.prototype.toString.call(e.sequence):t.longs===Number?new i.LongBits(e.sequence.low>>>0,e.sequence.high>>>0).toNumber():e.sequence),r},s.prototype.toJSON=function(){return this.constructor.toObject(this,e.util.toJSONOptions)},s.getTypeUrl=function(e){return void 0===e&&(e="type.googleapis.com"),e+"/simulcast.ShareSyncNotification"},s}(),s.FocusVideoNotification=function(){function s(e){if(e)for(var t=Object.keys(e),r=0;r<t.length;++r)null!=e[t[r]]&&(this[t[r]]=e[t[r]])}return s.prototype.enabled=!1,s.prototype.endpoint="",s.create=function(e){return new s(e)},s.encode=function(e,t){return t||(t=r.create()),null!=e.enabled&&Object.hasOwnProperty.call(e,"enabled")&&t.uint32(8).bool(e.enabled),null!=e.endpoint&&Object.hasOwnProperty.call(e,"endpoint")&&t.uint32(18).string(e.endpoint),t},s.encodeDelimited=function(e,t){return this.encode(e,t).ldelim()},s.decode=function(e,r){e instanceof t||(e=t.create(e));for(var i=void 0===r?e.len:e.pos+r,s=new n.simulcast.FocusVideoNotification;e.pos<i;){var o=e.uint32();switch(o>>>3){case 1:s.enabled=e.bool();break;case 2:s.endpoint=e.string();break;default:e.skipType(7&o)}}return s},s.decodeDelimited=function(e){return e instanceof t||(e=new t(e)),this.decode(e,e.uint32())},s.verify=function(e){return"object"!=typeof e||null===e?"object expected":null!=e.enabled&&e.hasOwnProperty("enabled")&&"boolean"!=typeof e.enabled?"enabled: boolean expected":null!=e.endpoint&&e.hasOwnProperty("endpoint")&&!i.isString(e.endpoint)?"endpoint: string expected":null},s.fromObject=function(e){if(e instanceof n.simulcast.FocusVideoNotification)return e;var t=new n.simulcast.FocusVideoNotification;return null!=e.enabled&&(t.enabled=Boolean(e.enabled)),null!=e.endpoint&&(t.endpoint=String(e.endpoint)),t},s.toObject=function(e,t){t||(t={});var r={};return t.defaults&&(r.enabled=!1,r.endpoint=""),null!=e.enabled&&e.hasOwnProperty("enabled")&&(r.enabled=e.enabled),null!=e.endpoint&&e.hasOwnProperty("endpoint")&&(r.endpoint=e.endpoint),r},s.prototype.toJSON=function(){return this.constructor.toObject(this,e.util.toJSONOptions)},s.getTypeUrl=function(e){return void 0===e&&(e="type.googleapis.com"),e+"/simulcast.FocusVideoNotification"},s}(),s.ActiveAudiosNotification=function(){function s(e){if(this.endpoints=[],e)for(var t=Object.keys(e),r=0;r<t.length;++r)null!=e[t[r]]&&(this[t[r]]=e[t[r]])}return s.prototype.endpoints=i.emptyArray,s.create=function(e){return new s(e)},s.encode=function(e,t){if(t||(t=r.create()),null!=e.endpoints&&e.endpoints.length)for(var i=0;i<e.endpoints.length;++i)t.uint32(10).string(e.endpoints[i]);return t},s.encodeDelimited=function(e,t){return this.encode(e,t).ldelim()},s.decode=function(e,r){e instanceof t||(e=t.create(e));for(var i=void 0===r?e.len:e.pos+r,s=new n.simulcast.ActiveAudiosNotification;e.pos<i;){var o=e.uint32();o>>>3==1?(s.endpoints&&s.endpoints.length||(s.endpoints=[]),s.endpoints.push(e.string())):e.skipType(7&o)}return s},s.decodeDelimited=function(e){return e instanceof t||(e=new t(e)),this.decode(e,e.uint32())},s.verify=function(e){if("object"!=typeof e||null===e)return"object expected";if(null!=e.endpoints&&e.hasOwnProperty("endpoints")){if(!Array.isArray(e.endpoints))return"endpoints: array expected";for(var t=0;t<e.endpoints.length;++t)if(!i.isString(e.endpoints[t]))return"endpoints: string[] expected"}return null},s.fromObject=function(e){if(e instanceof n.simulcast.ActiveAudiosNotification)return e;var t=new n.simulcast.ActiveAudiosNotification;if(e.endpoints){if(!Array.isArray(e.endpoints))throw TypeError(".simulcast.ActiveAudiosNotification.endpoints: array expected");t.endpoints=[];for(var r=0;r<e.endpoints.length;++r)t.endpoints[r]=String(e.endpoints[r])}return t},s.toObject=function(e,t){t||(t={});var r={};if((t.arrays||t.defaults)&&(r.endpoints=[]),e.endpoints&&e.endpoints.length){r.endpoints=[];for(var i=0;i<e.endpoints.length;++i)r.endpoints[i]=e.endpoints[i]}return r},s.prototype.toJSON=function(){return this.constructor.toObject(this,e.util.toJSONOptions)},s.getTypeUrl=function(e){return void 0===e&&(e="type.googleapis.com"),e+"/simulcast.ActiveAudiosNotification"},s}(),s.EndpointSyncNotification=function(){function s(e){if(this.role={},this.multiStreamInfo=[],e)for(var t=Object.keys(e),r=0;r<t.length;++r)null!=e[t[r]]&&(this[t[r]]=e[t[r]])}return s.prototype.action=0,s.prototype.id="",s.prototype.name="",s.prototype.roomId="",s.prototype.sdp="",s.prototype.timestamp=0n,s.prototype.role=i.emptyObject,s.prototype.userId="",s.prototype.deviceId="",s.prototype.multiStreamInfo=i.emptyArray,s.prototype.avatar="",s.prototype.mainVenueFlag="",s.create=function(e){return new s(e)},s.encode=function(e,t){if(t||(t=r.create()),null!=e.action&&Object.hasOwnProperty.call(e,"action")&&t.uint32(8).int32(e.action),null!=e.id&&Object.hasOwnProperty.call(e,"id")&&t.uint32(18).string(e.id),null!=e.name&&Object.hasOwnProperty.call(e,"name")&&t.uint32(26).string(e.name),null!=e.roomId&&Object.hasOwnProperty.call(e,"roomId")&&t.uint32(34).string(e.roomId),null!=e.sdp&&Object.hasOwnProperty.call(e,"sdp")&&t.uint32(42).string(e.sdp),null!=e.timestamp&&Object.hasOwnProperty.call(e,"timestamp")&&t.uint32(48).int64(e.timestamp),null!=e.role&&Object.hasOwnProperty.call(e,"role"))for(var i=Object.keys(e.role),n=0;n<i.length;++n)t.uint32(58).fork().uint32(10).string(i[n]).uint32(18).string(e.role[i[n]]).ldelim();if(null!=e.userId&&Object.hasOwnProperty.call(e,"userId")&&t.uint32(66).string(e.userId),null!=e.deviceId&&Object.hasOwnProperty.call(e,"deviceId")&&t.uint32(74).string(e.deviceId),null!=e.multiStreamInfo&&e.multiStreamInfo.length){for(t.uint32(82).fork(),n=0;n<e.multiStreamInfo.length;++n)t.int32(e.multiStreamInfo[n]);t.ldelim()}return null!=e.avatar&&Object.hasOwnProperty.call(e,"avatar")&&t.uint32(90).string(e.avatar),null!=e.mainVenueFlag&&Object.hasOwnProperty.call(e,"mainVenueFlag")&&t.uint32(98).string(e.mainVenueFlag),t},s.encodeDelimited=function(e,t){return this.encode(e,t).ldelim()},s.decode=function(e,r){e instanceof t||(e=t.create(e));for(var s,o,a=void 0===r?e.len:e.pos+r,c=new n.simulcast.EndpointSyncNotification;e.pos<a;){var u=e.uint32();switch(u>>>3){case 1:c.action=e.int32();break;case 2:c.id=e.string();break;case 3:c.name=e.string();break;case 4:c.roomId=e.string();break;case 5:c.sdp=e.string();break;case 6:c.timestamp=e.int64();break;case 7:c.role===i.emptyObject&&(c.role={});var h=e.uint32()+e.pos;for(s="",o="";e.pos<h;){var d=e.uint32();switch(d>>>3){case 1:s=e.string();break;case 2:o=e.string();break;default:e.skipType(7&d)}}c.role[s]=o;break;case 8:c.userId=e.string();break;case 9:c.deviceId=e.string();break;case 10:if(c.multiStreamInfo&&c.multiStreamInfo.length||(c.multiStreamInfo=[]),2==(7&u))for(h=e.uint32()+e.pos;e.pos<h;)c.multiStreamInfo.push(e.int32());else c.multiStreamInfo.push(e.int32());break;case 11:c.avatar=e.string();break;case 12:c.mainVenueFlag=e.string();break;default:e.skipType(7&u)}}return c},s.decodeDelimited=function(e){return e instanceof t||(e=new t(e)),this.decode(e,e.uint32())},s.verify=function(e){if("object"!=typeof e||null===e)return"object expected";if(null!=e.action&&e.hasOwnProperty("action"))switch(e.action){default:return"action: enum value expected";case 0:case 1:}if(null!=e.id&&e.hasOwnProperty("id")&&!i.isString(e.id))return"id: string expected";if(null!=e.name&&e.hasOwnProperty("name")&&!i.isString(e.name))return"name: string expected";if(null!=e.roomId&&e.hasOwnProperty("roomId")&&!i.isString(e.roomId))return"roomId: string expected";if(null!=e.sdp&&e.hasOwnProperty("sdp")&&!i.isString(e.sdp))return"sdp: string expected";if(null!=e.timestamp&&e.hasOwnProperty("timestamp")&&!(i.isInteger(e.timestamp)||e.timestamp&&i.isInteger(e.timestamp.low)&&i.isInteger(e.timestamp.high)))return"timestamp: integer|Long expected";if(null!=e.role&&e.hasOwnProperty("role")){if(!i.isObject(e.role))return"role: object expected";for(var t=Object.keys(e.role),r=0;r<t.length;++r)if(!i.isString(e.role[t[r]]))return"role: string{k:string} expected"}if(null!=e.userId&&e.hasOwnProperty("userId")&&!i.isString(e.userId))return"userId: string expected";if(null!=e.deviceId&&e.hasOwnProperty("deviceId")&&!i.isString(e.deviceId))return"deviceId: string expected";if(null!=e.multiStreamInfo&&e.hasOwnProperty("multiStreamInfo")){if(!Array.isArray(e.multiStreamInfo))return"multiStreamInfo: array expected";for(r=0;r<e.multiStreamInfo.length;++r)if(!i.isInteger(e.multiStreamInfo[r]))return"multiStreamInfo: integer[] expected"}return null!=e.avatar&&e.hasOwnProperty("avatar")&&!i.isString(e.avatar)?"avatar: string expected":null!=e.mainVenueFlag&&e.hasOwnProperty("mainVenueFlag")&&!i.isString(e.mainVenueFlag)?"mainVenueFlag: string expected":null},s.fromObject=function(e){if(e instanceof n.simulcast.EndpointSyncNotification)return e;var t=new n.simulcast.EndpointSyncNotification;switch(e.action){default:if("number"==typeof e.action){t.action=e.action;break}break;case"kAdd":case 0:t.action=0;break;case"kRemove":case 1:t.action=1}if(null!=e.id&&(t.id=String(e.id)),null!=e.name&&(t.name=String(e.name)),null!=e.roomId&&(t.roomId=String(e.roomId)),null!=e.sdp&&(t.sdp=String(e.sdp)),null!=e.timestamp&&(i.Long?(t.timestamp=i.Long.fromValue(e.timestamp)).unsigned=!1:"string"==typeof e.timestamp?t.timestamp=parseInt(e.timestamp,10):"number"==typeof e.timestamp?t.timestamp=e.timestamp:"object"==typeof e.timestamp&&(t.timestamp=new i.LongBits(e.timestamp.low>>>0,e.timestamp.high>>>0).toNumber())),e.role){if("object"!=typeof e.role)throw TypeError(".simulcast.EndpointSyncNotification.role: object expected");t.role={};for(var r=Object.keys(e.role),s=0;s<r.length;++s)t.role[r[s]]=String(e.role[r[s]])}if(null!=e.userId&&(t.userId=String(e.userId)),null!=e.deviceId&&(t.deviceId=String(e.deviceId)),e.multiStreamInfo){if(!Array.isArray(e.multiStreamInfo))throw TypeError(".simulcast.EndpointSyncNotification.multiStreamInfo: array expected");for(t.multiStreamInfo=[],s=0;s<e.multiStreamInfo.length;++s)t.multiStreamInfo[s]=0|e.multiStreamInfo[s]}return null!=e.avatar&&(t.avatar=String(e.avatar)),null!=e.mainVenueFlag&&(t.mainVenueFlag=String(e.mainVenueFlag)),t},s.toObject=function(e,t){t||(t={});var r,s={};if((t.arrays||t.defaults)&&(s.multiStreamInfo=[]),(t.objects||t.defaults)&&(s.role={}),t.defaults){if(s.action=t.enums===String?"kAdd":0,s.id="",s.name="",s.roomId="",s.sdp="",i.Long){var o=new i.Long(0,0,!1);s.timestamp=t.longs===String?o.toString():t.longs===Number?o.toNumber():o}else s.timestamp=t.longs===String?"0":0;s.userId="",s.deviceId="",s.avatar="",s.mainVenueFlag=""}if(null!=e.action&&e.hasOwnProperty("action")&&(s.action=t.enums===String?void 0===n.simulcast.EndpointSyncNotification.Action[e.action]?e.action:n.simulcast.EndpointSyncNotification.Action[e.action]:e.action),null!=e.id&&e.hasOwnProperty("id")&&(s.id=e.id),null!=e.name&&e.hasOwnProperty("name")&&(s.name=e.name),null!=e.roomId&&e.hasOwnProperty("roomId")&&(s.roomId=e.roomId),null!=e.sdp&&e.hasOwnProperty("sdp")&&(s.sdp=e.sdp),null!=e.timestamp&&e.hasOwnProperty("timestamp")&&("number"==typeof e.timestamp?s.timestamp=t.longs===String?String(e.timestamp):e.timestamp:s.timestamp=t.longs===String?i.Long.prototype.toString.call(e.timestamp):t.longs===Number?new i.LongBits(e.timestamp.low>>>0,e.timestamp.high>>>0).toNumber():e.timestamp),e.role&&(r=Object.keys(e.role)).length){s.role={};for(var a=0;a<r.length;++a)s.role[r[a]]=e.role[r[a]]}if(null!=e.userId&&e.hasOwnProperty("userId")&&(s.userId=e.userId),null!=e.deviceId&&e.hasOwnProperty("deviceId")&&(s.deviceId=e.deviceId),e.multiStreamInfo&&e.multiStreamInfo.length)for(s.multiStreamInfo=[],a=0;a<e.multiStreamInfo.length;++a)s.multiStreamInfo[a]=e.multiStreamInfo[a];return null!=e.avatar&&e.hasOwnProperty("avatar")&&(s.avatar=e.avatar),null!=e.mainVenueFlag&&e.hasOwnProperty("mainVenueFlag")&&(s.mainVenueFlag=e.mainVenueFlag),s},s.prototype.toJSON=function(){return this.constructor.toObject(this,e.util.toJSONOptions)},s.getTypeUrl=function(e){return void 0===e&&(e="type.googleapis.com"),e+"/simulcast.EndpointSyncNotification"},s.Action=function(){var e={},t=Object.create(e);return t[e[0]="kAdd"]=0,t[e[1]="kRemove"]=1,t}(),s}(),s.MediaNetworkStatusNotification=function(){function s(e){if(e)for(var t=Object.keys(e),r=0;r<t.length;++r)null!=e[t[r]]&&(this[t[r]]=e[t[r]])}return s.prototype.status=0,s.prototype.mediaType=0,s.prototype.endpoint="",s.prototype.signal=0,s.create=function(e){return new s(e)},s.encode=function(e,t){return t||(t=r.create()),null!=e.status&&Object.hasOwnProperty.call(e,"status")&&t.uint32(8).int32(e.status),null!=e.mediaType&&Object.hasOwnProperty.call(e,"mediaType")&&t.uint32(16).int32(e.mediaType),null!=e.endpoint&&Object.hasOwnProperty.call(e,"endpoint")&&t.uint32(26).string(e.endpoint),null!=e.signal&&Object.hasOwnProperty.call(e,"signal")&&t.uint32(32).int32(e.signal),t},s.encodeDelimited=function(e,t){return this.encode(e,t).ldelim()},s.decode=function(e,r){e instanceof t||(e=t.create(e));for(var i=void 0===r?e.len:e.pos+r,s=new n.simulcast.MediaNetworkStatusNotification;e.pos<i;){var o=e.uint32();switch(o>>>3){case 1:s.status=e.int32();break;case 2:s.mediaType=e.int32();break;case 3:s.endpoint=e.string();break;case 4:s.signal=e.int32();break;default:e.skipType(7&o)}}return s},s.decodeDelimited=function(e){return e instanceof t||(e=new t(e)),this.decode(e,e.uint32())},s.verify=function(e){if("object"!=typeof e||null===e)return"object expected";if(null!=e.status&&e.hasOwnProperty("status"))switch(e.status){default:return"status: enum value expected";case 0:case 1:}if(null!=e.mediaType&&e.hasOwnProperty("mediaType"))switch(e.mediaType){default:return"mediaType: enum value expected";case 0:case 1:case 2:}return null!=e.endpoint&&e.hasOwnProperty("endpoint")&&!i.isString(e.endpoint)?"endpoint: string expected":null!=e.signal&&e.hasOwnProperty("signal")&&!i.isInteger(e.signal)?"signal: integer expected":null},s.fromObject=function(e){if(e instanceof n.simulcast.MediaNetworkStatusNotification)return e;var t=new n.simulcast.MediaNetworkStatusNotification;switch(e.status){default:if("number"==typeof e.status){t.status=e.status;break}break;case"kPoorNetwork":case 0:t.status=0;break;case"kGoodNetwork":case 1:t.status=1}switch(e.mediaType){default:if("number"==typeof e.mediaType){t.mediaType=e.mediaType;break}break;case"kAudio":case 0:t.mediaType=0;break;case"kVideo":case 1:t.mediaType=1;break;case"kShare":case 2:t.mediaType=2}return null!=e.endpoint&&(t.endpoint=String(e.endpoint)),null!=e.signal&&(t.signal=0|e.signal),t},s.toObject=function(e,t){t||(t={});var r={};return t.defaults&&(r.status=t.enums===String?"kPoorNetwork":0,r.mediaType=t.enums===String?"kAudio":0,r.endpoint="",r.signal=0),null!=e.status&&e.hasOwnProperty("status")&&(r.status=t.enums===String?void 0===n.simulcast.MediaNetworkStatusNotification.Status[e.status]?e.status:n.simulcast.MediaNetworkStatusNotification.Status[e.status]:e.status),null!=e.mediaType&&e.hasOwnProperty("mediaType")&&(r.mediaType=t.enums===String?void 0===n.simulcast.MediaNetworkStatusNotification.MediaType[e.mediaType]?e.mediaType:n.simulcast.MediaNetworkStatusNotification.MediaType[e.mediaType]:e.mediaType),null!=e.endpoint&&e.hasOwnProperty("endpoint")&&(r.endpoint=e.endpoint),null!=e.signal&&e.hasOwnProperty("signal")&&(r.signal=e.signal),r},s.prototype.toJSON=function(){return this.constructor.toObject(this,e.util.toJSONOptions)},s.getTypeUrl=function(e){return void 0===e&&(e="type.googleapis.com"),e+"/simulcast.MediaNetworkStatusNotification"},s.MediaType=function(){var e={},t=Object.create(e);return t[e[0]="kAudio"]=0,t[e[1]="kVideo"]=1,t[e[2]="kShare"]=2,t}(),s.Status=function(){var e={},t=Object.create(e);return t[e[0]="kPoorNetwork"]=0,t[e[1]="kGoodNetwork"]=1,t}(),s}(),s.NetworkStateNotification=function(){function s(e){if(e)for(var t=Object.keys(e),r=0;r<t.length;++r)null!=e[t[r]]&&(this[t[r]]=e[t[r]])}return s.prototype.bitrate=0,s.prototype.loss=0,s.prototype.rtt=0,s.prototype.ratio=0,s.create=function(e){return new s(e)},s.encode=function(e,t){return t||(t=r.create()),null!=e.bitrate&&Object.hasOwnProperty.call(e,"bitrate")&&t.uint32(8).int32(e.bitrate),null!=e.loss&&Object.hasOwnProperty.call(e,"loss")&&t.uint32(16).int32(e.loss),null!=e.rtt&&Object.hasOwnProperty.call(e,"rtt")&&t.uint32(24).int32(e.rtt),null!=e.ratio&&Object.hasOwnProperty.call(e,"ratio")&&t.uint32(32).int32(e.ratio),t},s.encodeDelimited=function(e,t){return this.encode(e,t).ldelim()},s.decode=function(e,r){e instanceof t||(e=t.create(e));for(var i=void 0===r?e.len:e.pos+r,s=new n.simulcast.NetworkStateNotification;e.pos<i;){var o=e.uint32();switch(o>>>3){case 1:s.bitrate=e.int32();break;case 2:s.loss=e.int32();break;case 3:s.rtt=e.int32();break;case 4:s.ratio=e.int32();break;default:e.skipType(7&o)}}return s},s.decodeDelimited=function(e){return e instanceof t||(e=new t(e)),this.decode(e,e.uint32())},s.verify=function(e){return"object"!=typeof e||null===e?"object expected":null!=e.bitrate&&e.hasOwnProperty("bitrate")&&!i.isInteger(e.bitrate)?"bitrate: integer expected":null!=e.loss&&e.hasOwnProperty("loss")&&!i.isInteger(e.loss)?"loss: integer expected":null!=e.rtt&&e.hasOwnProperty("rtt")&&!i.isInteger(e.rtt)?"rtt: integer expected":null!=e.ratio&&e.hasOwnProperty("ratio")&&!i.isInteger(e.ratio)?"ratio: integer expected":null},s.fromObject=function(e){if(e instanceof n.simulcast.NetworkStateNotification)return e;var t=new n.simulcast.NetworkStateNotification;return null!=e.bitrate&&(t.bitrate=0|e.bitrate),null!=e.loss&&(t.loss=0|e.loss),null!=e.rtt&&(t.rtt=0|e.rtt),null!=e.ratio&&(t.ratio=0|e.ratio),t},s.toObject=function(e,t){t||(t={});var r={};return t.defaults&&(r.bitrate=0,r.loss=0,r.rtt=0,r.ratio=0),null!=e.bitrate&&e.hasOwnProperty("bitrate")&&(r.bitrate=e.bitrate),null!=e.loss&&e.hasOwnProperty("loss")&&(r.loss=e.loss),null!=e.rtt&&e.hasOwnProperty("rtt")&&(r.rtt=e.rtt),null!=e.ratio&&e.hasOwnProperty("ratio")&&(r.ratio=e.ratio),r},s.prototype.toJSON=function(){return this.constructor.toObject(this,e.util.toJSONOptions)},s.getTypeUrl=function(e){return void 0===e&&(e="type.googleapis.com"),e+"/simulcast.NetworkStateNotification"},s}(),s.SimulReliable=function(){function s(e){if(e)for(var t=Object.keys(e),r=0;r<t.length;++r)null!=e[t[r]]&&(this[t[r]]=e[t[r]])}return s.prototype.index=0,s.prototype.ack=0,s.prototype.type=0,s.prototype.body=i.newBuffer([]),s.prototype.sliceNum=0,s.prototype.sliceIndex=0,s.prototype.dataIndex=0,s.create=function(e){return new s(e)},s.encode=function(e,t){return t||(t=r.create()),null!=e.index&&Object.hasOwnProperty.call(e,"index")&&t.uint32(8).int32(e.index),null!=e.ack&&Object.hasOwnProperty.call(e,"ack")&&t.uint32(16).int32(e.ack),null!=e.type&&Object.hasOwnProperty.call(e,"type")&&t.uint32(24).int32(e.type),null!=e.body&&Object.hasOwnProperty.call(e,"body")&&t.uint32(34).bytes(e.body),null!=e.sliceNum&&Object.hasOwnProperty.call(e,"sliceNum")&&t.uint32(40).int32(e.sliceNum),null!=e.sliceIndex&&Object.hasOwnProperty.call(e,"sliceIndex")&&t.uint32(48).int32(e.sliceIndex),null!=e.dataIndex&&Object.hasOwnProperty.call(e,"dataIndex")&&t.uint32(56).int32(e.dataIndex),t},s.encodeDelimited=function(e,t){return this.encode(e,t).ldelim()},s.decode=function(e,r){e instanceof t||(e=t.create(e));for(var i=void 0===r?e.len:e.pos+r,s=new n.simulcast.SimulReliable;e.pos<i;){var o=e.uint32();switch(o>>>3){case 1:s.index=e.int32();break;case 2:s.ack=e.int32();break;case 3:s.type=e.int32();break;case 4:s.body=e.bytes();break;case 5:s.sliceNum=e.int32();break;case 6:s.sliceIndex=e.int32();break;case 7:s.dataIndex=e.int32();break;default:e.skipType(7&o)}}return s},s.decodeDelimited=function(e){return e instanceof t||(e=new t(e)),this.decode(e,e.uint32())},s.verify=function(e){if("object"!=typeof e||null===e)return"object expected";if(null!=e.index&&e.hasOwnProperty("index")&&!i.isInteger(e.index))return"index: integer expected";if(null!=e.ack&&e.hasOwnProperty("ack")&&!i.isInteger(e.ack))return"ack: integer expected";if(null!=e.type&&e.hasOwnProperty("type"))switch(e.type){default:return"type: enum value expected";case 0:case 1:case 2:case 3:case 4:case 5:case 7:case 8:case 9:case 10:case 11:case 12:case 13:case 14:case 15:case 16:case 17:case 18:case 19:case 20:case 22:}return null!=e.body&&e.hasOwnProperty("body")&&!(e.body&&"number"==typeof e.body.length||i.isString(e.body))?"body: buffer expected":null!=e.sliceNum&&e.hasOwnProperty("sliceNum")&&!i.isInteger(e.sliceNum)?"sliceNum: integer expected":null!=e.sliceIndex&&e.hasOwnProperty("sliceIndex")&&!i.isInteger(e.sliceIndex)?"sliceIndex: integer expected":null!=e.dataIndex&&e.hasOwnProperty("dataIndex")&&!i.isInteger(e.dataIndex)?"dataIndex: integer expected":null},s.fromObject=function(e){if(e instanceof n.simulcast.SimulReliable)return e;var t=new n.simulcast.SimulReliable;switch(null!=e.index&&(t.index=0|e.index),null!=e.ack&&(t.ack=0|e.ack),e.type){default:if("number"==typeof e.type){t.type=e.type;break}break;case"kSimulAck":case 0:t.type=0;break;case"kSimulSubscribe":case 1:t.type=1;break;case"kSimulNotification":case 2:t.type=2;break;case"kForwardNotification":case 3:t.type=3;break;case"kQualityNotification":case 4:t.type=4;break;case"kMuteStateNotification":case 5:t.type=5;break;case"kDesktopSimulNotifiction":case 7:t.type=7;break;case"kDesktopSubscriptionNotification":case 8:t.type=8;break;case"kRecvStreamSSRCNotification":case 9:t.type=9;break;case"kActiveAudiosNotification":case 10:t.type=10;break;case"kEndpointSyncNotification":case 11:t.type=11;break;case"kShareSyncNotification":case 12:t.type=12;break;case"kDtlsSubscribeNotification":case 13:t.type=13;break;case"kVideoSyncNotification":case 14:t.type=14;break;case"kMediaNetworkStatusNotification":case 15:t.type=15;break;case"kFocusVideoNotification":case 16:t.type=16;break;case"kDesktopResolutionLimitNotification":case 17:t.type=17;break;case"KRSSNRNotification":case 18:t.type=18;break;case"kNetworkStateNotification":case 19:t.type=19;break;case"kMessageSyncNotification":case 20:t.type=20;break;case"kMuteAudioNotification":case 22:t.type=22}return null!=e.body&&("string"==typeof e.body?i.base64.decode(e.body,t.body=i.newBuffer(i.base64.length(e.body)),0):e.body.length>=0&&(t.body=e.body)),null!=e.sliceNum&&(t.sliceNum=0|e.sliceNum),null!=e.sliceIndex&&(t.sliceIndex=0|e.sliceIndex),null!=e.dataIndex&&(t.dataIndex=0|e.dataIndex),t},s.toObject=function(e,t){t||(t={});var r={};return t.defaults&&(r.index=0,r.ack=0,r.type=t.enums===String?"kSimulAck":0,t.bytes===String?r.body="":(r.body=[],t.bytes!==Array&&(r.body=i.newBuffer(r.body))),r.sliceNum=0,r.sliceIndex=0,r.dataIndex=0),null!=e.index&&e.hasOwnProperty("index")&&(r.index=e.index),null!=e.ack&&e.hasOwnProperty("ack")&&(r.ack=e.ack),null!=e.type&&e.hasOwnProperty("type")&&(r.type=t.enums===String?void 0===n.simulcast.SimulReliable.MessageType[e.type]?e.type:n.simulcast.SimulReliable.MessageType[e.type]:e.type),null!=e.body&&e.hasOwnProperty("body")&&(r.body=t.bytes===String?i.base64.encode(e.body,0,e.body.length):t.bytes===Array?Array.prototype.slice.call(e.body):e.body),null!=e.sliceNum&&e.hasOwnProperty("sliceNum")&&(r.sliceNum=e.sliceNum),null!=e.sliceIndex&&e.hasOwnProperty("sliceIndex")&&(r.sliceIndex=e.sliceIndex),null!=e.dataIndex&&e.hasOwnProperty("dataIndex")&&(r.dataIndex=e.dataIndex),r},s.prototype.toJSON=function(){return this.constructor.toObject(this,e.util.toJSONOptions)},s.getTypeUrl=function(e){return void 0===e&&(e="type.googleapis.com"),e+"/simulcast.SimulReliable"},s.MessageType=function(){var e={},t=Object.create(e);return t[e[0]="kSimulAck"]=0,t[e[1]="kSimulSubscribe"]=1,t[e[2]="kSimulNotification"]=2,t[e[3]="kForwardNotification"]=3,t[e[4]="kQualityNotification"]=4,t[e[5]="kMuteStateNotification"]=5,t[e[7]="kDesktopSimulNotifiction"]=7,t[e[8]="kDesktopSubscriptionNotification"]=8,t[e[9]="kRecvStreamSSRCNotification"]=9,t[e[10]="kActiveAudiosNotification"]=10,t[e[11]="kEndpointSyncNotification"]=11,t[e[12]="kShareSyncNotification"]=12,t[e[13]="kDtlsSubscribeNotification"]=13,t[e[14]="kVideoSyncNotification"]=14,t[e[15]="kMediaNetworkStatusNotification"]=15,t[e[16]="kFocusVideoNotification"]=16,t[e[17]="kDesktopResolutionLimitNotification"]=17,t[e[18]="KRSSNRNotification"]=18,t[e[19]="kNetworkStateNotification"]=19,t[e[20]="kMessageSyncNotification"]=20,t[e[22]="kMuteAudioNotification"]=22,t}(),s}(),s.RecvStreamSSRCNotification=function(){function s(e){if(this.ssrcs=[],this.layers=[],e)for(var t=Object.keys(e),r=0;r<t.length;++r)null!=e[t[r]]&&(this[t[r]]=e[t[r]])}return s.prototype.endpoint="",s.prototype.type=0,s.prototype.ssrcs=i.emptyArray,s.prototype.layers=i.emptyArray,s.create=function(e){return new s(e)},s.encode=function(e,t){if(t||(t=r.create()),null!=e.endpoint&&Object.hasOwnProperty.call(e,"endpoint")&&t.uint32(10).string(e.endpoint),null!=e.type&&Object.hasOwnProperty.call(e,"type")&&t.uint32(16).int32(e.type),null!=e.ssrcs&&e.ssrcs.length){t.uint32(26).fork();for(var i=0;i<e.ssrcs.length;++i)t.uint32(e.ssrcs[i]);t.ldelim()}if(null!=e.layers&&e.layers.length)for(i=0;i<e.layers.length;++i)n.simulcast.SimulcastLayer.encode(e.layers[i],t.uint32(34).fork()).ldelim();return t},s.encodeDelimited=function(e,t){return this.encode(e,t).ldelim()},s.decode=function(e,r){e instanceof t||(e=t.create(e));for(var i=void 0===r?e.len:e.pos+r,s=new n.simulcast.RecvStreamSSRCNotification;e.pos<i;){var o=e.uint32();switch(o>>>3){case 1:s.endpoint=e.string();break;case 2:s.type=e.int32();break;case 3:if(s.ssrcs&&s.ssrcs.length||(s.ssrcs=[]),2==(7&o))for(var a=e.uint32()+e.pos;e.pos<a;)s.ssrcs.push(e.uint32());else s.ssrcs.push(e.uint32());break;case 4:s.layers&&s.layers.length||(s.layers=[]),s.layers.push(n.simulcast.SimulcastLayer.decode(e,e.uint32()));break;default:e.skipType(7&o)}}return s},s.decodeDelimited=function(e){return e instanceof t||(e=new t(e)),this.decode(e,e.uint32())},s.verify=function(e){if("object"!=typeof e||null===e)return"object expected";if(null!=e.endpoint&&e.hasOwnProperty("endpoint")&&!i.isString(e.endpoint))return"endpoint: string expected";if(null!=e.type&&e.hasOwnProperty("type"))switch(e.type){default:return"type: enum value expected";case 0:case 1:case 2:}if(null!=e.ssrcs&&e.hasOwnProperty("ssrcs")){if(!Array.isArray(e.ssrcs))return"ssrcs: array expected";for(var t=0;t<e.ssrcs.length;++t)if(!i.isInteger(e.ssrcs[t]))return"ssrcs: integer[] expected"}if(null!=e.layers&&e.hasOwnProperty("layers")){if(!Array.isArray(e.layers))return"layers: array expected";for(t=0;t<e.layers.length;++t){var r=n.simulcast.SimulcastLayer.verify(e.layers[t]);if(r)return"layers."+r}}return null},s.fromObject=function(e){if(e instanceof n.simulcast.RecvStreamSSRCNotification)return e;var t=new n.simulcast.RecvStreamSSRCNotification;switch(null!=e.endpoint&&(t.endpoint=String(e.endpoint)),e.type){default:if("number"==typeof e.type){t.type=e.type;break}break;case"AUDIO_MEDIA_ID":case 0:t.type=0;break;case"VIDEO_MEDIA_ID":case 1:t.type=1;break;case"SHARE_MEDIA_ID":case 2:t.type=2}if(e.ssrcs){if(!Array.isArray(e.ssrcs))throw TypeError(".simulcast.RecvStreamSSRCNotification.ssrcs: array expected");t.ssrcs=[];for(var r=0;r<e.ssrcs.length;++r)t.ssrcs[r]=e.ssrcs[r]>>>0}if(e.layers){if(!Array.isArray(e.layers))throw TypeError(".simulcast.RecvStreamSSRCNotification.layers: array expected");for(t.layers=[],r=0;r<e.layers.length;++r){if("object"!=typeof e.layers[r])throw TypeError(".simulcast.RecvStreamSSRCNotification.layers: object expected");t.layers[r]=n.simulcast.SimulcastLayer.fromObject(e.layers[r])}}return t},s.toObject=function(e,t){t||(t={});var r={};if((t.arrays||t.defaults)&&(r.ssrcs=[],r.layers=[]),t.defaults&&(r.endpoint="",r.type=t.enums===String?"AUDIO_MEDIA_ID":0),null!=e.endpoint&&e.hasOwnProperty("endpoint")&&(r.endpoint=e.endpoint),null!=e.type&&e.hasOwnProperty("type")&&(r.type=t.enums===String?void 0===n.simulcast.RecvStreamSSRCNotification.MediaID[e.type]?e.type:n.simulcast.RecvStreamSSRCNotification.MediaID[e.type]:e.type),e.ssrcs&&e.ssrcs.length){r.ssrcs=[];for(var i=0;i<e.ssrcs.length;++i)r.ssrcs[i]=e.ssrcs[i]}if(e.layers&&e.layers.length)for(r.layers=[],i=0;i<e.layers.length;++i)r.layers[i]=n.simulcast.SimulcastLayer.toObject(e.layers[i],t);return r},s.prototype.toJSON=function(){return this.constructor.toObject(this,e.util.toJSONOptions)},s.getTypeUrl=function(e){return void 0===e&&(e="type.googleapis.com"),e+"/simulcast.RecvStreamSSRCNotification"},s.MediaID=function(){var e={},t=Object.create(e);return t[e[0]="AUDIO_MEDIA_ID"]=0,t[e[1]="VIDEO_MEDIA_ID"]=1,t[e[2]="SHARE_MEDIA_ID"]=2,t}(),s}(),s.DesktopResolutionLimitNotification=function(){function s(e){if(e)for(var t=Object.keys(e),r=0;r<t.length;++r)null!=e[t[r]]&&(this[t[r]]=e[t[r]])}return s.prototype.endpoint="",s.prototype.maxResolution=0,s.create=function(e){return new s(e)},s.encode=function(e,t){return t||(t=r.create()),null!=e.endpoint&&Object.hasOwnProperty.call(e,"endpoint")&&t.uint32(10).string(e.endpoint),null!=e.maxResolution&&Object.hasOwnProperty.call(e,"maxResolution")&&t.uint32(16).int32(e.maxResolution),t},s.encodeDelimited=function(e,t){return this.encode(e,t).ldelim()},s.decode=function(e,r){e instanceof t||(e=t.create(e));for(var i=void 0===r?e.len:e.pos+r,s=new n.simulcast.DesktopResolutionLimitNotification;e.pos<i;){var o=e.uint32();switch(o>>>3){case 1:s.endpoint=e.string();break;case 2:s.maxResolution=e.int32();break;default:e.skipType(7&o)}}return s},s.decodeDelimited=function(e){return e instanceof t||(e=new t(e)),this.decode(e,e.uint32())},s.verify=function(e){if("object"!=typeof e||null===e)return"object expected";if(null!=e.endpoint&&e.hasOwnProperty("endpoint")&&!i.isString(e.endpoint))return"endpoint: string expected";if(null!=e.maxResolution&&e.hasOwnProperty("maxResolution"))switch(e.maxResolution){default:return"maxResolution: enum value expected";case 0:case 1:}return null},s.fromObject=function(e){if(e instanceof n.simulcast.DesktopResolutionLimitNotification)return e;var t=new n.simulcast.DesktopResolutionLimitNotification;switch(null!=e.endpoint&&(t.endpoint=String(e.endpoint)),e.maxResolution){default:if("number"==typeof e.maxResolution){t.maxResolution=e.maxResolution;break}break;case"kNotLimited":case 0:t.maxResolution=0;break;case"k1080p":case 1:t.maxResolution=1}return t},s.toObject=function(e,t){t||(t={});var r={};return t.defaults&&(r.endpoint="",r.maxResolution=t.enums===String?"kNotLimited":0),null!=e.endpoint&&e.hasOwnProperty("endpoint")&&(r.endpoint=e.endpoint),null!=e.maxResolution&&e.hasOwnProperty("maxResolution")&&(r.maxResolution=t.enums===String?void 0===n.simulcast.DesktopResolutionLimitNotification.MaxResolution[e.maxResolution]?e.maxResolution:n.simulcast.DesktopResolutionLimitNotification.MaxResolution[e.maxResolution]:e.maxResolution),r},s.prototype.toJSON=function(){return this.constructor.toObject(this,e.util.toJSONOptions)},s.getTypeUrl=function(e){return void 0===e&&(e="type.googleapis.com"),e+"/simulcast.DesktopResolutionLimitNotification"},s.MaxResolution=function(){var e={},t=Object.create(e);return t[e[0]="kNotLimited"]=0,t[e[1]="k1080p"]=1,t}(),s}(),s.RSSNRLayer=function(){function s(e){if(e)for(var t=Object.keys(e),r=0;r<t.length;++r)null!=e[t[r]]&&(this[t[r]]=e[t[r]])}return s.prototype.ssrc=0,s.prototype.bps=0,s.create=function(e){return new s(e)},s.encode=function(e,t){return t||(t=r.create()),null!=e.ssrc&&Object.hasOwnProperty.call(e,"ssrc")&&t.uint32(8).uint32(e.ssrc),null!=e.bps&&Object.hasOwnProperty.call(e,"bps")&&t.uint32(16).uint32(e.bps),t},s.encodeDelimited=function(e,t){return this.encode(e,t).ldelim()},s.decode=function(e,r){e instanceof t||(e=t.create(e));for(var i=void 0===r?e.len:e.pos+r,s=new n.simulcast.RSSNRLayer;e.pos<i;){var o=e.uint32();switch(o>>>3){case 1:s.ssrc=e.uint32();break;case 2:s.bps=e.uint32();break;default:e.skipType(7&o)}}return s},s.decodeDelimited=function(e){return e instanceof t||(e=new t(e)),this.decode(e,e.uint32())},s.verify=function(e){return"object"!=typeof e||null===e?"object expected":null!=e.ssrc&&e.hasOwnProperty("ssrc")&&!i.isInteger(e.ssrc)?"ssrc: integer expected":null!=e.bps&&e.hasOwnProperty("bps")&&!i.isInteger(e.bps)?"bps: integer expected":null},s.fromObject=function(e){if(e instanceof n.simulcast.RSSNRLayer)return e;var t=new n.simulcast.RSSNRLayer;return null!=e.ssrc&&(t.ssrc=e.ssrc>>>0),null!=e.bps&&(t.bps=e.bps>>>0),t},s.toObject=function(e,t){t||(t={});var r={};return t.defaults&&(r.ssrc=0,r.bps=0),null!=e.ssrc&&e.hasOwnProperty("ssrc")&&(r.ssrc=e.ssrc),null!=e.bps&&e.hasOwnProperty("bps")&&(r.bps=e.bps),r},s.prototype.toJSON=function(){return this.constructor.toObject(this,e.util.toJSONOptions)},s.getTypeUrl=function(e){return void 0===e&&(e="type.googleapis.com"),e+"/simulcast.RSSNRLayer"},s}(),s.RSSNRNotification=function(){function s(e){if(this.layers=[],e)for(var t=Object.keys(e),r=0;r<t.length;++r)null!=e[t[r]]&&(this[t[r]]=e[t[r]])}return s.prototype.layers=i.emptyArray,s.create=function(e){return new s(e)},s.encode=function(e,t){if(t||(t=r.create()),null!=e.layers&&e.layers.length)for(var i=0;i<e.layers.length;++i)n.simulcast.RSSNRLayer.encode(e.layers[i],t.uint32(10).fork()).ldelim();return t},s.encodeDelimited=function(e,t){return this.encode(e,t).ldelim()},s.decode=function(e,r){e instanceof t||(e=t.create(e));for(var i=void 0===r?e.len:e.pos+r,s=new n.simulcast.RSSNRNotification;e.pos<i;){var o=e.uint32();o>>>3==1?(s.layers&&s.layers.length||(s.layers=[]),s.layers.push(n.simulcast.RSSNRLayer.decode(e,e.uint32()))):e.skipType(7&o)}return s},s.decodeDelimited=function(e){return e instanceof t||(e=new t(e)),this.decode(e,e.uint32())},s.verify=function(e){if("object"!=typeof e||null===e)return"object expected";if(null!=e.layers&&e.hasOwnProperty("layers")){if(!Array.isArray(e.layers))return"layers: array expected";for(var t=0;t<e.layers.length;++t){var r=n.simulcast.RSSNRLayer.verify(e.layers[t]);if(r)return"layers."+r}}return null},s.fromObject=function(e){if(e instanceof n.simulcast.RSSNRNotification)return e;var t=new n.simulcast.RSSNRNotification;if(e.layers){if(!Array.isArray(e.layers))throw TypeError(".simulcast.RSSNRNotification.layers: array expected");t.layers=[];for(var r=0;r<e.layers.length;++r){if("object"!=typeof e.layers[r])throw TypeError(".simulcast.RSSNRNotification.layers: object expected");t.layers[r]=n.simulcast.RSSNRLayer.fromObject(e.layers[r])}}return t},s.toObject=function(e,t){t||(t={});var r={};if((t.arrays||t.defaults)&&(r.layers=[]),e.layers&&e.layers.length){r.layers=[];for(var i=0;i<e.layers.length;++i)r.layers[i]=n.simulcast.RSSNRLayer.toObject(e.layers[i],t)}return r},s.prototype.toJSON=function(){return this.constructor.toObject(this,e.util.toJSONOptions)},s.getTypeUrl=function(e){return void 0===e&&(e="type.googleapis.com"),e+"/simulcast.RSSNRNotification"},s}(),s.DtlsSubscribeDetail=function(){function s(e){if(e)for(var t=Object.keys(e),r=0;r<t.length;++r)null!=e[t[r]]&&(this[t[r]]=e[t[r]])}return s.prototype.policy=0,s.prototype.ssrc=0,s.prototype.fecSsrc=0,s.prototype.rtxSsrc=0,s.prototype.uuid="",s.prototype.quality=0,s.prototype.minquality=0,s.prototype.group="",s.prototype.bitrate=0,s.prototype.minbitrate=0,s.prototype.maxbitrate=0,s.prototype.csid="",s.prototype.framrate=0,s.prototype.codetype="",s.create=function(e){return new s(e)},s.encode=function(e,t){return t||(t=r.create()),null!=e.policy&&Object.hasOwnProperty.call(e,"policy")&&t.uint32(8).int32(e.policy),null!=e.ssrc&&Object.hasOwnProperty.call(e,"ssrc")&&t.uint32(16).uint32(e.ssrc),null!=e.fecSsrc&&Object.hasOwnProperty.call(e,"fecSsrc")&&t.uint32(24).uint32(e.fecSsrc),null!=e.rtxSsrc&&Object.hasOwnProperty.call(e,"rtxSsrc")&&t.uint32(32).uint32(e.rtxSsrc),null!=e.uuid&&Object.hasOwnProperty.call(e,"uuid")&&t.uint32(42).string(e.uuid),null!=e.quality&&Object.hasOwnProperty.call(e,"quality")&&t.uint32(48).uint32(e.quality),null!=e.minquality&&Object.hasOwnProperty.call(e,"minquality")&&t.uint32(56).uint32(e.minquality),null!=e.group&&Object.hasOwnProperty.call(e,"group")&&t.uint32(66).string(e.group),null!=e.bitrate&&Object.hasOwnProperty.call(e,"bitrate")&&t.uint32(72).uint32(e.bitrate),null!=e.minbitrate&&Object.hasOwnProperty.call(e,"minbitrate")&&t.uint32(80).uint32(e.minbitrate),null!=e.maxbitrate&&Object.hasOwnProperty.call(e,"maxbitrate")&&t.uint32(88).uint32(e.maxbitrate),null!=e.csid&&Object.hasOwnProperty.call(e,"csid")&&t.uint32(98).string(e.csid),null!=e.framrate&&Object.hasOwnProperty.call(e,"framrate")&&t.uint32(104).uint32(e.framrate),null!=e.codetype&&Object.hasOwnProperty.call(e,"codetype")&&t.uint32(114).string(e.codetype),t},s.encodeDelimited=function(e,t){return this.encode(e,t).ldelim()},s.decode=function(e,r){e instanceof t||(e=t.create(e));for(var i=void 0===r?e.len:e.pos+r,s=new n.simulcast.DtlsSubscribeDetail;e.pos<i;){var o=e.uint32();switch(o>>>3){case 1:s.policy=e.int32();break;case 2:s.ssrc=e.uint32();break;case 3:s.fecSsrc=e.uint32();break;case 4:s.rtxSsrc=e.uint32();break;case 5:s.uuid=e.string();break;case 6:s.quality=e.uint32();break;case 7:s.minquality=e.uint32();break;case 8:s.group=e.string();break;case 9:s.bitrate=e.uint32();break;case 10:s.minbitrate=e.uint32();break;case 11:s.maxbitrate=e.uint32();break;case 12:s.csid=e.string();break;case 13:s.framrate=e.uint32();break;case 14:s.codetype=e.string();break;default:e.skipType(7&o)}}return s},s.decodeDelimited=function(e){return e instanceof t||(e=new t(e)),this.decode(e,e.uint32())},s.verify=function(e){if("object"!=typeof e||null===e)return"object expected";if(null!=e.policy&&e.hasOwnProperty("policy"))switch(e.policy){default:return"policy: enum value expected";case 0:case 1:}return null!=e.ssrc&&e.hasOwnProperty("ssrc")&&!i.isInteger(e.ssrc)?"ssrc: integer expected":null!=e.fecSsrc&&e.hasOwnProperty("fecSsrc")&&!i.isInteger(e.fecSsrc)?"fecSsrc: integer expected":null!=e.rtxSsrc&&e.hasOwnProperty("rtxSsrc")&&!i.isInteger(e.rtxSsrc)?"rtxSsrc: integer expected":null!=e.uuid&&e.hasOwnProperty("uuid")&&!i.isString(e.uuid)?"uuid: string expected":null!=e.quality&&e.hasOwnProperty("quality")&&!i.isInteger(e.quality)?"quality: integer expected":null!=e.minquality&&e.hasOwnProperty("minquality")&&!i.isInteger(e.minquality)?"minquality: integer expected":null!=e.group&&e.hasOwnProperty("group")&&!i.isString(e.group)?"group: string expected":null!=e.bitrate&&e.hasOwnProperty("bitrate")&&!i.isInteger(e.bitrate)?"bitrate: integer expected":null!=e.minbitrate&&e.hasOwnProperty("minbitrate")&&!i.isInteger(e.minbitrate)?"minbitrate: integer expected":null!=e.maxbitrate&&e.hasOwnProperty("maxbitrate")&&!i.isInteger(e.maxbitrate)?"maxbitrate: integer expected":null!=e.csid&&e.hasOwnProperty("csid")&&!i.isString(e.csid)?"csid: string expected":null!=e.framrate&&e.hasOwnProperty("framrate")&&!i.isInteger(e.framrate)?"framrate: integer expected":null!=e.codetype&&e.hasOwnProperty("codetype")&&!i.isString(e.codetype)?"codetype: string expected":null},s.fromObject=function(e){if(e instanceof n.simulcast.DtlsSubscribeDetail)return e;var t=new n.simulcast.DtlsSubscribeDetail;switch(e.policy){default:if("number"==typeof e.policy){t.policy=e.policy;break}break;case"SUB_ACTIVE":case 0:t.policy=0;break;case"SUB_USER":case 1:t.policy=1}return null!=e.ssrc&&(t.ssrc=e.ssrc>>>0),null!=e.fecSsrc&&(t.fecSsrc=e.fecSsrc>>>0),null!=e.rtxSsrc&&(t.rtxSsrc=e.rtxSsrc>>>0),null!=e.uuid&&(t.uuid=String(e.uuid)),null!=e.quality&&(t.quality=e.quality>>>0),null!=e.minquality&&(t.minquality=e.minquality>>>0),null!=e.group&&(t.group=String(e.group)),null!=e.bitrate&&(t.bitrate=e.bitrate>>>0),null!=e.minbitrate&&(t.minbitrate=e.minbitrate>>>0),null!=e.maxbitrate&&(t.maxbitrate=e.maxbitrate>>>0),null!=e.csid&&(t.csid=String(e.csid)),null!=e.framrate&&(t.framrate=e.framrate>>>0),null!=e.codetype&&(t.codetype=String(e.codetype)),t},s.toObject=function(e,t){t||(t={});var r={};return t.defaults&&(r.policy=t.enums===String?"SUB_ACTIVE":0,r.ssrc=0,r.fecSsrc=0,r.rtxSsrc=0,r.uuid="",r.quality=0,r.minquality=0,r.group="",r.bitrate=0,r.minbitrate=0,r.maxbitrate=0,r.csid="",r.framrate=0,r.codetype=""),null!=e.policy&&e.hasOwnProperty("policy")&&(r.policy=t.enums===String?void 0===n.simulcast.DtlsSubscribeDetail.SubPolicy[e.policy]?e.policy:n.simulcast.DtlsSubscribeDetail.SubPolicy[e.policy]:e.policy),null!=e.ssrc&&e.hasOwnProperty("ssrc")&&(r.ssrc=e.ssrc),null!=e.fecSsrc&&e.hasOwnProperty("fecSsrc")&&(r.fecSsrc=e.fecSsrc),null!=e.rtxSsrc&&e.hasOwnProperty("rtxSsrc")&&(r.rtxSsrc=e.rtxSsrc),null!=e.uuid&&e.hasOwnProperty("uuid")&&(r.uuid=e.uuid),null!=e.quality&&e.hasOwnProperty("quality")&&(r.quality=e.quality),null!=e.minquality&&e.hasOwnProperty("minquality")&&(r.minquality=e.minquality),null!=e.group&&e.hasOwnProperty("group")&&(r.group=e.group),null!=e.bitrate&&e.hasOwnProperty("bitrate")&&(r.bitrate=e.bitrate),null!=e.minbitrate&&e.hasOwnProperty("minbitrate")&&(r.minbitrate=e.minbitrate),null!=e.maxbitrate&&e.hasOwnProperty("maxbitrate")&&(r.maxbitrate=e.maxbitrate),null!=e.csid&&e.hasOwnProperty("csid")&&(r.csid=e.csid),null!=e.framrate&&e.hasOwnProperty("framrate")&&(r.framrate=e.framrate),null!=e.codetype&&e.hasOwnProperty("codetype")&&(r.codetype=e.codetype),r},s.prototype.toJSON=function(){return this.constructor.toObject(this,e.util.toJSONOptions)},s.getTypeUrl=function(e){return void 0===e&&(e="type.googleapis.com"),e+"/simulcast.DtlsSubscribeDetail"},s.SubPolicy=function(){var e={},t=Object.create(e);return t[e[0]="SUB_ACTIVE"]=0,t[e[1]="SUB_USER"]=1,t}(),s}(),s.DtlsSubscribeNotification=function(){function s(e){if(this.subs=[],e)for(var t=Object.keys(e),r=0;r<t.length;++r)null!=e[t[r]]&&(this[t[r]]=e[t[r]])}return s.prototype.id=0,s.prototype.ackId=0,s.prototype.type=0,s.prototype.mtype=0,s.prototype.subs=i.emptyArray,s.create=function(e){return new s(e)},s.encode=function(e,t){if(t||(t=r.create()),null!=e.id&&Object.hasOwnProperty.call(e,"id")&&t.uint32(8).uint32(e.id),null!=e.ackId&&Object.hasOwnProperty.call(e,"ackId")&&t.uint32(16).uint32(e.ackId),null!=e.type&&Object.hasOwnProperty.call(e,"type")&&t.uint32(24).int32(e.type),null!=e.mtype&&Object.hasOwnProperty.call(e,"mtype")&&t.uint32(32).int32(e.mtype),null!=e.subs&&e.subs.length)for(var i=0;i<e.subs.length;++i)n.simulcast.DtlsSubscribeDetail.encode(e.subs[i],t.uint32(42).fork()).ldelim();return t},s.encodeDelimited=function(e,t){return this.encode(e,t).ldelim()},s.decode=function(e,r){e instanceof t||(e=t.create(e));for(var i=void 0===r?e.len:e.pos+r,s=new n.simulcast.DtlsSubscribeNotification;e.pos<i;){var o=e.uint32();switch(o>>>3){case 1:s.id=e.uint32();break;case 2:s.ackId=e.uint32();break;case 3:s.type=e.int32();break;case 4:s.mtype=e.int32();break;case 5:s.subs&&s.subs.length||(s.subs=[]),s.subs.push(n.simulcast.DtlsSubscribeDetail.decode(e,e.uint32()));break;default:e.skipType(7&o)}}return s},s.decodeDelimited=function(e){return e instanceof t||(e=new t(e)),this.decode(e,e.uint32())},s.verify=function(e){if("object"!=typeof e||null===e)return"object expected";if(null!=e.id&&e.hasOwnProperty("id")&&!i.isInteger(e.id))return"id: integer expected";if(null!=e.ackId&&e.hasOwnProperty("ackId")&&!i.isInteger(e.ackId))return"ackId: integer expected";if(null!=e.type&&e.hasOwnProperty("type"))switch(e.type){default:return"type: enum value expected";case 0:case 1:}if(null!=e.mtype&&e.hasOwnProperty("mtype"))switch(e.mtype){default:return"mtype: enum value expected";case 0:case 1:case 2:}if(null!=e.subs&&e.hasOwnProperty("subs")){if(!Array.isArray(e.subs))return"subs: array expected";for(var t=0;t<e.subs.length;++t){var r=n.simulcast.DtlsSubscribeDetail.verify(e.subs[t]);if(r)return"subs."+r}}return null},s.fromObject=function(e){if(e instanceof n.simulcast.DtlsSubscribeNotification)return e;var t=new n.simulcast.DtlsSubscribeNotification;switch(null!=e.id&&(t.id=e.id>>>0),null!=e.ackId&&(t.ackId=e.ackId>>>0),e.type){default:if("number"==typeof e.type){t.type=e.type;break}break;case"ACK":case 0:t.type=0;break;case"REFRESH":case 1:t.type=1}switch(e.mtype){default:if("number"==typeof e.mtype){t.mtype=e.mtype;break}break;case"MEDIA_UNDEFINED":case 0:t.mtype=0;break;case"MEDIA_VIDEO":case 1:t.mtype=1;break;case"MEDIA_DESKTOP":case 2:t.mtype=2}if(e.subs){if(!Array.isArray(e.subs))throw TypeError(".simulcast.DtlsSubscribeNotification.subs: array expected");t.subs=[];for(var r=0;r<e.subs.length;++r){if("object"!=typeof e.subs[r])throw TypeError(".simulcast.DtlsSubscribeNotification.subs: object expected");t.subs[r]=n.simulcast.DtlsSubscribeDetail.fromObject(e.subs[r])}}return t},s.toObject=function(e,t){t||(t={});var r={};if((t.arrays||t.defaults)&&(r.subs=[]),t.defaults&&(r.id=0,r.ackId=0,r.type=t.enums===String?"ACK":0,r.mtype=t.enums===String?"MEDIA_UNDEFINED":0),null!=e.id&&e.hasOwnProperty("id")&&(r.id=e.id),null!=e.ackId&&e.hasOwnProperty("ackId")&&(r.ackId=e.ackId),null!=e.type&&e.hasOwnProperty("type")&&(r.type=t.enums===String?void 0===n.simulcast.DtlsSubscribeNotification.MessageType[e.type]?e.type:n.simulcast.DtlsSubscribeNotification.MessageType[e.type]:e.type),null!=e.mtype&&e.hasOwnProperty("mtype")&&(r.mtype=t.enums===String?void 0===n.simulcast.DtlsSubscribeNotification.mediaType[e.mtype]?e.mtype:n.simulcast.DtlsSubscribeNotification.mediaType[e.mtype]:e.mtype),e.subs&&e.subs.length){r.subs=[];for(var i=0;i<e.subs.length;++i)r.subs[i]=n.simulcast.DtlsSubscribeDetail.toObject(e.subs[i],t)}return r},s.prototype.toJSON=function(){return this.constructor.toObject(this,e.util.toJSONOptions)},s.getTypeUrl=function(e){return void 0===e&&(e="type.googleapis.com"),e+"/simulcast.DtlsSubscribeNotification"},s.MessageType=function(){var e={},t=Object.create(e);return t[e[0]="ACK"]=0,t[e[1]="REFRESH"]=1,t}(),s.mediaType=function(){var e={},t=Object.create(e);return t[e[0]="MEDIA_UNDEFINED"]=0,t[e[1]="MEDIA_VIDEO"]=1,t[e[2]="MEDIA_DESKTOP"]=2,t}(),s}(),s.DtlsSubscribe=function(){function s(e){if(this.subs=[],e)for(var t=Object.keys(e),r=0;r<t.length;++r)null!=e[t[r]]&&(this[t[r]]=e[t[r]])}return s.prototype.id=0,s.prototype.ackId=0,s.prototype.type=0,s.prototype.mediaType=0,s.prototype.downBandwidthLimit=0,s.prototype.subs=i.emptyArray,s.create=function(e){return new s(e)},s.encode=function(e,t){if(t||(t=r.create()),null!=e.id&&Object.hasOwnProperty.call(e,"id")&&t.uint32(8).uint32(e.id),null!=e.ackId&&Object.hasOwnProperty.call(e,"ackId")&&t.uint32(16).uint32(e.ackId),null!=e.type&&Object.hasOwnProperty.call(e,"type")&&t.uint32(24).int32(e.type),null!=e.mediaType&&Object.hasOwnProperty.call(e,"mediaType")&&t.uint32(32).int32(e.mediaType),null!=e.downBandwidthLimit&&Object.hasOwnProperty.call(e,"downBandwidthLimit")&&t.uint32(40).uint32(e.downBandwidthLimit),null!=e.subs&&e.subs.length)for(var i=0;i<e.subs.length;++i)n.simulcast.MediaSubscribe.encode(e.subs[i],t.uint32(50).fork()).ldelim();return t},s.encodeDelimited=function(e,t){return this.encode(e,t).ldelim()},s.decode=function(e,r){e instanceof t||(e=t.create(e));for(var i=void 0===r?e.len:e.pos+r,s=new n.simulcast.DtlsSubscribe;e.pos<i;){var o=e.uint32();switch(o>>>3){case 1:s.id=e.uint32();break;case 2:s.ackId=e.uint32();break;case 3:s.type=e.int32();break;case 4:s.mediaType=e.int32();break;case 5:s.downBandwidthLimit=e.uint32();break;case 6:s.subs&&s.subs.length||(s.subs=[]),s.subs.push(n.simulcast.MediaSubscribe.decode(e,e.uint32()));break;default:e.skipType(7&o)}}return s},s.decodeDelimited=function(e){return e instanceof t||(e=new t(e)),this.decode(e,e.uint32())},s.verify=function(e){if("object"!=typeof e||null===e)return"object expected";if(null!=e.id&&e.hasOwnProperty("id")&&!i.isInteger(e.id))return"id: integer expected";if(null!=e.ackId&&e.hasOwnProperty("ackId")&&!i.isInteger(e.ackId))return"ackId: integer expected";if(null!=e.type&&e.hasOwnProperty("type"))switch(e.type){default:return"type: enum value expected";case 0:case 1:}if(null!=e.mediaType&&e.hasOwnProperty("mediaType"))switch(e.mediaType){default:return"mediaType: enum value expected";case 0:case 1:case 2:}if(null!=e.downBandwidthLimit&&e.hasOwnProperty("downBandwidthLimit")&&!i.isInteger(e.downBandwidthLimit))return"downBandwidthLimit: integer expected";if(null!=e.subs&&e.hasOwnProperty("subs")){if(!Array.isArray(e.subs))return"subs: array expected";for(var t=0;t<e.subs.length;++t){var r=n.simulcast.MediaSubscribe.verify(e.subs[t]);if(r)return"subs."+r}}return null},s.fromObject=function(e){if(e instanceof n.simulcast.DtlsSubscribe)return e;var t=new n.simulcast.DtlsSubscribe;switch(null!=e.id&&(t.id=e.id>>>0),null!=e.ackId&&(t.ackId=e.ackId>>>0),e.type){default:if("number"==typeof e.type){t.type=e.type;break}break;case"ACK":case 0:t.type=0;break;case"REFRESH":case 1:t.type=1}switch(e.mediaType){default:if("number"==typeof e.mediaType){t.mediaType=e.mediaType;break}break;case"INVAILD":case 0:t.mediaType=0;break;case"VIDEO":case 1:t.mediaType=1;break;case"SHARE":case 2:t.mediaType=2}if(null!=e.downBandwidthLimit&&(t.downBandwidthLimit=e.downBandwidthLimit>>>0),e.subs){if(!Array.isArray(e.subs))throw TypeError(".simulcast.DtlsSubscribe.subs: array expected");t.subs=[];for(var r=0;r<e.subs.length;++r){if("object"!=typeof e.subs[r])throw TypeError(".simulcast.DtlsSubscribe.subs: object expected");t.subs[r]=n.simulcast.MediaSubscribe.fromObject(e.subs[r])}}return t},s.toObject=function(e,t){t||(t={});var r={};if((t.arrays||t.defaults)&&(r.subs=[]),t.defaults&&(r.id=0,r.ackId=0,r.type=t.enums===String?"ACK":0,r.mediaType=t.enums===String?"INVAILD":0,r.downBandwidthLimit=0),null!=e.id&&e.hasOwnProperty("id")&&(r.id=e.id),null!=e.ackId&&e.hasOwnProperty("ackId")&&(r.ackId=e.ackId),null!=e.type&&e.hasOwnProperty("type")&&(r.type=t.enums===String?void 0===n.simulcast.DtlsSubscribe.MessageType[e.type]?e.type:n.simulcast.DtlsSubscribe.MessageType[e.type]:e.type),null!=e.mediaType&&e.hasOwnProperty("mediaType")&&(r.mediaType=t.enums===String?void 0===n.simulcast.DtlsSubscribe.MediaType[e.mediaType]?e.mediaType:n.simulcast.DtlsSubscribe.MediaType[e.mediaType]:e.mediaType),null!=e.downBandwidthLimit&&e.hasOwnProperty("downBandwidthLimit")&&(r.downBandwidthLimit=e.downBandwidthLimit),e.subs&&e.subs.length){r.subs=[];for(var i=0;i<e.subs.length;++i)r.subs[i]=n.simulcast.MediaSubscribe.toObject(e.subs[i],t)}return r},s.prototype.toJSON=function(){return this.constructor.toObject(this,e.util.toJSONOptions)},s.getTypeUrl=function(e){return void 0===e&&(e="type.googleapis.com"),e+"/simulcast.DtlsSubscribe"},s.MessageType=function(){var e={},t=Object.create(e);return t[e[0]="ACK"]=0,t[e[1]="REFRESH"]=1,t}(),s.MediaType=function(){var e={},t=Object.create(e);return t[e[0]="INVAILD"]=0,t[e[1]="VIDEO"]=1,t[e[2]="SHARE"]=2,t}(),s}(),s.MediaSubscribe=function(){function s(e){if(e)for(var t=Object.keys(e),r=0;r<t.length;++r)null!=e[t[r]]&&(this[t[r]]=e[t[r]])}return s.prototype.ssrc=0,s.prototype.uuid="",s.prototype.codecType=0,s.prototype.minLevel=0,s.prototype.maxLevel=0,s.prototype.policy=0,s.prototype.framerate=0,s.prototype.enable=!1,s.prototype.targetKbps=0,s.prototype.count=0,s.prototype.csi=0,s.create=function(e){return new s(e)},s.encode=function(e,t){return t||(t=r.create()),null!=e.ssrc&&Object.hasOwnProperty.call(e,"ssrc")&&t.uint32(8).uint32(e.ssrc),null!=e.uuid&&Object.hasOwnProperty.call(e,"uuid")&&t.uint32(18).string(e.uuid),null!=e.codecType&&Object.hasOwnProperty.call(e,"codecType")&&t.uint32(24).int32(e.codecType),null!=e.minLevel&&Object.hasOwnProperty.call(e,"minLevel")&&t.uint32(32).uint32(e.minLevel),null!=e.maxLevel&&Object.hasOwnProperty.call(e,"maxLevel")&&t.uint32(40).uint32(e.maxLevel),null!=e.policy&&Object.hasOwnProperty.call(e,"policy")&&t.uint32(48).int32(e.policy),null!=e.framerate&&Object.hasOwnProperty.call(e,"framerate")&&t.uint32(56).uint32(e.framerate),null!=e.enable&&Object.hasOwnProperty.call(e,"enable")&&t.uint32(64).bool(e.enable),null!=e.targetKbps&&Object.hasOwnProperty.call(e,"targetKbps")&&t.uint32(72).uint32(e.targetKbps),null!=e.count&&Object.hasOwnProperty.call(e,"count")&&t.uint32(80).uint32(e.count),null!=e.csi&&Object.hasOwnProperty.call(e,"csi")&&t.uint32(88).uint32(e.csi),t},s.encodeDelimited=function(e,t){return this.encode(e,t).ldelim()},s.decode=function(e,r){e instanceof t||(e=t.create(e));for(var i=void 0===r?e.len:e.pos+r,s=new n.simulcast.MediaSubscribe;e.pos<i;){var o=e.uint32();switch(o>>>3){case 1:s.ssrc=e.uint32();break;case 2:s.uuid=e.string();break;case 3:s.codecType=e.int32();break;case 4:s.minLevel=e.uint32();break;case 5:s.maxLevel=e.uint32();break;case 6:s.policy=e.int32();break;case 7:s.framerate=e.uint32();break;case 8:s.enable=e.bool();break;case 9:s.targetKbps=e.uint32();break;case 10:s.count=e.uint32();break;case 11:s.csi=e.uint32();break;default:e.skipType(7&o)}}return s},s.decodeDelimited=function(e){return e instanceof t||(e=new t(e)),this.decode(e,e.uint32())},s.verify=function(e){if("object"!=typeof e||null===e)return"object expected";if(null!=e.ssrc&&e.hasOwnProperty("ssrc")&&!i.isInteger(e.ssrc))return"ssrc: integer expected";if(null!=e.uuid&&e.hasOwnProperty("uuid")&&!i.isString(e.uuid))return"uuid: string expected";if(null!=e.codecType&&e.hasOwnProperty("codecType"))switch(e.codecType){default:return"codecType: enum value expected";case 0:case 1:case 2:}if(null!=e.minLevel&&e.hasOwnProperty("minLevel")&&!i.isInteger(e.minLevel))return"minLevel: integer expected";if(null!=e.maxLevel&&e.hasOwnProperty("maxLevel")&&!i.isInteger(e.maxLevel))return"maxLevel: integer expected";if(null!=e.policy&&e.hasOwnProperty("policy"))switch(e.policy){default:return"policy: enum value expected";case 0:case 1:}return null!=e.framerate&&e.hasOwnProperty("framerate")&&!i.isInteger(e.framerate)?"framerate: integer expected":null!=e.enable&&e.hasOwnProperty("enable")&&"boolean"!=typeof e.enable?"enable: boolean expected":null!=e.targetKbps&&e.hasOwnProperty("targetKbps")&&!i.isInteger(e.targetKbps)?"targetKbps: integer expected":null!=e.count&&e.hasOwnProperty("count")&&!i.isInteger(e.count)?"count: integer expected":null!=e.csi&&e.hasOwnProperty("csi")&&!i.isInteger(e.csi)?"csi: integer expected":null},s.fromObject=function(e){if(e instanceof n.simulcast.MediaSubscribe)return e;var t=new n.simulcast.MediaSubscribe;switch(null!=e.ssrc&&(t.ssrc=e.ssrc>>>0),null!=e.uuid&&(t.uuid=String(e.uuid)),e.codecType){default:if("number"==typeof e.codecType){t.codecType=e.codecType;break}break;case"INVAILD_CODECTYPE":case 0:t.codecType=0;break;case"H264":case 1:t.codecType=1;break;case"H265":case 2:t.codecType=2}switch(null!=e.minLevel&&(t.minLevel=e.minLevel>>>0),null!=e.maxLevel&&(t.maxLevel=e.maxLevel>>>0),e.policy){default:if("number"==typeof e.policy){t.policy=e.policy;break}break;case"ACTIVE":case 0:t.policy=0;break;case"USER":case 1:t.policy=1}return null!=e.framerate&&(t.framerate=e.framerate>>>0),null!=e.enable&&(t.enable=Boolean(e.enable)),null!=e.targetKbps&&(t.targetKbps=e.targetKbps>>>0),null!=e.count&&(t.count=e.count>>>0),null!=e.csi&&(t.csi=e.csi>>>0),t},s.toObject=function(e,t){t||(t={});var r={};return t.defaults&&(r.ssrc=0,r.uuid="",r.codecType=t.enums===String?"INVAILD_CODECTYPE":0,r.minLevel=0,r.maxLevel=0,r.policy=t.enums===String?"ACTIVE":0,r.framerate=0,r.enable=!1,r.targetKbps=0,r.count=0,r.csi=0),null!=e.ssrc&&e.hasOwnProperty("ssrc")&&(r.ssrc=e.ssrc),null!=e.uuid&&e.hasOwnProperty("uuid")&&(r.uuid=e.uuid),null!=e.codecType&&e.hasOwnProperty("codecType")&&(r.codecType=t.enums===String?void 0===n.simulcast.MediaSubscribe.CodecType[e.codecType]?e.codecType:n.simulcast.MediaSubscribe.CodecType[e.codecType]:e.codecType),null!=e.minLevel&&e.hasOwnProperty("minLevel")&&(r.minLevel=e.minLevel),null!=e.maxLevel&&e.hasOwnProperty("maxLevel")&&(r.maxLevel=e.maxLevel),null!=e.policy&&e.hasOwnProperty("policy")&&(r.policy=t.enums===String?void 0===n.simulcast.MediaSubscribe.SubPolicy[e.policy]?e.policy:n.simulcast.MediaSubscribe.SubPolicy[e.policy]:e.policy),null!=e.framerate&&e.hasOwnProperty("framerate")&&(r.framerate=e.framerate),null!=e.enable&&e.hasOwnProperty("enable")&&(r.enable=e.enable),null!=e.targetKbps&&e.hasOwnProperty("targetKbps")&&(r.targetKbps=e.targetKbps),null!=e.count&&e.hasOwnProperty("count")&&(r.count=e.count),null!=e.csi&&e.hasOwnProperty("csi")&&(r.csi=e.csi),r},s.prototype.toJSON=function(){return this.constructor.toObject(this,e.util.toJSONOptions)},s.getTypeUrl=function(e){return void 0===e&&(e="type.googleapis.com"),e+"/simulcast.MediaSubscribe"},s.SubPolicy=function(){var e={},t=Object.create(e);return t[e[0]="ACTIVE"]=0,t[e[1]="USER"]=1,t}(),s.CodecType=function(){var e={},t=Object.create(e);return t[e[0]="INVAILD_CODECTYPE"]=0,t[e[1]="H264"]=1,t[e[2]="H265"]=2,t}(),s}(),s.MessageSyncNotification=function(){function s(e){if(this.body={},e)for(var t=Object.keys(e),r=0;r<t.length;++r)null!=e[t[r]]&&(this[t[r]]=e[t[r]])}return s.prototype.endpoint="",s.prototype.body=i.emptyObject,s.create=function(e){return new s(e)},s.encode=function(e,t){if(t||(t=r.create()),null!=e.endpoint&&Object.hasOwnProperty.call(e,"endpoint")&&t.uint32(10).string(e.endpoint),null!=e.body&&Object.hasOwnProperty.call(e,"body"))for(var i=Object.keys(e.body),n=0;n<i.length;++n)t.uint32(18).fork().uint32(10).string(i[n]).uint32(18).string(e.body[i[n]]).ldelim();return t},s.encodeDelimited=function(e,t){return this.encode(e,t).ldelim()},s.decode=function(e,r){e instanceof t||(e=t.create(e));for(var s,o,a=void 0===r?e.len:e.pos+r,c=new n.simulcast.MessageSyncNotification;e.pos<a;){var u=e.uint32();switch(u>>>3){case 1:c.endpoint=e.string();break;case 2:c.body===i.emptyObject&&(c.body={});var h=e.uint32()+e.pos;for(s="",o="";e.pos<h;){var d=e.uint32();switch(d>>>3){case 1:s=e.string();break;case 2:o=e.string();break;default:e.skipType(7&d)}}c.body[s]=o;break;default:e.skipType(7&u)}}return c},s.decodeDelimited=function(e){return e instanceof t||(e=new t(e)),this.decode(e,e.uint32())},s.verify=function(e){if("object"!=typeof e||null===e)return"object expected";if(null!=e.endpoint&&e.hasOwnProperty("endpoint")&&!i.isString(e.endpoint))return"endpoint: string expected";if(null!=e.body&&e.hasOwnProperty("body")){if(!i.isObject(e.body))return"body: object expected";for(var t=Object.keys(e.body),r=0;r<t.length;++r)if(!i.isString(e.body[t[r]]))return"body: string{k:string} expected"}return null},s.fromObject=function(e){if(e instanceof n.simulcast.MessageSyncNotification)return e;var t=new n.simulcast.MessageSyncNotification;if(null!=e.endpoint&&(t.endpoint=String(e.endpoint)),e.body){if("object"!=typeof e.body)throw TypeError(".simulcast.MessageSyncNotification.body: object expected");t.body={};for(var r=Object.keys(e.body),i=0;i<r.length;++i)t.body[r[i]]=String(e.body[r[i]])}return t},s.toObject=function(e,t){t||(t={});var r,i={};if((t.objects||t.defaults)&&(i.body={}),t.defaults&&(i.endpoint=""),null!=e.endpoint&&e.hasOwnProperty("endpoint")&&(i.endpoint=e.endpoint),e.body&&(r=Object.keys(e.body)).length){i.body={};for(var n=0;n<r.length;++n)i.body[r[n]]=e.body[r[n]]}return i},s.prototype.toJSON=function(){return this.constructor.toObject(this,e.util.toJSONOptions)},s.getTypeUrl=function(e){return void 0===e&&(e="type.googleapis.com"),e+"/simulcast.MessageSyncNotification"},s}(),s}(),n}(requireMinimal()))}(simulproto$1);var simulproto=simulprotoExports,e$1=_mergeNamespaces({__proto__:null,default:simulproto},[simulprotoExports]);const{simulcast:f$1}=e$1;class ChannelHelper{constructor(e){let{peer:t}=e;this.Si=new Map,this.ki=0,this.Ei=0,this.xi=1,this.Ci=1e3,this.Ai=1400,this._i=1e3,this.J=a$9(),this.Ti=new Map,this.Ri=new Map,this.on=(e,t)=>(this.J.on(e,t),this),this.Oi=()=>{this.sendVideoSubscribeActiveType(),this.Vt.off(PeerEvents.DataChannelOpen,this.Oi)},this.Ii=e=>{if("string"==typeof e)return void channelLogger.info(e);const t=new Uint8Array(e),r=f$1.SimulReliable.decode(t);if(r.type===f$1.SimulReliable.MessageType.kSimulAck)return void(this.Ti.has(r.ack)?(this.J.all.forEach(((e,t)=>{const i=t.toString();i.includes("SubscribeVideo")&&Number(i.replace("SubscribeVideo-",""))<=r.ack&&this.J.emit(i)})),channelLogger.info("received subscribe video ack",r)):this.Ri.has(r.ack)?(this.J.all.forEach(((e,t)=>{const i=t.toString();i.includes("SubscribeShare")&&Number(i.replace("SubscribeShare-",""))<=r.ack&&this.J.emit(i)})),channelLogger.info("received subscribe share ack",r)):channelLogger.debug("received simul ack",r));if(this.ji(r.index),r.sliceNum<=1)return void this.Mi(r.body,r.type,r.index);let i=[];if(i=this.Si.get(r.dataIndex)||[],i)for(const e of i)if(e.index===r.sliceIndex)return;const n={index:r.sliceIndex,body:r.body};let s=!1;if(i.length>0)for(let e=0;e<i.length;++e)if((i[e].index||0)>r.sliceIndex){i.splice(e,0,n),s=!0;break}if(!1===s&&i.push(n),i.length!==r.sliceNum)return void this.Si.set(r.dataIndex,i);let o=new Uint8Array;for(const e of i)o=new Uint8Array([...o,...e.body]);this.Mi(o,r.type,r.index),this.Si.delete(r.dataIndex)},this.ji=e=>{var t;const r=new f$1.SimulReliable;r.type=f$1.SimulReliable.MessageType.kSimulAck,r.ack=e;const i=f$1.SimulReliable.encode(r).finish();this.ki=e,null===(t=this.Vt)||void 0===t||t.sendData(i)},this.qi=e=>{const t=f$1.DtlsSubscribeNotification.decode(e);channelLogger.debug(`kDtlsSubscribeNotification: id= ${t.id}, mtype= ${t.mtype}, subs= ${t.subs}, type= ${t.type}, ackId= ${t.ackId}`),t.type===f$1.DtlsSubscribeNotification.MessageType.REFRESH?(t.id>this.Ei&&(this.Ei=t.id,this.J.emit(EndpointEvents.DtlsSubscribeNotification,t)),this.Ni(t.id)):t.type===f$1.DtlsSubscribeNotification.MessageType.ACK&&channelLogger.debug(`handle Subscribe ACK id: ${t.id}, ackId: ${t.ackId}, currentAckId: ${this.Ei}`)},this.Pi=(e,t)=>{this.Ci++;const r=Math.ceil(e.byteLength/this.Ai);if(1===r)return void this.Di(r,0,this.Ci,e,t);let i=0;const n=e.byteLength;let s=0;for(;i<n;){const e=new Uint8Array(this.Ai);n-i>this.Ai?(e.subarray(i,i+this.Ai),i+=this.Ai):(e.subarray(i,n),i=n),this.Di(r,s,this.Ci,e,t),s++}channelLogger.warn("body数据超过1400,需要分片"),channelLogger.info("data body length: "+e.byteLength)},this.Di=(e,t,r,i,n)=>{var s;const o=new f$1.SimulReliable;o.index=this._i,o.ack=this.ki,o.type=n,o.body=i,o.sliceNum=e,o.sliceIndex=t,o.dataIndex=r;const a=f$1.SimulReliable.encode(o).finish();null===(s=this.Vt)||void 0===s||s.sendData(a),this._i++},this.sendSubscribe=async e=>{let{mediaType:t,subs:r}=e;const i=this._i;channelLogger.info("send subscribe",i);const n=t===f$1.DtlsSubscribe.MediaType.VIDEO;n?(this.Ti.set(i,i),channelLogger.debug("send subscribe video",r)):(this.Ri.set(i,i),channelLogger.debug("send subscribe share",r)),new f$1.DtlsSubscribe;const s=new f$1.DtlsSubscribe;s.ackId=++this.Ei,s.id=this.Ei,s.mediaType=t,s.type=f$1.DtlsSubscribe.MessageType.REFRESH,s.subs=r;const o=f$1.DtlsSubscribe.encode(s).finish();this.Pi(o,f$1.SimulReliable.MessageType.kDtlsSubscribeNotification);const a=`Subscribe${n?"Video":"Share"}-${i}`;let c;return Promise.race([new Promise(((e,t)=>{const r=()=>{this.J.off(a,r),n?this.Ti.delete(i):this.Ri.delete(i),window.clearTimeout(c),e()};this.J.on(a,r)})),new Promise(((e,t)=>{c=window.setTimeout((()=>{n?this.Ti.delete(i):this.Ri.delete(i),this.J.all.delete(a),t(new Error("request timeout"))}),500)}))])},this.Vt=t,this.Vt.on(PeerEvents.DataChannelMessage,this.Ii),this.Vt.on(PeerEvents.DataChannelOpen,this.Oi)}Mi(e,t,r){let i;switch(t){case f$1.SimulReliable.MessageType.kSimulSubscribe:i=f$1.SimulSubscribe.decode(e),this.J.emit(EndpointEvents.SimulSubscribe,i);break;case f$1.SimulReliable.MessageType.kSimulNotification:break;case f$1.SimulReliable.MessageType.kForwardNotification:i=f$1.ForwardNotification.decode(e),channelLogger.debug("kForwardNotification:",i.forwards),this.J.emit(EndpointEvents.ForwardNotification,{data:i,index:r});break;case f$1.SimulReliable.MessageType.kQualityNotification:i=f$1.QualityNotification.decode(e);for(const e of i.qualityInfos)channelLogger.debug(`kQualityNotification: ssrc= ${e.ssrc}, csrc= ${e.csrc}, actualMbps= ${e.actualMbps}, satisfied= ${e.satisfied}, type= ${e.type}`);this.J.emit(EndpointEvents.QualityNotification,i);break;case f$1.SimulReliable.MessageType.kMuteStateNotification:case f$1.SimulReliable.MessageType.kDesktopSimulNotifiction:break;case f$1.SimulReliable.MessageType.kRecvStreamSSRCNotification:i=f$1.RecvStreamSSRCNotification.decode(e),channelLogger.debug(`kRecvStreamSSRCNotification: endpoint= ${i.endpoint}, type= ${i.type}, ssrcs= ${i.ssrcs}`),this.J.emit(EndpointEvents.RecvStreamSSRCNotification,i);break;case f$1.SimulReliable.MessageType.kActiveAudiosNotification:i=f$1.ActiveAudiosNotification.decode(e),this.J.emit(EndpointEvents.ActiveAudiosNotification,i);break;case f$1.SimulReliable.MessageType.kEndpointSyncNotification:case f$1.SimulReliable.MessageType.kShareSyncNotification:break;case f$1.SimulReliable.MessageType.kDtlsSubscribeNotification:this.qi(e);break;case f$1.SimulReliable.MessageType.kVideoSyncNotification:break;case f$1.SimulReliable.MessageType.kMediaNetworkStatusNotification:i=f$1.MediaNetworkStatusNotification.decode(e),channelLogger.debug(`kMediaNetworkStatusNotification: endpoint= ${i.endpoint}, mediaType= ${i.mediaType}, status= ${i.status}`),this.J.emit(EndpointEvents.MediaNetworkStatusNotification,i);break;case f$1.SimulReliable.MessageType.kFocusVideoNotification:case f$1.SimulReliable.MessageType.kDesktopResolutionLimitNotification:break;case f$1.SimulReliable.MessageType.KRSSNRNotification:i=f$1.RSSNRNotification.decode(e),channelLogger.debug(`KRSSNRNotification: layers= ${i.layers}`),this.J.emit(EndpointEvents.RSSNRNotification,i)}}Ni(e){const t=new f$1.DtlsSubscribeNotification;t.id=this.xi++,t.ackId=e,t.type=f$1.DtlsSubscribeNotification.MessageType.ACK,t.mtype=f$1.DtlsSubscribeNotification.mediaType.MEDIA_UNDEFINED;const r=f$1.DtlsSubscribeNotification.encode(t).finish();this.Pi(r,f$1.SimulReliable.MessageType.kDtlsSubscribeNotification)}sendVideoSubscribeActiveType(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:f$1.VideoSyncNotification.VideoSubscribeActiveType.VideoSubcribeActiveWithSelfNotify;const t=new f$1.VideoSyncNotification;t.activeSubType=e;const r=f$1.VideoSyncNotification.encode(t).finish();this.Pi(r,f$1.SimulReliable.MessageType.kVideoSyncNotification)}}class SocketHandler{constructor(e){this.Le={},this.te=e.socket,this.Be=e.model,this.Vt=e.peer,this.J=e.emitter}registerSocketEvent(){this.te.onAll(((e,t)=>{const r=this.Le[e];if("function"==typeof r){const e=r(t);this.J.emit(e[0],e[1])}}))}}function bindTrackEvent(e,t){for(const[r,i]of Object.entries(t))e.on(r,i)}function unbindTrackEvent(e,t){for(const[r,i]of Object.entries(t))e.off(r,i)}var I;function K(e){return e&&{motion:"maintain-framerate",detail:"maintain-resolution",text:"maintain-resolution"}[e]||"balanced"}function L(e,t){return e+(void 0===t?"":"_"+t.toString())}!function(e){e[e.lv270=21]="lv270",e[e.lv360=30]="lv360",e[e.lv720=31]="lv720",e[e.lv1080=41]="lv1080",e[e.lv1440=50]="lv1440",e[e.lv2160=51]="lv2160"}(I||(I={}));const M=new Map([[exports.Resolution.rs270,I.lv270],[exports.Resolution.rs360,I.lv360],[exports.Resolution.rs720,I.lv720],[exports.Resolution.rs1080,I.lv1080],[exports.Resolution.rs1440,I.lv1440],[exports.Resolution.rs2160,I.lv2160]]);function N(e){return M.get(e)||I.lv360}class Agent{constructor(e){this.J=a$9(),this.Li=new Map,this.Bi=new Map,this.Fi=new Map,this.ee=-1,this.Hi=async()=>{await API.RSC.de({path:{sessionId:this.Be.sessionId,endpointId:this.Be.endpointId},headers:{"x-endpoint-id":this.Be.endpointId}})},this.Ui=async()=>{await API.RSC.fe({path:{sessionId:this.Be.sessionId,endpointId:this.Be.endpointId},headers:{"x-endpoint-id":this.Be.endpointId}})},this.Vi=async()=>{await API.RSC.$e({path:{sessionId:this.Be.sessionId,endpointId:this.Be.endpointId},headers:{"x-endpoint-id":this.Be.endpointId}})},this.Gi=async()=>{await API.RSC.Se({path:{sessionId:this.Be.sessionId,endpointId:this.Be.endpointId},headers:{"x-endpoint-id":this.Be.endpointId}})},this.changeMode=async(e,t)=>{await API.RSC.ke({path:{sessionId:this.Be.sessionId},data:{viewState:e,presenter:this.Be.endpointId,excludeEndpoints:null==t?void 0:t.excludeEndpoints},headers:{"x-endpoint-id":this.Be.endpointId}})},this.Ki=async()=>{this.Wi(),await this.Hi()},this.zi=async()=>{try{await this.Ki()}finally{this.Xi=void 0}},this.Ji=async()=>{this.Xi&&(await this.Ui(),this.Yi())},this.Yi=()=>{this.Xi&&(this.Vt.setLocalAudio(this.Xi.publishMediaStreamTrack),this.Xi.__published=!0)},this.Wi=()=>{this.Xi&&(this.Vt.removeTrack(this.Xi.publishMediaStreamTrack),this.Xi.__published=!1)},this.Zi=async()=>{this.Qi(),await this.Vi()},this.en=async()=>{try{await this.Zi()}finally{this.tn=void 0}},this.rn=async()=>{this.tn&&(await this.Gi(),this.sn())},this.sn=()=>{this.tn&&(this.Vt.setLocalVideo(this.tn.publishMediaStreamTrack,K(this.tn.optimizationMode)),this.tn.__published=!0)},this.Qi=()=>{this.tn&&(this.Vt.removeTrack(this.tn.publishMediaStreamTrack),this.tn.__published=!1)},this.an=()=>{this.tn&&this.Vt.applySendParameters({type:"video",degradationPreference:K(this.tn.optimizationMode)})},this.cn=async()=>{this.un&&(await this.changeMode(exports.ViewState.Share),this.hn())},this.dn=async()=>{agentLogger.info("share disabled"),this.ln(),this.Be.roomState.viewState===exports.ViewState.Share&&this.Be.roomState.presenter===this.Be.endpointId&&await this.changeMode(exports.ViewState.Video)},this.pn=async()=>{try{await this.dn()}finally{this.un=void 0}},this.hn=()=>{this.un&&(this.Vt.setLocalShareVideo(this.un.publishMediaStreamTrack,K(this.un.optimizationMode)),this.un.__published=!0)},this.ln=()=>{this.un&&(this.Vt.removeTrack(this.un.publishMediaStreamTrack),this.un.__published=!1)},this.vn=()=>{this.un&&this.Vt.applySendParameters({type:"video",degradationPreference:K(this.un.optimizationMode)})},this.bn=async()=>{if(this.tn)try{this.Vt.removeTrack(this.tn.publishMediaStreamTrack)}finally{this.tn=void 0}},this.mn=()=>{this.gn&&(this.Vt.setLocalShareAudio(this.gn.publishMediaStreamTrack),this.gn.__published=!0)},this.yn=()=>{this.gn&&(this.Vt.removeTrack(this.gn.publishMediaStreamTrack),this.gn.__published=!1)},this.publish=async e=>{if(e.audio){const t=Date.now();await this.Ui(),await this.Vt.setLocalAudio(e.audio.publishMediaStreamTrack)&&(this.Xi&&(this.Xi.__published=!1,this.wn(!1,"audio")),this.Xi=e.audio,this.Xi.__published=!0,this.wn(!0,"audio")),metrics.post(Events.UNMUTE_AUDIO,{consume:Date.now()-t})}if(e.video){const t=Date.now();await this.Gi(),await this.Vt.setLocalVideo(e.video.publishMediaStreamTrack,K(e.video.optimizationMode))&&(this.tn&&(this.tn.__published=!1,this.wn(!1,"video")),this.tn=e.video,this.tn.__published=!0,this.wn(!0,"video")),metrics.post(Events.UNMUTE_VIDEO,{consume:Date.now()-t})}if(e.share){if(e.share.video){const t=Date.now();await this.changeMode(exports.ViewState.Share,e.share.options),await this.Vt.setLocalShareVideo(e.share.video.publishMediaStreamTrack,K(e.share.video.optimizationMode))&&(this.un&&(this.un.__published=!1,this.wn(!1,"shareVideo")),this.un=e.share.video,this.un.__published=!0,this.wn(!0,"shareVideo"),metrics.post(Events.OPEN_DESKTOP_SHARE_QUALITY_MODE,{consume:Date.now()-t})),metrics.post(Events.OPEN_AUDIO_SHARE,{consume:Date.now()-t})}if(e.share.audio){const t=Date.now();await this.Vt.setLocalShareAudio(e.share.audio.publishMediaStreamTrack)&&(this.gn&&(this.gn.__published=!1,this.wn(!1,"shareAudio")),this.gn=e.share.audio,this.gn.__published=!0,this.wn(!0,"shareAudio")),metrics.post(Events.OPEN_AUDIO_SHARE,{consume:Date.now()-t})}}},this.unpublish=async e=>{if(e.audio){const t=Date.now();(e.audio instanceof MicrophoneAudioTrack||e.audio instanceof LocalAudioTrack)&&this.Xi&&this.Xi!==e.audio&&agentLogger.warn("unpublish audio track not match, but continue unpublish"),this.Xi&&this.Vt.removeTrack(this.Xi.publishMediaStreamTrack)&&(this.Xi.__published=!1,this.wn(!1,"audio"),this.Xi=void 0),await this.Hi(),metrics.post(Events.MUTE_AUDIO,{consume:Date.now()-t})}if(e.video){const t=Date.now();(e.video instanceof CameraVideoTrack||e.video instanceof LocalVideoTrack)&&this.tn&&this.tn!==e.video&&agentLogger.warn("unpublish video track not match, but continue unpublish"),this.tn&&this.Vt.removeTrack(this.tn.publishMediaStreamTrack)&&(this.tn.__published=!1,this.wn(!1,"video"),this.tn=void 0),await this.Vi(),metrics.post(Events.MUTE_VIDEO,{consume:Date.now()-t})}if(e.share){const t=Date.now();(e.share.video instanceof ScreenVideoTrack||e.share.video instanceof ElectronScreenVideoTrack||e.share.video instanceof LocalVideoTrack)&&this.un&&this.un!==e.share.video&&agentLogger.warn("unpublish share video track not match, but continue unpublish"),(e.share.audio instanceof ScreenAudioTrack||e.share.audio instanceof LocalAudioTrack)&&this.gn&&this.gn!==e.share.audio&&agentLogger.warn("unpublish share audio track not match, but continue unpublish"),e.share.audio&&this.gn&&this.Vt.removeTrack(this.gn.publishMediaStreamTrack)&&(this.gn.__published=!1,this.wn(!1,"shareAudio"),this.gn=void 0,metrics.post(Events.CLOSE_AUDIO_SHARE,{})),e.share.video&&this.un&&this.Vt.removeTrack(this.un.publishMediaStreamTrack)&&(this.un.__published=!1,this.wn(!1,"shareVideo"),this.un=void 0,await this.changeMode(exports.ViewState.Video),metrics.post(Events.CLOSE_DESKTOP_SHARE,{consume:Date.now()-t}))}},this.unsubscribeShare=()=>{if(this.$n){const e=Date.now(),t=this.Sn;this.Sn=void 0;try{this.kn.sendSubscribe({mediaType:simulprotoExports.simulcast.DtlsSubscribe.MediaType.SHARE,subs:[]}),this.Vt.releaseShareSSRC(),this.$n.track.close(),this.Fi.delete(this.$n.ssrc),this.$n=void 0}catch(e){throw t&&(this.Sn=t),e}finally{metrics.post(Events.CANCEL_RECEIVE_DESKTOP_SHARE,{consume:Date.now()-e})}}},this.En=async e=>{if("audio"==e.track.kind)if("0"===e.transceiver.mid)this.xn=new RemoteAudioTrack(e.streams[0].getAudioTracks()[0],e.streams[0]),this.J.emit(AgentEventType.ON_AUDIO_TRACK_ADD,{type:"audio",track:this.xn});else if("1"===e.transceiver.mid)this.Cn=new RemoteAudioTrack(e.track,e.streams[0]),this.J.emit(AgentEventType.ON_AUDIO_TRACK_ADD,{type:"shareAudio",track:this.Cn});else{const t=document.createElement("audio");t.volume=1,t.autoplay=!0,t.hidden=!0,t.srcObject=e.streams[0];try{await t.play(),agentLogger.info("audio play success")}catch(e){agentLogger.error("audio play fail",e)}}},this.Be=e.model,this.Vt=new Peer(e.model),this.ee=e.ownerId,this.kn=new ChannelHelper({peer:this.Vt}),this.registerChannelEvent(this.kn);let t="new";this.Vt.on(PeerEvents.RemoteStreamAdded,this.En).on(PeerEvents.ConnectionState,(e=>{peerLogger.info(this.ee,"ice connection state",e),"connected"===e?metrics.post(["new","connecting"].includes(t)?Events.ICE_CONNECTED:Events.ICE_RECONNECTED,{}):"disconnected"===e&&metrics.post(Events.ICE_DISCONNECTED,{}),"new"!==e&&this.J.emit(AgentEventType.MEDIA_STATE_CHANGE,{state:e}),t=e})).on(PeerEvents.NetworkQuality,(e=>{this.J.emit(AgentEventType.NETWORK_QUALITY,e)})).on(PeerEvents.RTCStats,(e=>{this.J.emit(AgentEventType.RTC_STATS,e)}))}registerChannelEvent(e){e.on(EndpointEvents.ActiveAudiosNotification,(e=>{this.J.emit(AgentEventType.ACTIVE_AUDIO_UPDATED,e.endpoints)})).on(EndpointEvents.ForwardNotification,(e=>{let{data:t}=e;const r=this.Li.get(ActiveVideoUuid);if(t.forwards)for(const e of t.forwards){e.ssrc&&this.Fi.set(e.ssrc,e),r&&e.ssrc===r.ssrc&&e.srcEndpointpId&&r.track.videoActiveForwardedChange({endpointId:e.srcEndpointpId,forward:!!e.forward});for(const t of this.Li.values())if(t.ssrc===e.ssrc){t.track.videoForwardChange(!!e.forward);break}}})).on(EndpointEvents.SimulSubscribe,(e=>{if(e.mediaType===simulprotoExports.simulcast.SimulSubscribe.MediaType.VIDEO){const t=new Map([[180,!1],[360,!1],[720,!1]]);for(const r of e.layers)r.enable&&r.mbps&&t.set(r.mbps,!0);this.Vt.changeSimulcast(t);const r={};[...t.entries()].forEach(((e,t)=>{e[1]&&(r["subscribeLayer"+t]=e[0])})),metrics.post(Events.SIMULCAST_CHANGED,r)}}))}registerSocketEvent(e){this.Ut=new SocketHandler({socket:e,peer:this.Vt,model:this.Be,emitter:this.J}),this.Ut.registerSocketEvent()}async join(e){let{videoMute:t=!1,audioMute:r=!1,nickname:i,avatar:n,deviceSn:s,code:o="",masterPassword:a="",password:c=""}=e;const u=Date.now(),h=await this.Vt.createOffer(),d={mediaOpts:{sdp:window.btoa((null==h?void 0:h.sdp)||""),isAudioMute:r,isVideoMute:t},features:{uniquestream:!1},ssl:!1,endpointInfo:{nickname:i||"default",headImage:n,platform:6,deviceSn:s},sessionInfo:{code:o,masterPassword:a,password:c},returnEndpointSize:1e3},{data:f}=await(o?API.RSC.ce({data:d}):API.RSC.ue({data:d}));return this.Be.updateRoomState({sessionId:f.session.id,roomCode:f.session.code}).updateSelfState({endpointId:f.endpoint.id,userId:f.endpoint.userId,nickName:f.endpoint.nickname,mediaOpts:f.endpoint.mediaOpts}),await this.Vt.handleAnswer(window.atob(f.sdp)),await this.Vt.addSdpCandidate(),this.Li=new Map,this.$n=void 0,this.Bi=new Map,this.Sn=void 0,this.Fi=new Map,this.Be.setMembers(f.session.endpoints.data),metrics.post(Events.JOIN_CONFERENCE,{consume:Date.now()-u}),"open"!==this.Vt.datachannelState&&await new Promise((e=>{const t=()=>{e(),this.Vt.off(PeerEvents.DataChannelOpen,t)};this.Vt.on(PeerEvents.DataChannelOpen,t)})),f}async leave(){return await API.RSC.le({path:{sessionId:this.Be.sessionId,endpointId:this.Be.endpointId},headers:{"x-endpoint-id":this.Be.endpointId}})}wn(e,t){if(e)switch(t){case"audio":if(this.Xi)return void bindTrackEvent(this.Xi,{unmuted:this.Ji,enabled:this.Ji,muted:this.Ki,disabled:this.Ki,"source-changed":this.Yi,"track-ended":this.Wi,closed:this.zi});break;case"video":if(this.tn)return void bindTrackEvent(this.tn,{unmuted:this.rn,enabled:this.rn,muted:this.Zi,disabled:this.Zi,"source-changed":this.sn,"track-ended":this.Qi,closed:this.en,"optimization-mode-changed":this.an});break;case"shareAudio":if(this.gn)return void bindTrackEvent(this.gn,{unmuted:this.mn,muted:this.yn,enabled:this.mn,disabled:this.yn,"source-changed":this.mn,"track-ended":this.yn,closed:this.bn});break;case"shareVideo":if(this.un)return void bindTrackEvent(this.un,{unmuted:this.cn,muted:this.dn,enabled:this.cn,disabled:this.dn,"source-changed":this.hn,"track-ended":this.dn,closed:this.pn,"optimization-mode-changed":this.vn})}else switch(t){case"audio":if(this.Xi)return void unbindTrackEvent(this.Xi,{unmuted:this.Ji,enabled:this.Ji,muted:this.Ki,disabled:this.Ki,"source-changed":this.Yi,"track-ended":this.Wi,closed:this.zi});break;case"video":if(this.tn)return void unbindTrackEvent(this.tn,{unmuted:this.rn,enabled:this.rn,muted:this.Zi,disabled:this.Zi,"source-changed":this.sn,"track-ended":this.Qi,closed:this.en,"optimization-mode-changed":this.an});break;case"shareAudio":if(this.gn)return void unbindTrackEvent(this.gn,{unmuted:this.mn,muted:this.yn,enabled:this.mn,disabled:this.yn,"source-changed":this.mn,"track-ended":this.yn,closed:this.bn});break;case"shareVideo":if(this.un)return void unbindTrackEvent(this.un,{unmuted:this.cn,muted:this.dn,enabled:this.cn,disabled:this.dn,"source-changed":this.hn,"track-ended":this.ln,closed:this.pn,"optimization-mode-changed":this.vn})}agentLogger.warn("operate track event with no published track",e,t)}async dismiss(){return await API.RSC.pe({path:{sessionId:this.Be.sessionId},headers:{"x-endpoint-id":this.Be.endpointId}})}async ai(e,t){let r=[];if(e===ShareUuid)this.Sn&&(this.Sn.maxLevel=N(t),r.push(this.Sn));else{const i=this.Bi.get(e);i&&(i.maxLevel=N(t),r=[...this.Bi.values()])}r.length&&await this.kn.sendSubscribe({mediaType:e===ShareUuid?simulprotoExports.simulcast.DtlsSubscribe.MediaType.SHARE:simulprotoExports.simulcast.DtlsSubscribe.MediaType.VIDEO,subs:r})}async subscribeVideo(e){if(e.find((e=>e.endpointId===this.Be.endpointId)))throw new MError(exports.ErrorCode.CanNotSubscribeYourself,"can’t subscribe yourself");const t=[],r=[];e.forEach(((e,i)=>{const n=this.Li.get(L(e.endpointId,e.captureSourceId));n?t.push({track:n.track,index:i}):r.push({...e,index:i})}));const i=this.Vt.getIdleVideoReceivers();if(i.length<r.length)throw new MError(exports.ErrorCode.SubscriptionExceedsRestrictions,"subscription exceeds restrictions, please unsubscribe");if(i.find((e=>!e.stream)))throw new MError(exports.ErrorCode.PeerTrackNotReady,"peer track not ready");try{return r.length&&(r.forEach(((e,t)=>{let{resolution:r,endpointId:n,captureSourceId:s}=e;const o=i[t];o.used=!0,this.Bi.set(L(n,s),{policy:simulprotoExports.simulcast.MediaSubscribe.SubPolicy.USER,ssrc:o.ssrc,fecSsrc:o.ssrc+1,rtxSsrc:o.ssrc+100,uuid:n,maxLevel:N(r),csi:s})})),await this.kn.sendSubscribe({mediaType:simulprotoExports.simulcast.DtlsSubscribe.MediaType.VIDEO,subs:[...this.Bi.values()]})),r.map(((e,t)=>{var r;let{endpointId:n,captureSourceId:s,resolution:o,index:a}=e;const c=L(n,s),u=i[t],h=u.stream.clone(),d=new RemoteMemberVideoTrack(h.getVideoTracks()[0],h,n,u.transceiver.receiver,this.ai.bind(this,c),null===(r=this.Be.membersMap.get(n))||void 0===r?void 0:r.options.videossrc,s);d.once("closed",(()=>{this.unsubscribeVideo([{endpointId:n,captureSourceId:s}])})),this.Li.set(c,{ssrc:u.ssrc,track:d});const f=this.Fi.get(u.ssrc);return f&&d.videoForwardChange(!!f.forward),metrics.post(Events.VIDEO_SUBSCRIBE,{remoteId:n,ssrc:u.ssrc.toString(),quality:o,streamIndex:s}),{index:a,track:d}})).concat(t).sort(((e,t)=>e.index-t.index)).map((e=>e.track))}catch(e){throw r.forEach((e=>{let{endpointId:t}=e;this.Bi.delete(t)})),this.Vt.releaseVideoSSRC(i.map((e=>e.ssrc))),e}}async subscribeActiveVideo(){var e;let t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:exports.Resolution.rs360;var r;if(null!==(e=this.Li.get(ActiveVideoUuid))&&void 0!==e&&e.track)return null===(r=this.Li.get(ActiveVideoUuid))||void 0===r?void 0:r.track;const i=this.Vt.getIdleVideoReceivers();if(i.length<1)throw new MError(exports.ErrorCode.SubscriptionExceedsRestrictions,"subscription exceeds restrictions, please unsubscribe");if(i.find((e=>!e.stream)))throw new MError(exports.ErrorCode.PeerTrackNotReady,"peer track not ready");const n=i[0];n.used=!0;try{this.Bi.set(ActiveVideoUuid,{policy:simulprotoExports.simulcast.MediaSubscribe.SubPolicy.ACTIVE,ssrc:n.ssrc,fecSsrc:n.ssrc+1,rtxSsrc:n.ssrc+100,maxLevel:N(t),uuid:"",csi:void 0}),await this.kn.sendSubscribe({mediaType:simulprotoExports.simulcast.DtlsSubscribe.MediaType.VIDEO,subs:[...this.Bi.values()]});const e=n.stream.clone();let r;const i=()=>{var e;const t=null===(e=n.transceiver)||void 0===e?void 0:e.receiver.getContributingSources();if(null!=t&&t.length&&r!==t[0].source){const e=this.Be.membersMap;for(const i of e.values())if(i.options.videossrc.includes(t[0].source))return r=t[0].source,{endpointId:i.endpointId,forward:!0}}},s=new RemoteActiveVideoTrack(e.getVideoTracks()[0],e,n.transceiver.receiver,i,this.ai.bind(this,ActiveVideoUuid));s.once("closed",this.unsubscribeActiveVideo.bind(this)),this.Li.set(ActiveVideoUuid,{ssrc:n.ssrc,track:s});const o=this.Fi.get(n.ssrc);return o&&(s.videoForwardChange(!!o.forward),s.videoActiveForwardedChange({endpointId:o.srcEndpointpId||"",forward:!!o.forward})),s}catch(e){throw this.Bi.delete(ActiveVideoUuid),this.Vt.releaseVideoSSRC([n.ssrc]),e}}async subscribeShare(e){var t;const r=this.Vt.getIdleShareReceiver();if(!r||!r.stream)throw new MError(exports.ErrorCode.PeerTrackNotReady,"peer track not ready");var i;if(null!==(t=this.$n)&&void 0!==t&&t.track)return null===(i=this.$n)||void 0===i?void 0:i.track;r.used=!0;const n=Date.now();try{this.Sn={ssrc:r.ssrc,fecSsrc:r.ssrc+1,rtxSsrc:r.ssrc+100,maxLevel:N(e)},await this.kn.sendSubscribe({mediaType:simulprotoExports.simulcast.DtlsSubscribe.MediaType.SHARE,subs:[this.Sn]});const t=r.stream.clone(),i=new RemoteScreenVideoTrack(t.getVideoTracks()[0],t,r.transceiver.receiver,this.ai.bind(this,ShareUuid));i.once("closed",this.unsubscribeShare.bind(this)),this.$n={ssrc:r.ssrc,track:i};const s=this.Fi.get(r.ssrc);s&&i.videoForwardChange(!!s.forward);const o=()=>{metrics.post(Events.DESKTOP_FIRST_FRAME,{rtt:Date.now()-n}),i.off("forward-state-change",o)};return i.on("forward-state-change",o),metrics.post(Events.SUBSCRIBE_DESKTOP,{isShare:!1,ssrc:r.ssrc.toString(),csrc:r.ssrc.toString(),...ResolutionRect[e]}),i}catch(e){throw this.Sn=void 0,this.Vt.releaseShareSSRC(),e}}unsubscribeVideo(e){const t=new Map;try{const r=[],i=[];if(e.forEach((e=>{let{endpointId:t,captureSourceId:n}=e;const s=L(t,n),o=this.Li.get(s);o&&(r.push({...o,id:s,endpointId:t,captureSourceId:n}),i.push({endpointId:t,captureSourceId:n}))})),r.length){const e=r.map((e=>{const r=this.Bi.get(e.id);return r&&t.set(e.id,r),this.Bi.delete(e.id),e.ssrc}));this.kn.sendSubscribe({mediaType:simulprotoExports.simulcast.DtlsSubscribe.MediaType.VIDEO,subs:[...this.Bi.values()]}),this.Vt.releaseVideoSSRC(e),r.forEach((e=>{e.track.close(),this.Li.delete(e.id),this.Fi.delete(e.ssrc),metrics.post(Events.VIDEO_UNSUBSCRIBE,{ssrc:e.ssrc.toString(),remoteId:e.endpointId.toString(),streamIndex:e.captureSourceId})}))}}catch(e){this.Bi=new Map([...this.Bi,...t])}}unsubscribeActiveVideo(){const e=this.Li.get(ActiveVideoUuid),t=this.Bi.get(ActiveVideoUuid);try{e&&t&&(this.Bi.delete(ActiveVideoUuid),this.kn.sendSubscribe({mediaType:simulprotoExports.simulcast.DtlsSubscribe.MediaType.VIDEO,subs:[...this.Bi.values()]}),this.Vt.releaseVideoSSRC([e.ssrc]),e.track.close(),this.Li.delete(e.track.uuid),this.Fi.delete(e.ssrc))}catch(e){t&&this.Bi.set(ActiveVideoUuid,t)}}on(e,t){this.J.on(e,t)}onAll(e){this.J.on("*",e)}destroy(){var e,t;this.Vt.close(),null===(e=this.Cn)||void 0===e||e.close(),null===(t=this.xn)||void 0===t||t.close(),this.Cn=void 0,this.xn=void 0}}var baseAssignValue=_baseAssignValue,eq$1=eq_1;function assignMergeValue$2(e,t,r){(void 0!==r&&!eq$1(e[t],r)||void 0===r&&!(t in e))&&baseAssignValue(e,t,r)}var _assignMergeValue=assignMergeValue$2;function createBaseFor$1(e){return function(t,r,i){for(var n=-1,s=Object(t),o=i(t),a=o.length;a--;){var c=o[e?a:++n];if(!1===r(s[c],c,s))break}return t}}var _createBaseFor=createBaseFor$1,createBaseFor=_createBaseFor,baseFor$1=createBaseFor(),_baseFor=baseFor$1,isArrayLike$1=isArrayLike_1,isObjectLike$1=isObjectLike_1;function isArrayLikeObject$1(e){return isObjectLike$1(e)&&isArrayLike$1(e)}var isArrayLikeObject_1=isArrayLikeObject$1,baseGetTag=_baseGetTag,getPrototype=_getPrototype,isObjectLike=isObjectLike_1,objectTag="[object Object]",funcProto=Function.prototype,objectProto=Object.prototype,funcToString=funcProto.toString,hasOwnProperty=objectProto.hasOwnProperty,objectCtorString=funcToString.call(Object);function isPlainObject$1(e){if(!isObjectLike(e)||baseGetTag(e)!=objectTag)return!1;var t=getPrototype(e);if(null===t)return!0;var r=hasOwnProperty.call(t,"constructor")&&t.constructor;return"function"==typeof r&&r instanceof r&&funcToString.call(r)==objectCtorString}var isPlainObject_1=isPlainObject$1;function safeGet$2(e,t){if(("constructor"!==t||"function"!=typeof e[t])&&"__proto__"!=t)return e[t]}var _safeGet=safeGet$2,copyObject=_copyObject,keysIn$1=keysIn_1;function toPlainObject$1(e){return copyObject(e,keysIn$1(e))}var toPlainObject_1=toPlainObject$1,assignMergeValue$1=_assignMergeValue,cloneBuffer=_cloneBufferExports,cloneTypedArray=_cloneTypedArray,copyArray=_copyArray,initCloneObject=_initCloneObject,isArguments=isArguments_1,isArray=isArray_1,isArrayLikeObject=isArrayLikeObject_1,isBuffer=isBufferExports,isFunction=isFunction_1,isObject$2=isObject_1,isPlainObject=isPlainObject_1,isTypedArray=isTypedArray_1,safeGet$1=_safeGet,toPlainObject=toPlainObject_1;function baseMergeDeep$1(e,t,r,i,n,s,o){var a=safeGet$1(e,r),c=safeGet$1(t,r),u=o.get(c);if(u)assignMergeValue$1(e,r,u);else{var h=s?s(a,c,r+"",e,t,o):void 0,d=void 0===h;if(d){var f=isArray(c),l=!f&&isBuffer(c),p=!f&&!l&&isTypedArray(c);h=c,f||l||p?isArray(a)?h=a:isArrayLikeObject(a)?h=copyArray(a):l?(d=!1,h=cloneBuffer(c,!0)):p?(d=!1,h=cloneTypedArray(c,!0)):h=[]:isPlainObject(c)||isArguments(c)?(h=a,isArguments(a)?h=toPlainObject(a):isObject$2(a)&&!isFunction(a)||(h=initCloneObject(c))):d=!1}d&&(o.set(c,h),n(h,c,i,s,o),o.delete(c)),assignMergeValue$1(e,r,h)}}var _baseMergeDeep=baseMergeDeep$1,Stack=_Stack,assignMergeValue=_assignMergeValue,baseFor=_baseFor,baseMergeDeep=_baseMergeDeep,isObject$1=isObject_1,keysIn=keysIn_1,safeGet=_safeGet;function baseMerge$1(e,t,r,i,n){e!==t&&baseFor(t,(function(s,o){if(n||(n=new Stack),isObject$1(s))baseMergeDeep(e,t,o,r,baseMerge$1,i,n);else{var a=i?i(safeGet(e,o),s,o+"",e,t,n):void 0;void 0===a&&(a=s),assignMergeValue(e,o,a)}}),keysIn)}var _baseMerge=baseMerge$1;function identity$2(e){return e}var identity_1=identity$2;function apply$1(e,t,r){switch(r.length){case 0:return e.call(t);case 1:return e.call(t,r[0]);case 2:return e.call(t,r[0],r[1]);case 3:return e.call(t,r[0],r[1],r[2])}return e.apply(t,r)}var _apply=apply$1,apply=_apply,nativeMax=Math.max;function overRest$1(e,t,r){return t=nativeMax(void 0===t?e.length-1:t,0),function(){for(var i=arguments,n=-1,s=nativeMax(i.length-t,0),o=Array(s);++n<s;)o[n]=i[t+n];n=-1;for(var a=Array(t+1);++n<t;)a[n]=i[n];return a[t]=r(o),apply(e,this,a)}}var _overRest=overRest$1;function constant$1(e){return function(){return e}}var constant_1=constant$1,constant=constant_1,defineProperty=_defineProperty,identity$1=identity_1,baseSetToString$1=defineProperty?function(e,t){return defineProperty(e,"toString",{configurable:!0,enumerable:!1,value:constant(t),writable:!0})}:identity$1,_baseSetToString=baseSetToString$1,HOT_COUNT=800,HOT_SPAN=16,nativeNow=Date.now;function shortOut$1(e){var t=0,r=0;return function(){var i=nativeNow(),n=HOT_SPAN-(i-r);if(r=i,n>0){if(++t>=HOT_COUNT)return arguments[0]}else t=0;return e.apply(void 0,arguments)}}var _shortOut=shortOut$1,baseSetToString=_baseSetToString,shortOut=_shortOut,setToString$1=shortOut(baseSetToString),_setToString=setToString$1,identity=identity_1,overRest=_overRest,setToString=_setToString;function baseRest$1(e,t){return setToString(overRest(e,t,identity),e+"")}var _baseRest=baseRest$1,eq=eq_1,isArrayLike=isArrayLike_1,isIndex=_isIndex,isObject=isObject_1;function isIterateeCall$1(e,t,r){if(!isObject(r))return!1;var i=typeof t;return!!("number"==i?isArrayLike(r)&&isIndex(t,r.length):"string"==i&&t in r)&&eq(r[t],e)}var _isIterateeCall=isIterateeCall$1,baseRest=_baseRest,isIterateeCall=_isIterateeCall;function createAssigner$1(e){return baseRest((function(t,r){var i=-1,n=r.length,s=n>1?r[n-1]:void 0,o=n>2?r[2]:void 0;for(s=e.length>3&&"function"==typeof s?(n--,s):void 0,o&&isIterateeCall(r[0],r[1],o)&&(s=n<3?void 0:s,n=1),t=Object(t);++i<n;){var a=r[i];a&&e(t,a,i,s)}return t}))}var _createAssigner=createAssigner$1,baseMerge=_baseMerge,createAssigner=_createAssigner,merge=createAssigner((function(e,t,r){baseMerge(e,t,r)})),merge_1=merge;const c=()=>({sessionId:"",presenter:"",viewState:exports.ViewState.Video,roomCode:""}),d=()=>({nickName:"",userId:"",endpointId:"",permissions:[],mediaOpts:{sharessrc:0,videossrc:[],audiossrc:0}});class Model{constructor(){this.An=new Map,this._n=c(),this.Tn=d(),this.Rn=""}get accessToken(){return this.Rn}get endpointId(){return this.Tn.endpointId}get permissions(){return this.Tn.permissions}get userId(){return this.Tn.userId}get nickName(){return this.Tn.nickName}get selfMediaOpts(){return this.Tn.mediaOpts}get sessionId(){return this._n.sessionId}get membersMap(){return this.An}get roomState(){return this._n}get roomCode(){return this._n.roomCode}insertMember(e){return this.An.set(e.endpointId,e),this}delMember(e){return this.An.delete(e),this}setMembers(e){return this.An.clear(),e.forEach((e=>{this.An.set(e.id,{nickname:e.nickname,userId:e.userId,deviceId:e.deviceId,endpointId:e.id,options:{...e.mediaOpts,isMute:e.isAudioMute,isVideoOff:e.isVideoMute,isSpeakerMute:e.isSpeakerMute},multiStreamInfo:e.multiStreamInfo})})),this}updateMember(e,t){return this.An.set(e,merge_1(this.An.get(e),t)),this}updateRoomState(e){return this._n={...this._n,...e},this}updateSelfState(e){return this.Tn={...this.Tn,...e},this}updateAccessToken(e){return this.Rn=e,this}resetRoom(){this.An.clear(),this._n=c(),this.Tn=d()}}const p=[AgentEventType.NETWORK_QUALITY,AgentEventType.ACTIVE_AUDIO_UPDATED,AgentEventType.RTC_STATS];let q=1;class Client{constructor(e){if(this.On=q++,this.Be=new Model,this.J=a$9(),this.In=!1,this.publish=async e=>{var t;this.jn("publish"),await(null===(t=this.Mn)||void 0===t?void 0:t.publish(e))},this.unpublish=async e=>{var t;this.jn("unpublish"),await(null===(t=this.Mn)||void 0===t?void 0:t.unpublish(e))},this.startCloudRecord=async e=>{var t;this.jn("startCloudRecord",e);const r=Date.now();await(null===(t=this.qn)||void 0===t?void 0:t.startCloudRecord(e)),metrics.post(Events.START_CLOUD_RECORD,{consume:Date.now()-r})},this.stopCloudRecord=async()=>{var e;this.jn("stopCloudRecord");const t=Date.now();await(null===(e=this.qn)||void 0===e?void 0:e.stopCloudRecord()),metrics.post(Events.STOP_CLOUD_RECORD,{consume:Date.now()-t})},this.leave=async()=>{this.jn("leave");const e=Date.now();try{var t;await(null===(t=this.Mn)||void 0===t?void 0:t.leave())}finally{this.Nn(),metrics.post(Events.LEAVE_CONFERENCE,{consume:Date.now()-e})}},this.dismiss=async()=>{this.jn("dismiss");try{var e;await(null===(e=this.Mn)||void 0===e?void 0:e.dismiss())}finally{this.Nn()}},!e)throw new Error("missing access token");this.Be.updateAccessToken(e),GlobalLogger.info(`client ${this.On} created`),this.J.on("*",((e,t)=>{p.includes(e)||GlobalLogger.info(`client ${this.On} ${e} dispatched`,t)})),metrics.start(this.Be)}get isDestroyed(){return this.In}jn(e,t){GlobalLogger.info(`client ${this.On}`,e,"api invoking",t||"")}async join(e){if(this.jn("join",e),this.Mn||this.qn||this.Pn)throw new MError(exports.ErrorCode.ClientJoinRoomAlready,"client join other room, please leave first");GlobalLogger.info(`client ${this.On} join begin`);try{this.Mn=new Agent({model:this.Be,ownerId:this.On}),this.Mn.onAll(((e,t)=>{Object.values(AgentEventType).includes(e)&&this.J.emit(e,t)}));const t=await this.Mn.join(e);this.Pn=new ServiceSocket({uri:e$6.ipv6&&t.serverOpts.socketUrlIPv6?t.serverOpts.socketUrlIPv6:t.serverOpts.socketUrlDomainName||t.serverOpts.socketUrl,endpointId:t.endpoint.id,accessToken:this.Be.accessToken,sessionId:t.session.id,userId:t.endpoint.userId,ownerId:this.On}),this.Mn.registerSocketEvent(this.Pn),this.qn=new RoomService({joinResult:t,socket:this.Pn,model:this.Be}),this.qn.registerSocketEvent(this.J),this.In||this.watchLeave(t.endpoint.id),this.In=!1;const{sdp:r,serverOpts:i,...n}=t;return{...n,serverOpts:{dataServer:i.dataServer}}}catch(e){throw GlobalLogger.error(`client ${this.On} join error`,e.message),this.Nn(),e}}async watchLeave(e){this.J.on(ClientEvents.USER_KICK_OUT,(t=>{t.endpointId===e&&this.Nn()})),this.J.on(ClientEvents.ROOM_CLOSE,(()=>{this.Nn()})),this.J.on(ClientEvents.CONNECTION_STATE_CHANGE,(e=>{e.state===exports.SocketEmitState.DISCONNECTED&&this.Nn()})),this.J.on(ClientEvents.MEDIA_STATE_CHANGE,(e=>{"failed"===e.state&&this.Nn()}))}async getMembers(){if(this.jn("getMembers"),!this.qn)throw new MError(exports.ErrorCode.NotInRoom,"not join room yet");return await this.qn.getMembers()}async getRoomInfo(){if(this.jn("getRoomInfo"),!this.qn)throw new MError(exports.ErrorCode.NotInRoom,"not join room yet");return await this.qn.getRoomInfo()}async kickOut(e){var t;return this.jn("kickOut",e),await(null===(t=this.qn)||void 0===t?void 0:t.kickOut(e))}async batchKickOut(e){var t;return this.jn("batchKickOut",e),await(null===(t=this.qn)||void 0===t?void 0:t.batchKickOut(e))}async changeRole(e){var t;return this.jn("changeRole",e),await(null===(t=this.qn)||void 0===t?void 0:t.changeRole(e))}async setMainVenue(e){var t;return this.jn("setMainVenue",e),await(null===(t=this.qn)||void 0===t?void 0:t.setMainVenue({endpointId:e,value:!0}))}async removeMainVenue(e){var t;return this.jn("removeMainVenue",e),await(null===(t=this.qn)||void 0===t?void 0:t.setMainVenue({endpointId:e,value:!1}))}async turnonVideo(e){var t;return this.jn("turnonVideo",e),await(null===(t=this.qn)||void 0===t?void 0:t.turnonVideo(e))}async turnoffVideo(e){var t;return this.jn("turnoffVideo",e),await(null===(t=this.qn)||void 0===t?void 0:t.turnoffVideo(e))}async muteAll(e){var t;return this.jn("muteAll",e),await(null===(t=this.qn)||void 0===t?void 0:t.muteAll(e))}async unmuteAll(){var e;return this.jn("unmuteAll"),await(null===(e=this.qn)||void 0===e?void 0:e.unmuteAll())}async mute(e){var t;return this.jn("mute",e),await(null===(t=this.qn)||void 0===t?void 0:t.mute(e))}async muteSpeaker(e){var t;return this.jn("muteSpeaker",e),await(null===(t=this.qn)||void 0===t?void 0:t.muteSpeaker(e))}async unmuteSpeaker(e){var t;return this.jn("unmuteSpeaker",e),await(null===(t=this.qn)||void 0===t?void 0:t.unmuteSpeaker(e))}async unmute(e){var t;return this.jn("unmute",e),await(null===(t=this.qn)||void 0===t?void 0:t.unmute(e))}async rejectUnmute(){var e;return this.jn("rejectUnmute"),await(null===(e=this.qn)||void 0===e?void 0:e.rejectUnmute())}async rejectTurnonVideo(){var e;return this.jn("rejectTurnonVideo"),await(null===(e=this.qn)||void 0===e?void 0:e.rejectTurnonVideo())}async updateMode(e){var t;return this.jn("updateMode",e),await(null===(t=this.Mn)||void 0===t?void 0:t.changeMode(e))}async setRoomOptions(e){var t;return this.jn("setRoomOptions",e),await(null===(t=this.qn)||void 0===t?void 0:t.setRoomOptions(e))}async getRoomOptions(){var e;return this.jn("getRoomOptions"),await(null===(e=this.qn)||void 0===e?void 0:e.getRoomOptions())}async changeNickname(e){var t;return this.jn("changeNickname"),await(null===(t=this.qn)||void 0===t?void 0:t.changeNickname(e))}Nn(){var e,t;GlobalLogger.info(`client ${this.On} destroyed`),this.In=!0,null===(e=this.Pn)||void 0===e||e.disconnect(),null===(t=this.Mn)||void 0===t||t.destroy(),this.Be.resetRoom(),this.Pn=void 0,this.Mn=void 0,this.qn=void 0,metrics.stop()}on(e,t){return GlobalLogger.info(`client ${this.On} ${e} register`),this.J.on(e,t),this}off(e,t){return GlobalLogger.info(`client ${this.On} ${e} unregister`),this.J.off(e,t),this}async subscribeVideo(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:exports.Resolution.rs360,r=arguments.length>2?arguments[2]:void 0;if(this.jn("subscribeVideo",{endpointId:e,resolution:t}),!this.Mn)throw new MError(exports.ErrorCode.MediaAgentNotReady,"media agent not ready");return(await this.Mn.subscribeVideo([{endpointId:e,resolution:t,captureSourceId:r}]))[0]}async unsubscribeVideo(e,t){if(this.jn("unsubscribeVideo",{endpointId:e}),!this.Mn)throw new MError(exports.ErrorCode.MediaAgentNotReady,"media agent not ready");await this.Mn.unsubscribeVideo([{endpointId:e,captureSourceId:t}])}async massSubscribeVideo(e){if(this.jn("massSubscribeVideo",e),!this.Mn)throw new MError(exports.ErrorCode.MediaAgentNotReady,"media agent not ready");return await this.Mn.subscribeVideo(e.map((e=>({...e,resolution:e.resolution||exports.Resolution.rs360}))))}async massUnsubscribeVideo(e){if(this.jn("massUnsubscribeVideo",e),!this.Mn)throw new MError(exports.ErrorCode.MediaAgentNotReady,"media agent not ready");await this.Mn.unsubscribeVideo(e)}async subscribeShare(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:exports.Resolution.rs1080;if(this.jn("subscribeShare",e),!this.Mn)throw new MError(exports.ErrorCode.MediaAgentNotReady,"media agent not ready");return await this.Mn.subscribeShare(e)}async unsubscribeShare(){if(this.jn("unsubscribeShare"),!this.Mn)throw new MError(exports.ErrorCode.MediaAgentNotReady,"media agent not ready");await this.Mn.unsubscribeShare()}async subscribeActiveVideo(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:exports.Resolution.rs360;if(this.jn("subscribeActiveVideo",e),!this.Mn)throw new MError(exports.ErrorCode.MediaAgentNotReady,"media agent not ready");return await this.Mn.subscribeActiveVideo(e)}async unsubscribeActiveVideo(){if(this.jn("unsubscribeActiveVideo"),!this.Mn)throw new MError(exports.ErrorCode.MediaAgentNotReady,"media agent not ready");await this.Mn.unsubscribeActiveVideo()}async hangUp(){var e;if(this.jn("hangUp"),!this.Mn)throw new MError(exports.ErrorCode.MediaAgentNotReady,"media agent not ready");await(null===(e=this.qn)||void 0===e?void 0:e.hangUp())}async hangOn(){var e;if(this.jn("handOn"),!this.Mn)throw new MError(exports.ErrorCode.MediaAgentNotReady,"media agent not ready");await(null===(e=this.qn)||void 0===e?void 0:e.hangOn())}async turnOffAudioMode(){var e;if(this.jn("turnOffAudioMode"),!this.Mn)throw new MError(exports.ErrorCode.MediaAgentNotReady,"media agent not ready");await(null===(e=this.qn)||void 0===e?void 0:e.turnOffAudioMode())}async turnOnAudioMode(){var e;if(this.jn("turnOnAudioMode"),!this.Mn)throw new MError(exports.ErrorCode.MediaAgentNotReady,"media agent not ready");await(null===(e=this.qn)||void 0===e?void 0:e.turnOnAudioMode())}}function e(e){return!!e.deviceId}class f{constructor(){this.J=a$9(),this.Dn=[],this.Ln=!1,this.init=()=>{if(this.Ln)return;if(!navigator.mediaDevices||!navigator.mediaDevices.enumerateDevices)throw new MError(exports.ErrorCode.NotSupport,"not support media ");const e=(e,t,r)=>{const i=t.filter((e=>e.kind===r));if(i.length){const t={audioinput:"microphone-changed",audiooutput:"playback-changed",videoinput:"camera-changed"};this.J.emit(t[r],{state:e,devices:i})}};if(navigator.mediaDevices.addEventListener("devicechange",(async()=>{const t=await navigator.mediaDevices.enumerateDevices(),r=new Map,i=new Map,n=[];if(t.forEach((e=>{r.set(e.deviceId+e.kind,e)})),this.Dn.forEach((e=>{i.set(e.deviceId+e.kind,e)})),r.forEach(((e,t)=>{var s,o;/default|communications/.test(t)&&e.groupId!==(null===(s=i.get(t))||void 0===s?void 0:s.groupId)?(r.delete(t),i.delete(t),n.push(e)):e.groupId===(null===(o=i.get(t))||void 0===o?void 0:o.groupId)&&(r.delete(t),i.delete(t))})),this.Dn=t,r.size){const t=[...r.values()];e("active",t,"audioinput"),e("active",t,"videoinput"),e("active",t,"audiooutput")}if(i.size){const t=[...i.values()];e("inactive",t,"audioinput"),e("inactive",t,"videoinput"),e("inactive",t,"audiooutput")}n.length&&this.J.emit("default-changed",n)})),navigator.permissions&&navigator.permissions.query)try{navigator.permissions.query({name:"microphone"}).then((e=>{this.Bn=e})).catch((e=>{deviceLogger.info("init microphone permission api fail",e)})),navigator.permissions.query({name:"camera"}).then((e=>{this.Fn=e})).catch((e=>{deviceLogger.info("init camera permission api fail",e)}))}catch(e){deviceLogger.error("not support permission api",e)}else deviceLogger.info("not support permission api");this.Ln=!0},this.getDevices=async()=>{deviceLogger.info("getDevices invoked");const e=await navigator.mediaDevices.enumerateDevices();return this.Dn=e,e},this.getCameras=async()=>(deviceLogger.info("getCameras invoked"),(await this.getDevices()).filter((e=>"videoinput"===e.kind)).filter(e)),this.getPlaybackDevices=async()=>(deviceLogger.info("getPlaybackDevices invoked"),(await this.getDevices()).filter((e=>"audiooutput"===e.kind)).filter(e)),this.getMicrophones=async()=>(deviceLogger.info("getMicrophones invoked"),(await this.getDevices()).filter((e=>"audioinput"===e.kind)).filter(e)),this.onCameraChanged=e=>{function t(t){e(t),deviceLogger.info("onCameraChanged dispatched",t)}return this.J.on("camera-changed",t),deviceLogger.info("onCameraChanged registered"),()=>{this.J.off("camera-changed",t),deviceLogger.info("onCameraChanged unregistered")}},this.onMicrophoneChanged=e=>{function t(t){e(t),deviceLogger.info("onMicrophoneChanged dispatched",t)}return this.J.on("microphone-changed",t),deviceLogger.info("onMicrophoneChanged registered"),()=>{this.J.off("microphone-changed",t),deviceLogger.info("onMicrophoneChanged unregistered")}},this.onPlaybackDeviceChanged=e=>{function t(t){e(t),deviceLogger.info("onPlaybackDeviceChanged dispatched",t)}return this.J.on("playback-changed",t),deviceLogger.info("onPlaybackDeviceChanged registered"),()=>{this.J.off("playback-changed",t),deviceLogger.info("onPlaybackDeviceChanged unregistered")}},this.onDefaultDeviceChanged=e=>{function t(t){e(t),deviceLogger.info("onDefaultDeviceChanged dispatched",t)}return this.J.on("default-changed",t),deviceLogger.info("onDefaultDeviceChanged registered"),()=>{this.J.off("default-changed",t),deviceLogger.info("onDefaultDeviceChanged unregistered")}},this.getMicrophonePermission=async()=>{if(!navigator.permissions||!navigator.permissions.query)throw new MError(exports.ErrorCode.NotSupport,"not support");deviceLogger.info("getMicrophonePermission invoked");try{return(await navigator.permissions.query({name:"microphone"})).state}catch(e){throw new MError(exports.ErrorCode.NotSupport,"not support")}},this.getCameraPermission=async()=>{if(!navigator.permissions||!navigator.permissions.query)throw new MError(exports.ErrorCode.NotSupport,"not support");deviceLogger.info("getCameraPermission invoked");try{return(await navigator.permissions.query({name:"camera"})).state}catch(e){throw new MError(exports.ErrorCode.NotSupport,"not support")}},this.onCameraPermissionChanged=e=>{if(!this.Fn)throw new MError(exports.ErrorCode.NotSupport,"not support");function t(t){t&&e(t.target.state),deviceLogger.info("onCameraPermissionChanged dispatched",t&&t.target&&t.target.state)}return this.Fn.addEventListener("change",t),deviceLogger.info("onCameraPermissionChanged registered"),()=>{var e;null===(e=this.Fn)||void 0===e||e.removeEventListener("change",t),deviceLogger.info("onCameraPermissionChanged unregistered")}},this.onMicrophonePermissionChanged=e=>{if(!this.Bn)throw new MError(exports.ErrorCode.NotSupport,"not support");function t(t){t&&e(t.target.state),deviceLogger.info("onMicrophonePermissionChanged dispatched",t&&t.target&&t.target.state)}return this.Bn.addEventListener("change",t),deviceLogger.info("onMicrophonePermissionChanged registered"),()=>{var e;null===(e=this.Bn)||void 0===e||e.removeEventListener("change",t),deviceLogger.info("onMicrophonePermissionChanged unregistered")}}}}const g$2=new f,init$1=g$2.init,getDevices=g$2.getDevices,getCameras=g$2.getCameras,getPlaybackDevices=g$2.getPlaybackDevices,getMicrophones=g$2.getMicrophones,onCameraChanged=g$2.onCameraChanged,onMicrophoneChanged=g$2.onMicrophoneChanged,onPlaybackDeviceChanged=g$2.onPlaybackDeviceChanged,onDefaultDeviceChanged=g$2.onDefaultDeviceChanged,getMicrophonePermission=g$2.getMicrophonePermission,getCameraPermission=g$2.getCameraPermission,onMicrophonePermissionChanged=g$2.onMicrophonePermissionChanged,onCameraPermissionChanged=g$2.onCameraPermissionChanged;var g$1;!function(e){e.OS="x-os-type",e.CSRF="x-csrf-token",e.HOST="x-ml-host"}(g$1||(g$1={}));const init=function(e){"string"==typeof e.server&&(e$6.ServerUri.apiProxy=e.server),Object.assign(e$6.HeaderConfig,{...e.extraHeaders,"x-device-type":"mobile"===e.deviceType?"m-web-sdk":"pc-web-sdk","x-ml-host":e$6.ServerUri.apiProxy}),"boolean"==typeof e.ipv6&&(e$6.ipv6=e.ipv6),e$6.maxEndpoint=Math.max(3,Math.min(25,e.maxEndpoint||9)),init$1(),GlobalLogger.info("initialized with",e)},createClient=function(e){if(e&&updateAuthToken(e),getAuthToken().access_token)return new Client(getAuthToken().access_token);throw new Error("please do login before create client")};var sha256Exports={},sha256={get exports(){return sha256Exports},set exports(e){sha256Exports=e}};async function g(){const e=getClientToken();if(e.access_token)return e;AuthLogger.info("getClientToken invoked");const{data:t}=await a$2.Auth.ne({data:{scope:"basic",state:"web"}});return AuthLogger.info("getClientToken success"),updateClientToken(t),t}
/**
   * [js-sha256]{@link https://github.com/emn178/js-sha256}
   *
   * @version 0.9.0
   * @author Chen, Yi-Cyuan [emn178@gmail.com]
   * @copyright Chen, Yi-Cyuan 2014-2017
   * @license MIT
   */
(function(module){(function(){var ERROR="input is invalid type",WINDOW="object"==typeof window,root=WINDOW?window:{};root.JS_SHA256_NO_WINDOW&&(WINDOW=!1);var WEB_WORKER=!WINDOW&&"object"==typeof self,NODE_JS=!root.JS_SHA256_NO_NODE_JS&&"object"==typeof process&&process.versions&&process.versions.node;NODE_JS?root=commonjsGlobal:WEB_WORKER&&(root=self);var COMMON_JS=!root.JS_SHA256_NO_COMMON_JS&&module.exports,ARRAY_BUFFER=!root.JS_SHA256_NO_ARRAY_BUFFER&&"undefined"!=typeof ArrayBuffer,HEX_CHARS="0123456789abcdef".split(""),EXTRA=[-2147483648,8388608,32768,128],SHIFT=[24,16,8,0],K=[1116352408,1899447441,3049323471,3921009573,961987163,1508970993,2453635748,2870763221,3624381080,310598401,607225278,1426881987,1925078388,2162078206,2614888103,3248222580,3835390401,4022224774,264347078,604807628,770255983,1249150122,1555081692,1996064986,2554220882,2821834349,2952996808,3210313671,3336571891,3584528711,113926993,338241895,666307205,773529912,1294757372,1396182291,1695183700,1986661051,2177026350,2456956037,2730485921,2820302411,3259730800,3345764771,3516065817,3600352804,4094571909,275423344,430227734,506948616,659060556,883997877,958139571,1322822218,1537002063,1747873779,1955562222,2024104815,2227730452,2361852424,2428436474,2756734187,3204031479,3329325298],OUTPUT_TYPES=["hex","array","digest","arrayBuffer"],blocks=[];!root.JS_SHA256_NO_NODE_JS&&Array.isArray||(Array.isArray=function(e){return"[object Array]"===Object.prototype.toString.call(e)}),!ARRAY_BUFFER||!root.JS_SHA256_NO_ARRAY_BUFFER_IS_VIEW&&ArrayBuffer.isView||(ArrayBuffer.isView=function(e){return"object"==typeof e&&e.buffer&&e.buffer.constructor===ArrayBuffer});var createOutputMethod=function(e,t){return function(r){return new Sha256(t,!0).update(r)[e]()}},createMethod=function(e){var t=createOutputMethod("hex",e);NODE_JS&&(t=nodeWrap(t,e)),t.create=function(){return new Sha256(e)},t.update=function(e){return t.create().update(e)};for(var r=0;r<OUTPUT_TYPES.length;++r){var i=OUTPUT_TYPES[r];t[i]=createOutputMethod(i,e)}return t},nodeWrap=function(method,is224){var crypto=eval("require('crypto')"),Buffer=eval("require('buffer').Buffer"),algorithm=is224?"sha224":"sha256",nodeMethod=function(e){if("string"==typeof e)return crypto.createHash(algorithm).update(e,"utf8").digest("hex");if(null==e)throw new Error(ERROR);return e.constructor===ArrayBuffer&&(e=new Uint8Array(e)),Array.isArray(e)||ArrayBuffer.isView(e)||e.constructor===Buffer?crypto.createHash(algorithm).update(new Buffer(e)).digest("hex"):method(e)};return nodeMethod},createHmacOutputMethod=function(e,t){return function(r,i){return new HmacSha256(r,t,!0).update(i)[e]()}},createHmacMethod=function(e){var t=createHmacOutputMethod("hex",e);t.create=function(t){return new HmacSha256(t,e)},t.update=function(e,r){return t.create(e).update(r)};for(var r=0;r<OUTPUT_TYPES.length;++r){var i=OUTPUT_TYPES[r];t[i]=createHmacOutputMethod(i,e)}return t};function Sha256(e,t){t?(blocks[0]=blocks[16]=blocks[1]=blocks[2]=blocks[3]=blocks[4]=blocks[5]=blocks[6]=blocks[7]=blocks[8]=blocks[9]=blocks[10]=blocks[11]=blocks[12]=blocks[13]=blocks[14]=blocks[15]=0,this.blocks=blocks):this.blocks=[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0],e?(this.h0=3238371032,this.h1=914150663,this.h2=812702999,this.h3=4144912697,this.h4=4290775857,this.h5=1750603025,this.h6=1694076839,this.h7=3204075428):(this.h0=1779033703,this.h1=3144134277,this.h2=1013904242,this.h3=2773480762,this.h4=1359893119,this.h5=2600822924,this.h6=528734635,this.h7=1541459225),this.block=this.start=this.bytes=this.hBytes=0,this.finalized=this.hashed=!1,this.first=!0,this.is224=e}function HmacSha256(e,t,r){var i,n=typeof e;if("string"===n){var s,o=[],a=e.length,c=0;for(i=0;i<a;++i)(s=e.charCodeAt(i))<128?o[c++]=s:s<2048?(o[c++]=192|s>>6,o[c++]=128|63&s):s<55296||s>=57344?(o[c++]=224|s>>12,o[c++]=128|s>>6&63,o[c++]=128|63&s):(s=65536+((1023&s)<<10|1023&e.charCodeAt(++i)),o[c++]=240|s>>18,o[c++]=128|s>>12&63,o[c++]=128|s>>6&63,o[c++]=128|63&s);e=o}else{if("object"!==n)throw new Error(ERROR);if(null===e)throw new Error(ERROR);if(ARRAY_BUFFER&&e.constructor===ArrayBuffer)e=new Uint8Array(e);else if(!(Array.isArray(e)||ARRAY_BUFFER&&ArrayBuffer.isView(e)))throw new Error(ERROR)}e.length>64&&(e=new Sha256(t,!0).update(e).array());var u=[],h=[];for(i=0;i<64;++i){var d=e[i]||0;u[i]=92^d,h[i]=54^d}Sha256.call(this,t,r),this.update(h),this.oKeyPad=u,this.inner=!0,this.sharedMemory=r}Sha256.prototype.update=function(e){if(!this.finalized){var t,r=typeof e;if("string"!==r){if("object"!==r)throw new Error(ERROR);if(null===e)throw new Error(ERROR);if(ARRAY_BUFFER&&e.constructor===ArrayBuffer)e=new Uint8Array(e);else if(!(Array.isArray(e)||ARRAY_BUFFER&&ArrayBuffer.isView(e)))throw new Error(ERROR);t=!0}for(var i,n,s=0,o=e.length,a=this.blocks;s<o;){if(this.hashed&&(this.hashed=!1,a[0]=this.block,a[16]=a[1]=a[2]=a[3]=a[4]=a[5]=a[6]=a[7]=a[8]=a[9]=a[10]=a[11]=a[12]=a[13]=a[14]=a[15]=0),t)for(n=this.start;s<o&&n<64;++s)a[n>>2]|=e[s]<<SHIFT[3&n++];else for(n=this.start;s<o&&n<64;++s)(i=e.charCodeAt(s))<128?a[n>>2]|=i<<SHIFT[3&n++]:i<2048?(a[n>>2]|=(192|i>>6)<<SHIFT[3&n++],a[n>>2]|=(128|63&i)<<SHIFT[3&n++]):i<55296||i>=57344?(a[n>>2]|=(224|i>>12)<<SHIFT[3&n++],a[n>>2]|=(128|i>>6&63)<<SHIFT[3&n++],a[n>>2]|=(128|63&i)<<SHIFT[3&n++]):(i=65536+((1023&i)<<10|1023&e.charCodeAt(++s)),a[n>>2]|=(240|i>>18)<<SHIFT[3&n++],a[n>>2]|=(128|i>>12&63)<<SHIFT[3&n++],a[n>>2]|=(128|i>>6&63)<<SHIFT[3&n++],a[n>>2]|=(128|63&i)<<SHIFT[3&n++]);this.lastByteIndex=n,this.bytes+=n-this.start,n>=64?(this.block=a[16],this.start=n-64,this.hash(),this.hashed=!0):this.start=n}return this.bytes>4294967295&&(this.hBytes+=this.bytes/4294967296<<0,this.bytes=this.bytes%4294967296),this}},Sha256.prototype.finalize=function(){if(!this.finalized){this.finalized=!0;var e=this.blocks,t=this.lastByteIndex;e[16]=this.block,e[t>>2]|=EXTRA[3&t],this.block=e[16],t>=56&&(this.hashed||this.hash(),e[0]=this.block,e[16]=e[1]=e[2]=e[3]=e[4]=e[5]=e[6]=e[7]=e[8]=e[9]=e[10]=e[11]=e[12]=e[13]=e[14]=e[15]=0),e[14]=this.hBytes<<3|this.bytes>>>29,e[15]=this.bytes<<3,this.hash()}},Sha256.prototype.hash=function(){var e,t,r,i,n,s,o,a,c,u=this.h0,h=this.h1,d=this.h2,f=this.h3,l=this.h4,p=this.h5,v=this.h6,b=this.h7,m=this.blocks;for(e=16;e<64;++e)t=((n=m[e-15])>>>7|n<<25)^(n>>>18|n<<14)^n>>>3,r=((n=m[e-2])>>>17|n<<15)^(n>>>19|n<<13)^n>>>10,m[e]=m[e-16]+t+m[e-7]+r<<0;for(c=h&d,e=0;e<64;e+=4)this.first?(this.is224?(s=300032,b=(n=m[0]-1413257819)-150054599<<0,f=n+24177077<<0):(s=704751109,b=(n=m[0]-210244248)-1521486534<<0,f=n+143694565<<0),this.first=!1):(t=(u>>>2|u<<30)^(u>>>13|u<<19)^(u>>>22|u<<10),i=(s=u&h)^u&d^c,b=f+(n=b+(r=(l>>>6|l<<26)^(l>>>11|l<<21)^(l>>>25|l<<7))+(l&p^~l&v)+K[e]+m[e])<<0,f=n+(t+i)<<0),t=(f>>>2|f<<30)^(f>>>13|f<<19)^(f>>>22|f<<10),i=(o=f&u)^f&h^s,v=d+(n=v+(r=(b>>>6|b<<26)^(b>>>11|b<<21)^(b>>>25|b<<7))+(b&l^~b&p)+K[e+1]+m[e+1])<<0,t=((d=n+(t+i)<<0)>>>2|d<<30)^(d>>>13|d<<19)^(d>>>22|d<<10),i=(a=d&f)^d&u^o,p=h+(n=p+(r=(v>>>6|v<<26)^(v>>>11|v<<21)^(v>>>25|v<<7))+(v&b^~v&l)+K[e+2]+m[e+2])<<0,t=((h=n+(t+i)<<0)>>>2|h<<30)^(h>>>13|h<<19)^(h>>>22|h<<10),i=(c=h&d)^h&f^a,l=u+(n=l+(r=(p>>>6|p<<26)^(p>>>11|p<<21)^(p>>>25|p<<7))+(p&v^~p&b)+K[e+3]+m[e+3])<<0,u=n+(t+i)<<0;this.h0=this.h0+u<<0,this.h1=this.h1+h<<0,this.h2=this.h2+d<<0,this.h3=this.h3+f<<0,this.h4=this.h4+l<<0,this.h5=this.h5+p<<0,this.h6=this.h6+v<<0,this.h7=this.h7+b<<0},Sha256.prototype.hex=function(){this.finalize();var e=this.h0,t=this.h1,r=this.h2,i=this.h3,n=this.h4,s=this.h5,o=this.h6,a=this.h7,c=HEX_CHARS[e>>28&15]+HEX_CHARS[e>>24&15]+HEX_CHARS[e>>20&15]+HEX_CHARS[e>>16&15]+HEX_CHARS[e>>12&15]+HEX_CHARS[e>>8&15]+HEX_CHARS[e>>4&15]+HEX_CHARS[15&e]+HEX_CHARS[t>>28&15]+HEX_CHARS[t>>24&15]+HEX_CHARS[t>>20&15]+HEX_CHARS[t>>16&15]+HEX_CHARS[t>>12&15]+HEX_CHARS[t>>8&15]+HEX_CHARS[t>>4&15]+HEX_CHARS[15&t]+HEX_CHARS[r>>28&15]+HEX_CHARS[r>>24&15]+HEX_CHARS[r>>20&15]+HEX_CHARS[r>>16&15]+HEX_CHARS[r>>12&15]+HEX_CHARS[r>>8&15]+HEX_CHARS[r>>4&15]+HEX_CHARS[15&r]+HEX_CHARS[i>>28&15]+HEX_CHARS[i>>24&15]+HEX_CHARS[i>>20&15]+HEX_CHARS[i>>16&15]+HEX_CHARS[i>>12&15]+HEX_CHARS[i>>8&15]+HEX_CHARS[i>>4&15]+HEX_CHARS[15&i]+HEX_CHARS[n>>28&15]+HEX_CHARS[n>>24&15]+HEX_CHARS[n>>20&15]+HEX_CHARS[n>>16&15]+HEX_CHARS[n>>12&15]+HEX_CHARS[n>>8&15]+HEX_CHARS[n>>4&15]+HEX_CHARS[15&n]+HEX_CHARS[s>>28&15]+HEX_CHARS[s>>24&15]+HEX_CHARS[s>>20&15]+HEX_CHARS[s>>16&15]+HEX_CHARS[s>>12&15]+HEX_CHARS[s>>8&15]+HEX_CHARS[s>>4&15]+HEX_CHARS[15&s]+HEX_CHARS[o>>28&15]+HEX_CHARS[o>>24&15]+HEX_CHARS[o>>20&15]+HEX_CHARS[o>>16&15]+HEX_CHARS[o>>12&15]+HEX_CHARS[o>>8&15]+HEX_CHARS[o>>4&15]+HEX_CHARS[15&o];return this.is224||(c+=HEX_CHARS[a>>28&15]+HEX_CHARS[a>>24&15]+HEX_CHARS[a>>20&15]+HEX_CHARS[a>>16&15]+HEX_CHARS[a>>12&15]+HEX_CHARS[a>>8&15]+HEX_CHARS[a>>4&15]+HEX_CHARS[15&a]),c},Sha256.prototype.toString=Sha256.prototype.hex,Sha256.prototype.digest=function(){this.finalize();var e=this.h0,t=this.h1,r=this.h2,i=this.h3,n=this.h4,s=this.h5,o=this.h6,a=this.h7,c=[e>>24&255,e>>16&255,e>>8&255,255&e,t>>24&255,t>>16&255,t>>8&255,255&t,r>>24&255,r>>16&255,r>>8&255,255&r,i>>24&255,i>>16&255,i>>8&255,255&i,n>>24&255,n>>16&255,n>>8&255,255&n,s>>24&255,s>>16&255,s>>8&255,255&s,o>>24&255,o>>16&255,o>>8&255,255&o];return this.is224||c.push(a>>24&255,a>>16&255,a>>8&255,255&a),c},Sha256.prototype.array=Sha256.prototype.digest,Sha256.prototype.arrayBuffer=function(){this.finalize();var e=new ArrayBuffer(this.is224?28:32),t=new DataView(e);return t.setUint32(0,this.h0),t.setUint32(4,this.h1),t.setUint32(8,this.h2),t.setUint32(12,this.h3),t.setUint32(16,this.h4),t.setUint32(20,this.h5),t.setUint32(24,this.h6),this.is224||t.setUint32(28,this.h7),e},HmacSha256.prototype=new Sha256,HmacSha256.prototype.finalize=function(){if(Sha256.prototype.finalize.call(this),this.inner){this.inner=!1;var e=this.array();Sha256.call(this,this.is224,this.sharedMemory),this.update(this.oKeyPad),this.update(e),Sha256.prototype.finalize.call(this)}};var exports=createMethod();exports.sha256=exports,exports.sha224=createMethod(!0),exports.sha256.hmac=createHmacMethod(),exports.sha224.hmac=createHmacMethod(!0),COMMON_JS?module.exports=exports:(root.sha256=exports.sha256,root.sha224=exports.sha224)})()})(sha256);const loginWithPassword=async e=>{let{account:t,password:r}=e;AuthLogger.info("loginWithPassword invoked"),await g();const{data:i}=await a$2.Auth.se({data:{scope:"basic",state:"web",username:t,password:sha256Exports.sha256.hex(r)}});return updateAuthToken(i),AuthLogger.info("loginWithAuthCode success",i.userId),i},loginWithAuthCode=async e=>{let{authCode:t,authType:r}=e;AuthLogger.info("loginWithAuthCode invoked");const{data:i}=await a$2.Auth.oe({data:{scope:"basic",state:"web",authCode:t,authType:r}});return updateAuthToken(i),AuthLogger.info("loginWithAuthCode success",i.userId),i},l={noiseSuppression:!0,echoCancellation:!0,autoGainControl:!0};async function createMicrophoneAudioTrack(e){trackLogger.info("createMicrophoneAudioTrack invoked",e);const t=+new Date,r=(await navigator.mediaDevices.enumerateDevices()).filter((e=>"audioinput"===e.kind));if(!r.length)throw new MError(exports.ErrorCode.DeviceNotFound,"not found audio input device");try{const r=await navigator.mediaDevices.getUserMedia({audio:{...l,...e}}),i=r.getAudioTracks()[0],n=new MicrophoneAudioTrack(i,r);return trackLogger.info("createMicrophoneAudioTrack success, used time",+new Date-t),n}catch(e){throw formatError(e)}}async function createCameraVideoTrack(e){try{trackLogger.info("createCameraVideoTrack invoked",e);const t=+new Date,r=(await navigator.mediaDevices.enumerateDevices()).filter((e=>"videoinput"===e.kind));if(!r.length)throw new MError(exports.ErrorCode.DeviceNotFound,"not found video input device");const i=await navigator.mediaDevices.getUserMedia({video:{...e}}),n=i.getVideoTracks()[0],s=new CameraVideoTrack(n,i);return trackLogger.info("createCameraVideoTrack success, used time",+new Date-t),s}catch(e){throw formatError(e)}}async function createMicrophoneAndCameraTracks(e){let{audio:t,video:r}=e;try{trackLogger.info("createMicrophoneAndCameraTracks invoked",t,r);const e=+new Date,i=await navigator.mediaDevices.enumerateDevices(),n=i.filter((e=>"audioinput"===e.kind)),s=i.filter((e=>"videoinput"===e.kind));if(!n.length||!s.length)throw new MError(exports.ErrorCode.DeviceNotFound,"not found audio or video input device");const o=await navigator.mediaDevices.getUserMedia({video:{...r},audio:{...l,...t}}),a=new MediaStream(o.getAudioTracks()),c=new MediaStream(o.getVideoTracks()),u=a.getAudioTracks()[0],h=c.getVideoTracks()[0],d=[new MicrophoneAudioTrack(u,a),new CameraVideoTrack(h,c)];return trackLogger.info("createMicrophoneAndCameraTracks success, used time",+new Date-e),d}catch(e){throw formatError(e)}}async function createScreenVideoTrack(){let e=!(arguments.length>0&&void 0!==arguments[0])||arguments[0],t=arguments.length>1&&void 0!==arguments[1]&&arguments[1],r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{};try{trackLogger.info("createScreenVideoTrack invoked",e,t);const i=+new Date,n=await navigator.mediaDevices.getDisplayMedia({...r,video:e,audio:t});trackLogger.info("screen video receive display media");const s=n.getAudioTracks().length?n.clone():void 0,o=n;o.getAudioTracks().forEach((e=>{o.removeTrack(e)})),null==s||s.getVideoTracks().forEach((e=>{s.removeTrack(e)}));const a=[new ScreenVideoTrack(o.getVideoTracks()[0],o),...s?[new ScreenAudioTrack(s.getAudioTracks()[0],s)]:[]];return trackLogger.info("createScreenVideoTrack success, used time",+new Date-i),a}catch(e){throw formatError(e)}}async function createElectronScreenVideoTrack(e){try{trackLogger.info("createElectronScreenVideoTrack invoked",e);const t=+new Date,r=await navigator.mediaDevices.getUserMedia({video:{mandatory:e}});trackLogger.info("electron screen video receive display media");const i=r;i.getAudioTracks().forEach((e=>{i.removeTrack(e)}));const n=[new ElectronScreenVideoTrack(i.getVideoTracks()[0],i)];return trackLogger.info("createElectronScreenVideoTrack success, used time",+new Date-t),n}catch(e){throw formatError(e)}}function createCustomAudioTrack(e){const t=e.getAudioTracks()[0];if(t)return e.getVideoTracks().forEach((t=>e.removeTrack(t))),new LocalAudioTrack(t,e);throw new MError(exports.ErrorCode.StreamTrackNull)}function createCustomVideoTrack(e){const t=e.getVideoTracks()[0];if(t)return e.getAudioTracks().forEach((t=>e.removeTrack(t))),new LocalVideoTrack(t,e);throw new MError(exports.ErrorCode.StreamTrackNull)}const registerExtensions=e=>{e.forEach((e=>{e.registered=!0,e.logger=bindLoggerTag("extension","")}))},version=e$6.version,commit=e$6.commit;exports.ClientEvents=ClientEvents,exports.MError=MError,exports.checkSystem=checkSystem,exports.commit=commit,exports.createCameraVideoTrack=createCameraVideoTrack,exports.createClient=createClient,exports.createCustomAudioTrack=createCustomAudioTrack,exports.createCustomVideoTrack=createCustomVideoTrack,exports.createElectronScreenVideoTrack=createElectronScreenVideoTrack,exports.createMicrophoneAndCameraTracks=createMicrophoneAndCameraTracks,exports.createMicrophoneAudioTrack=createMicrophoneAudioTrack,exports.createScreenVideoTrack=createScreenVideoTrack,exports.getCameraPermission=getCameraPermission,exports.getCameras=getCameras,exports.getDevices=getDevices,exports.getMicrophonePermission=getMicrophonePermission,exports.getMicrophones=getMicrophones,exports.getPlaybackDevices=getPlaybackDevices,exports.init=init,exports.loginWithAuthCode=loginWithAuthCode,exports.loginWithPassword=loginWithPassword,exports.onCameraChanged=onCameraChanged,exports.onCameraPermissionChanged=onCameraPermissionChanged,exports.onDefaultDeviceChanged=onDefaultDeviceChanged,exports.onMicrophoneChanged=onMicrophoneChanged,exports.onMicrophonePermissionChanged=onMicrophonePermissionChanged,exports.onPlaybackDeviceChanged=onPlaybackDeviceChanged,exports.registerExtensions=registerExtensions,exports.setLogLevel=setLogLevel,exports.setLogger=setLogger,exports.version=version}));
